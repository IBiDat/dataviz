<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>Age Distribution of Athletes by Sport since 1896</title>

  <meta property="description" itemprop="description" content="This project focuses on recreating a The Washington Post graph showing the olympic athlete distribution by sport and age since the inception of the modern games in 1896."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2025-01-09"/>
  <meta property="article:created" itemprop="dateCreated" content="2025-01-09"/>
  <meta name="article:author" content="Irene Bosque Gala"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Age Distribution of Athletes by Sport since 1896"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="This project focuses on recreating a The Washington Post graph showing the olympic athlete distribution by sport and age since the inception of the modern games in 1896."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Age Distribution of Athletes by Sport since 1896"/>
  <meta property="twitter:description" content="This project focuses on recreating a The Washington Post graph showing the olympic athlete distribution by sport and age since the inception of the modern games in 1896."/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","categories","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["Age Distribution of Athletes by Sport since 1896"]},{"type":"character","attributes":{},"value":["This project focuses on recreating a The Washington Post graph showing the olympic athlete distribution by sport and age since the inception of the modern games in 1896. \n"]},{"type":"character","attributes":{},"value":["2024"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Irene Bosque Gala"]}]}]},{"type":"character","attributes":{},"value":["2025-01-09"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["100535296_files/anchor-4.2.2/anchor.min.js","100535296_files/bowser-1.9.3/bowser.min.js","100535296_files/distill-2.2.21/template.v2.js","100535296_files/figure-html5/unnamed-chunk-11-1.png","100535296_files/figure-html5/unnamed-chunk-12-1.png","100535296_files/figure-html5/unnamed-chunk-13-1.png","100535296_files/figure-html5/unnamed-chunk-14-1.png","100535296_files/figure-html5/unnamed-chunk-15-1.png","100535296_files/figure-html5/unnamed-chunk-16-1.png","100535296_files/figure-html5/unnamed-chunk-17-1.png","100535296_files/figure-html5/unnamed-chunk-18-1.png","100535296_files/figure-html5/unnamed-chunk-19-1.png","100535296_files/figure-html5/unnamed-chunk-20-1.png","100535296_files/figure-html5/unnamed-chunk-21-1.png","100535296_files/figure-html5/unnamed-chunk-22-1.png","100535296_files/figure-html5/unnamed-chunk-23-1.png","100535296_files/header-attrs-2.28/header-attrs.js","100535296_files/jquery-3.6.0/jquery-3.6.0.js","100535296_files/jquery-3.6.0/jquery-3.6.0.min.js","100535296_files/jquery-3.6.0/jquery-3.6.0.min.map","100535296_files/popper-2.6.0/popper.min.js","100535296_files/tippy-6.2.7/tippy-bundle.umd.min.js","100535296_files/tippy-6.2.7/tippy-light-border.css","100535296_files/tippy-6.2.7/tippy.css","100535296_files/tippy-6.2.7/tippy.umd.min.js","100535296_files/webcomponents-2.0.0/webcomponents.js","432ccc9bae023c97f2f7a035df4d3e13.jpg","athlete_events1.csv","improvedgrafic-proueva.html","improvedgrafic-proueva_files/anchor-4.2.2/anchor.min.js","improvedgrafic-proueva_files/bowser-1.9.3/bowser.min.js","improvedgrafic-proueva_files/distill-2.2.21/template.v2.js","improvedgrafic-proueva_files/figure-html5/unnamed-chunk-3-1.png","improvedgrafic-proueva_files/figure-html5/unnamed-chunk-4-1.png","improvedgrafic-proueva_files/figure-html5/unnamed-chunk-5-1.png","improvedgrafic-proueva_files/header-attrs-2.28/header-attrs.js","improvedgrafic-proueva_files/jquery-3.6.0/jquery-3.6.0.js","improvedgrafic-proueva_files/jquery-3.6.0/jquery-3.6.0.min.js","improvedgrafic-proueva_files/jquery-3.6.0/jquery-3.6.0.min.map","improvedgrafic-proueva_files/popper-2.6.0/popper.min.js","improvedgrafic-proueva_files/tippy-6.2.7/tippy-bundle.umd.min.js","improvedgrafic-proueva_files/tippy-6.2.7/tippy-light-border.css","improvedgrafic-proueva_files/tippy-6.2.7/tippy.css","improvedgrafic-proueva_files/tippy-6.2.7/tippy.umd.min.js","improvedgrafic-proueva_files/webcomponents-2.0.0/webcomponents.js","PROJECT.html","PROJECT_files/anchor-4.2.2/anchor.min.js","PROJECT_files/bowser-1.9.3/bowser.min.js","PROJECT_files/distill-2.2.21/template.v2.js","PROJECT_files/figure-html5/unnamed-chunk-13-1.png","PROJECT_files/figure-html5/unnamed-chunk-14-1.png","PROJECT_files/figure-html5/unnamed-chunk-15-1.png","PROJECT_files/figure-html5/unnamed-chunk-16-1.png","PROJECT_files/figure-html5/unnamed-chunk-16-2.png","PROJECT_files/figure-html5/unnamed-chunk-17-1.png","PROJECT_files/figure-html5/unnamed-chunk-18-1.png","PROJECT_files/figure-html5/unnamed-chunk-19-1.png","PROJECT_files/figure-html5/unnamed-chunk-20-1.png","PROJECT_files/figure-html5/unnamed-chunk-21-1.png","PROJECT_files/figure-html5/unnamed-chunk-22-1.png","PROJECT_files/figure-html5/unnamed-chunk-23-1.png","PROJECT_files/figure-html5/unnamed-chunk-24-1.png","PROJECT_files/figure-html5/unnamed-chunk-25-1.png","PROJECT_files/figure-html5/unnamed-chunk-26-1.png","PROJECT_files/figure-html5/unnamed-chunk-27-1.png","PROJECT_files/figure-html5/unnamed-chunk-28-1.png","PROJECT_files/figure-html5/unnamed-chunk-29-1.png","PROJECT_files/header-attrs-2.28/header-attrs.js","PROJECT_files/jquery-3.6.0/jquery-3.6.0.js","PROJECT_files/jquery-3.6.0/jquery-3.6.0.min.js","PROJECT_files/jquery-3.6.0/jquery-3.6.0.min.map","PROJECT_files/popper-2.6.0/popper.min.js","PROJECT_files/tippy-6.2.7/tippy-bundle.umd.min.js","PROJECT_files/tippy-6.2.7/tippy-light-border.css","PROJECT_files/tippy-6.2.7/tippy.css","PROJECT_files/tippy-6.2.7/tippy.umd.min.js","PROJECT_files/webcomponents-2.0.0/webcomponents.js","pruebas-improved-graphic5.html","pruebas-improved-graphic5_files/anchor-4.2.2/anchor.min.js","pruebas-improved-graphic5_files/bowser-1.9.3/bowser.min.js","pruebas-improved-graphic5_files/distill-2.2.21/template.v2.js","pruebas-improved-graphic5_files/figure-html5/unnamed-chunk-3-1.png","pruebas-improved-graphic5_files/figure-html5/unnamed-chunk-4-1.png","pruebas-improved-graphic5_files/figure-html5/unnamed-chunk-5-1.png","pruebas-improved-graphic5_files/header-attrs-2.28/header-attrs.js","pruebas-improved-graphic5_files/jquery-3.6.0/jquery-3.6.0.js","pruebas-improved-graphic5_files/jquery-3.6.0/jquery-3.6.0.min.js","pruebas-improved-graphic5_files/jquery-3.6.0/jquery-3.6.0.min.map","pruebas-improved-graphic5_files/popper-2.6.0/popper.min.js","pruebas-improved-graphic5_files/tippy-6.2.7/tippy-bundle.umd.min.js","pruebas-improved-graphic5_files/tippy-6.2.7/tippy-light-border.css","pruebas-improved-graphic5_files/tippy-6.2.7/tippy.css","pruebas-improved-graphic5_files/tippy-6.2.7/tippy.umd.min.js","pruebas-improved-graphic5_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  hr.section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    margin: 0px;
  }


  d-byline {
    border-top: none;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
    border-top: none;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  /* tweak for Pandoc numbered line within distill */
  d-article pre.numberSource code > span {
      left: -2em;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // separator
    var separator = '<hr class="section-separator" style="clear: both"/>';
    // prepend separator above appendix
    $('.d-byline').before(separator);
    $('.d-article').before(separator);

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme, except when numbering line
    // in code chunk
    $('pre:not(.numberLines) code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        var author_name = front_matter.authors[i].author
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="100535296_files/header-attrs-2.28/header-attrs.js"></script>
  <script src="100535296_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="100535296_files/popper-2.6.0/popper.min.js"></script>
  <link href="100535296_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="100535296_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="100535296_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="100535296_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="100535296_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="100535296_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="100535296_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Age Distribution of Athletes by Sport since 1896","description":"This project focuses on recreating a The Washington Post graph showing the olympic athlete distribution by sport and age since the inception of the modern games in 1896.","authors":[{"author":"Irene Bosque Gala","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2025-01-09T00:00:00.000+01:00","citationText":"Gala, 2025"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Age Distribution of Athletes by Sport since 1896</h1>

<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt-tag">2024</div>
</div>
<!--/radix_placeholder_categories-->
<p><p>This project focuses on recreating a The Washington Post graph showing the olympic athlete distribution by sport and age since the inception of the modern games in 1896.</p></p>
</div>

<div class="d-byline">
  
  Irene Bosque Gala
  
<br/>2025-01-09
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#original-graph" id="toc-original-graph">ORIGINAL GRAPH</a>
<ul>
<li><a href="#strengths-and-limitations-of-the-visualization" id="toc-strengths-and-limitations-of-the-visualization">STRENGTHS AND LIMITATIONS OF THE VISUALIZATION</a></li>
</ul></li>
<li><a href="#graph-replication" id="toc-graph-replication">GRAPH REPLICATION</a>
<ul>
<li><a href="#downloading-libraries" id="toc-downloading-libraries">DOWNLOADING LIBRARIES</a></li>
<li><a href="#cleaning-data" id="toc-cleaning-data">CLEANING DATA</a></li>
<li><a href="#building-the-graph" id="toc-building-the-graph">BUILDING THE GRAPH</a>
<ul>
<li><a href="#fonts" id="toc-fonts">FONTS</a></li>
<li><a href="#theme" id="toc-theme">THEME</a></li>
<li><a href="#graph" id="toc-graph">GRAPH</a></li>
</ul></li>
</ul></li>
<li><a href="#alternative-graph" id="toc-alternative-graph">ALTERNATIVE GRAPH</a></li>
</ul>
</nav>
</div>
<h1 id="original-graph">ORIGINAL GRAPH</h1>
<p>The graph titled “Olympians” was published in 2012 by The Washington Post as part of an interactive feature exploring the history of Summer Olympic athletes since the first modern Games in 1896. The visualization aims to break down athlete participation by sport and age group, offering a comprehensive view of how athlete demographics vary across different disciplines, highlighting patterns and outliers in Olympic history.</p>
<p>The visualization organizes sports along the vertical axis, ranging from Archery to Wrestling, while the horizontal axis represents age groups, starting from 10–15 years and increasing gradually. The color gradient is used to indicate the density of athletes within each age group for a specific sport: darker blue shades represent higher participation, while lighter shades indicate smaller numbers.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="../../../432ccc9bae023c97f2f7a035df4d3e13.jpg" width="100%" /></p>
</div>
<h3 id="strengths-and-limitations-of-the-visualization">STRENGTHS AND LIMITATIONS OF THE VISUALIZATION</h3>
<p>One of the most notable strengths of the graph is its ability to present a large amount of information in a really compact space, as we can observe up to 32 sports in this relatively small plot. It also gives us a clear and comprehensive view of how age range varies across different disciplines, making it an excellent tool for spotting patterns at a glance. For example, we can quickly identify that sports like Gymnastics and Swimming are dominated by younger athletes, with the majority falling into the 10–20 age range, while sports like Equestrian and Shooting feature older competitors, often in their 40s or beyond.</p>
<p>While the graph effectively captures the overall age range of athletes across different sports, it presents several limitations. For instance, the visualization does not include key statistical measures, such as means or medians, which would provide a clearer understanding of central tendencies within each discipline. Moreover, identifying where the majority of athletes are clustered is not straightforward. This issue is particularly evident in sports with smaller datasets, such as taekwondo, triathlon, and rhythmic gymnastics, and even in sports with larger datasets, trends are difficult to discern, reducing the graph’s ability to highlight meaningful patterns.</p>
<h1 id="graph-replication">GRAPH REPLICATION</h1>
<h3 id="downloading-libraries">DOWNLOADING LIBRARIES</h3>
<p>The first step in replicating the graphic was to load the required libraries. These libraries provide essential tools for our data manipulation and visualization.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/talgalili/gplots'>gplots</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://wilkelab.org/ggtext/'>ggtext</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://mjskay.github.io/ggdist/'>ggdist</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://glue.tidyverse.org/'>glue</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://patchwork.data-imaginist.com'>patchwork</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/EmilHvitfeldt/paletteer'>paletteer</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/yixuan/showtext'>showtext</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/wch/extrafont'>extrafont</a></span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 id="cleaning-data">CLEANING DATA</h3>
<p>The original dataset, sourced from Kaggle, contains a wealth of detailed information about Olympic athletes, including their names, sports, birth years, ages, genders, nationalities, weights, and heights among others. This extensive dataset encompasses all athletes who have competed in the Olympic Games from 1896 to 2016. For the replication, we began by uploading the dataset, removing unnecessary columns and handling missing values from the main variable:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>olympics3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_csv</a></span><span class='op'>(</span><span class='st'>"athlete_events1.csv"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='va'>olympics3</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>Age</span>, <span class='va'>Sport</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/drop_na.html'>drop_na</a></span><span class='op'>(</span><span class='va'>Age</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Once the dataset was loaded, we observed that it contained a significantly larger number of sports than those present in the original graph. To address this, we applied a filter using the filter function from the tidyverse package, ensuring that only the sports featured in the original graph were retained in the dataset.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>data_filtered</span> <span class='op'>&lt;-</span> <span class='va'>data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Archery"</span> <span class='op'>|</span> <span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Athletics"</span> <span class='op'>|</span> <span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Badminton"</span> <span class='op'>|</span> <span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Basketball"</span> <span class='op'>|</span></span>
<span>           <span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Beach Volleyball"</span><span class='op'>|</span> <span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Boxing"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Canooing"</span><span class='op'>|</span></span>
<span>           <span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Cycling"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Diving"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Equestrianism"</span><span class='op'>|</span></span>
<span>           <span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Fencing"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Football"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Artistic Gymnsatics"</span><span class='op'>|</span></span>
<span>           <span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Handball"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Hockey"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Judo"</span><span class='op'>|</span></span>
<span>           <span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Modern Pentathlon"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Rhythmic Gymnastics"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Rowing"</span><span class='op'>|</span></span>
<span>           <span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Sailing"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Shooting"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Swimming"</span><span class='op'>|</span></span>
<span>           <span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Table Tenis"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Taekwondo"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Tennis"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Trampoling"</span><span class='op'>|</span></span>
<span>           <span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Triathlon"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Volleyball"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Water Polo"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Weightlifting"</span><span class='op'>|</span></span>
<span>           <span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Wrestling"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Table Tennis"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Canoeing"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Volleyball"</span><span class='op'>|</span></span>
<span>           <span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Gymnastics"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Synchronized Swimming"</span><span class='op'>|</span> <span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Trampolining"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>To analyze the distribution of athletes by age and sport, we first needed to count how many athletes of each age participated in each sport. To do this, we used the count() function, which allowed us to create a dataset showing the count of athletes of a specific age in each sport. After obtaining these counts, we then categorized the data. This was accomplished using the case_when() function, which allowed us to group the results into the same categories as those in the original visualization.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>data_counts</span> <span class='op'>&lt;-</span> <span class='va'>data_filtered</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/count.html'>count</a></span><span class='op'>(</span><span class='va'>Sport</span>, <span class='va'>Age</span><span class='op'>)</span> <span class='op'>|&gt;</span>         </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/rename.html'>rename</a></span><span class='op'>(</span>Count <span class='op'>=</span> <span class='va'>n</span><span class='op'>)</span> </span>
<span></span>
<span><span class='va'>data_counts</span> <span class='op'>&lt;-</span> <span class='va'>data_counts</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/mutate.html'>mutate</a></span><span class='op'>(</span>grouped_count <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/case_when.html'>case_when</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>Count</span><span class='op'>&gt;=</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>(</span><span class='va'>Count</span><span class='op'>&lt;</span><span class='fl'>5</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"1-5"</span>,</span>
<span>         <span class='op'>(</span><span class='va'>Count</span><span class='op'>&gt;=</span><span class='fl'>5</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>(</span><span class='va'>Count</span><span class='op'>&lt;</span><span class='fl'>30</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"&lt;30"</span>,</span>
<span>         <span class='op'>(</span><span class='va'>Count</span><span class='op'>&gt;=</span><span class='fl'>30</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>(</span><span class='va'>Count</span><span class='op'>&lt;</span><span class='fl'>60</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"&lt;60"</span>,</span>
<span>         <span class='op'>(</span><span class='va'>Count</span><span class='op'>&gt;=</span><span class='fl'>60</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>(</span><span class='va'>Count</span><span class='op'>&lt;</span><span class='fl'>90</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"&lt;90"</span>,</span>
<span>         <span class='op'>(</span><span class='va'>Count</span><span class='op'>&gt;=</span><span class='fl'>90</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>(</span><span class='va'>Count</span><span class='op'>&lt;</span><span class='fl'>120</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"&lt;120"</span>, </span>
<span>         <span class='op'>(</span><span class='va'>Count</span><span class='op'>&gt;=</span><span class='fl'>120</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>(</span><span class='va'>Count</span><span class='op'>&lt;</span><span class='fl'>150</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"&lt;150"</span>,</span>
<span>         <span class='op'>(</span><span class='va'>Count</span><span class='op'>&gt;=</span><span class='fl'>150</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>(</span><span class='va'>Count</span><span class='op'>&lt;</span><span class='fl'>400</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"&lt;400"</span>,</span>
<span>         <span class='op'>(</span><span class='va'>Count</span><span class='op'>&gt;=</span><span class='fl'>400</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"400 or higher"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>data_counts</span><span class='op'>$</span><span class='va'>Age</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span> <span class='op'>(</span><span class='va'>data_counts</span><span class='op'>$</span><span class='va'>Age</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Next, we renamed the sports to match the terminology used in the original graph, as “Rhythmic Gymnastics” and “Synchronized Swimming” were written differently. Following this, we ordered the sports alphabetically, from A to Z, in accordance with the structure of the original graph.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#Rythmic gymnastics into Rythimc Gym.</span></span>
<span></span>
<span><span class='va'>data_counts</span> <span class='op'>&lt;-</span> <span class='va'>data_counts</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/mutate.html'>mutate</a></span><span class='op'>(</span>Sport <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>Sport</span> <span class='op'>==</span> <span class='st'>"Rhythmic Gymnastics"</span>, <span class='st'>"Rhythmic Gym."</span>, <span class='va'>Sport</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Synchronized Swimming into Sync. Swimming</span></span>
<span></span>
<span><span class='va'>data_counts</span> <span class='op'>&lt;-</span> <span class='va'>data_counts</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/mutate.html'>mutate</a></span><span class='op'>(</span>Sport <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>Sport</span> <span class='op'>==</span> <span class='st'>"Synchronized Swimming"</span>, <span class='st'>"Sync. Swimming"</span>, <span class='va'>Sport</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#Ordering sports alphabetically</span></span>
<span></span>
<span><span class='va'>data_counts</span> <span class='op'>&lt;-</span> <span class='va'>data_counts</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>Sport</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/mutate.html'>mutate</a></span><span class='op'>(</span>Sport <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>Sport</span>, levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>Sport</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Finally, we create a new table using summarise to calculate the minimum and maximum ages for each sport in order to be able to add this information more easily to the graph later. Afterward, we merged this table with the original one using left_join.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>age_extremes</span> <span class='op'>&lt;-</span> <span class='va'>data_counts</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>Sport</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/summarise.html'>summarise</a></span><span class='op'>(</span>min_age <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>Age</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, </span>
<span>            max_age <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>Age</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> </span>
<span></span>
<span><span class='va'>data_counts</span> <span class='op'>&lt;-</span> <span class='va'>data_counts</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>age_extremes</span>, by <span class='op'>=</span> <span class='st'>"Sport"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h2 id="building-the-graph">BUILDING THE GRAPH</h2>
<p>Once the dataset was cleaned and prepared, we moved on to the process of replicating the graph. To ensure the final output closely resembled the original, we began by downloading the necessary resources, particularly the fonts used in the visualization.</p>
<h3 id="fonts">FONTS</h3>
<p>In order to replicate the font styles of the original graph, we focused on matching all the fonts displayed, which we identified through The Washington Post’s design system page. This resource provides details on the fonts they use, including their size, weight, and height specifications for articles: <a href="https://build.washingtonpost.com/foundations/typography" class="uri">https://build.washingtonpost.com/foundations/typography</a>.</p>
<p>We were able to recover all the required fonts, except for the title font, Postoni, which is a paid font. As an alternative, we chose Georgia, a font also used by The Washington Post for article text.</p>
<p>To implement these fonts in the graph, we used the showtext package, which allows for text rendering using fonts downloaded from Google Fonts, such as Libre Franklin, the font selected for annotations. Additionally, we employed the extrafont package, which simplifies the registration and use of external fonts installed on the operating system. We used Georgia for the title, subtitle, and caption, while Arial was chosen for the numbers indicating the maximum and minimum ages of athletes in each sport.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/sysfonts/man/font_add_google.html'>font_add_google</a></span><span class='op'>(</span><span class='st'>"Libre Franklin"</span>, <span class='st'>"franklin"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/showtext/man/showtext_auto.html'>showtext_auto</a></span><span class='op'>(</span><span class='op'>)</span> </span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/sysfonts/man/font_add.html'>font_add</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"Georgia"</span>, regular <span class='op'>=</span> <span class='st'>"C:/Windows/Fonts/georgia.ttf"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/sysfonts/man/font_add.html'>font_add</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"Arial"</span>, regular <span class='op'>=</span> <span class='st'>"C:/Windows/Fonts/arial.ttf"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 id="theme">THEME</h3>
<p>I believe that the most important and complex part of creating the graph was defining the theme. This particular graph is highly intricate, containing numerous elements and details that must be precisely arranged. As a result, I had to carefully adjust not only the annotations but also the axis titles, legend titles, legend colors, spacing between the elements, text sizes, and more. Once the theme was successfully applied, it immediately brought the graph closer to its final design, demonstrating just how crucial the theme is in shaping its overall aesthetic and coherence. This is why the graph appears so similar to the original from the very beginning, as in this final version the theme is applied since the first steps.</p>
<p>Some of the functions that help achieve this level of precision include starting with theme_minimal(base_size = 7) to establish a minimalist base with small text. The primary and secondary grids are removed using element_blank(), and panel.background sets a light gray background (gray97) with no borders (color = NA). The axis texts are customized in black, with adjusted sizes and very specific margins to replicate the original design. The legend is configured with legend.position to place it at the top of the graph, and legend.justification to fine-tune its exact position. The legend texts are personalized using legend.title and legend.text, with small sizes and precise margins. Additionally, legend.key.size reduces the size of the legend keys to 0.1 cm, creating a more compact design.</p>
<p>Proportions also played a crucial role in accurately representing this graph. For every version of the graph, the specification {r, fig.width=4, fig.height=6, out.width=“100%”} was added to each chunk, ensuring consistent sizing across all iterations. Additionally, coord_fixed(ratio=1.5) was used to adjust the aspect ratio between the X and Y axes. This ratio means that 1 unit on the Y-axis corresponds to 1.5 units on the X-axis, resulting in a Y-axis that appears more elongated and less compact than the X-axis. This adjustments were crucial for achieving the correct visual proportions and ensuring that the graph closely aligned with the original design.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>theme</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span>base_size <span class='op'>=</span> <span class='fl'>7</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    panel.grid.major <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    panel.grid.minor <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"gray97"</span>, color <span class='op'>=</span> <span class='cn'>NA</span><span class='op'>)</span>,</span>
<span>    axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"black"</span>, angle <span class='op'>=</span> <span class='fl'>0</span>, hjust <span class='op'>=</span> <span class='fl'>0.7</span>, size <span class='op'>=</span> <span class='fl'>7</span><span class='op'>)</span>,</span>
<span>    axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"black"</span>, size <span class='op'>=</span> <span class='fl'>7.3</span>, margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>r <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"Georgia"</span>, size <span class='op'>=</span> <span class='fl'>25</span>, face <span class='op'>=</span> <span class='st'>"bold"</span>, hjust <span class='op'>=</span> <span class='fl'>0.05</span>, vjust <span class='op'>=</span> <span class='fl'>0</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span>,</span>
<span>    plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"Georgia"</span>, size <span class='op'>=</span> <span class='fl'>8</span>, face <span class='op'>=</span> <span class='st'>"bold"</span>, color <span class='op'>=</span> <span class='st'>"gray60"</span>, hjust <span class='op'>=</span> <span class='fl'>0.05</span>, vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>5</span>, margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>b <span class='op'>=</span> <span class='fl'>15</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    plot.caption <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span></span>
<span>      family <span class='op'>=</span> <span class='st'>"Georgia"</span>, size <span class='op'>=</span> <span class='fl'>7.5</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, vjust <span class='op'>=</span> <span class='fl'>247</span>, margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>0</span>, l<span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>, color <span class='op'>=</span> <span class='st'>"gray60"</span>, lineheight <span class='op'>=</span> <span class='fl'>0.5</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    legend.position <span class='op'>=</span> <span class='st'>"top"</span>,</span>
<span>    legend.justification <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1.2</span><span class='op'>)</span>,</span>
<span>    legend.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>7.5</span>, face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>,</span>
<span>    legend.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>7</span>, margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>l <span class='op'>=</span> <span class='fl'>1</span>, r <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    plot.caption.position <span class='op'>=</span> <span class='st'>"panel"</span>,</span>
<span>    legend.key.size <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='st'>"cm"</span><span class='op'>)</span>,</span>
<span>    axis.title.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    axis.title.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span></span>
<span>      size <span class='op'>=</span> <span class='fl'>6.5</span>,</span>
<span>      angle <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>      hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>24</span>,</span>
<span>      vjust <span class='op'>=</span> <span class='fl'>1.035</span>,</span>
<span>      face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>,</span>
<span>    plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>20</span>, r <span class='op'>=</span> <span class='fl'>20</span>, b <span class='op'>=</span> <span class='fl'>20</span>, l <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 id="graph">GRAPH</h3>
<p>Once the theme was defined, we proceeded to create the base of the graph using the geom_tile function, which generates a mosaic plot. The aes(x = Age, y = Sport, fill = grouped_count) function maps ages to the X-axis, sports to the Y-axis, and the group size to the color of the tiles. To refine the color palette, we applied the scale_fill_manual function, carefully selecting the colors using the online tool imagecolorpicker.com.</p>
<p>The limits argument ensures that the legend displays the categories in a specific order, from “1-5” to “400 or higher”, while the labels argument customizes the labels in the legend to clearly describe the range of athletes in each group. Additionally, we set a clear title for the legend using the name parameter and arranged the legend in a single row with guide_legend(nrow = 1).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>data_counts</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Age</span>, y <span class='op'>=</span> <span class='va'>Sport</span>, fill <span class='op'>=</span> <span class='va'>grouped_count</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_tile.html'>geom_tile</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span></span>
<span>    values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>      <span class='st'>"1-5"</span> <span class='op'>=</span> <span class='st'>"#ddeaf9"</span>,</span>
<span>      <span class='st'>"&lt;30"</span> <span class='op'>=</span> <span class='st'>"#c4dbf1"</span>,</span>
<span>      <span class='st'>"&lt;60"</span> <span class='op'>=</span> <span class='st'>"#9fcae2"</span>,</span>
<span>      <span class='st'>"&lt;90"</span> <span class='op'>=</span> <span class='st'>"#6cadd4"</span>,</span>
<span>      <span class='st'>"&lt;120"</span> <span class='op'>=</span> <span class='st'>"#4193c3"</span>,</span>
<span>      <span class='st'>"&lt;150"</span> <span class='op'>=</span> <span class='st'>"#2372b5"</span>,</span>
<span>      <span class='st'>"&lt;400"</span> <span class='op'>=</span> <span class='st'>"#08519d"</span>,</span>
<span>      <span class='st'>"400 or higher"</span> <span class='op'>=</span> <span class='st'>"#083069"</span></span>
<span>    <span class='op'>)</span>, </span>
<span>    labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>      <span class='st'>"1-5"</span> <span class='op'>=</span> <span class='st'>"1-5 athletes"</span>,</span>
<span>      <span class='st'>"&lt;30"</span> <span class='op'>=</span> <span class='st'>"&lt;30"</span>,</span>
<span>      <span class='st'>"&lt;60"</span> <span class='op'>=</span> <span class='st'>"&lt;60"</span>,</span>
<span>      <span class='st'>"&lt;90"</span> <span class='op'>=</span> <span class='st'>"&lt;90"</span>,</span>
<span>      <span class='st'>"&lt;120"</span> <span class='op'>=</span> <span class='st'>"&lt;120"</span>,</span>
<span>      <span class='st'>"&lt;150"</span> <span class='op'>=</span> <span class='st'>"&lt;150"</span>,</span>
<span>      <span class='st'>"&lt;400"</span> <span class='op'>=</span> <span class='st'>"&lt;400"</span>,</span>
<span>      <span class='st'>"400 or higher"</span> <span class='op'>=</span> <span class='st'>"400 or higher"</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"1-5"</span>, <span class='st'>"&lt;30"</span>, <span class='st'>"&lt;60"</span>, <span class='st'>"&lt;90"</span>, <span class='st'>"&lt;120"</span>, <span class='st'>"&lt;150"</span>, <span class='st'>"&lt;400"</span>, <span class='st'>"400 or higher"</span><span class='op'>)</span>,</span>
<span>    name <span class='op'>=</span> <span class='st'>"Total athletes in each age group:"</span>,</span>
<span>    guide <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guide_legend.html'>guide_legend</a></span><span class='op'>(</span>nrow <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span> <span class='va'>theme</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_fixed.html'>coord_fixed</a></span><span class='op'>(</span>ratio <span class='op'>=</span> <span class='fl'>1.5</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>p</span></span></code></pre>
</div>
<p><img src="100535296_files/figure-html5/unnamed-chunk-11-1.png" width="624" /></p>
</div>
<p>Next, we customized the graph’s axes. For the X-axis, we used scale_x_continuous to position it at the top of the graph. This function also defines a range between 10 and 73, sets tick marks at intervals of 5, and customizes the labels to display “10YRS” only for the value 10, while showing the other values as standard numbers. For the Y-axis, we applied scale_y_discrete to remove unnecessary space before and after the categories (using expand = c(0, 0)), ensuring that the graph elements fit directly within the drawing area. After adjusting the axes, we added the title, subtitle, and caption (which will appear as the description in the top-right corner of the graph) using the labs function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span></span>
<span>    position <span class='op'>=</span> <span class='st'>"top"</span>,</span>
<span>    limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>73</span><span class='op'>)</span>,</span>
<span>    breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>70</span>, by <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>,</span>
<span>    labels <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>x</span> <span class='op'>==</span> <span class='fl'>10</span>, <span class='st'>"10YRS"</span>, <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_discrete.html'>scale_y_discrete</a></span><span class='op'>(</span>expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span></span>
<span>    title <span class='op'>=</span> <span class='st'>"Olympians"</span>,</span>
<span>    subtitle <span class='op'>=</span> <span class='st'>"By age, sport, country, and sex"</span>,</span>
<span>    y <span class='op'>=</span> <span class='st'>"BY SPORT"</span>,</span>
<span>    caption <span class='op'>=</span> <span class='st'>"Explore a Washington Post breakdown of all Summer Olympics\n athletes who have competed since the first modern Games in 1896.\n See the expansive rang in age of the competitors, and when men\n and women first competed in each sport."</span></span>
<span>    <span class='op'>)</span>  </span>
<span>  </span>
<span></span>
<span><span class='va'>p</span></span></code></pre>
</div>
<p><img src="100535296_files/figure-html5/unnamed-chunk-12-1.png" width="100%" /></p>
</div>
<p>In the next step, we used the geom_hline() function to add a white line to the graph, separating the sport categories. We position the line just below each category by converting the values of the Sport variable to numeric format and adjusting them by 0.5.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>Sport</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>0.5</span><span class='op'>)</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"white"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>0.3</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='va'>p</span></span></code></pre>
</div>
<p><img src="100535296_files/figure-html5/unnamed-chunk-13-1.png" width="100%" /></p>
</div>
<p>Next, we added the maximum and minimum age for each sport by using the variables max_age and min_age, which we created earlier. These values are then displayed on the graph using geom_text(), positioning the text labels accordingly.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>min_age</span>, y <span class='op'>=</span> <span class='va'>Sport</span>, label <span class='op'>=</span> <span class='va'>min_age</span><span class='op'>)</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>2.5</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>1.1</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"gray40"</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"Arial"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>max_age</span>, y <span class='op'>=</span> <span class='va'>Sport</span>, label <span class='op'>=</span> <span class='va'>max_age</span><span class='op'>)</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>2.5</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"gray40"</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"Arial"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>p</span></span></code></pre>
</div>
<p><img src="100535296_files/figure-html5/unnamed-chunk-14-1.png" width="100%" /></p>
</div>
<p>Finally, we add the annotations and the lines that connect the data points to these annotations. To create the L-shaped arrows, we combine two geom_segment() functions, one vertical and one horizontal, and position them on the plot to form this shape. Next, we add the three annotations visible in the graph using annotate(), specifying the exact location within the plot, as well as the size, color, font, and line spacing (with lineheight).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>72.5</span>, xend <span class='op'>=</span> <span class='fl'>73</span>, y <span class='op'>=</span> <span class='fl'>29</span> , yend <span class='op'>=</span> <span class='fl'>29</span><span class='op'>)</span>,  </span>
<span>    color <span class='op'>=</span> <span class='st'>"gray60"</span>, size <span class='op'>=</span> <span class='fl'>0.04</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>73</span>, xend <span class='op'>=</span> <span class='fl'>73</span>, y <span class='op'>=</span> <span class='fl'>24</span>, yend <span class='op'>=</span> <span class='fl'>29</span><span class='op'>)</span>,  </span>
<span>    color <span class='op'>=</span> <span class='st'>"gray60"</span>, size <span class='op'>=</span> <span class='fl'>0.04</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>  <span class='st'>"text"</span>,</span>
<span>  x <span class='op'>=</span> <span class='fl'>62</span>, y <span class='op'>=</span> <span class='fl'>28</span>,</span>
<span>  label <span class='op'>=</span> <span class='st'>"Arthur von Pongracz\nof Austria, competed in\nindividual and team\ndressage. At 72\nPongracz placed fourth\nin team and 16th in\nindividual."</span>,</span>
<span>  hjust <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>  size <span class='op'>=</span> <span class='fl'>2.1</span>,</span>
<span>  color <span class='op'>=</span> <span class='st'>"gray30"</span>, </span>
<span>  family <span class='op'>=</span> <span class='st'>"franklin"</span>,</span>
<span>  lineheight <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>50</span>, xend <span class='op'>=</span> <span class='fl'>59</span>, y <span class='op'>=</span> <span class='fl'>20.5</span>, yend <span class='op'>=</span> <span class='fl'>20.5</span><span class='op'>)</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"gray60"</span>, size <span class='op'>=</span> <span class='fl'>0.04</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fl'>60</span>, y <span class='op'>=</span> <span class='fl'>18.5</span>, </span>
<span>    label <span class='op'>=</span> <span class='st'>"At age 10, Dimitrios \nLoundras of Greece, won\nbronze in the 1896 men's\nteam parallel bars. Jan de\nBoer of Netherlands, then 49\nyears old, competed in the\n1908 men's team all-around."</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>2.1</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"gray30"</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"franklin"</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>72.5</span>, xend <span class='op'>=</span> <span class='fl'>73</span>, y <span class='op'>=</span> <span class='fl'>6</span>, yend <span class='op'>=</span> <span class='fl'>6</span><span class='op'>)</span>,  </span>
<span>    color <span class='op'>=</span> <span class='st'>"gray60"</span>, size <span class='op'>=</span> <span class='fl'>0.04</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>73</span>, xend <span class='op'>=</span> <span class='fl'>73</span>, y <span class='op'>=</span> <span class='fl'>6</span>, yend <span class='op'>=</span> <span class='fl'>11</span><span class='op'>)</span>,  </span>
<span>    color <span class='op'>=</span> <span class='st'>"gray60"</span>, size <span class='op'>=</span> <span class='fl'>0.04</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fl'>62</span>, y <span class='op'>=</span> <span class='fl'>6</span>,  </span>
<span>    label <span class='op'>=</span> <span class='st'>"Oscar Swahn of\nSweden, set the first\nOlympic record in\nmen's single shot\nrunning target in 1908,\nat age 60. He is also\nthe oldest gold\nmedalist in an\nindividual Olympic\nevent."</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>2.1</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"gray30"</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"franklin"</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.5</span></span>
<span>  <span class='op'>)</span> </span>
<span></span>
<span><span class='va'>p</span></span></code></pre>
</div>
<p><img src="100535296_files/figure-html5/unnamed-chunk-15-1.png" width="100%" /></p>
</div>
<p>With all adjustments and customizations in place, we now have the final version of the replicated graph, which closely mirrors the original in both design and structure. While this concludes the replication process, the next step will involve creating an alternative graph that enhances the original design and offers new insights.</p>
<h1 id="alternative-graph">ALTERNATIVE GRAPH</h1>
<p>Building on the replication, the alternative version was developed to address some of the limitations of the original visualization. This new graph aims to provide a more detailed and accurate representation of the data by including important statistical measures, such as the mean and median, and enhancing the depiction of distributions. To achieve this, we decided to create a ridgeline plot with an additional inner plot as a legend to improve interpretability and clarity.</p>
<p>We began by cleaning the data once again, with some adjustments to the order of sports based on more meaningful criteria. We decided to arrange the sports according to the median age of athletes in each sport. This approach allowed us to clearly identify which sports accommodate a broader range of ages and which are more concentrated with younger athletes. To achieve this, we used the reorder() function, specifying FUN = median to sort the sports by median age, and -Age to ensure they were ordered from the youngest to the oldest.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>olympics3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_csv</a></span><span class='op'>(</span><span class='st'>"athlete_events1.csv"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>olympics</span> <span class='op'>&lt;-</span> <span class='va'>olympics3</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>Age</span>, <span class='va'>Sport</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/drop_na.html'>drop_na</a></span><span class='op'>(</span><span class='va'>Age</span>, <span class='va'>Sport</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>olympics</span> <span class='op'>&lt;-</span> <span class='va'>olympics</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Archery"</span> <span class='op'>|</span> <span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Athletics"</span> <span class='op'>|</span> <span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Badminton"</span> <span class='op'>|</span> <span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Basketball"</span> <span class='op'>|</span></span>
<span>           <span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Beach Volleyball"</span><span class='op'>|</span> <span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Boxing"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Canooing"</span><span class='op'>|</span></span>
<span>           <span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Cycling"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Diving"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Equestrianism"</span><span class='op'>|</span></span>
<span>           <span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Fencing"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Football"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Artistic Gymnsatics"</span><span class='op'>|</span></span>
<span>           <span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Handball"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Hockey"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Judo"</span><span class='op'>|</span></span>
<span>           <span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Modern Pentathlon"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Rhythmic Gymnastics"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Rowing"</span><span class='op'>|</span></span>
<span>           <span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Sailing"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Shooting"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Swimming"</span><span class='op'>|</span></span>
<span>           <span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Table Tenis"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Taekwondo"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Tennis"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Trampoling"</span><span class='op'>|</span></span>
<span>           <span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Triathlon"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Volleyball"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Water Polo"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Weightlifting"</span><span class='op'>|</span></span>
<span>           <span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Wrestling"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Table Tennis"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Canoeing"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Volleyball"</span><span class='op'>|</span></span>
<span>           <span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Gymnastics"</span><span class='op'>|</span><span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Synchronized Swimming"</span><span class='op'>|</span> <span class='va'>Sport</span><span class='op'>==</span><span class='st'>"Trampolining"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>olympics</span><span class='op'>$</span><span class='va'>Age</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span> <span class='op'>(</span><span class='va'>olympics</span><span class='op'>$</span><span class='va'>Age</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#Rythmic gymnastics into Rythimc Gym.</span></span>
<span></span>
<span><span class='va'>olympics</span> <span class='op'>&lt;-</span> <span class='va'>olympics</span><span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/mutate.html'>mutate</a></span><span class='op'>(</span>Sport <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>Sport</span> <span class='op'>==</span> <span class='st'>"Rhythmic Gymnastics"</span>, <span class='st'>"Rhythmic Gym."</span>, <span class='va'>Sport</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Synchronized Swimming into Sync. Swimming</span></span>
<span></span>
<span><span class='va'>olympics</span> <span class='op'>&lt;-</span> <span class='va'>olympics</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/mutate.html'>mutate</a></span><span class='op'>(</span>Sport <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>Sport</span> <span class='op'>==</span> <span class='st'>"Synchronized Swimming"</span>, <span class='st'>"Sync. Swimming"</span>, <span class='va'>Sport</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#To order the y axes by the median</span></span>
<span></span>
<span><span class='va'>olympics</span> <span class='op'>&lt;-</span> <span class='va'>olympics</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/mutate.html'>mutate</a></span><span class='op'>(</span>Sport <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/reorder.factor.html'>reorder</a></span><span class='op'>(</span><span class='va'>Sport</span>, <span class='op'>-</span><span class='va'>Age</span>, FUN <span class='op'>=</span> <span class='va'>median</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Next, and continuing with the data preparation for the alternative graph, we generated additional variables that will be useful for creating the graph. To identify outliers, we calculated the IQR for each sport to determine the lower and upper boundaries. We then filtered out any values falling outside these limits and merged this information back into the main dataset. This step will be useful when overlaying the outliers on the main plot using geom_point(). Additionally, we calculated and stored the median age for each sport within the dataset, which allowed us to add a dashed line to the plot, facilitating easier comparisons between sports.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#Calculate the outliers</span></span>
<span><span class='va'>outliers</span> <span class='op'>&lt;-</span> <span class='va'>olympics</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>Sport</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/summarise.html'>summarise</a></span><span class='op'>(</span></span>
<span>    Q1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span><span class='op'>(</span><span class='va'>Age</span>, <span class='fl'>0.25</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,</span>
<span>    Q3 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span><span class='op'>(</span><span class='va'>Age</span>, <span class='fl'>0.75</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,</span>
<span>    IQR <span class='op'>=</span> <span class='va'>Q3</span> <span class='op'>-</span> <span class='va'>Q1</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    lower_limit <span class='op'>=</span> <span class='va'>Q1</span> <span class='op'>-</span> <span class='fl'>3</span> <span class='op'>*</span> <span class='va'>IQR</span>,</span>
<span>    upper_limit <span class='op'>=</span> <span class='va'>Q3</span> <span class='op'>+</span> <span class='fl'>3</span> <span class='op'>*</span> <span class='va'>IQR</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>Sport</span>, <span class='va'>lower_limit</span>, <span class='va'>upper_limit</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Join the outliers to the dataset</span></span>
<span><span class='va'>olympics_outliers</span> <span class='op'>&lt;-</span> <span class='va'>olympics</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>outliers</span>, by <span class='op'>=</span> <span class='st'>"Sport"</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/mutate.html'>mutate</a></span><span class='op'>(</span>is_outlier <span class='op'>=</span> <span class='va'>Age</span> <span class='op'>&lt;</span> <span class='va'>lower_limit</span> <span class='op'>|</span> <span class='va'>Age</span> <span class='op'>&gt;</span> <span class='va'>upper_limit</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>is_outlier</span><span class='op'>)</span>  </span>
<span></span>
<span><span class='co'>#Create the median age</span></span>
<span></span>
<span><span class='va'>median_age</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/median.html'>median</a></span><span class='op'>(</span><span class='va'>olympics3</span><span class='op'>$</span><span class='va'>Age</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>After reprocessing the data, we moved on to creating the graph, starting with the base without the legend. To achieve this, we designed a ridgeline plot using stat_halfeye() and stat_interval() from the ggdist package, which provided a clear view of the distribution of ages across sports. The median age was marked with stat_summary(), and the average age was indicated through an annotation. Additionally, we added a dashed line to mark the median age and used geom_point() to highlight the outliers with the new variables created earlier. Customizations like flipping the coordinates, adjusting axis breaks, and using a similar color scheme as the original graphic helped refine the presentation, making it visually appealing and easy to interpret.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>olympics</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>Sport</span>, <span class='va'>Age</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='http://mjskay.github.io/ggdist/reference/stat_halfeye.html'>stat_halfeye</a></span><span class='op'>(</span>fill_type <span class='op'>=</span> <span class='st'>"segments"</span>, alpha <span class='op'>=</span> <span class='fl'>0.8</span>, scale <span class='op'>=</span> <span class='fl'>0.9</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='http://mjskay.github.io/ggdist/reference/stat_interval.html'>stat_interval</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/stat_summary.html'>stat_summary</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"point"</span>, fun <span class='op'>=</span> <span class='va'>median</span>, color <span class='op'>=</span> <span class='st'>"black"</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>33</span>, y <span class='op'>=</span> <span class='fl'>0</span>, label <span class='op'>=</span> <span class='st'>"(\U00F8 age)"</span>,</span>
<span>           family <span class='op'>=</span> <span class='st'>"franklin"</span>, size <span class='op'>=</span> <span class='fl'>6.5</span>, hjust <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/stat_summary.html'>stat_summary</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>Age</span><span class='op'>)</span>,</span>
<span>    geom <span class='op'>=</span> <span class='st'>"text"</span>,</span>
<span>    fun.data <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>        y <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>        label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span><span class='op'>(</span><span class='st'>"(%s)"</span>, <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/number.html'>number</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>x</span> <span class='op'>&gt;</span> <span class='fl'>0</span>, <span class='va'>x</span>, <span class='cn'>NA</span><span class='op'>)</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, accuracy <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>}</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"franklin"</span>, size <span class='op'>=</span> <span class='fl'>6</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='va'>median_age</span>, col <span class='op'>=</span> <span class='st'>"black"</span>, lty <span class='op'>=</span> <span class='st'>"dashed"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>33.3</span>, y <span class='op'>=</span> <span class='fl'>25</span>, label <span class='op'>=</span> <span class='st'>"Median age"</span>,</span>
<span>           family <span class='op'>=</span> <span class='st'>"franklin"</span>, size <span class='op'>=</span> <span class='fl'>8</span>, hjust <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>olympics_outliers</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Sport</span>, y <span class='op'>=</span> <span class='va'>Age</span><span class='op'>)</span>,</span>
<span>             size <span class='op'>=</span> <span class='fl'>1</span>, shape <span class='op'>=</span> <span class='fl'>19</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>70</span>, by <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_discrete.html'>scale_x_discrete</a></span><span class='op'>(</span>expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_color_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#e7e5cc"</span>, <span class='st'>"#9fcae2"</span>, <span class='st'>"#08519d"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_flip.html'>coord_flip</a></span><span class='op'>(</span>ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>80</span><span class='op'>)</span>, xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>33.5</span><span class='op'>)</span>, expand <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span></span>
<span>    title <span class='op'>=</span> <span class='st'>"OLYMPICS"</span>,</span>
<span>    subtitle <span class='op'>=</span> <span class='st'>"by age and sport"</span>,</span>
<span>    x <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>    y <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    panel.grid <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    panel.grid.major.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>linewidth <span class='op'>=</span> <span class='fl'>0.1</span>, color <span class='op'>=</span> <span class='st'>"grey75"</span><span class='op'>)</span>,</span>
<span>    plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"Georgia"</span>, size <span class='op'>=</span> <span class='fl'>45</span>, margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span> <span class='op'>(</span>b <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    plot.title.position <span class='op'>=</span> <span class='st'>"plot"</span>,</span>
<span>    plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_textbox.html'>element_textbox_simple</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>40</span>, family <span class='op'>=</span> <span class='st'>"Georgia"</span>, color <span class='op'>=</span> <span class='st'>"gray40"</span>, margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span> <span class='op'>(</span>b <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    plot.caption.position <span class='op'>=</span> <span class='st'>"plot"</span>,</span>
<span>    axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>1</span>, family <span class='op'>=</span> <span class='st'>"franklin"</span>, size <span class='op'>=</span> <span class='fl'>25</span>, color <span class='op'>=</span> <span class='st'>"black"</span>, face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>,</span>
<span>    axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>25</span>, family <span class='op'>=</span> <span class='st'>"franklin"</span>, margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>r <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span>,</span>
<span>    plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>4</span>, <span class='fl'>17</span>, <span class='fl'>4</span>, <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>p</span></span></code></pre>
</div>
<p><img src="100535296_files/figure-html5/unnamed-chunk-18-1.png" width="864" /></p>
</div>
<p>To create the legend, we constructed a separate plot focused on a specific sport—volleyball in this case. In this plot, we used annotate() to label specific age ranges, such as the 50%, 80%, and 95% percentiles of ages, as well as to highlight the median and overall age distribution. To make the annotations more intuitive and visually connected to the relevant features on the plot, we employed geom_curve(), which draws curved arrows pointing directly to each annotation.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>df_for_legend</span> <span class='op'>&lt;-</span> <span class='va'>olympics</span> <span class='op'>|&gt;</span>  </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Sport</span> <span class='op'>==</span> <span class='st'>"Volleyball"</span><span class='op'>)</span> </span>
<span></span>
<span><span class='va'>p_legend</span> <span class='op'>&lt;-</span> <span class='va'>df_for_legend</span> <span class='op'>|&gt;</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>Sport</span>, <span class='va'>Age</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='http://mjskay.github.io/ggdist/reference/stat_halfeye.html'>stat_halfeye</a></span><span class='op'>(</span>fill_type <span class='op'>=</span> <span class='st'>"segments"</span>, alpha <span class='op'>=</span> <span class='fl'>0.8</span>, scale <span class='op'>=</span> <span class='fl'>0.6</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='http://mjskay.github.io/ggdist/reference/stat_interval.html'>stat_interval</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/stat_summary.html'>stat_summary</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"point"</span>, fun <span class='op'>=</span> <span class='va'>median</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.65</span>, <span class='fl'>0.65</span>, <span class='fl'>0.65</span>, <span class='fl'>1.34</span>, <span class='fl'>1.6</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>21</span> , <span class='fl'>29</span>, <span class='fl'>36</span>, <span class='fl'>27</span>, <span class='fl'>33</span><span class='op'>)</span>,</span>
<span>    label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"50% of ages\nfall within this range"</span>, <span class='st'>"80% of ages"</span>, </span>
<span>              <span class='st'>"95% of ages"</span>, <span class='st'>"Median"</span>, <span class='st'>"Distribution\n of ages"</span><span class='op'>)</span>,</span>
<span>    fill <span class='op'>=</span> <span class='cn'>NA</span>, family <span class='op'>=</span> <span class='st'>"Arial"</span>, size <span class='op'>=</span> <span class='fl'>5.8</span>, vjust <span class='op'>=</span> <span class='fl'>1</span>, lineheight <span class='op'>=</span> <span class='fl'>0.5</span>  </span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_curve</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>      x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.7</span>, <span class='fl'>0.7</span>, <span class='fl'>0.7</span>, <span class='fl'>1.225</span>, <span class='fl'>1.4</span><span class='op'>)</span>,</span>
<span>      xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.98</span>, <span class='fl'>0.98</span>, <span class='fl'>0.98</span>, <span class='fl'>1.02</span>, <span class='fl'>1.5</span><span class='op'>)</span>,</span>
<span>      y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>24</span>, <span class='fl'>30</span>, <span class='fl'>33</span>, <span class='fl'>26</span>, <span class='fl'>28</span><span class='op'>)</span>,</span>
<span>      yend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>24</span>, <span class='fl'>30</span>, <span class='fl'>33</span>, <span class='fl'>25</span>, <span class='fl'>30</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, xend <span class='op'>=</span> <span class='va'>xend</span>, y <span class='op'>=</span> <span class='va'>y</span>, yend <span class='op'>=</span> <span class='va'>yend</span><span class='op'>)</span>,</span>
<span>    stat <span class='op'>=</span> <span class='st'>"unique"</span>, curvature <span class='op'>=</span> <span class='fl'>0.2</span>, size <span class='op'>=</span> <span class='fl'>0.6</span>, color <span class='op'>=</span> <span class='st'>"grey12"</span>,</span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>20</span>, length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='st'>"mm"</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_color_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#e7e5cc"</span>, <span class='st'>"#9fcae2"</span>, <span class='st'>"#08519d"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_flip.html'>coord_flip</a></span><span class='op'>(</span>expand <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_void</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"black"</span>, fill <span class='op'>=</span> <span class='st'>"grey95"</span><span class='op'>)</span>,</span>
<span>        plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, r <span class='op'>=</span> <span class='fl'>0</span>, b <span class='op'>=</span> <span class='fl'>0</span>, l <span class='op'>=</span> <span class='fl'>0</span>, unit <span class='op'>=</span> <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>p_legend</span></span></code></pre>
</div>
<p><img src="100535296_files/figure-html5/unnamed-chunk-19-1.png" width="624" /></p>
</div>
<p>Finally, we combined the original plot with the plot legend by using inset_element():</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/inset_element.html'>inset_element</a></span><span class='op'>(</span><span class='va'>p_legend</span>, </span>
<span>                left <span class='op'>=</span> <span class='fl'>0.58</span>, </span>
<span>                right <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>                top <span class='op'>=</span> <span class='fl'>0.95</span>, </span>
<span>                bottom <span class='op'>=</span> <span class='fl'>0.85</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="100535296_files/figure-html5/unnamed-chunk-20-1.png" width="864" /></p>
</div>
<p>This alternative graph provides a more detailed and clearer view of where most athletes are concentrated, thanks to the enhanced distribution representation. By highlighting key statistical measures, such as the mean and median, and comparing them to the overall mean across all Olympic disciplines, it provides a deeper understanding of how each sport deviates from the general trend.</p>
<p>In conclusion, this article has walked through the process of replicating and then improving an Olympic athletes’ age distribution graph. This exercise highlights not only the importance of thoughtful data visualization but also the intrinsic complexity of the process. What might seem like a simple graph often requires significant effort to align every element precisely as intended. This process also demonstrates how iterative improvements not only refine the visual representation but can greatly enhance both interpretability and usefulness.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
