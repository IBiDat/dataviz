<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>Cocaine consumption</title>

  <meta property="description" itemprop="description" content="This project aims to provide insights into the principal consumers of cocaine through a bar plot. I chose this topic because I find it interesting and relevant, especially in relation to the global issues surrounding drug trafficking. &#10;The bar plot serves as an effective tool to visually compare the data, making complex information more accessible and understandable. I was particularly inspired by the work of El Orden Mundial, which I consider they do a great job of visualizing data."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2024-12-20"/>
  <meta property="article:created" itemprop="dateCreated" content="2024-12-20"/>
  <meta name="article:author" content="Jorge Ramos"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Cocaine consumption"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="This project aims to provide insights into the principal consumers of cocaine through a bar plot. I chose this topic because I find it interesting and relevant, especially in relation to the global issues surrounding drug trafficking. &#10;The bar plot serves as an effective tool to visually compare the data, making complex information more accessible and understandable. I was particularly inspired by the work of El Orden Mundial, which I consider they do a great job of visualizing data."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Cocaine consumption"/>
  <meta property="twitter:description" content="This project aims to provide insights into the principal consumers of cocaine through a bar plot. I chose this topic because I find it interesting and relevant, especially in relation to the global issues surrounding drug trafficking. &#10;The bar plot serves as an effective tool to visually compare the data, making complex information more accessible and understandable. I was particularly inspired by the work of El Orden Mundial, which I consider they do a great job of visualizing data."/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","categories","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["Cocaine consumption"]},{"type":"character","attributes":{},"value":["This project aims to provide insights into the principal consumers of cocaine through a bar plot. I chose this topic because I find it interesting and relevant, especially in relation to the global issues surrounding drug trafficking. \nThe bar plot serves as an effective tool to visually compare the data, making complex information more accessible and understandable. I was particularly inspired by the work of El Orden Mundial, which I consider they do a great job of visualizing data. \n"]},{"type":"character","attributes":{},"value":["2024"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Jorge Ramos"]}]}]},{"type":"character","attributes":{},"value":["2024-12-20"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["100541120_files/anchor-4.2.2/anchor.min.js","100541120_files/bowser-1.9.3/bowser.min.js","100541120_files/distill-2.2.21/template.v2.js","100541120_files/figure-html5/unnamed-chunk-10-1.png","100541120_files/figure-html5/unnamed-chunk-12-1.png","100541120_files/figure-html5/unnamed-chunk-13-1.png","100541120_files/figure-html5/unnamed-chunk-14-1.png","100541120_files/figure-html5/unnamed-chunk-15-1.png","100541120_files/figure-html5/unnamed-chunk-16-1.png","100541120_files/figure-html5/unnamed-chunk-3-1.png","100541120_files/figure-html5/unnamed-chunk-4-1.png","100541120_files/figure-html5/unnamed-chunk-5-1.png","100541120_files/figure-html5/unnamed-chunk-6-1.png","100541120_files/figure-html5/unnamed-chunk-7-1.png","100541120_files/figure-html5/unnamed-chunk-8-1.png","100541120_files/figure-html5/unnamed-chunk-9-1.png","100541120_files/header-attrs-2.28/header-attrs.js","100541120_files/header-attrs-2.29/header-attrs.js","100541120_files/jquery-3.6.0/jquery-3.6.0.js","100541120_files/jquery-3.6.0/jquery-3.6.0.min.js","100541120_files/jquery-3.6.0/jquery-3.6.0.min.map","100541120_files/popper-2.6.0/popper.min.js","100541120_files/tippy-6.2.7/tippy-bundle.umd.min.js","100541120_files/tippy-6.2.7/tippy-light-border.css","100541120_files/tippy-6.2.7/tippy.css","100541120_files/tippy-6.2.7/tippy.umd.min.js","100541120_files/webcomponents-2.0.0/webcomponents.js","barchart_coc_large.png","Flags/Albania.png","Flags/Argentina.png","Flags/Australia.png","Flags/Canada.png","Flags/Chile.png","Flags/Combined_flag_of_England_and_Wales.svg","Flags/CostaRica.png","Flags/Ireland.png","Flags/Netherlands.png","Flags/Poland.png","Flags/Saint_Patrick's_Saltire.svg","Flags/Scotland.png","Flags/Spain.png","Flags/UnitedStates.png","Flags/Uruguay.png"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  hr.section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    margin: 0px;
  }


  d-byline {
    border-top: none;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
    border-top: none;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  /* tweak for Pandoc numbered line within distill */
  d-article pre.numberSource code > span {
      left: -2em;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // separator
    var separator = '<hr class="section-separator" style="clear: both"/>';
    // prepend separator above appendix
    $('.d-byline').before(separator);
    $('.d-article').before(separator);

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme, except when numbering line
    // in code chunk
    $('pre:not(.numberLines) code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        var author_name = front_matter.authors[i].author
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="100541120_files/header-attrs-2.29/header-attrs.js"></script>
  <script src="100541120_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="100541120_files/popper-2.6.0/popper.min.js"></script>
  <link href="100541120_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="100541120_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="100541120_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="100541120_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="100541120_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="100541120_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="100541120_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Cocaine consumption","description":"This project aims to provide insights into the principal consumers of cocaine through a bar plot. I chose this topic because I find it interesting and relevant, especially in relation to the global issues surrounding drug trafficking. \nThe bar plot serves as an effective tool to visually compare the data, making complex information more accessible and understandable. I was particularly inspired by the work of El Orden Mundial, which I consider they do a great job of visualizing data.","authors":[{"author":"Jorge Ramos","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2024-12-20T00:00:00.000+01:00","citationText":"Ramos, 2024"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Cocaine consumption</h1>

<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt-tag">2024</div>
</div>
<!--/radix_placeholder_categories-->
<p><p>This project aims to provide insights into the principal consumers of cocaine through a bar plot. I chose this topic because I find it interesting and relevant, especially in relation to the global issues surrounding drug trafficking.
The bar plot serves as an effective tool to visually compare the data, making complex information more accessible and understandable. I was particularly inspired by the work of El Orden Mundial, which I consider they do a great job of visualizing data.</p></p>
</div>

<div class="d-byline">
  
  Jorge Ramos
  
<br/>2024-12-20
</div>

<div class="d-article">
<p>First I load the libraries that I will need to make the plot:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://r-spatial.github.io/sf/'>sf</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://paleolimbot.github.io/ggspatial/'>ggspatial</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://docs.ropensci.org/rnaturalearth/'>rnaturalearth</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://docs.ropensci.org/rnaturalearthdata/'>rnaturalearthdata</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tibble.tidyverse.org/'>tibble</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/GuangchuangYu/ggimage'>ggimage</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tibble.tidyverse.org/'>tibble</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>grid</span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://www.rforge.net/png/'>png</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://wilkelab.org/ggtext/'>ggtext</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/yixuan/showtext'>showtext</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/wch/extrafont'>extrafont</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://www.rforge.net/png/'>png</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://devtools.r-lib.org/'>devtools</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>flagon</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Now, I can start with the data i need to make the graph. In the original plot from El Orden Mundial there is one papers where they extract the information. These are: UNODC (2018): World Drug Report 2018: opioid crisis, prescription drug abuse expands; cocaine and opium hit record highs.</p>
<p>Unfortunately, I couldn’t find an available database with this data. I found in UNODC page other databases with the information of cocaine use, but none of them coincide with the consumption percentage of 2018 presented in the plot.</p>
<p>Due to this, I will try to make my own database with the information in order to make the representation later.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Data I need: Country, Position, and Consume Percentage.</span></span>
<span></span>
<span><span class='va'>cocaine_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span></span>
<span>  Posición <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>6</span>, <span class='fl'>7</span>, <span class='fl'>8</span>, <span class='fl'>8</span>, <span class='fl'>10</span>, <span class='fl'>11</span>, <span class='fl'>12</span>, <span class='fl'>13</span>, <span class='fl'>14</span>, <span class='fl'>15</span><span class='op'>)</span>,</span>
<span>  País <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Australia"</span>, <span class='st'>"Albania"</span>, <span class='st'>"Estados Unidos"</span>, <span class='st'>"Escocia (R.U.)"</span>, <span class='st'>"Inglaterra y Gales (R.U.)"</span>,</span>
<span>              <span class='st'>"España"</span>, <span class='st'>"Países Bajos"</span>, <span class='st'>"Irlanda del Norte (R.U.)"</span>, <span class='st'>"Uruguay"</span>, <span class='st'>"Argentina"</span>,</span>
<span>              <span class='st'>"Irlanda"</span>, <span class='st'>"Canadá"</span>, <span class='st'>"Polonia"</span>, <span class='st'>"Chile"</span>, <span class='st'>"Costa Rica"</span><span class='op'>)</span>,</span>
<span>  `Porcentaje de consumo (%)` <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2.5</span>, <span class='fl'>2.5</span>, <span class='fl'>2.4</span>, <span class='fl'>2.34</span>, <span class='fl'>2.3</span>, <span class='fl'>2.0</span>, <span class='fl'>1.9</span>, <span class='fl'>1.8</span>, <span class='fl'>1.8</span>, <span class='fl'>1.67</span>, </span>
<span>                                   <span class='fl'>1.5</span>, <span class='fl'>1.47</span>, <span class='fl'>1.4</span>, <span class='fl'>1.38</span>, <span class='fl'>1.33</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='co'>#I do this to order the countries in the graph</span></span>
<span><span class='va'>cocaine_data</span><span class='op'>$</span><span class='va'>País</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>cocaine_data</span><span class='op'>$</span><span class='va'>País</span>, levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='va'>cocaine_data</span><span class='op'>$</span><span class='va'>País</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Now, I am going to choose the font I am going to use for the text in the plot.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/yixuan/showtext'>showtext</a></span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/sysfonts/man/font_add_google.html'>font_add_google</a></span><span class='op'>(</span><span class='st'>"Mulish"</span>, <span class='st'>"mulish"</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/showtext/man/showtext_auto.html'>showtext_auto</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>I needed to change the original font as it wasn’t open-source. I selected a font from Google Fonts that is slightly similar, ensuring the visual appearance aligns with the authentic bar plot.</p>
<p>Now, I can start with the plot. I am going to do this by layers, I consider it will make the code more readable and organized, ensuring each part of the plot is built in a modular way.</p>
<p>The first step regarding to the graph creation is to restrict the length and height of the graph, for this I introduce &lt;```{r, fig.width= 8.5, fig.height= 6}&gt;</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>barchart_coc1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>cocaine_data</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>País</span>, </span>
<span>                                         y <span class='op'>=</span> <span class='va'>`Porcentaje de consumo (%)`</span>,</span>
<span>                                         fill <span class='op'>=</span> <span class='va'>`Porcentaje de consumo (%)`</span><span class='op'>)</span>, </span>
<span>                        family <span class='op'>=</span> <span class='st'>"mulish"</span>, font.main <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Create bar chart with identity stat (values directly from data)</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></span><span class='op'>(</span>stat <span class='op'>=</span> <span class='st'>"identity"</span>, width <span class='op'>=</span> <span class='fl'>0.7</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Flip to make a horizontal bar chart</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_flip.html'>coord_flip</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='co'># Add a vertical line on the axis Y </span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>0.65</span>, xend <span class='op'>=</span> <span class='fl'>15.35</span>, y <span class='op'>=</span> <span class='fl'>0</span>, yend <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>, </span>
<span>               color <span class='op'>=</span> <span class='st'>"#498f3d"</span>, </span>
<span>               linewidth <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Add positions of the countries next to the  Y axis</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>Posición</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.12</span><span class='op'>)</span>, </span>
<span>            hjust <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>            color <span class='op'>=</span> <span class='st'>"#0A0A0A"</span>, </span>
<span>            size <span class='op'>=</span> <span class='fl'>4.3</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span>, font.main <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Add consumption percentages at the end of each bar</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"\\."</span>, <span class='st'>","</span>, </span>
<span>                                    <span class='fu'><a href='https://rdrr.io/r/base/formatc.html'>formatC</a></span><span class='op'>(</span><span class='va'>`Porcentaje de consumo (%)`</span>, </span>
<span>                                            format <span class='op'>=</span> <span class='st'>"f"</span>, digits <span class='op'>=</span> <span class='fl'>2</span>, drop0trailing <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>, <span class='st'>"%"</span><span class='op'>)</span>, </span>
<span>                y <span class='op'>=</span> <span class='va'>`Porcentaje de consumo (%)`</span><span class='op'>)</span>, </span>
<span>            hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.4</span>, </span>
<span>            vjust <span class='op'>=</span> <span class='fl'>0.38</span>,</span>
<span>            color <span class='op'>=</span> <span class='st'>"#0A0A0A"</span>, </span>
<span>            size <span class='op'>=</span> <span class='fl'>4.25</span>, </span>
<span>            family <span class='op'>=</span> <span class='st'>"mulish"</span>, font.main <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Adjust the expansion of the y-axis to give more space at the edges</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>expand <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/expansion.html'>expansion</a></span><span class='op'>(</span>add <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.6</span>, <span class='fl'>1.5</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Extend the x-axis limits slightly to make space for annotations</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/expand_limits.html'>expand_limits</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>16.4</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Add a label for the "Position" column</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, label <span class='op'>=</span> <span class='st'>"Position"</span>,</span>
<span>           x <span class='op'>=</span> <span class='fl'>15.85</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.15</span>, size <span class='op'>=</span> <span class='fl'>4.4</span>, vjust <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>           color <span class='op'>=</span> <span class='st'>"#353939"</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='co'># Use a color gradient to fill the bars (low to high values)</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_gradient.html'>scale_fill_gradient</a></span><span class='op'>(</span>low <span class='op'>=</span> <span class='st'>"#c0cd94"</span>, high <span class='op'>=</span> <span class='st'>"#84a528"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Add titles, subtitles, and captions</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Principales consumidores de cocaína"</span>, </span>
<span>       subtitle <span class='op'>=</span> <span class='st'>"Porcentaje de adultos que han consumido en el último año*"</span>, </span>
<span>       caption <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span></span>
<span>         <span class='st'>"Último año con datos disponibles*&lt;br&gt;"</span>,</span>
<span>         <span class='st'>"**Cartografía:**&lt;br&gt;"</span>,</span>
<span>         <span class='st'>"Abel Gil Lobo (2019)&lt;br&gt;"</span>, </span>
<span>         <span class='st'>"**Fuente:**&lt;br&gt;"</span>,</span>
<span>         <span class='st'>"UNODC (2018)"</span><span class='op'>)</span>,</span>
<span>       y <span class='op'>=</span> <span class='st'>"Consumption Percentage (%)"</span>, </span>
<span>       x <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Apply a minimal theme for the plot</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    <span class='co'># Remove x-axis title, text, and ticks</span></span>
<span>    axis.title.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    axis.title.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    axis.ticks.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    panel.grid <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>13</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span>, color <span class='op'>=</span> <span class='st'>"#0A0A0A"</span><span class='op'>)</span>, </span>
<span>    <span class='co'># Remove the grid lines</span></span>
<span>    panel.grid.major <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    <span class='co'># Hide the legend</span></span>
<span>    legend.position <span class='op'>=</span> <span class='st'>"none"</span>,</span>
<span>    <span class='co'># Adjust plot margins</span></span>
<span>    plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>0</span>, r <span class='op'>=</span> <span class='fl'>5</span>, b <span class='op'>=</span> <span class='fl'>1</span>, l<span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>, </span>
<span>    <span class='co'># Remove panel and plot backgrounds</span></span>
<span>    panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>, </span>
<span>    plot.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    <span class='co'># Style the caption with markdown support</span></span>
<span>    plot.caption <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0</span>, vjust <span class='op'>=</span> <span class='fl'>1</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, </span>
<span>                                    size <span class='op'>=</span> <span class='fl'>8</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span>, margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>0</span>, r <span class='op'>=</span> <span class='fl'>0</span>, b <span class='op'>=</span> <span class='fl'>0</span>, l <span class='op'>=</span> <span class='fl'>11</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    <span class='co'># Style the title and subtitle with specific positions and sizes</span></span>
<span>    plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0.07</span>, vjust <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>                              size <span class='op'>=</span> <span class='fl'>29</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span><span class='op'>)</span>,<span class='co'># Adjust bottom margin for title</span></span>
<span>    plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0.12</span>, vjust <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>                                 size <span class='op'>=</span> <span class='fl'>22</span>, color <span class='op'>=</span> <span class='st'>"#353939"</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span><span class='op'>)</span>,<span class='co'># Adjust bottom margin for subtitle</span></span>
<span>    <span class='co'># Position title and subtitle within the plot panel</span></span>
<span>    plot.title.position <span class='op'>=</span> <span class='st'>"plot"</span>,</span>
<span>    plot.subtitle.position <span class='op'>=</span> <span class='st'>"plot"</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='va'>barchart_coc1</span></span></code></pre>
</div>
<p><img src="100541120_files/figure-html5/unnamed-chunk-4-1.png" width="816" /></p>
</div>
<p>Now I can continue with the flags, which have been one of the main challenges. First, it was difficult to find the right package for this task. Second, the issue was with the images themselves, as I initially had to download them, which added to the complexity.</p>
<p>Finally, I decided to use a package that I have downloaded from Github, called “flagon”. &lt;“<a href="https://github.com/coolbutuseless/flagon" class="uri">https://github.com/coolbutuseless/flagon</a>”&gt;</p>
<p>But there is also a particularity, some of the flags of the original plot are not in this package (because these are from regions inside a country), so I needed to download in the project file.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#Install the package:</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://devtools.r-lib.org/'>devtools</a></span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://remotes.r-lib.org/reference/install_local.html'>install_local</a></span><span class='op'>(</span><span class='st'>"C:/Users/jorge/Desktop/CSS/Data-Visualization/Cocaine in Europe - Datavis/flagon-master"</span><span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://www.rforge.net/png/'>png</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>flagon</span><span class='op'>)</span></span>
<span><span class='co'># Read PNG images for flags</span></span>
<span><span class='va'>Australia</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='fu'>flagon</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/flagon/man/flags.html'>flags</a></span><span class='op'>(</span><span class='st'>"au"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>Albania</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='fu'>flagon</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/flagon/man/flags.html'>flags</a></span><span class='op'>(</span><span class='st'>"al"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>Estados_Unidos</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='fu'>flagon</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/flagon/man/flags.html'>flags</a></span><span class='op'>(</span><span class='st'>"us"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>Escocia</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='st'>"C:/Users/jorge/Desktop/CSS/Data-Visualization/Cocaine in Europe - Datavis/flagon-master/inst/png/sct.png"</span><span class='op'>)</span></span>
<span><span class='va'>Inglaterra</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='st'>"C:/Users/jorge/Desktop/CSS/Data-Visualization/Cocaine in Europe - Datavis/Images/England and Wales.png"</span><span class='op'>)</span></span>
<span><span class='va'>España</span> <span class='op'>&lt;-</span>  <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='fu'>flagon</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/flagon/man/flags.html'>flags</a></span><span class='op'>(</span><span class='st'>"es"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>Paises_Bajos</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='fu'>flagon</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/flagon/man/flags.html'>flags</a></span><span class='op'>(</span><span class='st'>"nl"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>Irlanda_norte</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='st'>"C:/Users/jorge/Desktop/CSS/Data-Visualization/Cocaine in Europe - Datavis/Images/Northern Ireland.png"</span><span class='op'>)</span></span>
<span><span class='va'>Uruguay</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='fu'>flagon</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/flagon/man/flags.html'>flags</a></span><span class='op'>(</span><span class='st'>"uy"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>Argentina</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='fu'>flagon</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/flagon/man/flags.html'>flags</a></span><span class='op'>(</span><span class='st'>"ar"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>Irlanda</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='fu'>flagon</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/flagon/man/flags.html'>flags</a></span><span class='op'>(</span><span class='st'>"ie"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>Canada</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='fu'>flagon</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/flagon/man/flags.html'>flags</a></span><span class='op'>(</span><span class='st'>"ca"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>Polonia</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='fu'>flagon</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/flagon/man/flags.html'>flags</a></span><span class='op'>(</span><span class='st'>"pl"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>Chile</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='fu'>flagon</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/flagon/man/flags.html'>flags</a></span><span class='op'>(</span><span class='st'>"cl"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>CostaRica</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='fu'>flagon</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/flagon/man/flags.html'>flags</a></span><span class='op'>(</span><span class='st'>"cr"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#Add flags to the bar chart using `annotation_raster`</span></span>
<span><span class='va'>flag_plot</span> <span class='op'>&lt;-</span> <span class='va'>barchart_coc1</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_raster.html'>annotation_raster</a></span><span class='op'>(</span><span class='va'>CostaRica</span>, xmin <span class='op'>=</span> <span class='fl'>0.6</span>, xmax <span class='op'>=</span> <span class='fl'>1.3</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.62</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.34</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_raster.html'>annotation_raster</a></span><span class='op'>(</span><span class='va'>Chile</span>, xmin <span class='op'>=</span> <span class='fl'>1.6</span>, xmax <span class='op'>=</span> <span class='fl'>2.3</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.62</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.34</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_raster.html'>annotation_raster</a></span><span class='op'>(</span><span class='va'>Polonia</span>, xmin <span class='op'>=</span> <span class='fl'>2.6</span>, xmax <span class='op'>=</span> <span class='fl'>3.3</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.62</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.34</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_raster.html'>annotation_raster</a></span><span class='op'>(</span><span class='va'>Canada</span>, xmin <span class='op'>=</span> <span class='fl'>3.6</span>, xmax <span class='op'>=</span> <span class='fl'>4.3</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.62</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.34</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_raster.html'>annotation_raster</a></span><span class='op'>(</span><span class='va'>Argentina</span>, xmin <span class='op'>=</span> <span class='fl'>5.6</span>, xmax <span class='op'>=</span> <span class='fl'>6.3</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.62</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.34</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_raster.html'>annotation_raster</a></span><span class='op'>(</span><span class='va'>Irlanda</span>, xmin <span class='op'>=</span> <span class='fl'>4.6</span>, xmax <span class='op'>=</span> <span class='fl'>5.3</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.62</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.34</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_raster.html'>annotation_raster</a></span><span class='op'>(</span><span class='va'>Irlanda_norte</span>, xmin <span class='op'>=</span> <span class='fl'>7.6</span>, xmax <span class='op'>=</span> <span class='fl'>8.3</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.62</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.34</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_raster.html'>annotation_raster</a></span><span class='op'>(</span><span class='va'>Uruguay</span>, xmin <span class='op'>=</span> <span class='fl'>6.6</span>, xmax <span class='op'>=</span> <span class='fl'>7.3</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.62</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.34</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_raster.html'>annotation_raster</a></span><span class='op'>(</span><span class='va'>Paises_Bajos</span>, xmin <span class='op'>=</span> <span class='fl'>8.6</span>, xmax <span class='op'>=</span> <span class='fl'>9.3</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.62</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.34</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_raster.html'>annotation_raster</a></span><span class='op'>(</span><span class='va'>España</span>, xmin <span class='op'>=</span> <span class='fl'>9.6</span>, xmax <span class='op'>=</span> <span class='fl'>10.3</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.62</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.34</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_raster.html'>annotation_raster</a></span><span class='op'>(</span><span class='va'>Inglaterra</span>, xmin <span class='op'>=</span> <span class='fl'>10.6</span>, xmax <span class='op'>=</span> <span class='fl'>11.3</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.62</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.34</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_raster.html'>annotation_raster</a></span><span class='op'>(</span><span class='va'>Escocia</span>, xmin <span class='op'>=</span> <span class='fl'>11.6</span>, xmax <span class='op'>=</span> <span class='fl'>12.3</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.62</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.34</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_raster.html'>annotation_raster</a></span><span class='op'>(</span><span class='va'>Estados_Unidos</span>, xmin <span class='op'>=</span> <span class='fl'>12.6</span>, xmax <span class='op'>=</span> <span class='fl'>13.3</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.62</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.34</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_raster.html'>annotation_raster</a></span><span class='op'>(</span><span class='va'>Albania</span>, xmin <span class='op'>=</span> <span class='fl'>13.6</span>, xmax <span class='op'>=</span> <span class='fl'>14.3</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.62</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.34</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_raster.html'>annotation_raster</a></span><span class='op'>(</span><span class='va'>Australia</span>, xmin <span class='op'>=</span> <span class='fl'>14.6</span>, xmax <span class='op'>=</span> <span class='fl'>15.3</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.62</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.34</span><span class='op'>)</span>  </span>
<span></span>
<span></span>
<span><span class='co'>#Now, we can display the final plot with flags</span></span>
<span><span class='va'>flag_plot</span></span></code></pre>
</div>
<p><img src="100541120_files/figure-html5/unnamed-chunk-5-1.png" width="816" /></p>
</div>
<p>As we can see, one problem I encountered was with the quality of the flags in the graph. Despite using the annotation_raster() function to add them, the quality of the flags appeared quite poor.
For the shades that has the authentic graph, I tried to introduce grey rectangles on the back of the flags but it wasn’t a good option. Also I tried to edit the images of the packages but then when I tried to introduce those flags in the graph they dissappeared.</p>
<p>The next step is to introduce the logos. These original figures were difficult to find, so I decided to made a screenshot of the original plot and introduce the pictures with patchwork package.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#logos</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://patchwork.data-imaginist.com'>patchwork</a></span><span class='op'>)</span>  </span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>grid</span><span class='op'>)</span>  </span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://www.rforge.net/png/'>png</a></span><span class='op'>)</span>  </span>
<span></span>
<span><span class='co'># Read the PNG images for the logos</span></span>
<span><span class='va'>logo1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='st'>"C:/Users/jorge/Desktop/CSS/Data-Visualization/Cocaine in Europe - Datavis/eom.png"</span><span class='op'>)</span></span>
<span><span class='va'>logo2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='st'>"C:/Users/jorge/Desktop/CSS/Data-Visualization/Cocaine in Europe - Datavis/cuch.png"</span><span class='op'>)</span>  </span>
<span></span>
<span><span class='co'>#Convert images into raster objects to be used in the plot</span></span>
<span><span class='va'>logo1_grob</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grid/grid.raster.html'>rasterGrob</a></span><span class='op'>(</span><span class='va'>logo1</span>, interpolate <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>  <span class='co'>#Convert the first logo into a graphical object</span></span>
<span><span class='va'>logo2_grob</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grid/grid.raster.html'>rasterGrob</a></span><span class='op'>(</span><span class='va'>logo2</span>, interpolate <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>  <span class='co'>#Convert the second logo into a graphical object</span></span>
<span></span>
<span><span class='co'>#Combine the bar chart with flags and logos</span></span>
<span><span class='va'>plot_logo</span> <span class='op'>&lt;-</span> <span class='va'>flag_plot</span> <span class='op'>+</span> </span>
<span>  <span class='co'># Add Logo 1 in the topright corner</span></span>
<span>  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/inset_element.html'>inset_element</a></span><span class='op'>(</span></span>
<span>    <span class='va'>logo1_grob</span>,</span>
<span>    left <span class='op'>=</span> <span class='fl'>0.62</span>, bottom <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.12</span>, right <span class='op'>=</span> <span class='fl'>1.02</span>, top <span class='op'>=</span> <span class='fl'>0.17</span>,  <span class='co'>#Position for top-right corner</span></span>
<span>    align_to <span class='op'>=</span> <span class='st'>"panel"</span>,  <span class='co'># Align the position to the panel dimensions</span></span>
<span>    on_top <span class='op'>=</span> <span class='cn'>TRUE</span>  <span class='co'># Ensure the logo appears on top of the plot</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Add Logo 2 in the bottomright corner</span></span>
<span>  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/inset_element.html'>inset_element</a></span><span class='op'>(</span></span>
<span>    <span class='va'>logo2_grob</span>,</span>
<span>    left <span class='op'>=</span> <span class='fl'>0.62</span>, bottom <span class='op'>=</span> <span class='fl'>0.12</span>, right <span class='op'>=</span> <span class='fl'>1.02</span>, top <span class='op'>=</span> <span class='fl'>0.56</span>,  <span class='co'>#Position for bottom-right corner</span></span>
<span>    align_to <span class='op'>=</span> <span class='st'>"panel"</span>,  </span>
<span>    on_top <span class='op'>=</span> <span class='cn'>FALSE</span>  </span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'>#The final plot</span></span>
<span><span class='va'>plot_logo</span></span></code></pre>
</div>
<p><img src="100541120_files/figure-html5/unnamed-chunk-6-1.png" width="816" /></p>
</div>
<p>CRITICISM OF THE ORIGINAL GRAPH:</p>
<ol type="1">
<li><p>Although it is titled Main Cocaine Consumers, all the observations are countries except for Scotland, England and Wales, and Northern Ireland. Two issues can be identified here: first, while these territories are divided, England and Wales are kept together, meaning these observations do not correspond to an administrative area of the United Kingdom. Second, I believe these observations should have been grouped into a single one, United Kingdom, to allow for a better comparison.</p></li>
<li><p>It’s important to acknowledge that this is a sensitive topic, as it touches on drug consumption, which involves complex social, economic, and cultural factors. Additionally, gathering reliable data on cocaine use poses significant challenges. Drug use is often underreported due to stigma, illegality, and variations in how surveys or studies are conducted across different regions or countries.</p></li>
</ol>
<p>This previous part have been my replica to the graph. As you can see, there are some differences. First, there are some adjustment issues, such as with the size of the figures, text, and positioning. I’ve tried to make it as similar as possible, but there are still some aspects that could be improved. Second, the flag images, as in the original, the quality of these is much higher than what I’ve managed to achieve, as well as the shading behind them.</p>
<p>Considering the points mentioned, I can now move forward with improving the graph. Despite the challenges, I believe the original graph is a strong representation of the data. It effectively conveys the information in a clear and straightforward manner. The simplicity of the design makes it easy to understand, and the choice of a bar plot is particularly appropriate for visualizing this type of comparative data.</p>
<p>First, I will proceed to address some aesthetic aspects that, in my opinion, will improve the overall quality of the graphic:</p>
<p>1.Aligning positions: Adjusting the positioning number to ensure they are visually balanced and aligned properly.</p>
<p>2.Axis line: Modifying the line on the axis to make it more distinct will help to clarify the data’s structure and improve the overall clarity of the graph.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Create the bar chart with reordered countries and custom aesthetics</span></span>
<span><span class='va'>upgrade</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>cocaine_data</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/reorder.factor.html'>reorder</a></span><span class='op'>(</span><span class='va'>País</span>, <span class='va'>`Porcentaje de consumo (%)`</span><span class='op'>)</span>,  <span class='co'># Reorder countries by consumption percentage</span></span>
<span>                                    y <span class='op'>=</span> <span class='va'>`Porcentaje de consumo (%)`</span>,</span>
<span>                                    fill <span class='op'>=</span> <span class='va'>`Porcentaje de consumo (%)`</span><span class='op'>)</span>, </span>
<span>                  family <span class='op'>=</span> <span class='st'>"mulish"</span>, font.main <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Add horizontal bars for each country</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></span><span class='op'>(</span>stat <span class='op'>=</span> <span class='st'>"identity"</span>, width <span class='op'>=</span> <span class='fl'>0.7</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Flip the axes for a horizontal bar chart</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_flip.html'>coord_flip</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='co'># Add a horizontal line at y = 0 to connect the starting points of the bars</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>0.6</span>, xend <span class='op'>=</span> <span class='fl'>15.4</span>, y <span class='op'>=</span> <span class='fl'>0</span>, yend <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>, </span>
<span>               color <span class='op'>=</span> <span class='st'>"black"</span>, <span class='co'>#Change the color from the original one</span></span>
<span>               linewidth <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Add the ranking positions to the left of the y-axis</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>Posición</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.2</span><span class='op'>)</span>, </span>
<span>            hjust <span class='op'>=</span> <span class='fl'>0.5</span>,  <span class='co'>#Adjust text horizontally</span></span>
<span>            color <span class='op'>=</span> <span class='st'>"#0A0A0A"</span>,  <span class='co'>#Text color</span></span>
<span>            size <span class='op'>=</span> <span class='fl'>4.3</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span>, font.main <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Add the percentage of consumption at the end of each bar</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"\\."</span>, <span class='st'>","</span>, <span class='fu'><a href='https://rdrr.io/r/base/formatc.html'>formatC</a></span><span class='op'>(</span><span class='va'>`Porcentaje de consumo (%)`</span>, </span>
<span>                                                       format <span class='op'>=</span> <span class='st'>"f"</span>, digits <span class='op'>=</span> <span class='fl'>2</span>, drop0trailing <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>, <span class='st'>"%"</span><span class='op'>)</span>, </span>
<span>                y <span class='op'>=</span> <span class='va'>`Porcentaje de consumo (%)`</span><span class='op'>)</span>, </span>
<span>            hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.4</span>,  <span class='co'>#Adjust the text placement horizontally</span></span>
<span>            vjust <span class='op'>=</span> <span class='fl'>0.38</span>,  <span class='co'>#Adjust the text placement vertically</span></span>
<span>            color <span class='op'>=</span> <span class='st'>"#0A0A0A"</span>, </span>
<span>            size <span class='op'>=</span> <span class='fl'>4</span>, </span>
<span>            family <span class='op'>=</span> <span class='st'>"mulish"</span>, font.main <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Adjust the expansion of the y-axis</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>expand <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/expansion.html'>expansion</a></span><span class='op'>(</span>add <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.6</span>, <span class='fl'>1.5</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Add additional space for the x-axis limits</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/expand_limits.html'>expand_limits</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>17</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Add a label for the "Position" column</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, label <span class='op'>=</span> <span class='st'>"Posición"</span>,</span>
<span>           x <span class='op'>=</span> <span class='fl'>15.8</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.2</span>, size <span class='op'>=</span> <span class='fl'>4</span>, vjust <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>           color <span class='op'>=</span> <span class='st'>"#353939"</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='co'># Set a gradient color scale for the bars</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_gradient.html'>scale_fill_gradient</a></span><span class='op'>(</span>low <span class='op'>=</span> <span class='st'>"#c0cd94"</span>, high <span class='op'>=</span> <span class='st'>"#84a528"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Add plot labels</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Principales consumidores de cocaína"</span>,  </span>
<span>       subtitle <span class='op'>=</span> <span class='st'>"Porcentaje de adultos que han consumido en el último año*"</span>, </span>
<span>       caption <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span>  </span>
<span>         <span class='st'>"Último  año con datos disponibles*&lt;br&gt;"</span>,</span>
<span>         <span class='st'>"**Cartografía:**&lt;br&gt;"</span>,</span>
<span>         <span class='st'>"Abel Gil Lobo (2019)&lt;br&gt;"</span>, </span>
<span>         <span class='st'>"**Fuente:**&lt;br&gt;"</span>,</span>
<span>         <span class='st'>"UNODC (2018)"</span><span class='op'>)</span>,</span>
<span>       y <span class='op'>=</span> <span class='st'>"Porcentaje de consumo (%)"</span>,  <span class='co'># Y-axis label</span></span>
<span>       x <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span> <span class='op'>+</span>  <span class='co'># No label for the x-axis</span></span>
<span>  <span class='co'># Customize the overall theme</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    axis.title.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,  <span class='co'># Remove x-axis title</span></span>
<span>    axis.title.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,  <span class='co'># Remove y-axis title</span></span>
<span>    axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,  <span class='co'># Remove x-axis text</span></span>
<span>    axis.ticks.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,  <span class='co'># Remove x-axis ticks</span></span>
<span>    panel.grid <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,  <span class='co'>#Remove grid lines</span></span>
<span>    axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>13</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span>, color <span class='op'>=</span> <span class='st'>"#0A0A0A"</span><span class='op'>)</span>, </span>
<span>    panel.grid.major <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,  <span class='co'># Remove major grid lines</span></span>
<span>    legend.position <span class='op'>=</span> <span class='st'>"none"</span>,  <span class='co'>#Hide legend</span></span>
<span>    plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>0</span>, r <span class='op'>=</span> <span class='fl'>5</span>, b <span class='op'>=</span> <span class='fl'>1</span>, l<span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,  <span class='co'># Adjust plot margins</span></span>
<span>    panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,  <span class='co'># Set panel background to blank</span></span>
<span>    plot.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,  <span class='co'>#Set overall plot background to blank</span></span>
<span>    <span class='co'># Style for the plot caption</span></span>
<span>    plot.caption <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0</span>, vjust <span class='op'>=</span> <span class='fl'>1</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, </span>
<span>                                    size <span class='op'>=</span> <span class='fl'>8</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span>, margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>0</span>, r <span class='op'>=</span> <span class='fl'>0</span>, b <span class='op'>=</span> <span class='fl'>0</span>, l <span class='op'>=</span> <span class='fl'>11</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    <span class='co'>#Style for the main title</span></span>
<span>    plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0.07</span>, vjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>29</span>, </span>
<span>                              family <span class='op'>=</span> <span class='st'>"mulish"</span><span class='op'>)</span>,  </span>
<span>    <span class='co'>#Style for the subtitle</span></span>
<span>    plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0.12</span>, vjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>22</span>, </span>
<span>                                 color <span class='op'>=</span> <span class='st'>"#353939"</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># Position the title and subtitle within the panel</span></span>
<span>    plot.title.position <span class='op'>=</span> <span class='st'>"plot"</span>,</span>
<span>    plot.subtitle.position <span class='op'>=</span> <span class='st'>"plot"</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># Display the improvements</span></span>
<span><span class='va'>upgrade</span></span></code></pre>
</div>
<p><img src="100541120_files/figure-html5/unnamed-chunk-7-1.png" width="816" /></p>
</div>
<p>My aim is to make the graph more informative, so I decided to introduce the continent information in the graph.Therefore, I introduce the Continent values in a new variable.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#Introduce the variable</span></span>
<span><span class='va'>cocaine_data</span><span class='op'>$</span><span class='va'>Continente</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Oceanía"</span>,<span class='st'>"Europa"</span>,<span class='st'>"América"</span>,<span class='st'>"Europa"</span>,<span class='st'>"Europa"</span>,<span class='st'>"Europa"</span>,<span class='st'>"Europa"</span>,<span class='st'>"Europa"</span>,<span class='st'>"América"</span>,<span class='st'>"América"</span>,<span class='st'>"Europa"</span>,<span class='st'>"América"</span>,<span class='st'>"Europa"</span>,<span class='st'>"América"</span>,<span class='st'>"América"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#I convert it to a factor for the legend:</span></span>
<span><span class='va'>cocaine_data</span><span class='op'>$</span><span class='va'>Continente</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>cocaine_data</span><span class='op'>$</span><span class='va'>Continente</span>, </span>
<span>                                  levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Oceanía"</span>, <span class='st'>"Europa"</span>, <span class='st'>"América"</span><span class='op'>)</span><span class='op'>)</span> </span>
<span></span>
<span></span>
<span><span class='co'># Create the bar chart with countries and color by continent</span></span>
<span><span class='va'>upgrade_color</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>cocaine_data</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>País</span>, </span>
<span>                                   y <span class='op'>=</span> <span class='va'>`Porcentaje de consumo (%)`</span>,</span>
<span>                                   fill <span class='op'>=</span> <span class='va'>Continente</span><span class='op'>)</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span>, font.main <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></span><span class='op'>(</span>stat <span class='op'>=</span> <span class='st'>"identity"</span>, width <span class='op'>=</span> <span class='fl'>0.7</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_flip.html'>coord_flip</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>  <span class='co'># Para girar</span></span>
<span>  <span class='co'># Línea vertical en el eje y, conectando el inicio de las barras</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>0.6</span>, xend <span class='op'>=</span> <span class='fl'>15.4</span>, y <span class='op'>=</span> <span class='fl'>0</span>, yend <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>, </span>
<span>               color <span class='op'>=</span> <span class='st'>"black"</span>, </span>
<span>               linewidth <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Agregar las posiciones al lado del eje Y</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>Posición</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.2</span><span class='op'>)</span>, </span>
<span>            hjust <span class='op'>=</span> <span class='fl'>0.5</span>, </span>
<span>            color <span class='op'>=</span> <span class='st'>"#0A0A0A"</span>, </span>
<span>            size <span class='op'>=</span> <span class='fl'>4.3</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span>, font.main <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Agregar los porcentajes de consumo al final de cada barra</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"\\."</span>, <span class='st'>","</span>, <span class='fu'><a href='https://rdrr.io/r/base/formatc.html'>formatC</a></span><span class='op'>(</span><span class='va'>`Porcentaje de consumo (%)`</span>, format <span class='op'>=</span> <span class='st'>"f"</span>, digits <span class='op'>=</span> <span class='fl'>2</span>, drop0trailing <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>, <span class='st'>"%"</span><span class='op'>)</span>, </span>
<span>                y <span class='op'>=</span> <span class='va'>`Porcentaje de consumo (%)`</span><span class='op'>)</span>, </span>
<span>            hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.4</span>, </span>
<span>            vjust <span class='op'>=</span> <span class='fl'>0.38</span>,</span>
<span>            color <span class='op'>=</span> <span class='st'>"#0A0A0A"</span>, </span>
<span>            size <span class='op'>=</span> <span class='fl'>4.25</span>, </span>
<span>            family <span class='op'>=</span> <span class='st'>"mulish"</span>, font.main <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='co'># Ajustar la expansión del eje Y</span></span>
<span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>expand <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/expansion.html'>expansion</a></span><span class='op'>(</span>add <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.6</span>, <span class='fl'>1.5</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/expand_limits.html'>expand_limits</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>16.4</span><span class='op'>)</span>  <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, label <span class='op'>=</span> <span class='st'>"Posición"</span>,</span>
<span>           x <span class='op'>=</span> <span class='fl'>15.85</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.2</span>, size <span class='op'>=</span> <span class='fl'>4.4</span>, vjust <span class='op'>=</span> <span class='fl'>0</span>, color <span class='op'>=</span> <span class='st'>"#353939"</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>   <span class='co'># Añadir la paleta de colores manualmente para la variable Continente</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Oceanía"</span> <span class='op'>=</span> <span class='st'>"#2C3E50"</span>, </span>
<span>                               <span class='st'>"Europa"</span> <span class='op'>=</span> <span class='st'>"#FFA500"</span>, </span>
<span>                               <span class='st'>"América"</span> <span class='op'>=</span> <span class='st'>"#84a528"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Principales consumidores de cocaína"</span>, </span>
<span>       subtitle <span class='op'>=</span> <span class='st'>"Porcentaje de adultos que han consumido en el último año*"</span>, </span>
<span>       caption <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span></span>
<span>         <span class='st'>"Último  año con datos disponibles*&lt;br&gt;"</span>,</span>
<span>         <span class='st'>"**Cartografía:**&lt;br&gt;"</span>,</span>
<span>         <span class='st'>"Abel Gil Lobo (2019)&lt;br&gt;"</span>, </span>
<span>         <span class='st'>"**Fuente:**&lt;br&gt;"</span>,</span>
<span>         <span class='st'>"UNODC (2018)"</span><span class='op'>)</span>,</span>
<span>       y <span class='op'>=</span> <span class='st'>"Porcentaje de consumo (%)"</span>, </span>
<span>       x <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    axis.title.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    axis.title.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    axis.ticks.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    panel.grid <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>r <span class='op'>=</span> <span class='fl'>1.7</span><span class='op'>)</span>, size <span class='op'>=</span> <span class='fl'>12.8</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span>, color <span class='op'>=</span> <span class='st'>"#0A0A0A"</span><span class='op'>)</span>, </span>
<span>    panel.grid.major <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.9</span>, <span class='fl'>0.88</span><span class='op'>)</span>,</span>
<span>    plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>0</span>, r <span class='op'>=</span> <span class='fl'>5</span>, b <span class='op'>=</span> <span class='fl'>1</span>, l<span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>, </span>
<span>    panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>, </span>
<span>    plot.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    plot.caption <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0</span>, vjust <span class='op'>=</span> <span class='fl'>1</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>8</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span>, margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>0</span>, r <span class='op'>=</span> <span class='fl'>0</span>, b <span class='op'>=</span> <span class='fl'>0</span>, l <span class='op'>=</span> <span class='fl'>11</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0.07</span>, vjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>29</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span><span class='op'>)</span>,  <span class='co'># Ajuste margen inferior del título</span></span>
<span>    plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0.12</span>, vjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>22</span>, color <span class='op'>=</span> <span class='st'>"#353939"</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span><span class='op'>)</span>,  <span class='co'># Ajuste margen inferior del subtítulo</span></span>
<span>    plot.title.position <span class='op'>=</span> <span class='st'>"plot"</span>,  <span class='co'># Título dentro del panel</span></span>
<span>    plot.subtitle.position <span class='op'>=</span> <span class='st'>"plot"</span>  <span class='co'># Subtítulo dentro del panel</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='va'>upgrade_color</span></span></code></pre>
</div>
<p><img src="100541120_files/figure-html5/unnamed-chunk-8-1.png" width="816" /></p>
</div>
<p>With these aesthetic improvements, the graph now allows us to visually capture more information. Each bar is assigned a different color representing a continent: blue for Oceania, yellow for Europe, and green for the Americas, as indicated in the legend at the top right.</p>
<p>This color coding reveals that, while the top consumer is from Oceania, the majority of the remaining consumers are from Europe and America. Notably, most of these countries and regions are developed nations.</p>
<p>Now that I have modified the aesthetics of the graph, I can proceed with the steps I followed in the replication process.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#Add flags to the bar chart:</span></span>
<span><span class='va'>upgrade_flag</span> <span class='op'>&lt;-</span> <span class='va'>upgrade_color</span> <span class='op'>+</span></span>
<span>  <span class='co'># I Position the flags on the chart maintaining original coordinates</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_raster.html'>annotation_raster</a></span><span class='op'>(</span><span class='va'>CostaRica</span>, xmin <span class='op'>=</span> <span class='fl'>0.6</span>, xmax <span class='op'>=</span> <span class='fl'>1.3</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.66</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.38</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_raster.html'>annotation_raster</a></span><span class='op'>(</span><span class='va'>Chile</span>, xmin <span class='op'>=</span> <span class='fl'>1.6</span>, xmax <span class='op'>=</span> <span class='fl'>2.3</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.66</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.38</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_raster.html'>annotation_raster</a></span><span class='op'>(</span><span class='va'>Polonia</span>, xmin <span class='op'>=</span> <span class='fl'>2.6</span>, xmax <span class='op'>=</span> <span class='fl'>3.3</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.66</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.38</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_raster.html'>annotation_raster</a></span><span class='op'>(</span><span class='va'>Canada</span>, xmin <span class='op'>=</span> <span class='fl'>3.6</span>, xmax <span class='op'>=</span> <span class='fl'>4.3</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.66</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.38</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_raster.html'>annotation_raster</a></span><span class='op'>(</span><span class='va'>Argentina</span>, xmin <span class='op'>=</span> <span class='fl'>5.6</span>, xmax <span class='op'>=</span> <span class='fl'>6.3</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.66</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.38</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_raster.html'>annotation_raster</a></span><span class='op'>(</span><span class='va'>Irlanda</span>, xmin <span class='op'>=</span> <span class='fl'>4.6</span>, xmax <span class='op'>=</span> <span class='fl'>5.3</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.66</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.38</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_raster.html'>annotation_raster</a></span><span class='op'>(</span><span class='va'>Irlanda_norte</span>, xmin <span class='op'>=</span> <span class='fl'>7.6</span>, xmax <span class='op'>=</span> <span class='fl'>8.3</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.66</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.38</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_raster.html'>annotation_raster</a></span><span class='op'>(</span><span class='va'>Uruguay</span>, xmin <span class='op'>=</span> <span class='fl'>6.6</span>, xmax <span class='op'>=</span> <span class='fl'>7.3</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.646</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.38</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_raster.html'>annotation_raster</a></span><span class='op'>(</span><span class='va'>Paises_Bajos</span>, xmin <span class='op'>=</span> <span class='fl'>8.6</span>, xmax <span class='op'>=</span> <span class='fl'>9.3</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.66</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.38</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_raster.html'>annotation_raster</a></span><span class='op'>(</span><span class='va'>España</span>, xmin <span class='op'>=</span> <span class='fl'>9.6</span>, xmax <span class='op'>=</span> <span class='fl'>10.3</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.66</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.38</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_raster.html'>annotation_raster</a></span><span class='op'>(</span><span class='va'>Inglaterra</span>, xmin <span class='op'>=</span> <span class='fl'>10.6</span>, xmax <span class='op'>=</span> <span class='fl'>11.3</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.66</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.38</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_raster.html'>annotation_raster</a></span><span class='op'>(</span><span class='va'>Escocia</span>, xmin <span class='op'>=</span> <span class='fl'>11.6</span>, xmax <span class='op'>=</span> <span class='fl'>12.3</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.66</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.38</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_raster.html'>annotation_raster</a></span><span class='op'>(</span><span class='va'>Estados_Unidos</span>, xmin <span class='op'>=</span> <span class='fl'>12.6</span>, xmax <span class='op'>=</span> <span class='fl'>13.3</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.66</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.38</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_raster.html'>annotation_raster</a></span><span class='op'>(</span><span class='va'>Albania</span>, xmin <span class='op'>=</span> <span class='fl'>13.6</span>, xmax <span class='op'>=</span> <span class='fl'>14.3</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.66</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.38</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_raster.html'>annotation_raster</a></span><span class='op'>(</span><span class='va'>Australia</span>, xmin <span class='op'>=</span> <span class='fl'>14.6</span>, xmax <span class='op'>=</span> <span class='fl'>15.3</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.66</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.38</span><span class='op'>)</span>  </span>
<span></span>
<span><span class='co'>#Display the chart with flags positioned</span></span>
<span><span class='va'>upgrade_flag</span></span></code></pre>
</div>
<p><img src="100541120_files/figure-html5/unnamed-chunk-9-1.png" width="816" /></p>
</div>
<p>I followed the previous steps, so the problems of quality remain here.</p>
<p>Finally, I reintroduce the logos as in the original graph:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>grid</span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://patchwork.data-imaginist.com'>patchwork</a></span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#Combine the flag chart with logos</span></span>
<span><span class='va'>final_upgrade</span> <span class='op'>&lt;-</span> <span class='va'>upgrade_flag</span> <span class='op'>+</span> </span>
<span>  <span class='co'>#Add Logo 1 (top-right position)</span></span>
<span>  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/inset_element.html'>inset_element</a></span><span class='op'>(</span></span>
<span>    <span class='va'>logo1_grob</span>,</span>
<span>    left <span class='op'>=</span> <span class='fl'>0.62</span>, bottom <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.12</span>, right <span class='op'>=</span> <span class='fl'>1.02</span>, top <span class='op'>=</span> <span class='fl'>0.17</span>, <span class='co'># Top-right corner position</span></span>
<span>    align_to <span class='op'>=</span> <span class='st'>"panel"</span>,</span>
<span>    on_top <span class='op'>=</span> <span class='cn'>TRUE</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'>#Add Logo 2 (bottom-right position)</span></span>
<span>  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/inset_element.html'>inset_element</a></span><span class='op'>(</span></span>
<span>    <span class='va'>logo2_grob</span>,</span>
<span>    left <span class='op'>=</span> <span class='fl'>0.62</span>, bottom <span class='op'>=</span> <span class='fl'>0.12</span>, right <span class='op'>=</span> <span class='fl'>1.02</span>, top <span class='op'>=</span> <span class='fl'>0.56</span>, <span class='co'># Bottom-right corner position</span></span>
<span>    align_to <span class='op'>=</span> <span class='st'>"panel"</span>,</span>
<span>    on_top <span class='op'>=</span> <span class='cn'>FALSE</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='va'>final_upgrade</span></span></code></pre>
</div>
<p><img src="100541120_files/figure-html5/unnamed-chunk-10-1.png" width="816" /></p>
</div>
<p>This has been the improvement to my graph. With enhancements in its visual appearance and the inclusion of data from the continents, I believe the graph now provides more information. However, the issue is that, given the quality of the original graph and the available data, the scope for improvement was limited.</p>
<p>Therefore, I believe two approaches could be considered with this type of data. First, creating a graph that reflects the evolution of cocaine consumption, and second, categorizing countries based on their status. I have decided on three categories: producer, transition, and consumer countries.</p>
<p>For the purpose of creating an alternative visualization, I am going to invent some data about the evolution of cocaine consumption in these countries. My aim is to group the countries into three categories: producer, transition, and consumer countries.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># I am going to generate random values for with the range of [0.92, 3.5]</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>123</span><span class='op'>)</span>  </span>
<span><span class='va'>serie_1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fl'>15</span>, min <span class='op'>=</span> <span class='fl'>0.92</span>, max <span class='op'>=</span> <span class='fl'>3.5</span><span class='op'>)</span>  </span>
<span><span class='va'>serie_2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fl'>15</span>, min <span class='op'>=</span> <span class='fl'>0.92</span>, max <span class='op'>=</span> <span class='fl'>3.5</span><span class='op'>)</span></span>
<span><span class='va'>serie_3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fl'>15</span>, min <span class='op'>=</span> <span class='fl'>0.92</span>, max <span class='op'>=</span> <span class='fl'>3.5</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Now I need to unify:</span></span>
<span><span class='va'>serie_completa</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>serie_1</span>, <span class='va'>serie_2</span>, <span class='va'>serie_3</span>,</span>
<span>                    <span class='fl'>2.5</span>, <span class='fl'>2.5</span>, <span class='fl'>2.4</span>, <span class='fl'>2.34</span>, <span class='fl'>2.3</span>, <span class='fl'>2.0</span>, <span class='fl'>1.9</span>, <span class='fl'>1.8</span>, <span class='fl'>1.8</span>, <span class='fl'>1.67</span>, </span>
<span>                    <span class='fl'>1.5</span>, <span class='fl'>1.47</span>, <span class='fl'>1.4</span>, <span class='fl'>1.38</span>, <span class='fl'>1.33</span><span class='op'>)</span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span><span class='co'>#Create a tibble with the previous information</span></span>
<span><span class='va'>data_countries</span> <span class='op'>&lt;-</span> <span class='fu'>tibble</span><span class='fu'>::</span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span></span>
<span>  País <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Australia"</span>, <span class='st'>"Albania"</span>, <span class='st'>"Estados Unidos"</span>, <span class='st'>"Escocia (R.U.)"</span>, <span class='st'>"Inglaterra y Gales (R.U.)"</span>, <span class='st'>"España"</span>, </span>
<span>           <span class='st'>"Países Bajos"</span>, <span class='st'>"Irlanda del Norte (R.U.)"</span>, <span class='st'>"Uruguay"</span>, <span class='st'>"Argentina"</span>, <span class='st'>"Irlanda"</span>, <span class='st'>"Canadá"</span>, <span class='st'>"Polonia"</span>, </span>
<span>           <span class='st'>"Chile"</span>, <span class='st'>"Costa Rica"</span>, <span class='st'>"Australia"</span>, <span class='st'>"Albania"</span>, <span class='st'>"Estados Unidos"</span>, <span class='st'>"Escocia (R.U.)"</span>, </span>
<span>           <span class='st'>"Inglaterra y Gales (R.U.)"</span>, <span class='st'>"España"</span>, <span class='st'>"Países Bajos"</span>, <span class='st'>"Irlanda del Norte (R.U.)"</span>, <span class='st'>"Uruguay"</span>, </span>
<span>           <span class='st'>"Argentina"</span>, <span class='st'>"Irlanda"</span>, <span class='st'>"Canadá"</span>, <span class='st'>"Polonia"</span>, <span class='st'>"Chile"</span>, <span class='st'>"Costa Rica"</span>, <span class='st'>"Australia"</span>, <span class='st'>"Albania"</span>, </span>
<span>           <span class='st'>"Estados Unidos"</span>, <span class='st'>"Escocia (R.U.)"</span>, <span class='st'>"Inglaterra y Gales (R.U.)"</span>, <span class='st'>"España"</span>, <span class='st'>"Países Bajos"</span>, </span>
<span>           <span class='st'>"Irlanda del Norte (R.U.)"</span>, <span class='st'>"Uruguay"</span>, <span class='st'>"Argentina"</span>, <span class='st'>"Irlanda"</span>, <span class='st'>"Canadá"</span>, <span class='st'>"Polonia"</span>, <span class='st'>"Chile"</span>, </span>
<span>           <span class='st'>"Costa Rica"</span>, <span class='st'>"Australia"</span>, <span class='st'>"Albania"</span>, <span class='st'>"Estados Unidos"</span>, <span class='st'>"Escocia (R.U.)"</span>, <span class='st'>"Inglaterra y Gales (R.U.)"</span>, </span>
<span>           <span class='st'>"España"</span>, <span class='st'>"Países Bajos"</span>, <span class='st'>"Irlanda del Norte (R.U.)"</span>, <span class='st'>"Uruguay"</span>, <span class='st'>"Argentina"</span>, <span class='st'>"Irlanda"</span>, <span class='st'>"Canadá"</span>, </span>
<span>           <span class='st'>"Polonia"</span>, <span class='st'>"Chile"</span>, <span class='st'>"Costa Rica"</span><span class='op'>)</span>,</span>
<span>  `Porcentaje de consumo` <span class='op'>=</span> <span class='va'>serie_completa</span>,</span>
<span>  Año <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1988</span>, <span class='fl'>1998</span>, <span class='fl'>2008</span>, <span class='fl'>2018</span><span class='op'>)</span>, each <span class='op'>=</span> <span class='fl'>15</span><span class='op'>)</span>  </span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Now, I create the varibale estatus:</span></span>
<span><span class='va'>data_countries</span> <span class='op'>&lt;-</span> <span class='va'>data_countries</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>País <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>    <span class='va'>País</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Escocia (R.U.)"</span>, <span class='st'>"Inglaterra y Gales (R.U.)"</span>, <span class='st'>"Irlanda del Norte (R.U.)"</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"Reino Unido"</span>,</span>
<span>    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='va'>País</span></span>
<span>  <span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>País</span>, <span class='va'>Año</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>`Porcentaje de consumo` <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>`Porcentaje de consumo`</span><span class='op'>)</span>, .groups <span class='op'>=</span> <span class='st'>'drop'</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>estatus <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>    <span class='va'>País</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Albania"</span>, <span class='st'>"Argentina"</span>, <span class='st'>"Costa Rica"</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"Productor"</span>,</span>
<span>    <span class='va'>País</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"España"</span>, <span class='st'>"Uruguay"</span>, <span class='st'>"Países Bajos"</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"Transición"</span>,</span>
<span>    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='st'>"Consumidor"</span></span>
<span>  <span class='op'>)</span><span class='op'>)</span> </span>
<span><span class='co'>#Join the values of Escocia, Inglaterra, Gales e Irlanda del Norte to create Reino Unido, and I have calculated the mean.</span></span>
<span></span>
<span><span class='va'>data_countries</span></span></code></pre>
</div>
<pre><code># A tibble: 52 × 4
   País        Año `Porcentaje de consumo` estatus   
   &lt;chr&gt;     &lt;dbl&gt;                   &lt;dbl&gt; &lt;chr&gt;     
 1 Albania    1988                    2.95 Productor 
 2 Albania    1998                    1.55 Productor 
 3 Albania    2008                    3.25 Productor 
 4 Albania    2018                    2.5  Productor 
 5 Argentina  1988                    2.10 Productor 
 6 Argentina  1998                    2.61 Productor 
 7 Argentina  2008                    1.52 Productor 
 8 Argentina  2018                    1.67 Productor 
 9 Australia  1988                    1.66 Consumidor
10 Australia  1998                    3.24 Consumidor
# ℹ 42 more rows</code></pre>
</div>
<p>I must mention that since the consumption data has been generated randomly, the evolution may seem strange. However, I preferred to do it this way to represent the variations, without considering how it might turn out.</p>
<p>First, I will also maintain the size of the graph to ensure consistency and comparability with the previous one. Similarly, I will keep the font used in the replica because it is similar and I believe it enhances readability. I will also include the images of the tubes and lines.</p>
<p>To complete this exercise, I will present different visualization styles or attempts I have made:</p>
<p>In the first attempt, I aim to represent the evolution by country.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggrepel.slowkow.com/'>ggrepel</a></span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Plot showing the trend of cocaine consumption by country over time</span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>data_countries</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Año</span>, </span>
<span>      y <span class='op'>=</span> <span class='va'>`Porcentaje de consumo`</span>, </span>
<span>      color <span class='op'>=</span> <span class='va'>País</span><span class='op'>)</span> <span class='op'>+</span>  <span class='co'>#Color by country</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>linewidth <span class='op'>=</span> <span class='fl'>0.75</span><span class='op'>)</span> <span class='op'>+</span>  <span class='co'>#Thicker lines for clarity</span></span>
<span>  <span class='fu'>ggrepel</span><span class='fu'>::</span><span class='fu'><a href='https://ggrepel.slowkow.com/reference/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>data_countries</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>País</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Año</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>Año</span><span class='op'>)</span><span class='op'>)</span>,  <span class='co'># Labels only for the most recent year</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>País</span><span class='op'>)</span>, </span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>3.5</span>,</span>
<span>    direction <span class='op'>=</span> <span class='st'>"y"</span>,  <span class='co'>#Avoid label overlaps</span></span>
<span>    nudge_x <span class='op'>=</span> <span class='fl'>1.5</span>,  <span class='co'>#Move labels to the right</span></span>
<span>    segment.color <span class='op'>=</span> <span class='st'>"grey70"</span>, </span>
<span>    segment.size <span class='op'>=</span> <span class='fl'>0.3</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span></span>
<span>    breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1988</span>, <span class='fl'>1998</span>, <span class='fl'>2008</span>, <span class='fl'>2018</span><span class='op'>)</span>,  <span class='co'># Set x axis breaks</span></span>
<span>    labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"1988"</span>, <span class='st'>"1998"</span>, <span class='st'>"2008"</span>, <span class='st'>"2018"</span><span class='op'>)</span>  <span class='co'>#x axis labels</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span></span>
<span>    breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>1</span>, <span class='fl'>1.5</span>, <span class='fl'>2</span>, <span class='fl'>2.5</span>, <span class='fl'>3</span>, <span class='fl'>3.5</span>, <span class='fl'>4</span><span class='op'>)</span>,  <span class='co'>#Set y axis breaks</span></span>
<span>    labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>1</span>, <span class='fl'>1.5</span>, <span class='fl'>2</span>, <span class='fl'>2.5</span>, <span class='fl'>3</span>, <span class='fl'>3.5</span>, <span class='fl'>4</span><span class='op'>)</span>  <span class='co'># y axis labels</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/expand_limits.html'>expand_limits</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>2022</span>, y <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>  <span class='co'>#Expand axis limits</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span></span>
<span>    title <span class='op'>=</span> <span class='st'>"Evolución del Consumo de Cocaína"</span>,</span>
<span>    subtitle <span class='op'>=</span> <span class='st'>"Porcentaje de adultos que han consumido cocaína"</span>,</span>
<span>    caption <span class='op'>=</span> <span class='st'>"*¡Los datos han sido generados de forma aleatoria!*"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>  <span class='co'># Minimal theme</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    legend.position <span class='op'>=</span> <span class='st'>"none"</span>,  <span class='co'># Hide legend</span></span>
<span>    axis.title.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>14</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span><span class='op'>)</span>, </span>
<span>    axis.title.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>14</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span><span class='op'>)</span>,</span>
<span>    plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0</span>, vjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>27</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span><span class='op'>)</span>,</span>
<span>    plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0</span>, vjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>24</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span>, colour <span class='op'>=</span> <span class='st'>"#4D5154"</span><span class='op'>)</span>,</span>
<span>    plot.caption <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>9</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span><span class='op'>)</span>,</span>
<span>    plot.margin <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>, <span class='st'>"cm"</span><span class='op'>)</span>  </span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
<p><img src="100541120_files/figure-html5/unnamed-chunk-12-1.png" width="816" /></p>
</div>
<p>As we can see, although the graph represents our objective, it is somewhat difficult to read. Adding the grey lines for annotating the country names has made it slightly easier to follow. However, despite the graph conveying the idea I want to express, I believe the visualization is not very clear.
Therefore, I consider it important to explore other ways of visualizing the data to make it more readable and visually appealing.</p>
<p>Now, I will try placing the country labels at the beginning as well, to see if this approach makes the graph easier to read. Another idea that occurred to me is to include the country names both at the beginning, next to the y-axis, and at the end.
In this attempt, I will also add the logos to simulate a finalized graph.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#First I am going to charge the logos</span></span>
<span><span class='va'>logo3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='st'>"C:/Users/jorge/Desktop/CSS/Data-Visualization/Cocaine in Europe - Datavis/tur.png"</span><span class='op'>)</span></span>
<span><span class='va'>logo3_grob</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grid/grid.raster.html'>rasterGrob</a></span><span class='op'>(</span><span class='va'>logo3</span>, interpolate <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span><span class='va'>logo4</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='st'>"C:/Users/jorge/Desktop/CSS/Data-Visualization/Cocaine in Europe - Datavis/tur1.png"</span><span class='op'>)</span></span>
<span><span class='va'>logo4_grob</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grid/grid.raster.html'>rasterGrob</a></span><span class='op'>(</span><span class='va'>logo4</span>, interpolate <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span><span class='va'>logo5</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='st'>"C:/Users/jorge/Desktop/CSS/Data-Visualization/Cocaine in Europe - Datavis/ray.png"</span><span class='op'>)</span></span>
<span><span class='va'>logo5_grob</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grid/grid.raster.html'>rasterGrob</a></span><span class='op'>(</span><span class='va'>logo5</span>, interpolate <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>grid</span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://patchwork.data-imaginist.com'>patchwork</a></span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Updating the country name "Estados Unidos" to "EEUU" for better fit on the plot</span></span>
<span><span class='va'>data_countries</span> <span class='op'>&lt;-</span> <span class='va'>data_countries</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>etiqueta <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>País</span> <span class='op'>==</span> <span class='st'>"Estados Unidos"</span>, <span class='st'>"EEUU"</span>, <span class='va'>País</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#Plot:</span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>data_countries</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Año</span>, </span>
<span>      y <span class='op'>=</span> <span class='va'>`Porcentaje de consumo`</span>, </span>
<span>      color <span class='op'>=</span> <span class='va'>País</span><span class='op'>)</span> <span class='op'>+</span>  <span class='co'>#Plot by country</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>linewidth <span class='op'>=</span> <span class='fl'>0.75</span><span class='op'>)</span> <span class='op'>+</span>  <span class='co'># Increase the line width</span></span>
<span>  <span class='co'># Labels at the beginning of the line (first year)</span></span>
<span>  <span class='fu'>ggrepel</span><span class='fu'>::</span><span class='fu'><a href='https://ggrepel.slowkow.com/reference/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>data_countries</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>País</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Año</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>Año</span><span class='op'>)</span><span class='op'>)</span>,  <span class='co'># Filter data for labels at the start</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>etiqueta</span><span class='op'>)</span>, </span>
<span>    size <span class='op'>=</span> <span class='fl'>3.5</span>,</span>
<span>    direction <span class='op'>=</span> <span class='st'>"y"</span>,  <span class='co'>#Adjust direction to avoid overlap</span></span>
<span>    nudge_x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1.9</span>,   <span class='co'>#Move labels to the left</span></span>
<span>    segment.color <span class='op'>=</span> <span class='st'>"grey70"</span>,  <span class='co'>#Line color connecting the labels</span></span>
<span>    segment.size <span class='op'>=</span> <span class='fl'>0.3</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'>ggrepel</span><span class='fu'>::</span><span class='fu'><a href='https://ggrepel.slowkow.com/reference/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>data_countries</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>País</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Año</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>Año</span><span class='op'>)</span><span class='op'>)</span>,  <span class='co'>#Filter only the last year</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>etiqueta</span><span class='op'>)</span>, </span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>3.5</span>,</span>
<span>    direction <span class='op'>=</span> <span class='st'>"y"</span>,  <span class='co'>#Adjust direction to avoid overlap</span></span>
<span>    nudge_x <span class='op'>=</span> <span class='fl'>1.5</span>,      <span class='co'>#Move labels to the right</span></span>
<span>    segment.color <span class='op'>=</span> <span class='st'>"grey70"</span>,  <span class='co'>#  Add lines connecting the labels to the points</span></span>
<span>    segment.size <span class='op'>=</span> <span class='fl'>0.3</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span></span>
<span>    breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1988</span>, <span class='fl'>1998</span>, <span class='fl'>2008</span>, <span class='fl'>2018</span><span class='op'>)</span>,  <span class='co'>#Set breaks at specific years</span></span>
<span>    labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"1988"</span>, <span class='st'>"1998"</span>, <span class='st'>"2008"</span>, <span class='st'>"2018"</span><span class='op'>)</span>  <span class='co'>#Labels for the years</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>1</span>, <span class='fl'>1.5</span>, <span class='fl'>2</span>, <span class='fl'>2.5</span>, <span class='fl'>3</span>, <span class='fl'>3.5</span>, <span class='fl'>4</span><span class='op'>)</span>,</span>
<span>                     labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>1</span>, <span class='fl'>1.5</span>, <span class='fl'>2</span>, <span class='fl'>2.5</span>, <span class='fl'>3</span>, <span class='fl'>3.5</span>, <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/expand_limits.html'>expand_limits</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>2022</span>, y <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Evolución del Consumo de Cocaína"</span>,</span>
<span>       subtitle <span class='op'>=</span> <span class='st'>"Porcentaje adultos consumidores"</span>,</span>
<span>       caption <span class='op'>=</span> <span class='st'>"*¡Los datos han sido generados de forma aleatoria!*"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span>,</span>
<span>        axis.title.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>14</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span><span class='op'>)</span>,  <span class='co'># Set the x-axis title size</span></span>
<span>        axis.title.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>14</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span><span class='op'>)</span>,</span>
<span>        axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>12</span>, face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>,</span>
<span>        plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0</span>, vjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>27</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span><span class='op'>)</span>,</span>
<span>        plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0</span>, vjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>24</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span>, colour <span class='op'>=</span> <span class='st'>"#4D5154"</span><span class='op'>)</span>,</span>
<span>        plot.caption <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>9</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span><span class='op'>)</span>,</span>
<span>        plot.margin <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'>#Adding logos to the plot</span></span>
<span>  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/inset_element.html'>inset_element</a></span><span class='op'>(</span></span>
<span>    <span class='va'>logo3_grob</span>,</span>
<span>    left <span class='op'>=</span> <span class='fl'>0.82</span>, bottom <span class='op'>=</span> <span class='fl'>1</span>, right <span class='op'>=</span> <span class='fl'>1.35</span>, top <span class='op'>=</span> <span class='fl'>1.25</span>,  <span class='co'>#Position at the upper right</span></span>
<span>    align_to <span class='op'>=</span> <span class='st'>"panel"</span>,</span>
<span>    on_top <span class='op'>=</span> <span class='cn'>TRUE</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/inset_element.html'>inset_element</a></span><span class='op'>(</span></span>
<span>    <span class='va'>logo4_grob</span>,</span>
<span>    left <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.16</span>, bottom <span class='op'>=</span> <span class='fl'>1</span>, right <span class='op'>=</span> <span class='fl'>0</span>, top <span class='op'>=</span> <span class='fl'>1.25</span>, <span class='co'>#Position at the upper-left</span></span>
<span>    align_to <span class='op'>=</span> <span class='st'>"panel"</span>,</span>
<span>    on_top <span class='op'>=</span> <span class='cn'>TRUE</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/inset_element.html'>inset_element</a></span><span class='op'>(</span></span>
<span>    <span class='va'>logo5_grob</span>,</span>
<span>    left <span class='op'>=</span> <span class='fl'>0.79</span>, bottom <span class='op'>=</span> <span class='fl'>1</span>, right <span class='op'>=</span> <span class='fl'>0.95</span>, top <span class='op'>=</span> <span class='fl'>1.25</span>, <span class='co'>#Another position at the upper-right</span></span>
<span>    align_to <span class='op'>=</span> <span class='st'>"panel"</span>,</span>
<span>    on_top <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="100541120_files/figure-html5/unnamed-chunk-13-1.png" width="816" /></p>
</div>
<p>In this way, the evolution of consumption can be followed much more clearly, although the presence of 13 countries still makes the graph somewhat difficult to read, as there are many lines crossing each other.</p>
<p>Next, I will attempt the same representation as before but grouping the countries based on their status values: producers, consumers, and transition countries.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>ggstream</span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/wch/extrafont'>extrafont</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggrepel.slowkow.com/'>ggrepel</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://scales.r-lib.org'>scales</a></span><span class='op'>)</span>  </span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggrepel.slowkow.com/'>ggrepel</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='co'>#Colors for each status (Producer, Consumer, Transition)</span></span>
<span><span class='va'>color_palette</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>  <span class='st'>"Productor"</span> <span class='op'>=</span> <span class='st'>"#0072B2"</span>,  <span class='co'>#Strong blue for Producer</span></span>
<span>  <span class='st'>"Consumidor"</span> <span class='op'>=</span> <span class='st'>"#D55E00"</span>,  <span class='co'>#Strong red for Consumer</span></span>
<span>  <span class='st'>"Transición"</span> <span class='op'>=</span> <span class='st'>"#009E73"</span>   <span class='co'>#Bright green for Transition</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>data_countries</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Año</span>, </span>
<span>      y <span class='op'>=</span> <span class='va'>`Porcentaje de consumo`</span>, </span>
<span>      group <span class='op'>=</span> <span class='va'>País</span>, </span>
<span>      color <span class='op'>=</span> <span class='va'>estatus</span><span class='op'>)</span> <span class='op'>+</span>  <span class='co'># Use 'estatus' for coloring based on category</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>linewidth <span class='op'>=</span> <span class='fl'>0.75</span><span class='op'>)</span> <span class='op'>+</span>  <span class='co'>#Lines for each country</span></span>
<span>  <span class='co'>#Labels at the start of the line (first year)</span></span>
<span>  <span class='fu'>ggrepel</span><span class='fu'>::</span><span class='fu'><a href='https://ggrepel.slowkow.com/reference/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>data_countries</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>País</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Año</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>Año</span><span class='op'>)</span><span class='op'>)</span>,  <span class='co'>#Filter data for labels at the start</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>etiqueta</span><span class='op'>)</span>, </span>
<span>    size <span class='op'>=</span> <span class='fl'>3.5</span>,</span>
<span>    direction <span class='op'>=</span> <span class='st'>"y"</span>,  <span class='co'>#Adjust direction to avoid overlap</span></span>
<span>    nudge_x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1.9</span>,   <span class='co'>#ove labels to the left</span></span>
<span>    segment.color <span class='op'>=</span> <span class='st'>"grey70"</span>,  <span class='co'># Line color connecting the labels</span></span>
<span>    segment.size <span class='op'>=</span> <span class='fl'>0.3</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Labels at the end of the line (last year)</span></span>
<span>  <span class='fu'>ggrepel</span><span class='fu'>::</span><span class='fu'><a href='https://ggrepel.slowkow.com/reference/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>data_countries</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>País</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Año</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>Año</span><span class='op'>)</span><span class='op'>)</span>,  <span class='co'>#Filter only the last year</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>etiqueta</span><span class='op'>)</span>, </span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>3.5</span>,</span>
<span>    direction <span class='op'>=</span> <span class='st'>"y"</span>,  <span class='co'># Adjust direction to avoid overlap</span></span>
<span>    nudge_x <span class='op'>=</span> <span class='fl'>1.5</span>,    <span class='co'>#Move labels to the right</span></span>
<span>    segment.color <span class='op'>=</span> <span class='st'>"grey70"</span>,  <span class='co'>#Add lines connecting the labels to the points</span></span>
<span>    segment.size <span class='op'>=</span> <span class='fl'>0.3</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span></span>
<span>    breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1988</span>, <span class='fl'>1998</span>, <span class='fl'>2008</span>, <span class='fl'>2018</span><span class='op'>)</span>,</span>
<span>    labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"1988"</span>, <span class='st'>"1998"</span>, <span class='st'>"2008"</span>, <span class='st'>"2018"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>4</span>, <span class='fl'>0.5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/expand_limits.html'>expand_limits</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>2022</span>, y <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span></span>
<span>    title <span class='op'>=</span> <span class='st'>"Evolución del Consumo de Cocaína"</span>,</span>
<span>    subtitle <span class='op'>=</span> <span class='st'>"Porcentaje de adultos consumidores"</span>,</span>
<span>    caption <span class='op'>=</span> <span class='st'>"*¡Los datos han sido generados de forma aleatoria!*"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"ESTATUS"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_color_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>color_palette</span><span class='op'>)</span> <span class='op'>+</span>  <span class='co'>#assign colors</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.85</span>, <span class='fl'>0.85</span><span class='op'>)</span>,  <span class='co'># Legend position within the plot (relative coordinates)</span></span>
<span>    legend.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span>,  <span class='co'># Size of the legend title</span></span>
<span>    legend.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>,  <span class='co'># Size of the legend text</span></span>
<span>    axis.title.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>14</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span><span class='op'>)</span>,</span>
<span>    axis.title.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>14</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span><span class='op'>)</span>,</span>
<span>    axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>12</span>, face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>,  <span class='co'># Y-axis values in bold and size 12</span></span>
<span>    plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0</span>, vjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>27</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span><span class='op'>)</span>,</span>
<span>    plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0</span>, vjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>24</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span>, colour <span class='op'>=</span> <span class='st'>"#4D5154"</span><span class='op'>)</span>,</span>
<span>    plot.caption <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>9</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span><span class='op'>)</span>,</span>
<span>    plot.margin <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>, <span class='st'>"cm"</span><span class='op'>)</span>  <span class='co'># Add margins (top, right, bottom, left)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Adding logos to the plot</span></span>
<span><span class='fu'><a href='https://patchwork.data-imaginist.com/reference/inset_element.html'>inset_element</a></span><span class='op'>(</span></span>
<span>    <span class='va'>logo3_grob</span>,</span>
<span>    left <span class='op'>=</span> <span class='fl'>0.82</span>, bottom <span class='op'>=</span> <span class='fl'>1</span>, right <span class='op'>=</span> <span class='fl'>1.35</span>, top <span class='op'>=</span> <span class='fl'>1.25</span>,  <span class='co'>#Position at the upper right</span></span>
<span>    align_to <span class='op'>=</span> <span class='st'>"panel"</span>,</span>
<span>    on_top <span class='op'>=</span> <span class='cn'>TRUE</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/inset_element.html'>inset_element</a></span><span class='op'>(</span></span>
<span>    <span class='va'>logo4_grob</span>,</span>
<span>    left <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.16</span>, bottom <span class='op'>=</span> <span class='fl'>1</span>, right <span class='op'>=</span> <span class='fl'>0</span>, top <span class='op'>=</span> <span class='fl'>1.25</span>, <span class='co'>#Position at the upper-left</span></span>
<span>    align_to <span class='op'>=</span> <span class='st'>"panel"</span>,</span>
<span>    on_top <span class='op'>=</span> <span class='cn'>TRUE</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/inset_element.html'>inset_element</a></span><span class='op'>(</span></span>
<span>    <span class='va'>logo5_grob</span>,</span>
<span>    left <span class='op'>=</span> <span class='fl'>0.79</span>, bottom <span class='op'>=</span> <span class='fl'>1</span>, right <span class='op'>=</span> <span class='fl'>0.95</span>, top <span class='op'>=</span> <span class='fl'>1.25</span>, <span class='co'>#Another position at the upper-right</span></span>
<span>    align_to <span class='op'>=</span> <span class='st'>"panel"</span>,</span>
<span>    on_top <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="100541120_files/figure-html5/unnamed-chunk-14-1.png" width="816" /></p>
</div>
<p>Regarding this graph, although I have represented the information I initially wanted, I believe that reducing 13 countries to 3 colors still hinders clear readability.</p>
<p>Therefore, a solution to the problem could be to create 3 separate graphs using facet wrap, as this would help avoid having too many countries in a single grid.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggrepel.slowkow.com/'>ggrepel</a></span><span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='co'># Crear el gráfico con facet_wrap y colores según estatus</span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>data_countries</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Año</span>, </span>
<span>      y <span class='op'>=</span> <span class='va'>`Porcentaje de consumo`</span>, </span>
<span>      group <span class='op'>=</span> <span class='va'>País</span>,</span>
<span>      color <span class='op'>=</span> <span class='va'>estatus</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>linewidth <span class='op'>=</span> <span class='fl'>0.75</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'>ggrepel</span><span class='fu'>::</span><span class='fu'><a href='https://ggrepel.slowkow.com/reference/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>data_countries</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>País</span>, <span class='va'>estatus</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Año</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>Año</span><span class='op'>)</span><span class='op'>)</span>,  </span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>País</span><span class='op'>)</span>, </span>
<span>    size <span class='op'>=</span> <span class='fl'>3.5</span>,</span>
<span>    nudge_x <span class='op'>=</span> <span class='fl'>1.5</span>,  </span>
<span>    segment.color <span class='op'>=</span> <span class='st'>"grey70"</span>,</span>
<span>    segment.size <span class='op'>=</span> <span class='fl'>0.3</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span></span>
<span>    breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1988</span>, <span class='fl'>1998</span>, <span class='fl'>2008</span>, <span class='fl'>2018</span><span class='op'>)</span>,</span>
<span>    labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"1988"</span>, <span class='st'>"1998"</span>, <span class='st'>"2008"</span>, <span class='st'>"2018"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span></span>
<span>    breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>4</span>, <span class='fl'>0.5</span><span class='op'>)</span>,</span>
<span>    labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>4</span>, <span class='fl'>0.5</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_color_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>color_palette</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/expand_limits.html'>expand_limits</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>2022</span>, y <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>facet_wrap</a></span><span class='op'>(</span><span class='op'>~</span><span class='va'>estatus</span>, ncol <span class='op'>=</span> <span class='fl'>1</span>, scales <span class='op'>=</span> <span class='st'>"free_y"</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    legend.position <span class='op'>=</span> <span class='st'>"none"</span>,  </span>
<span>    axis.title.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>14</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span><span class='op'>)</span>,</span>
<span>    axis.title.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>14</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span><span class='op'>)</span>,</span>
<span>    plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0</span>, vjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>27</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span><span class='op'>)</span>,</span>
<span>    plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0</span>, vjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>24</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span>, colour <span class='op'>=</span> <span class='st'>"#4D5154"</span><span class='op'>)</span>,</span>
<span>    plot.caption <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>9</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span><span class='op'>)</span>,</span>
<span>    strip.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>15</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span>, face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>,</span>
<span>    plot.margin <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>, <span class='st'>"cm"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
<p><img src="100541120_files/figure-html5/unnamed-chunk-15-1.png" width="816" /></p>
</div>
<p>Since the Consumer category contains the most countries, this could make the graph less readable. To address this issue, I will split this category into two: European Consumers and Non-European Consumers. This way, the data will be more organized and easier to interpret, ensuring clearer visibility for each group.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggrepel.slowkow.com/'>ggrepel</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#First, odify the data:</span></span>
<span><span class='va'>data_countries</span> <span class='op'>&lt;-</span> <span class='va'>data_countries</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>estatus_modificado <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>    <span class='va'>estatus</span> <span class='op'>==</span> <span class='st'>"Consumidor"</span> <span class='op'>&amp;</span> <span class='va'>País</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Reino Unido"</span>, <span class='st'>"Irlanda"</span>, <span class='st'>"Polonia"</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"Consumidores Europeos"</span>,</span>
<span>    <span class='va'>estatus</span> <span class='op'>==</span> <span class='st'>"Consumidor"</span> <span class='op'>&amp;</span> <span class='va'>País</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Estados Unidos"</span>, <span class='st'>"Australia"</span>, <span class='st'>"Canadá"</span>, <span class='st'>"Chile"</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"Consumidores No Europeos"</span>,</span>
<span>    <span class='va'>estatus</span> <span class='op'>==</span> <span class='st'>"Productor"</span> <span class='op'>~</span> <span class='st'>"Países Productores"</span>,</span>
<span>    <span class='va'>estatus</span> <span class='op'>==</span> <span class='st'>"Transición"</span> <span class='op'>~</span> <span class='st'>"Países Transitorios"</span>,</span>
<span>    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='va'>estatus</span>  </span>
<span>  <span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#Colors for each estatus:</span></span>
<span><span class='va'>color_palette</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>  <span class='st'>"Países Productores"</span> <span class='op'>=</span> <span class='st'>"#0072B2"</span>,       </span>
<span>  <span class='st'>"Países Transitorios"</span> <span class='op'>=</span> <span class='st'>"#009E73"</span>,      </span>
<span>  <span class='st'>"Consumidores Europeos"</span> <span class='op'>=</span> <span class='st'>"#D55E00"</span>,  </span>
<span>  <span class='st'>"Consumidores No Europeos"</span> <span class='op'>=</span> <span class='st'>"#CC79A7"</span>   </span>
<span><span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='co'>#PLOT</span></span>
<span><span class='va'>grafico_facet</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>data_countries</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Año</span>, </span>
<span>      y <span class='op'>=</span> <span class='va'>`Porcentaje de consumo`</span>, </span>
<span>      group <span class='op'>=</span> <span class='va'>País</span>,</span>
<span>      color <span class='op'>=</span> <span class='va'>estatus_modificado</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>linewidth <span class='op'>=</span> <span class='fl'>0.75</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>    <span class='fu'>ggrepel</span><span class='fu'>::</span><span class='fu'><a href='https://ggrepel.slowkow.com/reference/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>data_countries</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>País</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Año</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>Año</span><span class='op'>)</span><span class='op'>)</span>,  </span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>etiqueta</span><span class='op'>)</span>, </span>
<span>    size <span class='op'>=</span> <span class='fl'>3.5</span>,</span>
<span>    direction <span class='op'>=</span> <span class='st'>"y"</span>,  </span>
<span>    nudge_x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>2.1</span>,   </span>
<span>    segment.color <span class='op'>=</span> <span class='st'>"grey70"</span>,  </span>
<span>    segment.size <span class='op'>=</span> <span class='fl'>0.3</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span> <span class='co'># Líneas de los países</span></span>
<span>  <span class='fu'>ggrepel</span><span class='fu'>::</span><span class='fu'><a href='https://ggrepel.slowkow.com/reference/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>data_countries</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>País</span>, <span class='va'>estatus_modificado</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Año</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>Año</span><span class='op'>)</span><span class='op'>)</span>,  </span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>etiqueta</span><span class='op'>)</span>, </span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>3.5</span>,</span>
<span>    direction <span class='op'>=</span> <span class='st'>"y"</span>,  </span>
<span>    nudge_x <span class='op'>=</span> <span class='fl'>0.7</span>,      </span>
<span>    segment.color <span class='op'>=</span> <span class='st'>"grey70"</span>,  </span>
<span>    segment.size <span class='op'>=</span> <span class='fl'>0.3</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span></span>
<span>    breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1988</span>, <span class='fl'>1998</span>, <span class='fl'>2008</span>, <span class='fl'>2018</span><span class='op'>)</span>,</span>
<span>    labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"1988"</span>, <span class='st'>"1998"</span>, <span class='st'>"2008"</span>, <span class='st'>"2018"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span></span>
<span>    breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>4</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span>    labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>4</span>, <span class='fl'>1</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_color_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>color_palette</span><span class='op'>)</span> <span class='op'>+</span>  <span class='co'># Assign colors by estatus modificado</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/expand_limits.html'>expand_limits</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>2022</span>, y <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>facet_wrap</a></span><span class='op'>(</span><span class='op'>~</span><span class='va'>estatus_modificado</span>, ncol <span class='op'>=</span> <span class='fl'>1</span>, scales <span class='op'>=</span> <span class='st'>"free_y"</span><span class='op'>)</span> <span class='op'>+</span>  <span class='co'>#New panel for estatus modificado</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span></span>
<span>    title <span class='op'>=</span> <span class='st'>"Evolución del Consumo de Cocaína"</span>,</span>
<span>    subtitle <span class='op'>=</span> <span class='st'>"Porcentaje de adultos consumidores según el estatus"</span>,</span>
<span>    caption <span class='op'>=</span> <span class='st'>"*¡Los datos han sido generados de forma aleatoria!*"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    legend.position <span class='op'>=</span> <span class='st'>"none"</span>,  </span>
<span>    axis.title.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>14</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span><span class='op'>)</span>,</span>
<span>    axis.title.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>14</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span><span class='op'>)</span>,</span>
<span>    plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0</span>, vjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>27</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span><span class='op'>)</span>,</span>
<span>    plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0</span>, vjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>24</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span>, colour <span class='op'>=</span> <span class='st'>"#4D5154"</span><span class='op'>)</span>,</span>
<span>    plot.caption <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>9</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span><span class='op'>)</span>,</span>
<span>    strip.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>15</span>, family <span class='op'>=</span> <span class='st'>"mulish"</span>, face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>,  </span>
<span>    plot.margin <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>, <span class='st'>"cm"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span><span class='fu'><a href='https://patchwork.data-imaginist.com/reference/inset_element.html'>inset_element</a></span><span class='op'>(</span></span>
<span>    <span class='va'>logo3_grob</span>,</span>
<span>    left <span class='op'>=</span> <span class='fl'>0.82</span>, bottom <span class='op'>=</span> <span class='fl'>1</span>, right <span class='op'>=</span> <span class='fl'>1.35</span>, top <span class='op'>=</span> <span class='fl'>1.25</span>,  <span class='co'>#Position at the upper right</span></span>
<span>    align_to <span class='op'>=</span> <span class='st'>"panel"</span>,</span>
<span>    on_top <span class='op'>=</span> <span class='cn'>TRUE</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/inset_element.html'>inset_element</a></span><span class='op'>(</span></span>
<span>    <span class='va'>logo4_grob</span>,</span>
<span>    left <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.16</span>, bottom <span class='op'>=</span> <span class='fl'>1</span>, right <span class='op'>=</span> <span class='fl'>0</span>, top <span class='op'>=</span> <span class='fl'>1.25</span>, <span class='co'>#Position at the upper-left</span></span>
<span>    align_to <span class='op'>=</span> <span class='st'>"panel"</span>,</span>
<span>    on_top <span class='op'>=</span> <span class='cn'>TRUE</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/inset_element.html'>inset_element</a></span><span class='op'>(</span></span>
<span>    <span class='va'>logo5_grob</span>,</span>
<span>    left <span class='op'>=</span> <span class='fl'>0.79</span>, bottom <span class='op'>=</span> <span class='fl'>1</span>, right <span class='op'>=</span> <span class='fl'>0.95</span>, top <span class='op'>=</span> <span class='fl'>1.25</span>, <span class='co'>#Another position at the upper-right</span></span>
<span>    align_to <span class='op'>=</span> <span class='st'>"panel"</span>,</span>
<span>    on_top <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='va'>grafico_facet</span>    <span class='co'>#intentaria marcar los años en todos</span></span></code></pre>
</div>
<p><img src="100541120_files/figure-html5/unnamed-chunk-16-1.png" width="816" /></p>
</div>
<p>I believe this graph is much more readable and makes it easier to compare the patterns across the different categories. By separating the countries into smaller, more focused groups, the data becomes less cluttered and more accessible, allowing for clearer insights.</p>
<p>To conclude, I would like to reflect on the graphs I have created. From my point of view, if I could only choose one, my choice would be the second graph, as I believe it is the most aesthetically pleasing. Its design stands out and conveys the intended message effectively.</p>
<p>However, I also recognize that this graph may be challenging to read, as it requires focus to follow the progression of the lines accurately. This could make it less accessible for some viewers, especially when attempting to interpret complex patterns quickly.</p>
<p>On the other hand, the final graph allows for a clearer comparison of countries within the same category. It simplifies the visualization by grouping similar nations, making trends within each group more evident. However, comparing countries across different categories becomes more challenging with this layout. This trade-off highlights the difficulty of balancing clarity and comparability in visualizations, as the ideal choice often depends on the specific context and the audience’s needs.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
