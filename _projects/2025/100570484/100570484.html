<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>Changing Fortunes</title>

  <meta property="description" itemprop="description" content="Financial Times Graph Replication"/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2026-01-13"/>
  <meta property="article:created" itemprop="dateCreated" content="2026-01-13"/>
  <meta name="article:author" content="Tommaso Accornero"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Changing Fortunes"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Financial Times Graph Replication"/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Changing Fortunes"/>
  <meta property="twitter:description" content="Financial Times Graph Replication"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","categories","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["Changing Fortunes"]},{"type":"character","attributes":{},"value":["Financial Times Graph Replication"]},{"type":"character","attributes":{},"value":["2025"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Tommaso Accornero"]}]}]},{"type":"character","attributes":{},"value":["2026-01-13"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["100570484_files/anchor-4.2.2/anchor.min.js","100570484_files/bowser-1.9.3/bowser.min.js","100570484_files/distill-2.2.21/template.v2.js","100570484_files/figure-html5/create slope chart-1.png","100570484_files/figure-html5/map-1.png","100570484_files/figure-html5/plot improvement-1.png","100570484_files/figure-html5/plot-1.png","100570484_files/figure-html5/plot2-1.png","100570484_files/figure-html5/setup1-1.png","100570484_files/figure-html5/slope-1.png","100570484_files/figure-html5/Text Box-1.png","100570484_files/figure-html5/US map-1.png","100570484_files/header-attrs-2.29/header-attrs.js","100570484_files/jquery-3.6.0/jquery-3.6.0.js","100570484_files/jquery-3.6.0/jquery-3.6.0.min.js","100570484_files/jquery-3.6.0/jquery-3.6.0.min.map","100570484_files/popper-2.6.0/popper.min.js","100570484_files/tippy-6.2.7/tippy-bundle.umd.min.js","100570484_files/tippy-6.2.7/tippy-light-border.css","100570484_files/tippy-6.2.7/tippy.css","100570484_files/tippy-6.2.7/tippy.umd.min.js","100570484_files/webcomponents-2.0.0/webcomponents.js","Changing fortunes.jpg","Clean_Median_Data.csv","geocoded_data.csv","middle_class_sheets.xlsx"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  hr.section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    margin: 0px;
  }


  d-byline {
    border-top: none;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
    border-top: none;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  /* tweak for Pandoc numbered line within distill */
  d-article pre.numberSource code > span {
      left: -2em;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // separator
    var separator = '<hr class="section-separator" style="clear: both"/>';
    // prepend separator above appendix
    $('.d-byline').before(separator);
    $('.d-article').before(separator);

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme, except when numbering line
    // in code chunk
    $('pre:not(.numberLines) code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        var author_name = front_matter.authors[i].author
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="100570484_files/header-attrs-2.29/header-attrs.js"></script>
  <script src="100570484_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="100570484_files/popper-2.6.0/popper.min.js"></script>
  <link href="100570484_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="100570484_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="100570484_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="100570484_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="100570484_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="100570484_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="100570484_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Changing Fortunes","description":"Financial Times Graph Replication","authors":[{"author":"Tommaso Accornero","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2026-01-13T00:00:00.000+01:00","citationText":"Accornero, 2026"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Changing Fortunes</h1>

<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt-tag">2025</div>
</div>
<!--/radix_placeholder_categories-->
<p>Financial Times Graph Replication</p>
</div>

<div class="d-byline">
  
  Tommaso Accornero
  
<br/>2026-01-13
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#introduction" id="toc-introduction">Introduction</a></li>
<li><a href="#the-original-graph---explained" id="toc-the-original-graph---explained">The Original Graph - Explained</a></li>
<li><a href="#replication" id="toc-replication">Replication</a>
<ul>
<li><a href="#loading-libraries-fonts-and-data" id="toc-loading-libraries-fonts-and-data">Loading Libraries, Fonts and Data</a></li>
<li><a href="#data-preparation" id="toc-data-preparation">Data Preparation</a></li>
<li><a href="#create-the-main-slope-chart" id="toc-create-the-main-slope-chart">Create The Main Slope Chart</a></li>
<li><a href="#load-and-fix-geocoded-data-for-map" id="toc-load-and-fix-geocoded-data-for-map">Load and Fix Geocoded Data For Map</a></li>
<li><a href="#us-map" id="toc-us-map">US map</a></li>
<li><a href="#text-box" id="toc-text-box">Text Box</a></li>
<li><a href="#final-plot-and-arrows" id="toc-final-plot-and-arrows">Final Plot (and Arrows)</a></li>
</ul></li>
<li><a href="#limitations" id="toc-limitations">Limitations</a></li>
<li><a href="#alternative-visualization" id="toc-alternative-visualization">Alternative Visualization</a>
<ul>
<li><a href="#load-and-prepare-the-data" id="toc-load-and-prepare-the-data">Load and Prepare the Data</a></li>
<li><a href="#key-data-points" id="toc-key-data-points">Key Data Points</a></li>
<li><a href="#the-plot" id="toc-the-plot">The Plot</a></li>
</ul></li>
<li><a href="#conclusions" id="toc-conclusions">Conclusions</a></li>
</ul>
</nav>
</div>
<h2 id="introduction">Introduction</h2>
<p>In this project, I will walk you through all the necessary steps to replicate and eventually improve a graph, trying to think of different ways to visualize data.</p>
<p>This project is linked to our course on Data Visualization as part of our Computational Social Science master at Carlos III de Madrid. We were asked to choose a challenging graph to replicate. Therefore, I have chosen to replicate a graph from the Financial Times called “Changing Fortunes”, while the data is from the Pew Research Center, a nonpartisan fact tank that informs the public about the issues, attitudes and trends shaping the world.</p>
<p>The reason why I chose this graph is because in the recent years there has been more and more talk regarding a sharp increase in inequality, a decrease in affordability, and a shrinkage of the so-called “middle class” and this, however, is not a recent issue. The data and the graph give us information about a sharp decrease on average median household income in the Unites States of America from 1999 to 2014.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Changing%20fortunes.jpg" width="100%" style="display: block; margin: auto;" /></p>
</div>
<p style="font-size: 12px; color: gray; margin-top: -10px;">
Original graph. Figure from <a href="https://www.ft.com/content/a8e9f23c-1695-11e6-9d98-00386a18e39d#axzz48U6PcY6s" target="_blank">Financial Times</a>
</p>
<h2 id="the-original-graph---explained">The Original Graph - Explained</h2>
<p>The original graph showcases on the left hand side a classic Slope Chart where I have the difference in average median household income in thousands of US dollars for the main metropolitan areas in the USA. Highlighted I have in blue lines the biggest 10 risers (the metropolitan areas that saw their median income increase the most), in red lines the biggest 10 fallers (the metropolitan areas that saw their median income decrease the most), and in a grey line Raleigh, NC which is highlighted because it was named in the main article of the Financial Times, and it was the main protagonist of this story that they were trying to tell.</p>
<p>On the top right hand corner, I have a map of the USA where I have all the metropolitan areas and their geographical location and in the same colors of the slope I also have the biggest 10 risers, 10 biggest fallers, and Raleigh, NC. The biggest “Winner”, biggest “Loser” and “Raleigh, NC” are also specified by an arrow that start from the slope chart and point at their location.</p>
<p>I also have an informative text box on the right side and a legend at the bottom left corner.</p>
<h2 id="replication">Replication</h2>
<h3 id="loading-libraries-fonts-and-data">Loading Libraries, Fonts and Data</h3>
<p>The following libraries are used for the graph replication and the graph improvement.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggrepel.slowkow.com/'>ggrepel</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/adeckmyn/maps'>maps</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://r-spatial.github.io/sf/'>sf</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://usmap.dev'>usmap</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://jessecambon.github.io/tidygeocoder/'>tidygeocoder</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://wilkelab.org/ggtext/'>ggtext</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://wilkelab.org/cowplot/'>cowplot</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://allancameron.github.io/geomtextpath/'>geomtextpath</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/yixuan/sysfonts'>sysfonts</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/yixuan/showtext'>showtext</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://readxl.tidyverse.org'>readxl</a></span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Here I have the font that I are going to use. One first limitation in our reproduction is that the Financial Times uses a font called “Financier” that is not open source.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># LOAD CUSTOM FONT</span></span>
<span><span class='fu'>sysfonts</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/sysfonts/man/font_add_google.html'>font_add_google</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"Open Sans"</span>, family <span class='op'>=</span> <span class='st'>"open-sans"</span><span class='op'>)</span></span>
<span><span class='fu'>showtext</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/showtext/man/showtext_auto.html'>showtext_auto</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='fu'>showtext</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/showtext/man/showtext_opts.html'>showtext_opts</a></span><span class='op'>(</span>dpi <span class='op'>=</span> <span class='fl'>300</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Here is the data in the form of a .csv file that was kindly given to me by the people at the Pew Research Center.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># READ AND PREPARE THE DATA</span></span>
<span><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv2</a></span><span class='op'>(</span><span class='st'>"Clean_Median_Data.csv"</span>, sep <span class='op'>=</span> <span class='st'>";"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 id="data-preparation">Data Preparation</h3>
<p>In this section, I prepared the data for visualization by converting income values to numeric format and calculating both absolute and percentage changes in median household income between 1999 and 2014.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='va'>data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    Median_1999 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>Median_1999</span><span class='op'>)</span>,</span>
<span>    Median_2014 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>Median_2014</span><span class='op'>)</span>,</span>
<span>    change <span class='op'>=</span> <span class='va'>Median_2014</span> <span class='op'>-</span> <span class='va'>Median_1999</span>,</span>
<span>    pct_change <span class='op'>=</span> <span class='op'>(</span><span class='op'>(</span><span class='va'>Median_2014</span> <span class='op'>-</span> <span class='va'>Median_1999</span><span class='op'>)</span> <span class='op'>/</span> <span class='va'>Median_1999</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>100</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Then, I identified the top 10 metropolitan areas with the highest increase and decrease in median income, as well as highlighted Raleigh, NC.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Identify top 10 risers and fallers</span></span>
<span><span class='va'>top_risers</span> <span class='op'>&lt;-</span> <span class='va'>data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>pct_change</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>top_fallers</span> <span class='op'>&lt;-</span> <span class='va'>data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>pct_change</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>raleigh</span> <span class='op'>&lt;-</span> <span class='va'>data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>X</span> <span class='op'>==</span> <span class='st'>"Raleigh, NC"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Here, I categorized each metropolitan area according to their status of riser, faller, Raleigh, and other. Then I applied pivot_longer so that I could create the slope charts that show income trends over time without any potential issues.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Add category column</span></span>
<span><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='va'>data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>category <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>    <span class='va'>X</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>top_risers</span> <span class='op'>~</span> <span class='st'>"riser"</span>,</span>
<span>    <span class='va'>X</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>top_fallers</span> <span class='op'>~</span> <span class='st'>"faller"</span>,</span>
<span>    <span class='va'>X</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>raleigh</span> <span class='op'>~</span> <span class='st'>"Raleigh"</span>,</span>
<span>    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='st'>"other"</span></span>
<span>  <span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Prepare data for plotting (long format)</span></span>
<span><span class='va'>plot_data</span> <span class='op'>&lt;-</span> <span class='va'>data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>Median_1999</span>, <span class='va'>Median_2014</span>, <span class='va'>category</span>, <span class='va'>pct_change</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span>cols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>Median_1999</span>, <span class='va'>Median_2014</span><span class='op'>)</span>,</span>
<span>               names_to <span class='op'>=</span> <span class='st'>"year"</span>,</span>
<span>               values_to <span class='op'>=</span> <span class='st'>"income"</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>year_num <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>year</span> <span class='op'>==</span> <span class='st'>"Median_1999"</span>, <span class='fl'>1999</span>, <span class='fl'>2014</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 id="create-the-main-slope-chart">Create The Main Slope Chart</h3>
<p>Here is where I built the slope chart, which is the core visualization of this project. After some trial and error, I layered the the plot thinking about in which order to place the lines. First, the dotted lines that you can see in the original graph, signalling the various important median income whole numbers (50, 60, 70, 80, and 90). Then the actual slope lines. Firstly, the background lines for “other” metros, then overlaying highlighted lines and points for the biggest risers (blue), biggest fallers (red), and Raleigh (gray). Then, I had to manually position each label with the city names (21 in total), the axis annotations and the little legend in the top right corner of the slope chart, trying to somewhat replicate the Financial Times aesthetics.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>main_plot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>plot_data</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>year_num</span>, y <span class='op'>=</span> <span class='va'>income</span>, group <span class='op'>=</span> <span class='va'>X</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Manual dotted grid lines</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"segment"</span>, x <span class='op'>=</span> <span class='fl'>1999</span>, xend <span class='op'>=</span> <span class='fl'>2014</span>, y <span class='op'>=</span> <span class='fl'>50</span>, yend <span class='op'>=</span> <span class='fl'>50</span>,</span>
<span>           color <span class='op'>=</span> <span class='st'>"gray85"</span>, linetype <span class='op'>=</span> <span class='st'>"dotted"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"segment"</span>, x <span class='op'>=</span> <span class='fl'>1999</span>, xend <span class='op'>=</span> <span class='fl'>2014</span>, y <span class='op'>=</span> <span class='fl'>60</span>, yend <span class='op'>=</span> <span class='fl'>60</span>,</span>
<span>           color <span class='op'>=</span> <span class='st'>"gray85"</span>, linetype <span class='op'>=</span> <span class='st'>"dotted"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"segment"</span>, x <span class='op'>=</span> <span class='fl'>1999</span>, xend <span class='op'>=</span> <span class='fl'>2014</span>, y <span class='op'>=</span> <span class='fl'>70</span>, yend <span class='op'>=</span> <span class='fl'>70</span>,</span>
<span>           color <span class='op'>=</span> <span class='st'>"gray85"</span>, linetype <span class='op'>=</span> <span class='st'>"dotted"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"segment"</span>, x <span class='op'>=</span> <span class='fl'>1999</span>, xend <span class='op'>=</span> <span class='fl'>2014</span>, y <span class='op'>=</span> <span class='fl'>80</span>, yend <span class='op'>=</span> <span class='fl'>80</span>,</span>
<span>           color <span class='op'>=</span> <span class='st'>"gray85"</span>, linetype <span class='op'>=</span> <span class='st'>"dotted"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"segment"</span>, x <span class='op'>=</span> <span class='fl'>1999</span>, xend <span class='op'>=</span> <span class='fl'>2014</span>, y <span class='op'>=</span> <span class='fl'>90</span>, yend <span class='op'>=</span> <span class='fl'>90</span>,</span>
<span>           color <span class='op'>=</span> <span class='st'>"gray85"</span>, linetype <span class='op'>=</span> <span class='st'>"dotted"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Background lines for "others"</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>plot_data</span> <span class='op'>|&gt;</span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>category</span> <span class='op'>==</span> <span class='st'>"other"</span><span class='op'>)</span>,</span>
<span>            color <span class='op'>=</span> <span class='st'>"#F2DFCE"</span>, size <span class='op'>=</span> <span class='fl'>0.6</span>, alpha <span class='op'>=</span> <span class='fl'>0.4</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Lines for top fallers (red)</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>plot_data</span> <span class='op'>|&gt;</span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>category</span> <span class='op'>==</span> <span class='st'>"faller"</span><span class='op'>)</span>,</span>
<span>            color <span class='op'>=</span> <span class='st'>"#9D2B4D"</span>, size <span class='op'>=</span> <span class='fl'>0.6</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Lines for top risers (blue)</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>plot_data</span> <span class='op'>|&gt;</span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>category</span> <span class='op'>==</span> <span class='st'>"riser"</span><span class='op'>)</span>,</span>
<span>            color <span class='op'>=</span> <span class='st'>"#477FB0"</span>, size <span class='op'>=</span> <span class='fl'>0.6</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Line for Raleigh (gray)</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>plot_data</span> <span class='op'>|&gt;</span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>category</span> <span class='op'>==</span> <span class='st'>"Raleigh"</span><span class='op'>)</span>,</span>
<span>            color <span class='op'>=</span> <span class='st'>"#757472"</span>, size <span class='op'>=</span> <span class='fl'>0.6</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># POINTS "other" (bottom)</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>plot_data</span> <span class='op'>|&gt;</span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>category</span> <span class='op'>==</span> <span class='st'>"other"</span><span class='op'>)</span>,</span>
<span>             color <span class='op'>=</span> <span class='st'>"#EAE3DD"</span>, size <span class='op'>=</span> <span class='fl'>1.3</span>, alpha <span class='op'>=</span> <span class='fl'>0.6</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># POINTS fallers (on top of others)</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>plot_data</span> <span class='op'>|&gt;</span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>category</span> <span class='op'>==</span> <span class='st'>"faller"</span><span class='op'>)</span>,</span>
<span>             color <span class='op'>=</span> <span class='st'>"#9D2B4D"</span>, size <span class='op'>=</span> <span class='fl'>1.3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># POINTS risers (on top of others)</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>plot_data</span> <span class='op'>|&gt;</span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>category</span> <span class='op'>==</span> <span class='st'>"riser"</span><span class='op'>)</span>,</span>
<span>             color <span class='op'>=</span> <span class='st'>"#477FB0"</span>, size <span class='op'>=</span> <span class='fl'>1.3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># POINT Raleigh</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>plot_data</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>category</span> <span class='op'>==</span> <span class='st'>"Raleigh"</span><span class='op'>)</span>,</span>
<span>             color <span class='op'>=</span> <span class='st'>"#757472"</span>, size <span class='op'>=</span> <span class='fl'>1.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Metropolitan cities Labels</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2014.5</span>, y <span class='op'>=</span> <span class='fl'>90.743</span>, label <span class='op'>=</span> <span class='st'>"Midland, TX"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>2.7</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2014.5</span>, y <span class='op'>=</span> <span class='fl'>89.5</span>, label <span class='op'>=</span> <span class='st'>"37%"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3.5</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2014.5</span>, y <span class='op'>=</span> <span class='fl'>80.966</span>, label <span class='op'>=</span> <span class='st'>"Barnstable Town, MA"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>2.7</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2014.5</span>, y <span class='op'>=</span> <span class='fl'>76.074</span>, label <span class='op'>=</span> <span class='st'>"Burlington area, VT"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>2.7</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2014.5</span>, y <span class='op'>=</span> <span class='fl'>74.5</span>, label <span class='op'>=</span> <span class='st'>"Raleigh, NC"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>2.7</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2014.5</span>, y <span class='op'>=</span> <span class='fl'>73.5</span>, label <span class='op'>=</span> <span class='st'>"Lebanon, PA"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>2.7</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2014.5</span>, y <span class='op'>=</span> <span class='fl'>66.6</span>, label <span class='op'>=</span> <span class='st'>"Grand Junction, CO"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>2.7</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2014.5</span>, y <span class='op'>=</span> <span class='fl'>65.6</span>, label <span class='op'>=</span> <span class='st'>"Odessa, TX"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>2.7</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2014.5</span>, y <span class='op'>=</span> <span class='fl'>64.6</span>, label <span class='op'>=</span> <span class='st'>"Lafayette, LA"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>2.7</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2014.5</span>, y <span class='op'>=</span> <span class='fl'>63.6</span>, label <span class='op'>=</span> <span class='st'>"Ocean City, NJ"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>2.7</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2014.5</span>, y <span class='op'>=</span> <span class='fl'>62.6</span>, label <span class='op'>=</span> <span class='st'>"Wichita Falls, TX"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>2.7</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2014.5</span>, y <span class='op'>=</span> <span class='fl'>61.6</span>, label <span class='op'>=</span> <span class='st'>"New Orleans area, LA"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>2.7</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2014.5</span>, y <span class='op'>=</span> <span class='fl'>60.2</span>, label <span class='op'>=</span> <span class='st'>"Michigan City Area, IN"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>2.7</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2014.5</span>, y <span class='op'>=</span> <span class='fl'>59.35</span>, label <span class='op'>=</span> <span class='st'>"Jackson, MI"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>2.7</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2014.5</span>, y <span class='op'>=</span> <span class='fl'>58.3</span>, label <span class='op'>=</span> <span class='st'>"Jackson, TN"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>2.7</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2014.5</span>, y <span class='op'>=</span> <span class='fl'>57.38</span>, label <span class='op'>=</span> <span class='st'>"Winston-Salem, NC"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>2.7</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2014.5</span>, y <span class='op'>=</span> <span class='fl'>56.45</span>, label <span class='op'>=</span> <span class='st'>"Elkhart-Goshen, IN"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>2.7</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2014.5</span>, y <span class='op'>=</span> <span class='fl'>55.2</span>, label <span class='op'>=</span> <span class='st'>"Springfield, OH"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>2.7</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2014.5</span>, y <span class='op'>=</span> <span class='fl'>53.957</span>, label <span class='op'>=</span> <span class='st'>"-27%"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3.5</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2014.5</span>, y <span class='op'>=</span> <span class='fl'>52.8</span>, label <span class='op'>=</span> <span class='st'>"Hickory area, NC"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>2.7</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2014.5</span>, y <span class='op'>=</span> <span class='fl'>51.278</span>, label <span class='op'>=</span> <span class='st'>"Burlington, NC"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>2.7</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2014.5</span>, y <span class='op'>=</span> <span class='fl'>49.2</span>, label <span class='op'>=</span> <span class='st'>"Rocky Mount, NC"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>2.7</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2014.5</span>, y <span class='op'>=</span> <span class='fl'>48.2</span>, label <span class='op'>=</span> <span class='st'>"Goldsboro, NC"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>2.7</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># y-axis numbers</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2013.7</span>, y <span class='op'>=</span> <span class='fl'>90.7</span>, label <span class='op'>=</span> <span class='st'>"90"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>3.2</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span>, alpha <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2013.7</span>, y <span class='op'>=</span> <span class='fl'>80.7</span>, label <span class='op'>=</span> <span class='st'>"80"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>3.2</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span>, alpha <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2013.7</span>, y <span class='op'>=</span> <span class='fl'>70.7</span>, label <span class='op'>=</span> <span class='st'>"70"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>3.2</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span>, alpha <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2013.7</span>, y <span class='op'>=</span> <span class='fl'>60.7</span>, label <span class='op'>=</span> <span class='st'>"60"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>3.2</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span>, alpha <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2013.7</span>, y <span class='op'>=</span> <span class='fl'>50.7</span>, label <span class='op'>=</span> <span class='st'>"50"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>3.2</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span>, alpha <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># compact legend in upper-right corner</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"segment"</span>, x <span class='op'>=</span> <span class='fl'>2015</span>, xend <span class='op'>=</span> <span class='fl'>2016.2</span>, y <span class='op'>=</span> <span class='fl'>88</span>, yend <span class='op'>=</span> <span class='fl'>88</span>, </span>
<span>           color <span class='op'>=</span> <span class='st'>"#477FB0"</span>, size <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"point"</span>, x <span class='op'>=</span> <span class='fl'>2015</span>, y <span class='op'>=</span> <span class='fl'>88</span>, color <span class='op'>=</span> <span class='st'>"#477FB0"</span>, size <span class='op'>=</span> <span class='fl'>1.3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"point"</span>, x <span class='op'>=</span> <span class='fl'>2016.2</span>, y <span class='op'>=</span> <span class='fl'>88</span>, color <span class='op'>=</span> <span class='st'>"#477FB0"</span>, size <span class='op'>=</span> <span class='fl'>1.3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2016.8</span>, y <span class='op'>=</span> <span class='fl'>88</span>, label <span class='op'>=</span> <span class='st'>"10 biggest risers"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>2.5</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"segment"</span>, x <span class='op'>=</span> <span class='fl'>2015</span>, xend <span class='op'>=</span> <span class='fl'>2016.2</span>, y <span class='op'>=</span> <span class='fl'>86.5</span>, yend <span class='op'>=</span> <span class='fl'>86.5</span>, </span>
<span>           color <span class='op'>=</span> <span class='st'>"#8B0000"</span>, size <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"point"</span>, x <span class='op'>=</span> <span class='fl'>2015</span>, y <span class='op'>=</span> <span class='fl'>86.5</span>, color <span class='op'>=</span> <span class='st'>"#8B0000"</span>, size <span class='op'>=</span> <span class='fl'>1.3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"point"</span>, x <span class='op'>=</span> <span class='fl'>2016.2</span>, y <span class='op'>=</span> <span class='fl'>86.5</span>, color <span class='op'>=</span> <span class='st'>"#8B0000"</span>, size <span class='op'>=</span> <span class='fl'>1.3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2016.8</span>, y <span class='op'>=</span> <span class='fl'>86.5</span>, label <span class='op'>=</span> <span class='st'>"10 biggest fallers"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>2.5</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"segment"</span>, x <span class='op'>=</span> <span class='fl'>2015</span>, xend <span class='op'>=</span> <span class='fl'>2016.2</span>, y <span class='op'>=</span> <span class='fl'>85</span>, yend <span class='op'>=</span> <span class='fl'>85</span>, </span>
<span>           color <span class='op'>=</span> <span class='st'>"#EAE3DD"</span>, size <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"point"</span>, x <span class='op'>=</span> <span class='fl'>2015</span>, y <span class='op'>=</span> <span class='fl'>85</span>, color <span class='op'>=</span> <span class='st'>"#EAE3DD"</span>, size <span class='op'>=</span> <span class='fl'>1.3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"point"</span>, x <span class='op'>=</span> <span class='fl'>2016.2</span>, y <span class='op'>=</span> <span class='fl'>85</span>, color <span class='op'>=</span> <span class='st'>"#EAE3DD"</span>, size <span class='op'>=</span> <span class='fl'>1.3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2016.8</span>, y <span class='op'>=</span> <span class='fl'>85</span>, label <span class='op'>=</span> <span class='st'>"Others"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>2.5</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Scale and theme</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1999</span>, <span class='fl'>2014</span><span class='op'>)</span>, </span>
<span>                     limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1998.7</span>, <span class='fl'>2050</span><span class='op'>)</span>,</span>
<span>                     expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>                     position <span class='op'>=</span> <span class='st'>"top"</span>,</span>
<span>                     labels <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span> <span class='op'>+</span> <span class='co'># To avoid labels being outside chart</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>40</span>, <span class='fl'>100</span>, by <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>,</span>
<span>                     limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>43</span>, <span class='fl'>92.8</span><span class='op'>)</span>,</span>
<span>                     expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.023</span>, <span class='fl'>0.023</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_color_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"other"</span> <span class='op'>=</span> <span class='st'>"#EAE3DD"</span>, <span class='st'>"riser"</span> <span class='op'>=</span> <span class='st'>"#477FB0"</span>,</span>
<span>                                <span class='st'>"faller"</span> <span class='op'>=</span> <span class='st'>"#8B0000"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Titles</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Changing fortunes"</span>,</span>
<span>       subtitle <span class='op'>=</span> <span class='st'>"US median adjusted household income ($'000)*"</span>,</span>
<span>       x <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>       y <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Theme customization</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>16</span>, family <span class='op'>=</span> <span class='st'>"open-sans"</span><span class='op'>)</span>,</span>
<span>    plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>10</span>, margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>b <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>, family <span class='op'>=</span> <span class='st'>"open-sans"</span><span class='op'>)</span>,</span>
<span>    panel.grid.major.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    panel.grid.minor <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    panel.grid.major.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    axis.text.x.top <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>10</span>, face <span class='op'>=</span> <span class='st'>"bold"</span>, family <span class='op'>=</span> <span class='st'>"open-sans"</span><span class='op'>)</span>,</span>
<span>    axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    axis.ticks.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    legend.position <span class='op'>=</span> <span class='st'>"none"</span>,</span>
<span>    plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>10</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span>  <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"open-sans"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>main_plot</span></span></code></pre>
</div>
<p><img src="100570484_files/figure-html5/create%20slope%20chart-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<h3 id="load-and-fix-geocoded-data-for-map">Load and Fix Geocoded Data For Map</h3>
<p>Here there is a little section for you to understand how I obtained and wrote out in a .csv file the geocoded data for all the cities I had in our database. The code is all commented out because if you run it, it may take a few minutes to an hour for your computer to run this as it requires quite a bit of computational power.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># PREPARE DATA FOR GEOCODING</span></span>
<span><span class='co'># Create a clean address column for geocoding</span></span>
<span><span class='co'># Extract main city name from metro area names</span></span>
<span><span class='co'># data_for_geocoding &lt;- data |&gt;</span></span>
<span><span class='co'>#  mutate(</span></span>
<span><span class='co'>#    # Clean metro names for geocoding - extract main city</span></span>
<span><span class='co'>#    address = gsub("-.*", "", X),</span></span>
<span><span class='co'>#    address = gsub(" area", "", address),</span></span>
<span><span class='co'>#    address = trimws(address)</span></span>
<span><span class='co'>#  )</span></span>
<span><span class='co'># GEOCODE METRO AREAS</span></span>
<span><span class='co'># Geocode the metro areas using OpenStreetMap (osm) method</span></span>
<span><span class='co'># This is free and doesn't require an API key</span></span>
<span><span class='co'># Note: This may take several minutes for 229 metros</span></span>
<span><span class='co'># geocoded_data &lt;- data_for_geocoding |&gt;</span></span>
<span><span class='co'>#  geocode(address, method = 'osm', lat = lat, long = lon)</span></span>
<span></span>
<span><span class='co'># SAVE TO CSV</span></span>
<span><span class='co'># write.csv(geocoded_data, "geocoded_data.csv", row.names = FALSE)</span></span></code></pre>
</div>
</div>
<p>The <code>geocode()</code> function worked really well, however, it made some confusion regarding certain metropolitan areas that had a bit of a stranger nomenclature. For example, Burlington-South Burlington, VT was called Burlington area on the graph but not on the .csv file. This was not an issue for places that had a unique name, but for others such as “Naples-Immokalee-Marco Island, FL” the function automatically assigned it to Naples, Italy and therefore was messing up with our data a lot. Therefore, I had to manually correct all these metropolitan areas with their coordinates and then <code>left_join()</code> them to the original <code>geocoded_data.csv</code> file</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>geocoded_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span><span class='st'>"geocoded_data.csv"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Fix incorrectly geocoded metros (matched wrong cities outside US)</span></span>
<span><span class='va'>corrections</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tribble.html'>tribble</a></span><span class='op'>(</span></span>
<span>  <span class='op'>~</span><span class='va'>X</span>, <span class='op'>~</span><span class='va'>lat_fix</span>, <span class='op'>~</span><span class='va'>lon_fix</span>,</span>
<span>  <span class='st'>"Augusta-Richmond County, GA-SC"</span>, <span class='fl'>33.4735</span>, <span class='op'>-</span><span class='fl'>82.0105</span>,</span>
<span>  <span class='st'>"Birmingham-Hoover, AL"</span>, <span class='fl'>33.5207</span>, <span class='op'>-</span><span class='fl'>86.8025</span>,</span>
<span>  <span class='st'>"Canton-Massillon, OH"</span>, <span class='fl'>40.7989</span>, <span class='op'>-</span><span class='fl'>81.3784</span>,</span>
<span>  <span class='st'>"Hickory-Lenoir-Morganton, NC"</span>, <span class='fl'>35.7331</span>, <span class='op'>-</span><span class='fl'>81.3412</span>,</span>
<span>  <span class='st'>"Manchester-Nashua, NH"</span>, <span class='fl'>42.9956</span>, <span class='op'>-</span><span class='fl'>71.4548</span>,</span>
<span>  <span class='st'>"Naples-Immokalee-Marco Island, FL"</span>, <span class='fl'>26.1420</span>, <span class='op'>-</span><span class='fl'>81.7948</span>,</span>
<span>  <span class='st'>"Norwich-New London, CT"</span>, <span class='fl'>41.3557</span>, <span class='op'>-</span><span class='fl'>72.0995</span>,</span>
<span>  <span class='st'>"Olympia-Tumwater, WA"</span>, <span class='fl'>47.0379</span>, <span class='op'>-</span><span class='fl'>122.9007</span>,</span>
<span>  <span class='st'>"Santa Cruz-Watsonville, CA"</span>, <span class='fl'>36.9741</span>, <span class='op'>-</span><span class='fl'>122.0308</span>,</span>
<span>  <span class='st'>"Santa Maria-Santa Barbara, CA"</span>, <span class='fl'>34.9530</span>, <span class='op'>-</span><span class='fl'>120.4357</span>,</span>
<span>  <span class='st'>"Winston-Salem, NC"</span>, <span class='fl'>36.0999</span>, <span class='op'>-</span><span class='fl'>80.2442</span>,</span>
<span>  <span class='st'>"York-Hanover, PA"</span>, <span class='fl'>39.9626</span>, <span class='op'>-</span><span class='fl'>76.7277</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Apply corrections</span></span>
<span><span class='va'>geocoded_data</span> <span class='op'>&lt;-</span> <span class='va'>geocoded_data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>corrections</span>, by <span class='op'>=</span> <span class='st'>"X"</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    lat <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>lat_fix</span><span class='op'>)</span>, <span class='va'>lat_fix</span>, <span class='va'>lat</span><span class='op'>)</span>,</span>
<span>    lon <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>lon_fix</span><span class='op'>)</span>, <span class='va'>lon_fix</span>, <span class='va'>lon</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>lat_fix</span>, <span class='op'>-</span><span class='va'>lon_fix</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 id="us-map">US map</h3>
<p>I filtered the geocoded data to only include the metropolitan areas with valid coordinates and select the essential variables for mapping.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># prepare the map data</span></span>
<span><span class='va'>map_data</span> <span class='op'>&lt;-</span> <span class='va'>geocoded_data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>lat</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>lon</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>lon</span>, <span class='va'>lat</span>, <span class='va'>Median_1999</span>, <span class='va'>Median_2014</span>, <span class='va'>category</span>, <span class='va'>pct_change</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>I used the <code>usmap</code>’s package transformation funxtioon to convert standard latitude/longitude into an actual representation of the United States.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Transform coordinates to usmap projection</span></span>
<span><span class='va'>map_data_transformed</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/usmap/man/usmap_transform.html'>usmap_transform</a></span><span class='op'>(</span><span class='va'>map_data</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Here, I retrieved the geographic US state borders as a patial features (sf) object, excluding Puerto Rico as it was not present in the original graph.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># usmap data as sf object, excluding Puerto Rico</span></span>
<span><span class='va'>us_states</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/usmap/man/us_map.html'>us_map</a></span><span class='op'>(</span>regions <span class='op'>=</span> <span class='st'>"states"</span>, exclude <span class='op'>=</span> <span class='st'>"PR"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>The sf package helped me dissolving the state boundaries into a single polygon object and to just give me the outline of the USA without the inter-state borders.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Convert to sf object</span></span>
<span><span class='va'>us_states_sf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_as_sf.html'>st_as_sf</a></span><span class='op'>(</span><span class='va'>us_states</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Dissolve all states into one polygon (removes internal state boundaries)</span></span>
<span><span class='va'>us_outline</span> <span class='op'>&lt;-</span> <span class='va'>us_states_sf</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://r-spatial.github.io/sf/reference/geos_combine.html'>st_union</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://r-spatial.github.io/sf/reference/sf.html'>st_sf</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># SEPARATE MAP DATA BY CATEGORY</span></span>
<span><span class='va'>map_other</span> <span class='op'>&lt;-</span> <span class='va'>map_data_transformed</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>category</span> <span class='op'>==</span> <span class='st'>"other"</span><span class='op'>)</span></span>
<span><span class='va'>map_riser</span> <span class='op'>&lt;-</span> <span class='va'>map_data_transformed</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>category</span> <span class='op'>==</span> <span class='st'>"riser"</span><span class='op'>)</span></span>
<span><span class='va'>map_faller</span> <span class='op'>&lt;-</span> <span class='va'>map_data_transformed</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>category</span> <span class='op'>==</span> <span class='st'>"faller"</span><span class='op'>)</span></span>
<span><span class='va'>map_raleigh</span> <span class='op'>&lt;-</span> <span class='va'>map_data_transformed</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>category</span> <span class='op'>==</span> <span class='st'>"Raleigh"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>And here I used <code>ggplot()</code> to give us our finalized US map.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># CREATE THE MAP</span></span>
<span><span class='va'>us_map_plot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsf.html'>geom_sf</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>us_outline</span>,</span>
<span>    fill <span class='op'>=</span> <span class='st'>"white"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.1</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsf.html'>geom_sf</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>map_other</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>geometry <span class='op'>=</span> <span class='va'>geometry</span><span class='op'>)</span>,</span>
<span>          color <span class='op'>=</span> <span class='st'>"#F2DFCE"</span>, size <span class='op'>=</span> <span class='fl'>1.2</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsf.html'>geom_sf</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>map_riser</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>geometry <span class='op'>=</span> <span class='va'>geometry</span><span class='op'>)</span>,</span>
<span>          color <span class='op'>=</span> <span class='st'>"#477FB0"</span>, size <span class='op'>=</span> <span class='fl'>1.2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsf.html'>geom_sf</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>map_faller</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>geometry <span class='op'>=</span> <span class='va'>geometry</span><span class='op'>)</span>,</span>
<span>          color <span class='op'>=</span> <span class='st'>"#9D2B4D"</span>, size <span class='op'>=</span> <span class='fl'>1.2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsf.html'>geom_sf</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>map_raleigh</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>geometry <span class='op'>=</span> <span class='va'>geometry</span><span class='op'>)</span>,</span>
<span>          color <span class='op'>=</span> <span class='st'>"#757472"</span>, size <span class='op'>=</span> <span class='fl'>1.2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_void</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    plot.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='va'>us_map_plot</span></span></code></pre>
</div>
<p><img src="100570484_files/figure-html5/US%20map-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<h3 id="text-box">Text Box</h3>
<p>Using ggplot’s annotation capabilities with richtext formatting, I created two text boxes to give us crucial context.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>text_box</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"richtext"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fl'>0.98</span>, y <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"The 229 (of 381) metropolitan&lt;br&gt;areas shown, account for &lt;b&gt;76%&lt;/b&gt;&lt;br&gt;of the total population of the&lt;br&gt;United States"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>1</span>, vjust <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>3.3</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>1.2</span>,</span>
<span>    label.color <span class='op'>=</span> <span class='cn'>NA</span>,</span>
<span>    fill <span class='op'>=</span> <span class='cn'>NA</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"richtext"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fl'>0.98</span>, y <span class='op'>=</span> <span class='fl'>0.66</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Of those 229, &lt;b&gt;190&lt;/b&gt; have seen&lt;br&gt;their median income fall"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>1</span>, vjust <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>3.3</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>1.2</span>,</span>
<span>    label.color <span class='op'>=</span> <span class='cn'>NA</span>,</span>
<span>    fill <span class='op'>=</span> <span class='cn'>NA</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>xlim</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>ylim</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_void</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>text_box</span></span></code></pre>
</div>
<p><img src="100570484_files/figure-html5/Text%20Box-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<h3 id="final-plot-and-arrows">Final Plot (and Arrows)</h3>
<p>In this final part, I used <code>cowplot</code>’s layering features to combine all the different visualization into one final plot. In addition, I added the axis labels, the arrows pointing at the key metros (Midland TX, Springfield OH, and Raleigh NC), and a footer with data attribution. After a lot of trial and error, I positioned all the different plots into the spaces that they had in the original graph. This was done at the best of cowplot’s capabilities and the result is quite compelling and very close to the original.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># COMBINE EVERYTHING USING COWPLOT</span></span>
<span><span class='va'>final_plot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://wilkelab.org/cowplot/reference/ggdraw.html'>ggdraw</a></span><span class='op'>(</span><span class='va'>main_plot</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Add white background first</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"white"</span>, color <span class='op'>=</span> <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Axis labels (1999 and 2014)</span></span>
<span>  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/draw_label.html'>draw_label</a></span><span class='op'>(</span><span class='st'>"1999"</span>, x <span class='op'>=</span> <span class='fl'>0.05</span>, y <span class='op'>=</span> <span class='fl'>0.905</span>, hjust <span class='op'>=</span> <span class='fl'>0.5</span>, size <span class='op'>=</span> <span class='fl'>10</span>, </span>
<span>             fontface <span class='op'>=</span> <span class='st'>"bold"</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/draw_label.html'>draw_label</a></span><span class='op'>(</span><span class='st'>"2014"</span>, x <span class='op'>=</span> <span class='fl'>0.295</span>, y <span class='op'>=</span> <span class='fl'>0.905</span>, hjust <span class='op'>=</span> <span class='fl'>0.5</span>, size <span class='op'>=</span> <span class='fl'>10</span>, </span>
<span>             fontface <span class='op'>=</span> <span class='st'>"bold"</span>, color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># map in top-right corner</span></span>
<span>  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/draw_plot.html'>draw_plot</a></span><span class='op'>(</span><span class='va'>us_map_plot</span>, x <span class='op'>=</span> <span class='fl'>0.48</span>, y <span class='op'>=</span> <span class='fl'>0.52</span>, width <span class='op'>=</span> <span class='fl'>0.48</span>, height <span class='op'>=</span> <span class='fl'>0.52</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># text box below the map</span></span>
<span>  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/draw_plot.html'>draw_plot</a></span><span class='op'>(</span><span class='va'>text_box</span>, x <span class='op'>=</span> <span class='fl'>0.55</span>, y <span class='op'>=</span> <span class='fl'>0.08</span>, width <span class='op'>=</span> <span class='fl'>0.42</span>, height <span class='op'>=</span> <span class='fl'>0.40</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Arrow 1: Midland, TX (Biggest winner) - with curved text</span></span>
<span>  <span class='fu'><a href='https://allancameron.github.io/geomtextpath/reference/geom_textcurve.html'>geom_textcurve</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>0.429</span>, y <span class='op'>=</span> <span class='fl'>0.87</span>, xend <span class='op'>=</span> <span class='fl'>0.707</span>, yend <span class='op'>=</span> <span class='fl'>0.747</span><span class='op'>)</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Biggest winner"</span>,</span>
<span>    curvature <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.44</span>,</span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.15</span>, <span class='st'>"cm"</span><span class='op'>)</span>, type <span class='op'>=</span> <span class='st'>"open"</span><span class='op'>)</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.3</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>2.7</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"italic"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0.05</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.3</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Arrow 2: Springfield, OH (Biggest loser) - first segment with text</span></span>
<span>  <span class='fu'><a href='https://allancameron.github.io/geomtextpath/reference/geom_textcurve.html'>geom_textcurve</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>0.458</span>, y <span class='op'>=</span> <span class='fl'>0.2435</span>, xend <span class='op'>=</span> <span class='fl'>0.65</span>, yend <span class='op'>=</span> <span class='fl'>0.53</span><span class='op'>)</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Biggest loser"</span>,</span>
<span>    curvature <span class='op'>=</span> <span class='fl'>0.18</span>,</span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.3</span>,</span>
<span>        size <span class='op'>=</span> <span class='fl'>2.7</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"italic"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0.02</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>1.4</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Arrow 2: Second segment without text</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_curve</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>0.65</span>, y <span class='op'>=</span> <span class='fl'>0.53</span>, xend <span class='op'>=</span> <span class='fl'>0.837</span>, yend <span class='op'>=</span> <span class='fl'>0.8135</span><span class='op'>)</span>,</span>
<span>    curvature <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.18</span>,  <span class='co'># Negative curvature</span></span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.15</span>, <span class='st'>"cm"</span><span class='op'>)</span>, type <span class='op'>=</span> <span class='st'>"open"</span><span class='op'>)</span>,  <span class='co'># Arrow only at end</span></span>
<span>    color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.3</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Arrow 3: Raleigh, NC</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_curve</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>0.865</span>, y <span class='op'>=</span> <span class='fl'>0.70</span>, xend <span class='op'>=</span> <span class='fl'>0.887</span>, yend <span class='op'>=</span> <span class='fl'>0.787</span><span class='op'>)</span>,</span>
<span>    curvature <span class='op'>=</span> <span class='fl'>0.3</span>,</span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.15</span>, <span class='st'>"cm"</span><span class='op'>)</span>, type <span class='op'>=</span> <span class='st'>"open"</span><span class='op'>)</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.3</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Label for Raleigh</span></span>
<span>  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/draw_label.html'>draw_label</a></span><span class='op'>(</span><span class='st'>"Raleigh, NC"</span>, x <span class='op'>=</span> <span class='fl'>0.76</span>, y <span class='op'>=</span> <span class='fl'>0.70</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>8</span>,</span>
<span>             color <span class='op'>=</span> <span class='st'>"#5d5d5c"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Semi-transparent rectangle behind footer text</span></span>
<span><span class='fu'><a href='https://wilkelab.org/cowplot/reference/draw_grob.html'>draw_grob</a></span><span class='op'>(</span></span>
<span>  <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/grid.rect.html'>rectGrob</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='fl'>0.025</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>0.044</span>,</span>
<span>    width <span class='op'>=</span> <span class='fl'>0.285</span>,</span>
<span>    height <span class='op'>=</span> <span class='fl'>0.10</span>,</span>
<span>    just <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"left"</span>, <span class='st'>"bottom"</span><span class='op'>)</span>,</span>
<span>    gp <span class='op'>=</span> <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/gpar.html'>gpar</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"#F2DFCE"</span>, alpha <span class='op'>=</span> <span class='fl'>0.15</span>, col <span class='op'>=</span> <span class='cn'>NA</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Footer annotation (bottom left)</span></span>
<span>  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/draw_label.html'>draw_label</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"* Scaled to 3-person household, adjusted for cost of living in the metro relative to the nation\nGraphic: Steven Bernard  Source: Pew Research Center"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fl'>0.03</span>, </span>
<span>    y <span class='op'>=</span> <span class='fl'>0.067</span>, </span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>    size <span class='op'>=</span> <span class='fl'>7</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#888888"</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>1.3</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='va'>final_plot</span></span></code></pre>
</div>
<p><img src="100570484_files/figure-html5/plot-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<h2 id="limitations">Limitations</h2>
<p>While my replication is very lose to the Financial Times original, there are some limitations that are worth noting.</p>
<p><strong>Font Availability</strong>: The Financial Times uses an owned font called “Financier” in their graphics, which is not available to me. Therefore, I checked for various similar fonts and I got to the conclusion of using “Open Sans” from Google Fonts as an alternative. While it is close and professional, it certainly lacks the essence and elegance of Financier.</p>
<p><strong>Background Context</strong>: In the original Financial Times article, the graphic is above the Financial Times’ classic salmon-pink background. This results in the optical effect that the semi-transparent beige rectangle behind the footer text perfectly blends with it, which is something I cannot achieve here in R and that is out of scope for this project. Therefore, that is why that box looks less integrated. I could have chosen to remove it but I decide to keep it as it still is part of the original graph.</p>
<p>Nevertheless, the replication still carries out the core visualization and it still tells the same story that the original Financial Times article did.</p>
<h2 id="alternative-visualization">Alternative Visualization</h2>
<p>For the Alternative Visualization, I focused on the main shortcoming of the original graph in my opinion. That is that the graph is not immediate. What is the story that is telling us? That of 229 metropolitan areas, 190 have seen their median income fall. Thing is that we see that not by looking at the graph right away but only when we read the text box. While that is certainly informative, it is not the true reason on why you decide to do a visualization. You should be able to tell a story without needing writing.</p>
<p>Therefore, with this in mind, I decided that my Alternative Visualization would be focusing on this. In addition, I thought that only showing income decreasing tell one side of the story, but not the entirety of it. That is why I decided to ask the people at the Pew Research Center if they could provide me with additional data about that same time frame.</p>
<p>They have offered me the whole database and from that I chose to focus on inequality change, because I wanted to see that if with the decrease of median income, inequality was also impacted. Specifically I used the matrix of the 90/10 ratio which is a measure of income inequality that compares the income of households in the 90th percentile (earning more than 90% of the population) to those at the 10th percentile (earns more than 10% of the population, and less than the remaining 90). The results were that inequality rose in 88% of metropolitan areas and that income fell in 83% of metropolitan areas.</p>
<h3 id="load-and-prepare-the-data">Load and Prepare the Data</h3>
<p>Here I extracted the inequality change (measured by the 90/10 ratio) from the Excel sheet (sheet 5), selecting the appropriate rows and columns.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Load the data and select only important rows</span></span>
<span><span class='va'>inequality_raw</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span></span>
<span>  <span class='st'>"middle_class_sheets.xlsx"</span>,</span>
<span>  sheet <span class='op'>=</span> <span class='st'>"5. Income inequality, metro"</span>,</span>
<span>  skip <span class='op'>=</span> <span class='fl'>9</span>,</span>
<span>  col_names <span class='op'>=</span> <span class='cn'>FALSE</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Select relevant columns</span></span>
<span><span class='va'>inequality_data</span> <span class='op'>&lt;-</span> <span class='va'>inequality_raw</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span>Metro <span class='op'>=</span> <span class='fl'>1</span>, Ratio_1999 <span class='op'>=</span> <span class='fl'>2</span>, Ratio_2014 <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>Metro</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    Ratio_1999 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>Ratio_1999</span><span class='op'>)</span>,</span>
<span>    Ratio_2014 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>Ratio_2014</span><span class='op'>)</span>,</span>
<span>    change_inequality <span class='op'>=</span> <span class='va'>Ratio_2014</span> <span class='op'>-</span> <span class='va'>Ratio_1999</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<p>While the income data comes from our previous cleaned dataset.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>income_data</span> <span class='op'>&lt;-</span> <span class='va'>data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span>Metro <span class='op'>=</span> <span class='va'>X</span>, <span class='va'>Median_1999</span>, <span class='va'>Median_2014</span>, <span class='va'>pct_change</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>I applied <code>inner_join</code> to these two datasets by metropolitan area name and calculated the percentage change in income and absolute change in the 90/10 inequality ratio to create our final dataset that will help us carry out the improved visualization.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>plot_data</span> <span class='op'>&lt;-</span> <span class='va'>income_data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>inner_join</a></span><span class='op'>(</span><span class='va'>inequality_data</span>, by <span class='op'>=</span> <span class='st'>"Metro"</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>pct_change</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>change_inequality</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 id="key-data-points">Key Data Points</h3>
<p>To showcase the most meaningful patterns in the data, I split metropolitan areas into four quadrants based on whether income and inequality increased or decreased.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># IDENTIFY KEY METROS - BASED ON QUADRANTS</span></span>
<span><span class='co'># First, assign each metro to a quadrant</span></span>
<span><span class='va'>plot_data</span> <span class='op'>&lt;-</span> <span class='va'>plot_data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>quadrant <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>    <span class='va'>pct_change</span> <span class='op'>&gt;</span> <span class='fl'>0</span> <span class='op'>&amp;</span> <span class='va'>change_inequality</span> <span class='op'>&gt;</span> <span class='fl'>0</span> <span class='op'>~</span> <span class='st'>"Richer but more unequal"</span>,</span>
<span>    <span class='va'>pct_change</span> <span class='op'>&gt;</span> <span class='fl'>0</span> <span class='op'>&amp;</span> <span class='va'>change_inequality</span> <span class='op'>&lt;=</span> <span class='fl'>0</span> <span class='op'>~</span> <span class='st'>"Richer and more equal"</span>,</span>
<span>    <span class='va'>pct_change</span> <span class='op'>&lt;=</span> <span class='fl'>0</span> <span class='op'>&amp;</span> <span class='va'>change_inequality</span> <span class='op'>&gt;</span> <span class='fl'>0</span> <span class='op'>~</span> <span class='st'>"Poorer and more unequal"</span>,</span>
<span>    <span class='va'>pct_change</span> <span class='op'>&lt;=</span> <span class='fl'>0</span> <span class='op'>&amp;</span> <span class='va'>change_inequality</span> <span class='op'>&lt;=</span> <span class='fl'>0</span> <span class='op'>~</span> <span class='st'>"Poorer but more equal"</span></span>
<span>  <span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>I then identified the most extreme case in each quadrant.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Top "Richer and more equal" (best outcome - income up, inequality down)</span></span>
<span><span class='va'>top_richer_equal</span> <span class='op'>&lt;-</span> <span class='va'>plot_data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>quadrant</span> <span class='op'>==</span> <span class='st'>"Richer and more equal"</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>pct_change</span><span class='op'>)</span>, <span class='va'>change_inequality</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>Metro</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Top "Richer but more unequal" (income up, inequality up)</span></span>
<span><span class='va'>top_richer_unequal</span> <span class='op'>&lt;-</span> <span class='va'>plot_data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>quadrant</span> <span class='op'>==</span> <span class='st'>"Richer but more unequal"</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>pct_change</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>Metro</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Worst "Poorer and more unequal" (worst outcome - income down, inequality up)</span></span>
<span><span class='va'>top_poorer_unequal</span> <span class='op'>&lt;-</span> <span class='va'>plot_data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>quadrant</span> <span class='op'>==</span> <span class='st'>"Poorer and more unequal"</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>pct_change</span>, <span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>change_inequality</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>Metro</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Worst "Poorer but more equal" (income down, but inequality down)</span></span>
<span><span class='va'>top_poorer_equal</span> <span class='op'>&lt;-</span> <span class='va'>plot_data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>quadrant</span> <span class='op'>==</span> <span class='st'>"Poorer but more equal"</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>change_inequality</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>Metro</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>These four metros became the highlights of our data, representing a snapshot of the economic experiences across US metropolitan areas during this period.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Combine all top performers</span></span>
<span><span class='va'>top_performers</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>top_richer_equal</span>, <span class='va'>top_richer_unequal</span>, <span class='va'>top_poorer_unequal</span>, <span class='va'>top_poorer_equal</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Add highlight column</span></span>
<span><span class='va'>plot_data</span> <span class='op'>&lt;-</span> <span class='va'>plot_data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>is_top <span class='op'>=</span> <span class='va'>Metro</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>top_performers</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Data for labels</span></span>
<span><span class='va'>label_data</span> <span class='op'>&lt;-</span> <span class='va'>plot_data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>is_top</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Metro <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace</a></span><span class='op'>(</span><span class='va'>Metro</span>, <span class='st'>"Hilton Head Island-Bluffton-Beaufort, SC"</span>, <span class='st'>"Hilton Head Island, SC"</span><span class='op'>)</span>,</span>
<span>         Metro <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace</a></span><span class='op'>(</span><span class='va'>Metro</span>, <span class='st'>"Burlington-South Burlington, VT"</span>, <span class='st'>"Burlington Area, VT"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>I had R calculate the actual statistics for inequality and income percentage change.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># CALCULATE STATS FOR ANNOTATION</span></span>
<span><span class='va'>n_total</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>plot_data</span><span class='op'>)</span></span>
<span><span class='va'>n_inequality_rose</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>plot_data</span><span class='op'>$</span><span class='va'>change_inequality</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>)</span></span>
<span><span class='va'>pct_inequality_rose</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>100</span> <span class='op'>*</span> <span class='va'>n_inequality_rose</span> <span class='op'>/</span> <span class='va'>n_total</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>n_income_fell</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>plot_data</span><span class='op'>$</span><span class='va'>pct_change</span> <span class='op'>&lt;</span> <span class='fl'>0</span><span class='op'>)</span></span>
<span><span class='va'>pct_income_fell</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>100</span> <span class='op'>*</span> <span class='va'>n_income_fell</span> <span class='op'>/</span> <span class='va'>n_total</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>I gave each quadrant a color to have people immediately understand that each quadrant and color mean something. The color scale is based on a color blind scale so that the graph is accessible to everyone.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># DEFINE COLORS - ONE FOR EACH QUADRANT</span></span>
<span><span class='co'># Based on a Color blind scale</span></span>
<span><span class='va'>color_richer_equal</span> <span class='op'>&lt;-</span> <span class='st'>"#159E00"</span>     <span class='co'># Green - best outcome</span></span>
<span><span class='va'>color_richer_unequal</span> <span class='op'>&lt;-</span> <span class='st'>"#0072B2"</span>   <span class='co'># Blue - mixed (richer but unequal)</span></span>
<span><span class='va'>color_poorer_unequal</span> <span class='op'>&lt;-</span> <span class='st'>"#D55E00"</span>   <span class='co'># Red - worst outcome</span></span>
<span><span class='va'>color_poorer_equal</span> <span class='op'>&lt;-</span> <span class='st'>"#F0E442"</span>     <span class='co'># Yellow - mixed (poorer but more equal)</span></span>
<span><span class='va'>color_text</span> <span class='op'>&lt;-</span> <span class='st'>"black"</span></span>
<span></span>
<span><span class='co'># Set up color mapping</span></span>
<span><span class='va'>quadrant_colors</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>  <span class='st'>"Richer and more equal"</span> <span class='op'>=</span> <span class='va'>color_richer_equal</span>,</span>
<span>  <span class='st'>"Richer but more unequal"</span> <span class='op'>=</span> <span class='va'>color_richer_unequal</span>,</span>
<span>  <span class='st'>"Poorer and more unequal"</span> <span class='op'>=</span> <span class='va'>color_poorer_unequal</span>,</span>
<span>  <span class='st'>"Poorer but more equal"</span> <span class='op'>=</span> <span class='va'>color_poorer_equal</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Set factor levels for legend order</span></span>
<span><span class='va'>plot_data</span> <span class='op'>&lt;-</span> <span class='va'>plot_data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>quadrant <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>quadrant</span>, levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"Poorer and more unequal"</span>,</span>
<span>    <span class='st'>"Poorer but more equal"</span>,</span>
<span>    <span class='st'>"Richer but more unequal"</span>,</span>
<span>    <span class='st'>"Richer and more equal"</span></span>
<span>  <span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>label_data</span> <span class='op'>&lt;-</span> <span class='va'>label_data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>quadrant <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>quadrant</span>, levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"Richer and more equal"</span>,</span>
<span>    <span class='st'>"Richer but more unequal"</span>,</span>
<span>    <span class='st'>"Poorer but more equal"</span>,</span>
<span>    <span class='st'>"Poorer and more unequal"</span></span>
<span>  <span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 id="the-plot">The Plot</h3>
<p>My Alternative Visualization changes the linear narrative of the slope chart into a different kind of narrative with an extra variable. Here it is possible to see the the relationship between income change and inequality change. Each metropolitan area is a point signaling the change that happened between the period 1999 and 2014. They all have a color linked to the change they went through and we have the top/worst performer per quadrant and the other points are slightly more opaque in the background. The centered axes at zero give us clear quadrants, while the annotation box in the top-right provides immediate context. I believe this plot allows the viewers to quickly identify the trends that american metropolitan society went through in the 15 years between 1999 and 2014.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># DEFINE AXIS LIMITS</span></span>
<span><span class='va'>x_max</span> <span class='op'>&lt;-</span> <span class='fl'>38</span></span>
<span><span class='va'>y_max</span> <span class='op'>&lt;-</span> <span class='fl'>10</span></span>
<span></span>
<span><span class='va'>x_limits</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>x_max</span>, <span class='va'>x_max</span><span class='op'>)</span></span>
<span><span class='va'>y_limits</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>5</span>, <span class='va'>y_max</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># CREATE THE QUADRANT SCATTERPLOT</span></span>
<span><span class='va'>quadrant_plot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>plot_data</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>pct_change</span>, y <span class='op'>=</span> <span class='va'>change_inequality</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Quadrant lines at 0,0</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fl'>0</span>, color <span class='op'>=</span> <span class='st'>"gray60"</span>, linetype <span class='op'>=</span> <span class='st'>"dashed"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='fl'>0</span>, color <span class='op'>=</span> <span class='st'>"gray60"</span>, linetype <span class='op'>=</span> <span class='st'>"dashed"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Annotation: key insight (top-right corner) with box</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"label"</span>,</span>
<span>    x <span class='op'>=</span> <span class='va'>x_max</span>,</span>
<span>    y <span class='op'>=</span> <span class='va'>y_max</span> <span class='op'>*</span> <span class='fl'>0.97</span>,</span>
<span>    label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Inequality rose in "</span>, <span class='va'>pct_inequality_rose</span>, <span class='st'>"% of metropolitan areas\nIncome fell in "</span>, <span class='va'>pct_income_fell</span>, <span class='st'>"% of metropolitan areas"</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>3.56</span>,</span>
<span>    color <span class='op'>=</span> <span class='va'>color_text</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.9</span>,</span>
<span>    fill <span class='op'>=</span> <span class='st'>"white"</span>,</span>
<span>    label.size <span class='op'>=</span> <span class='fl'>0.3</span>,</span>
<span>    label.padding <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.4</span>, <span class='st'>"lines"</span><span class='op'>)</span>,</span>
<span>    label.r <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.15</span>, <span class='st'>"lines"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Background points (low alpha)</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>plot_data</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='va'>is_top</span><span class='op'>)</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='va'>quadrant</span><span class='op'>)</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>2.5</span>,</span>
<span>    alpha <span class='op'>=</span> <span class='fl'>0.4</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Highlighted top 3 per quadrant (full color)</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>plot_data</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>is_top</span><span class='op'>)</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='va'>quadrant</span><span class='op'>)</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>3.5</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Labels for top 3 per quadrant</span></span>
<span>  <span class='fu'><a href='https://ggrepel.slowkow.com/reference/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>label_data</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>Metro</span><span class='op'>)</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    color <span class='op'>=</span> <span class='va'>color_text</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    max.overlaps <span class='op'>=</span> <span class='fl'>20</span>,</span>
<span>    segment.color <span class='op'>=</span> <span class='st'>"gray50"</span>,</span>
<span>    segment.size <span class='op'>=</span> <span class='fl'>0.4</span>,</span>
<span>    box.padding <span class='op'>=</span> <span class='fl'>0.4</span>,</span>
<span>    point.padding <span class='op'>=</span> <span class='fl'>0.5</span>,</span>
<span>    force <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>    min.segment.length <span class='op'>=</span> <span class='fl'>0.4</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Color scale</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_color_manual</a></span><span class='op'>(</span></span>
<span>    values <span class='op'>=</span> <span class='va'>quadrant_colors</span>,</span>
<span>    name <span class='op'>=</span> <span class='cn'>NULL</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Scales</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>limits <span class='op'>=</span> <span class='va'>x_limits</span>, breaks <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/pretty_breaks.html'>pretty_breaks</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>7</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>limits <span class='op'>=</span> <span class='va'>y_limits</span>, breaks <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/pretty_breaks.html'>pretty_breaks</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>7</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Titles and labels</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span></span>
<span>    title <span class='op'>=</span> <span class='st'>"Inequality rose almost everywhere, but not equally"</span>,</span>
<span>    subtitle <span class='op'>=</span> <span class='st'>"Change in median household income vs change in inequality (90/10 ratio), 1999-2014"</span>,</span>
<span>    x <span class='op'>=</span> <span class='st'>"Change in median income (%)"</span>,</span>
<span>    y <span class='op'>=</span> <span class='st'>"Change in 90/10 inequality ratio"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Theme</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>16</span>, face <span class='op'>=</span> <span class='st'>"bold"</span>, hjust <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>,</span>
<span>    plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>10</span>, color <span class='op'>=</span> <span class='va'>color_text</span>, margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>b <span class='op'>=</span> <span class='fl'>15</span><span class='op'>)</span>, hjust <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>,</span>
<span>    axis.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>10</span>, color <span class='op'>=</span> <span class='va'>color_text</span><span class='op'>)</span>,</span>
<span>    axis.title.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>,</span>
<span>    axis.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>9</span>, color <span class='op'>=</span> <span class='va'>color_text</span><span class='op'>)</span>,</span>
<span>    panel.grid.minor <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    panel.grid.major <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"gray90"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span>,</span>
<span>    plot.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"white"</span>, color <span class='op'>=</span> <span class='cn'>NA</span><span class='op'>)</span>,</span>
<span>    plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>15</span>, <span class='fl'>15</span>, <span class='fl'>15</span>, <span class='fl'>15</span><span class='op'>)</span>,</span>
<span>    legend.position <span class='op'>=</span> <span class='st'>"top"</span>,</span>
<span>    legend.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>9</span><span class='op'>)</span>,</span>
<span>    legend.key.size <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.8</span>, <span class='st'>"lines"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guide_legend.html'>guide_legend</a></span><span class='op'>(</span>nrow <span class='op'>=</span> <span class='fl'>1</span>, override.aes <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>quadrant_plot</span></span></code></pre>
</div>
<p><img src="100570484_files/figure-html5/plot%20improvement-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<h2 id="conclusions">Conclusions</h2>
<p>This project showed me how meaningful data visualizations actually require just as much technical proficiency as thoughtful analytical choices about how to present information. The process of replicating the Financial Times “Changing Fortunes” graph really opened my eyes about how much craftsmanship there is behind these visualizations. Each element serves a purpose. There are things in graphs such as dotted gridlines, label placement, or arrows that I would have never looked at before this project and that now I cannot help but to notice when I see one on social media or on an article.</p>
<p>The journey of replicating this graph has been an invaluable learning experience. I had to deal with so many challenges that I did not even know they were challenges in the first place. These technical issues taught me a very important lesson: behind every (good) data visualization there are hours of data preparation, thinking, trial and error, and constant polishing.</p>
<p>However, the most important knowledge I gained was during the alternative visualization process. While the original Financial Times is clearly better looking and more elegant than my visualization, it requires people to read text to fully understand the graph. That is something that I cannot compromise with when we talk about informative graphs. This limitation motivated me to create a visualization that would make the story immediately visible. All this while adding a crucial second dimension: inequality change. By visualizing both variables at the same timie, it reveals that economic decline was frequently accompanied by rising inequality, with 88% of metros experiencing increased inequality during the same period. This changes our understanding from “most places got poorer” to “most places got poorer and more unequal” giving us a more nuanced understanding of American societal transformation in this time period.</p>
<p>Looking forward, there are a lot of implementations that could be done to my graph. First and foremost, include more recent data so we could have data spanning from 1999 to 2025. In addition, interactive visualizations using <code>plotly</code> or <code>Shiny</code> could allow users to look at specific metropolitan areas, filter by region or population size, and see how different economic sectors contributed to overall income changes. Another very interesting proposition could be to have temporal change to show how these patterns evolved year-by-year rather than simply comparing two endpoints. This would be specifically interesting to see if these changes were slow and gradual or drastic events such as the 2008 financial crisis were the driving factor.</p>
<p>In conclusion, this project instilled in me the notion that effective data visualization is not merely about technical execution but about making concious choices that serve the story you want to tell. The original Financial Times graphic shows us the power of elegancy and multi-layered visualizations. The alternative visualization gives us a different approach: sometimes clarity is more important aesthetic refinement. Both approaches have their pros and cons, and ideally we should not have to compromise between them.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
