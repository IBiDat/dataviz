<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>Protests motives distribution across spanish regions</title>

  <meta property="description" itemprop="description" content="Map graph with pie charts from Spanish National Atlas (ANE) that shows protests motives distribution across spanish provinces in 2022. The represented data comes from the 2022 statistical yearbook on protests published by the Spanish Ministry of Interior."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2026-01-12"/>
  <meta property="article:created" itemprop="dateCreated" content="2026-01-12"/>
  <meta name="article:author" content="Alicia Mira Guirao"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Protests motives distribution across spanish regions"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Map graph with pie charts from Spanish National Atlas (ANE) that shows protests motives distribution across spanish provinces in 2022. The represented data comes from the 2022 statistical yearbook on protests published by the Spanish Ministry of Interior."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Protests motives distribution across spanish regions"/>
  <meta property="twitter:description" content="Map graph with pie charts from Spanish National Atlas (ANE) that shows protests motives distribution across spanish provinces in 2022. The represented data comes from the 2022 statistical yearbook on protests published by the Spanish Ministry of Interior."/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","categories","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["Protests motives distribution across spanish regions"]},{"type":"character","attributes":{},"value":["Map graph with pie charts from Spanish National Atlas (ANE) that shows protests motives distribution across spanish provinces in 2022. The represented data comes from the 2022 statistical yearbook on protests published by the Spanish Ministry of Interior."]},{"type":"character","attributes":{},"value":["2025"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Alicia Mira Guirao"]}]}]},{"type":"character","attributes":{},"value":["2026-01-12"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["100453622_files/anchor-4.2.2/anchor.min.js","100453622_files/bowser-1.9.3/bowser.min.js","100453622_files/distill-2.2.21/template.v2.js","100453622_files/figure-html5/Canary Island Map-1.png","100453622_files/figure-html5/Plotting final map-1.png","100453622_files/figure-html5/Plotting the final version-1.png","100453622_files/figure-html5/unnamed-chunk-1-1.png","100453622_files/figure-html5/unnamed-chunk-1-2.png","100453622_files/figure-html5/unnamed-chunk-18-1.png","100453622_files/figure-html5/unnamed-chunk-28-1.png","100453622_files/figure-html5/unnamed-chunk-9-1.png","100453622_files/header-attrs-2.29/header-attrs.js","100453622_files/jquery-3.6.0/jquery-3.6.0.js","100453622_files/jquery-3.6.0/jquery-3.6.0.min.js","100453622_files/jquery-3.6.0/jquery-3.6.0.min.map","100453622_files/popper-2.6.0/popper.min.js","100453622_files/tippy-6.2.7/tippy-bundle.umd.min.js","100453622_files/tippy-6.2.7/tippy-light-border.css","100453622_files/tippy-6.2.7/tippy.css","100453622_files/tippy-6.2.7/tippy.umd.min.js","100453622_files/webcomponents-2.0.0/webcomponents.js","Gráfico original.jpg","ImprovementDataBase.xlsx","ReplicationDataBase.xlsx"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  hr.section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    margin: 0px;
  }


  d-byline {
    border-top: none;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
    border-top: none;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  /* tweak for Pandoc numbered line within distill */
  d-article pre.numberSource code > span {
      left: -2em;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // separator
    var separator = '<hr class="section-separator" style="clear: both"/>';
    // prepend separator above appendix
    $('.d-byline').before(separator);
    $('.d-article').before(separator);

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme, except when numbering line
    // in code chunk
    $('pre:not(.numberLines) code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        var author_name = front_matter.authors[i].author
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="100453622_files/header-attrs-2.29/header-attrs.js"></script>
  <script src="100453622_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="100453622_files/popper-2.6.0/popper.min.js"></script>
  <link href="100453622_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="100453622_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="100453622_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="100453622_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="100453622_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="100453622_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="100453622_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Protests motives distribution across spanish regions","description":"Map graph with pie charts from Spanish National Atlas (ANE) that shows protests motives distribution across spanish provinces in 2022. The represented data comes from the 2022 statistical yearbook on protests published by the Spanish Ministry of Interior.","authors":[{"author":"Alicia Mira Guirao","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2026-01-12T00:00:00.000+01:00","citationText":"Guirao, 2026"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Protests motives distribution across spanish regions</h1>

<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt-tag">2025</div>
</div>
<!--/radix_placeholder_categories-->
<p>Map graph with pie charts from Spanish National Atlas (ANE) that shows protests motives distribution across spanish provinces in 2022. The represented data comes from the 2022 statistical yearbook on protests published by the Spanish Ministry of Interior.</p>
</div>

<div class="d-byline">
  
  Alicia Mira Guirao
  
<br/>2026-01-12
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#introduction" id="toc-introduction">Introduction</a></li>
<li><a href="#replication" id="toc-replication">Replication</a></li>
<li><a href="#plotting-canary-island-map" id="toc-plotting-canary-island-map">Plotting Canary island Map</a></li>
<li><a href="#plotting-final-map" id="toc-plotting-final-map">Plotting final map</a></li>
<li><a href="#alternative-graph-version" id="toc-alternative-graph-version">Alternative graph version</a></li>
<li><a href="#plotting-the-graph" id="toc-plotting-the-graph">Plotting the graph</a></li>
<li><a href="#limitations-and-conclusions" id="toc-limitations-and-conclusions">Limitations and conclusions</a></li>
</ul>
</nav>
</div>
<h3 id="introduction">Introduction</h3>
<p>The statistical yearbooks on protests from the Spanish Ministry of Interior are official publications that collect and systematize diverse information about the Ministry’s different areas of competence, such as the exercise of fundamental rights like participating in demonstrations and public gatherings.</p>
<p>This analysis examines the Spanish protest distribution across provinces trough motive categories. I chose to work with this dataset because I found the data particularly interesting for understanding territorial variations in protest activity.</p>
<h4 id="original-chart">Original Chart</h4>
<p>The original graphic is an pie-chart map in which a distinctive color represents different protest motives. In addition, the pie-chart size vary depending on the number of protests for each region. The graph contains some texts specifying characteristics from the collected data (for example, data for Catalonia and the Basque Country is not available because it is under competence of their regional governments).</p>
<figure>
<img src="Gra%CC%81fico%20original.jpg" class="external" style="width:100.0%" alt="Pie-chart map. Source: Atlas Nacional de España (ANE)" />
<figcaption aria-hidden="true">Pie-chart map. Source: Atlas Nacional de España (ANE)</figcaption>
</figure>
<h3 id="replication">Replication</h3>
<h4 id="libraries">Libraries</h4>
<p>The first step is to load all the libraries that will be used.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://juliasilge.github.io/tidytext/'>tidytext</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://readxl.tidyverse.org'>readxl</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://r-spatial.github.io/sf/'>sf</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ropengov.github.io/giscoR/'>giscoR</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ropenspain.github.io/mapSpain/'>mapSpain</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://docs.ropensci.org/rnaturalearth/'>rnaturalearth</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://docs.ropensci.org/rnaturalearthdata/'>rnaturalearthdata</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>grid</span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/yixuan/showtext'>showtext</a></span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="fonts">Fonts</h4>
<p>Next, necessary fonts for the replicated graph have to be loaded from Google fonts.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/showtext/man/showtext_auto.html'>showtext_auto</a></span><span class='op'>(</span><span class='op'>)</span> </span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/sysfonts/man/font_add_google.html'>font_add_google</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"Lexend Deca"</span>, </span>
<span>                family <span class='op'>=</span> <span class='st'>"Lexend"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="data-import">Data Import</h4>
<p>Obtaining the data was not a difficult step since it is publicly available on the Ministry of Interior website with its respective statistical yearbook inform.</p>
<p>The main issue with I faced with the data was dealing with the “Other Motives” category. A footnote explains that this category includes “migration, drug trafficking, terrorism, nationalism and 1st of may -related matters.” But, in reality, this category does not contain only those specific types of protests. It actually includes many other protest motives that are not published anywhere. I realized this while working with the database and seeing that, to create those pie-charts, those least frequent protest categories – migration, drug trafficking (…) – were incorporated into the “Others”category, but nowhere is it publicly explained what the “Other” category includes itself, apart from that motives added later.</p>
<p>This is a significant problem, as “Other Motives” represents the second most frequent category nationwide, and its composition remains unclear.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>protests</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span><span class='st'>"ReplicationDataBase.xlsx"</span>, </span>
<span>                   sheet <span class='op'>=</span> <span class='st'>"TABLA 1-3-7"</span>,</span>
<span>                   skip <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='co'># skipping the title</span></span>
<span></span>
<span><span class='va'>prov</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ropenspain.github.io/mapSpain/reference/esp_get_prov.html'>esp_get_prov</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>neighbors</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ropengov.github.io/giscoR/reference/gisco_get.html'>gisco_get_countries</a></span><span class='op'>(</span></span>
<span>  country <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Portugal"</span>, <span class='st'>"France"</span>, <span class='st'>"Morocco"</span>, <span class='st'>"Algeria"</span>, <span class='st'>"Andorra"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Adding those that are left because they are named differently in INE</span></span>
<span><span class='va'>protests</span> <span class='op'>&lt;-</span> <span class='va'>protests</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    `Comunidad autónoma y provincia` <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/recode.html'>recode</a></span><span class='op'>(</span></span>
<span>      <span class='va'>`Comunidad autónoma y provincia`</span>,</span>
<span>      <span class='st'>"Murcia, Región de"</span> <span class='op'>=</span> <span class='st'>"Murcia"</span>,</span>
<span>      <span class='st'>"Navarra, Comunidad Foral de"</span> <span class='op'>=</span> <span class='st'>"Navarra"</span>,</span>
<span>      <span class='st'>"Madrid, Comunidad de"</span>    <span class='op'>=</span> <span class='st'>"Madrid"</span>,</span>
<span>      <span class='st'>"Asturias, Principado de"</span>  <span class='op'>=</span> <span class='st'>"Asturias"</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># Filtering only provinces</span></span>
<span><span class='va'>data_prov</span> <span class='op'>&lt;-</span> <span class='va'>protests</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>`Comunidad autónoma y provincia`</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>prov</span><span class='op'>$</span><span class='va'>ine.prov.name</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Jonning shapefile with filtered dataframe</span></span>
<span><span class='va'>protest_prov</span> <span class='op'>&lt;-</span> <span class='va'>prov</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>data_prov</span>, </span>
<span>            by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ine.prov.name"</span> <span class='op'>=</span> <span class='st'>"Comunidad autónoma y provincia"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Creating data for canary islands map</span></span>
<span><span class='va'>canarias_data</span> <span class='op'>&lt;-</span> <span class='va'>protest_prov</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>ine.prov.name</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Palmas, Las"</span>, <span class='st'>"Santa Cruz de Tenerife"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Creating data for peninsula and baleares map</span></span>
<span><span class='va'>peninsula_data</span> <span class='op'>&lt;-</span> <span class='va'>protest_prov</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='va'>ine.prov.name</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Palmas, Las"</span>, <span class='st'>"Santa Cruz de Tenerife"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Once I imported the data, I uploaded through the function gisco_get_countries() spanish neighbour countries that, even they do not cointain any info, appear in the map to locate Spain on the globe. Then, I filtered only the provinces and left-joined it with their shapefiles so we can get the geometry of each region with its respective protest information inside the same dataset. After that, I separated data of the peninsula and Baleares islands from the Canary islands, since different maps for each will have to be created.</p>
<p>Next I obtained the centroides of each province for pie-charts and then I moved them as in the original graph, summing or subtracting coordenates, since most of them are not exactly in the center of the area:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>peninsula_data</span> <span class='op'>&lt;-</span> <span class='va'>peninsula_data</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    centroide <span class='op'>=</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/geos_unary.html'>st_centroid</a></span><span class='op'>(</span><span class='va'>geometry</span><span class='op'>)</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_coordinates.html'>st_coordinates</a></span><span class='op'>(</span><span class='va'>centroide</span><span class='op'>)</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span>,</span>
<span>    y <span class='op'>=</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_coordinates.html'>st_coordinates</a></span><span class='op'>(</span><span class='va'>centroide</span><span class='op'>)</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>]</span>,</span>
<span></span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>      <span class='va'>ine.prov.name</span> <span class='op'>==</span> <span class='st'>"Segovia"</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>+</span> <span class='fl'>0.2</span>,</span>
<span>      <span class='va'>ine.prov.name</span> <span class='op'>==</span> <span class='st'>"Toledo"</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>-</span> <span class='fl'>0.45</span>,</span>
<span>      <span class='va'>ine.prov.name</span> <span class='op'>==</span> <span class='st'>"Pontevedra"</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>-</span> <span class='fl'>0.2</span>,</span>
<span>      <span class='va'>ine.prov.name</span> <span class='op'>==</span> <span class='st'>"Sevilla"</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>-</span> <span class='fl'>0.05</span>,</span>
<span>      <span class='va'>ine.prov.name</span> <span class='op'>==</span> <span class='st'>"Granada"</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>-</span> <span class='fl'>0.4</span>,</span>
<span>      <span class='va'>ine.prov.name</span> <span class='op'>==</span> <span class='st'>"Almería"</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>+</span> <span class='fl'>0.1</span>,</span>
<span>      <span class='va'>ine.prov.name</span> <span class='op'>==</span> <span class='st'>"Murcia"</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>+</span> <span class='fl'>0.1</span>,</span>
<span>      <span class='va'>ine.prov.name</span> <span class='op'>==</span> <span class='st'>"Alicante/Alacant"</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>+</span> <span class='fl'>0.25</span>,</span>
<span>      <span class='va'>ine.prov.name</span> <span class='op'>==</span> <span class='st'>"Castellón/Castelló"</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>+</span> <span class='fl'>0.25</span>,</span>
<span>      <span class='va'>ine.prov.name</span> <span class='op'>==</span> <span class='st'>"Valencia/València"</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>+</span> <span class='fl'>0.4</span>,</span>
<span>      <span class='va'>ine.prov.name</span> <span class='op'>==</span> <span class='st'>"Balears, Illes"</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>-</span> <span class='fl'>0.3</span>,</span>
<span>      <span class='va'>ine.prov.name</span> <span class='op'>==</span> <span class='st'>"Guadalajara"</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>+</span> <span class='fl'>0.2</span>,</span>
<span>      <span class='va'>ine.prov.name</span> <span class='op'>==</span> <span class='st'>"Ceuta"</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>+</span> <span class='fl'>0.35</span>,</span>
<span>      <span class='va'>ine.prov.name</span> <span class='op'>==</span> <span class='st'>"Melilla"</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>+</span> <span class='fl'>0.25</span>,</span>
<span>      <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='va'>x</span>                                 </span>
<span>    <span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>      <span class='va'>ine.prov.name</span> <span class='op'>==</span> <span class='st'>"Segovia"</span> <span class='op'>~</span> <span class='va'>y</span> <span class='op'>+</span> <span class='fl'>0.35</span>,</span>
<span>      <span class='va'>ine.prov.name</span> <span class='op'>==</span> <span class='st'>"Coruña, A"</span> <span class='op'>~</span> <span class='va'>y</span> <span class='op'>+</span> <span class='fl'>0.1</span>,</span>
<span>      <span class='va'>ine.prov.name</span> <span class='op'>==</span> <span class='st'>"Pontevedra"</span> <span class='op'>~</span> <span class='va'>y</span> <span class='op'>-</span> <span class='fl'>0.3</span>,</span>
<span>      <span class='va'>ine.prov.name</span> <span class='op'>==</span> <span class='st'>"Navarra"</span> <span class='op'>~</span> <span class='va'>y</span> <span class='op'>+</span> <span class='fl'>0.25</span>,</span>
<span>      <span class='va'>ine.prov.name</span> <span class='op'>==</span> <span class='st'>"Sevilla"</span> <span class='op'>~</span> <span class='va'>y</span> <span class='op'>+</span> <span class='fl'>0.25</span>,</span>
<span>      <span class='va'>ine.prov.name</span> <span class='op'>==</span> <span class='st'>"Granada"</span> <span class='op'>~</span> <span class='va'>y</span> <span class='op'>-</span> <span class='fl'>0.15</span>,</span>
<span>      <span class='va'>ine.prov.name</span> <span class='op'>==</span> <span class='st'>"Almería"</span> <span class='op'>~</span> <span class='va'>y</span> <span class='op'>-</span> <span class='fl'>0.1</span>,</span>
<span>      <span class='va'>ine.prov.name</span> <span class='op'>==</span> <span class='st'>"Murcia"</span> <span class='op'>~</span> <span class='va'>y</span> <span class='op'>-</span> <span class='fl'>0.25</span>,</span>
<span>      <span class='va'>ine.prov.name</span> <span class='op'>==</span> <span class='st'>"Asturias"</span> <span class='op'>~</span> <span class='va'>y</span> <span class='op'>+</span> <span class='fl'>0.2</span>,</span>
<span>      <span class='va'>ine.prov.name</span> <span class='op'>==</span> <span class='st'>"Cantabria"</span> <span class='op'>~</span> <span class='va'>y</span> <span class='op'>+</span> <span class='fl'>0.2</span>,</span>
<span>      <span class='va'>ine.prov.name</span> <span class='op'>==</span> <span class='st'>"Alicante/Alacant"</span> <span class='op'>~</span> <span class='va'>y</span> <span class='op'>-</span> <span class='fl'>0.2</span>,</span>
<span>      <span class='va'>ine.prov.name</span> <span class='op'>==</span> <span class='st'>"Valencia/València"</span> <span class='op'>~</span> <span class='va'>y</span> <span class='op'>+</span> <span class='fl'>0.1</span>,</span>
<span>      <span class='va'>ine.prov.name</span> <span class='op'>==</span> <span class='st'>"Ceuta"</span> <span class='op'>~</span> <span class='va'>y</span> <span class='op'>-</span> <span class='fl'>0.1</span>,</span>
<span>      <span class='va'>ine.prov.name</span> <span class='op'>==</span> <span class='st'>"Melilla"</span> <span class='op'>~</span> <span class='va'>y</span> <span class='op'>+</span> <span class='fl'>0.1</span>,</span>
<span>      <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='va'>y</span>                                  <span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>canarias_data</span> <span class='op'>&lt;-</span> <span class='va'>canarias_data</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    centroide <span class='op'>=</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/geos_unary.html'>st_centroid</a></span><span class='op'>(</span><span class='va'>geometry</span><span class='op'>)</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_coordinates.html'>st_coordinates</a></span><span class='op'>(</span><span class='va'>centroide</span><span class='op'>)</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span>,</span>
<span>    y <span class='op'>=</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_coordinates.html'>st_coordinates</a></span><span class='op'>(</span><span class='va'>centroide</span><span class='op'>)</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>]</span>,</span>
<span></span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span><span class='va'>ine.prov.name</span> <span class='op'>==</span> <span class='st'>"Palmas, Las"</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>-</span> <span class='fl'>0.2</span>,</span>
<span>      <span class='va'>ine.prov.name</span> <span class='op'>==</span> <span class='st'>"Santa Cruz de Tenerife"</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>-</span> <span class='fl'>0.3</span>,</span>
<span>            <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='va'>x</span>                                 <span class='op'>)</span>,</span>
<span>     y <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>      <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='va'>y</span>                                  <span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>I renamed the “Other Motives” category by adding an asterisk, as shown in the original graph. I created a vector containing all protest motives and regrouped them so that the least frequent categories are counted under “Other motives”. I also created a vector following the same order as the original legend, and another one establishing their respective colors:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Renaming names legend from the dataset as in the original graph </span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>peninsula_data</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>39</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"Otras motivaciones*"</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>canarias_data</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>39</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"Otras motivaciones*"</span></span>
<span></span>
<span><span class='co'># Creation of a vector of protest motives</span></span>
<span><span class='va'>motivo_cols</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>  <span class='st'>"Temas laborales"</span>,</span>
<span>  <span class='st'>"Temas de inmigración"</span>,</span>
<span>  <span class='st'>"Asuntos vecinales"</span>,</span>
<span>  <span class='st'>"Contra la droga y la delincuencia"</span>,</span>
<span>  <span class='st'>"Apoyo a grupos terroristas"</span>,</span>
<span>  <span class='st'>"Libertad de presos de grupos terroristas"</span>,</span>
<span>  <span class='st'>"Contra el terrorismo"</span>,</span>
<span>  <span class='st'>"Enseñanza"</span>,</span>
<span>  <span class='st'>"Temas nacionalistas"</span>, </span>
<span>  <span class='st'>"Contra medidas políticas y legislativas"</span>,</span>
<span>  <span class='st'>"Sanidad"</span>,</span>
<span>  <span class='st'>"Agrarias"</span>,</span>
<span>  <span class='st'>"Ecologistas"</span>,</span>
<span>  <span class='st'>"Contra la violencia de género"</span>,</span>
<span>  <span class='st'>"1º de Mayo"</span>,</span>
<span>  <span class='st'>"Otras motivaciones*"</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Regrouping motives as in the graphic</span></span>
<span><span class='va'>motivo_cols</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>  <span class='va'>motivo_cols</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"Temas de inmigración"</span>,</span>
<span>    <span class='st'>"Contra la droga y la delincuencia"</span>,</span>
<span>    <span class='st'>"Contra el terrorismo"</span>,</span>
<span>    <span class='st'>"Libertad de presos de grupos terroristas"</span>,</span>
<span>    <span class='st'>"Apoyo a grupos terroristas"</span>,</span>
<span>    <span class='st'>"Temas nacionalistas"</span>,</span>
<span>    <span class='st'>"1º de Mayo"</span>,</span>
<span>    <span class='st'>"Otras motivaciones*"</span></span>
<span>  <span class='op'>)</span> <span class='op'>~</span> <span class='st'>"Otras motivaciones*"</span>,</span>
<span>  <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='va'>motivo_cols</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Ordering motives as in the legend from the graph </span></span>
<span><span class='va'>orden_deseado</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>  <span class='st'>"Temas laborales"</span>,</span>
<span>  <span class='st'>"Asuntos vecinales"</span>,</span>
<span>  <span class='st'>"Enseñanza"</span>,</span>
<span>  <span class='st'>"Contra medidas políticas\ny legislativas"</span>,</span>
<span>  <span class='st'>"Sanidad"</span>,</span>
<span>  <span class='st'>"Agrarias"</span>,</span>
<span>  <span class='st'>"Ecologistas"</span>,</span>
<span>  <span class='st'>"Contra la violencia\nde género"</span>,</span>
<span>  <span class='st'>"Otras motivaciones*"</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Colors for each motive</span></span>
<span><span class='va'>colores_motivos</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>  <span class='st'>"Temas laborales"</span> <span class='op'>=</span> <span class='st'>"#de5424"</span>,              </span>
<span>  <span class='st'>"Asuntos vecinales"</span> <span class='op'>=</span> <span class='st'>"#e0945d"</span>,            </span>
<span>  <span class='st'>"Enseñanza"</span> <span class='op'>=</span> <span class='st'>"#63a4bc"</span>,                    </span>
<span>  <span class='st'>"Contra medidas políticas\ny legislativas"</span> <span class='op'>=</span> <span class='st'>"#848ab5"</span>,</span>
<span>  <span class='st'>"Sanidad"</span> <span class='op'>=</span> <span class='st'>"#95bb9e"</span>,                     </span>
<span>  <span class='st'>"Agrarias"</span> <span class='op'>=</span> <span class='st'>"#ebd98c"</span>,                     </span>
<span>  <span class='st'>"Ecologistas"</span> <span class='op'>=</span> <span class='st'>"#b7c27e"</span>,                </span>
<span>  <span class='st'>"Contra la violencia\nde género"</span><span class='op'>=</span> <span class='st'>"#a47297"</span>,</span>
<span>  <span class='st'>"Otras motivaciones*"</span> <span class='op'>=</span> <span class='st'>"#8a898a"</span>        </span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>After that, I created data frames containing specific data for the peninsula and Baleares pie-charts in order to calculate proportions for each province, due to pie-charts size tell us the number of protest happenned:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Turning characteres into numeric in order to calculate proportions</span></span>
<span><span class='va'>peninsula_data</span> <span class='op'>&lt;-</span> <span class='va'>peninsula_data</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/across.html'>across</a></span><span class='op'>(</span></span>
<span>    .cols <span class='op'>=</span> <span class='fu'><a href='https://tidyselect.r-lib.org/reference/all_of.html'>all_of</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>motivo_cols</span>, <span class='st'>"Total"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>.</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>canarias_data</span> <span class='op'>&lt;-</span> <span class='va'>canarias_data</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/across.html'>across</a></span><span class='op'>(</span></span>
<span>    .cols <span class='op'>=</span> <span class='fu'><a href='https://tidyselect.r-lib.org/reference/all_of.html'>all_of</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>motivo_cols</span>, <span class='st'>"Total"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>.</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Creating data for pie charts</span></span>
<span><span class='va'>pies_peninsula</span> <span class='op'>&lt;-</span> <span class='va'>peninsula_data</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>ine.prov.name</span>, <span class='va'>x</span>, <span class='va'>y</span>, <span class='fu'><a href='https://tidyselect.r-lib.org/reference/all_of.html'>all_of</a></span><span class='op'>(</span><span class='va'>motivo_cols</span><span class='op'>)</span>, <span class='va'>Total</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span></span>
<span>    cols      <span class='op'>=</span> <span class='fu'><a href='https://tidyselect.r-lib.org/reference/all_of.html'>all_of</a></span><span class='op'>(</span><span class='va'>motivo_cols</span><span class='op'>)</span>,</span>
<span>    names_to  <span class='op'>=</span> <span class='st'>"motivo"</span>,             </span>
<span>    values_to <span class='op'>=</span> <span class='st'>"valor"</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># recoding names to be shown in two lines</span></span>
<span>    motivo <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/recode.html'>recode</a></span><span class='op'>(</span></span>
<span>      <span class='va'>motivo</span>,</span>
<span>      <span class='st'>"Contra medidas políticas y legislativas"</span> <span class='op'>=</span> <span class='st'>"Contra medidas políticas\ny legislativas"</span>,</span>
<span>      <span class='st'>"Contra la violencia de género"</span> <span class='op'>=</span> <span class='st'>"Contra la violencia\nde género"</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    <span class='co'># converting into factor establishing the order </span></span>
<span>    motivo <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>motivo</span>, levels <span class='op'>=</span> <span class='va'>orden_deseado</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>ine.prov.name</span>, <span class='va'>motivo</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>ine.prov.name</span><span class='op'>)</span> <span class='op'>|&gt;</span>             </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    prop <span class='op'>=</span> <span class='va'>valor</span> <span class='op'>/</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>valor</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,    </span>
<span>    angle_end <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>prop</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>2</span> <span class='op'>*</span> <span class='va'>pi</span>,         </span>
<span>    angle_start <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/lead-lag.html'>lag</a></span><span class='op'>(</span><span class='va'>angle_end</span>, default <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span> </span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Pie proportion for each province</span></span>
<span><span class='va'>max_total</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>pies_peninsula</span><span class='op'>$</span><span class='va'>Total</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span><span class='va'>factor_escala</span> <span class='op'>&lt;-</span> <span class='fl'>0.9</span>  </span>
<span></span>
<span><span class='va'>pies_peninsula</span> <span class='op'>&lt;-</span> <span class='va'>pies_peninsula</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    radius <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>Total</span> <span class='op'>/</span> <span class='va'>max_total</span><span class='op'>)</span> <span class='op'>*</span> <span class='va'>factor_escala</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Then I did same process for Canary island pie charts:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Same process for canary island pies</span></span>
<span><span class='va'>canarias_pies</span> <span class='op'>&lt;-</span> <span class='va'>canarias_data</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>ine.prov.name</span>, <span class='va'>x</span>, <span class='va'>y</span>, <span class='fu'><a href='https://tidyselect.r-lib.org/reference/all_of.html'>all_of</a></span><span class='op'>(</span><span class='va'>motivo_cols</span><span class='op'>)</span>, <span class='va'>Total</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span></span>
<span>    cols      <span class='op'>=</span> <span class='fu'><a href='https://tidyselect.r-lib.org/reference/all_of.html'>all_of</a></span><span class='op'>(</span><span class='va'>motivo_cols</span><span class='op'>)</span>,</span>
<span>    names_to  <span class='op'>=</span> <span class='st'>"motivo"</span>,             </span>
<span>    values_to <span class='op'>=</span> <span class='st'>"valor"</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span></span>
<span>    motivo <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/recode.html'>recode</a></span><span class='op'>(</span></span>
<span>      <span class='va'>motivo</span>,</span>
<span>      <span class='st'>"Contra medidas políticas y legislativas"</span> <span class='op'>=</span> <span class='st'>"Contra medidas políticas\ny legislativas"</span>,</span>
<span>      <span class='st'>"Contra la violencia de género"</span> <span class='op'>=</span> <span class='st'>"Contra la violencia\nde género"</span></span>
<span>    <span class='op'>)</span>,</span>
<span></span>
<span>    motivo <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>motivo</span>, levels <span class='op'>=</span> <span class='va'>orden_deseado</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>ine.prov.name</span>, <span class='va'>motivo</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>ine.prov.name</span><span class='op'>)</span> <span class='op'>|&gt;</span>             </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    prop <span class='op'>=</span> <span class='va'>valor</span> <span class='op'>/</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>valor</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,    </span>
<span>    angle_end <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>prop</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>2</span> <span class='op'>*</span> <span class='va'>pi</span>,         </span>
<span>    angle_start <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/lead-lag.html'>lag</a></span><span class='op'>(</span><span class='va'>angle_end</span>, default <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span> </span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>max_total</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>canarias_pies</span><span class='op'>$</span><span class='va'>Total</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span><span class='va'>factor_escala</span> <span class='op'>&lt;-</span> <span class='fl'>0.4</span></span>
<span></span>
<span><span class='va'>canarias_pies</span> <span class='op'>&lt;-</span> <span class='va'>canarias_pies</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    radius <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>Total</span> <span class='op'>/</span> <span class='va'>max_total</span><span class='op'>)</span> <span class='op'>*</span> <span class='va'>factor_escala</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 id="plotting-canary-island-map">Plotting Canary island Map</h3>
<h4 id="map-base-creation">Map base creation</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>mapa_canarias</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsf.html'>geom_sf</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>canarias_data</span>,</span>
<span>    fill <span class='op'>=</span> <span class='st'>"#FEFAE0"</span>,   </span>
<span>    color <span class='op'>=</span> <span class='st'>"#4D5662"</span>,      </span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.3</span></span>
<span>  <span class='op'>)</span> </span></code></pre>
</div>
</div>
<h4 id="protest-data-pie-charts">Protest data pie-charts</h4>
<p>I added the proportional pie charts for protest data using canarias_pies data (specific to Canary Islands)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>mapa_canarias</span> <span class='op'>&lt;-</span> <span class='va'>mapa_canarias</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'>ggforce</span><span class='fu'>::</span><span class='fu'><a href='https://ggforce.data-imaginist.com/reference/geom_arc_bar.html'>geom_arc_bar</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>canarias_pies</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span></span>
<span>      x0 <span class='op'>=</span> <span class='va'>x</span>,</span>
<span>      y0 <span class='op'>=</span> <span class='va'>y</span>,</span>
<span>      r0 <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>      r <span class='op'>=</span> <span class='va'>radius</span>,</span>
<span>      start <span class='op'>=</span> <span class='va'>angle_start</span>,</span>
<span>      end <span class='op'>=</span> <span class='va'>angle_end</span>,</span>
<span>      fill <span class='op'>=</span> <span class='va'>motivo</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span>,</span>
<span>    alpha <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="color-scale">Color Scale</h4>
<p>I added the previous made color scale for each protest motive.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>mapa_canarias</span> <span class='op'>&lt;-</span> <span class='va'>mapa_canarias</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>colores_motivos</span><span class='op'>)</span> </span></code></pre>
</div>
</div>
<h4 id="coordinate-system">Coordinate system</h4>
<p>I used expand = FALSE for no extra space around the islands, focusing only on that specific area.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span> <span class='va'>mapa_canarias</span> <span class='op'>&lt;-</span> <span class='va'>mapa_canarias</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsf.html'>coord_sf</a></span><span class='op'>(</span></span>
<span>    expand <span class='op'>=</span> <span class='cn'>FALSE</span>,   </span>
<span>    clip <span class='op'>=</span> <span class='st'>"off"</span><span class='op'>)</span> </span></code></pre>
</div>
</div>
<h4 id="theme-customization">Theme Customization</h4>
<p>Custom theme settings: background colors (Light blue fill), white 5pt border (creates “frame” effect), custom margins as in the original graph.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span> <span class='va'>mapa_canarias</span> <span class='op'>&lt;-</span> <span class='va'>mapa_canarias</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_void</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    legend.position <span class='op'>=</span> <span class='st'>"none"</span>,</span>
<span>    plot.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span></span>
<span>      fill <span class='op'>=</span> <span class='st'>"#e6ffff"</span>,</span>
<span>      color <span class='op'>=</span> <span class='st'>"#ffffff"</span>,        </span>
<span>      linewidth <span class='op'>=</span> <span class='fl'>5</span> </span>
<span>    <span class='op'>)</span>,</span>
<span>    panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>     plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>3</span>,<span class='fl'>3</span>,<span class='fl'>8</span>,<span class='fl'>33</span>, <span class='st'>"pt"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="converting-to-graphical-object">Converting to graphical object</h4>
<p>I converted the canary island into a graphical object (grob) to be inserted in the final map.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>grob_canarias</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplotGrob.html'>ggplotGrob</a></span><span class='op'>(</span><span class='va'>mapa_canarias</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>mapa_canarias</span></span></code></pre>
</div>
<p><img src="100453622_files/figure-html5/unnamed-chunk-9-1.png" width="624" /></p>
</div>
<h4 id="pie-charts-size-legend">Pie-charts size legend</h4>
<p>This chunk creates a size legend for proportional pie charts on a map. It defines seven size classes representing the total number of protests, ranging from 58 to 4,251. The legend uses circles whose areas are proportional to the values they represent, calculated using the formula sqrt(value / π) * scale_factor.</p>
<p>The circles are vertically stacked at a fixed longitude (x = -11) with their Y-coordinates calculated to prevent overlapping. Display labels use thousand separators for readability (e.g., “1.000” instead of “949”). The final tibble contains all necessary positioning data, including circle centers, radios, and starting coordinates for plotting.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>valores_reales</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>58</span>, <span class='fl'>252</span>, <span class='fl'>949</span>, <span class='fl'>1579</span>, <span class='fl'>2464</span>, <span class='fl'>3498</span>, <span class='fl'>4241</span><span class='op'>)</span></span>
<span><span class='va'>etiquetas_display</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"58"</span>, <span class='st'>"250"</span>, <span class='st'>"1.000"</span>, <span class='st'>"1.500"</span>, <span class='st'>"2.500"</span>, <span class='st'>"3.500"</span>, <span class='st'>"4.251"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>max_total_peninsula</span> <span class='op'>&lt;-</span> <span class='fl'>4251</span></span>
<span></span>
<span><span class='va'>factor_escala_leyenda</span> <span class='op'>&lt;-</span> <span class='fl'>0.020</span></span>
<span></span>
<span><span class='va'>radios</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>valores_reales</span> <span class='op'>/</span> <span class='va'>pi</span><span class='op'>)</span> <span class='op'>*</span> <span class='va'>factor_escala_leyenda</span></span>
<span></span>
<span><span class='va'>y_base_comun</span> <span class='op'>&lt;-</span> <span class='fl'>41.9</span> </span>
<span></span>
<span><span class='va'>y_centers</span> <span class='op'>&lt;-</span> <span class='va'>y_base_comun</span> <span class='op'>+</span> <span class='va'>radios</span> </span>
<span></span>
<span><span class='va'>y_tops</span> <span class='op'>&lt;-</span> <span class='va'>y_centers</span> <span class='op'>+</span> <span class='va'>radios</span></span>
<span></span>
<span><span class='co'># Tibble with all the data</span></span>
<span><span class='va'>legend_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span></span>
<span>  manifestaciones <span class='op'>=</span> <span class='va'>valores_reales</span>,</span>
<span>  etiqueta <span class='op'>=</span> <span class='va'>etiquetas_display</span>,</span>
<span>  radius <span class='op'>=</span> <span class='va'>radios</span>,</span>
<span>  x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>11</span>,              <span class='co'># same X for every circle</span></span>
<span>  y <span class='op'>=</span> <span class='va'>y_centers</span>           <span class='co'># Y go increasingly</span></span>
<span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    x_start <span class='op'>=</span> <span class='va'>x</span> <span class='op'>-</span> <span class='va'>radius</span>,  <span class='co'># Left edge (instead of x + radius)</span></span>
<span>    y_start <span class='op'>=</span> <span class='va'>y</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 id="plotting-final-map">Plotting final map</h3>
<p>This is final replication of the peninsula and Baleares islands map with the inserted Canary islands GROB I made before.</p>
<h4 id="map-base-layers">Map base layers</h4>
<p>First, I created the base map using ggplot2. The first layer are neighboring countries (light gray fill, dark gray borders). Second layer spanish mainland provinces (cream color fill). I used geom_sf() for spatial data visualization.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>final_map</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>      <span class='co'># Neighbor Countries</span></span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsf.html'>geom_sf</a></span><span class='op'>(</span></span>
<span>        data <span class='op'>=</span> <span class='va'>neighbors</span>,</span>
<span>        fill <span class='op'>=</span> <span class='st'>"#D6D6D6"</span>, </span>
<span>        color <span class='op'>=</span> <span class='st'>"#4D5662"</span>,</span>
<span>        linewidth <span class='op'>=</span> <span class='fl'>0.3</span></span>
<span>      <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>      <span class='co'># Spanish provinces </span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsf.html'>geom_sf</a></span><span class='op'>(</span></span>
<span>        data <span class='op'>=</span> <span class='va'>peninsula_data</span>,</span>
<span>        fill <span class='op'>=</span> <span class='st'>"#FEFAE0"</span>,   </span>
<span>        color <span class='op'>=</span> <span class='st'>"#4D5662"</span>,      </span>
<span>        linewidth <span class='op'>=</span> <span class='fl'>0.3</span></span>
<span>      <span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="pie-charts-for-protest-data">Pie-charts for protest data</h4>
<p>Each pie chart location is determined by x and y coordinates. Each radius size represents total number of protests. Sectors/segments show distribution of protest motives.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>final_map</span> <span class='op'>&lt;-</span> <span class='va'>final_map</span> <span class='op'>+</span></span>
<span>      </span>
<span><span class='co'># Pie-charts</span></span>
<span>      <span class='fu'>ggforce</span><span class='fu'>::</span><span class='fu'><a href='https://ggforce.data-imaginist.com/reference/geom_arc_bar.html'>geom_arc_bar</a></span><span class='op'>(</span></span>
<span>        data <span class='op'>=</span> <span class='va'>pies_peninsula</span>,</span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span></span>
<span>          x0 <span class='op'>=</span> <span class='va'>x</span>,              </span>
<span>          y0 <span class='op'>=</span> <span class='va'>y</span>,              </span>
<span>          r0 <span class='op'>=</span> <span class='fl'>0</span>,             </span>
<span>          r <span class='op'>=</span> <span class='va'>radius</span>,          </span>
<span>          start <span class='op'>=</span> <span class='va'>angle_start</span>, </span>
<span>          end <span class='op'>=</span> <span class='va'>angle_end</span>,    </span>
<span>          fill <span class='op'>=</span> <span class='va'>motivo</span>,</span>
<span>          color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>        <span class='op'>)</span>,</span>
<span>        color <span class='op'>=</span> <span class='st'>"black"</span>,       </span>
<span>        linewidth <span class='op'>=</span> <span class='fl'>0.2</span>,</span>
<span>        alpha <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>      <span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="color-scale-for-protest-motives">Color scale for protest motives</h4>
<p>I applied custom colors to different protest motives through a predefined vector of colors.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>final_map</span> <span class='op'>&lt;-</span> <span class='va'>final_map</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span></span>
<span>        values <span class='op'>=</span> <span class='va'>colores_motivos</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="legend-customization">Legend customization</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Protest motives guides legend  </span></span>
<span><span class='va'>final_map</span> <span class='op'>&lt;-</span> <span class='va'>final_map</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span></span>
<span>      fill <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guide_legend.html'>guide_legend</a></span><span class='op'>(</span></span>
<span>        override.aes <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span></span>
<span>          shape <span class='op'>=</span> <span class='fl'>24</span>,     </span>
<span>          size <span class='op'>=</span> <span class='fl'>1.3</span>, <span class='co'>#2      </span></span>
<span>          color <span class='op'>=</span> <span class='st'>"black"</span>,  </span>
<span>          stroke <span class='op'>=</span> <span class='fl'>0.4</span>       </span>
<span>        <span class='op'>)</span>,</span>
<span>        byrow <span class='op'>=</span> <span class='cn'>TRUE</span>,        </span>
<span>        spacing.y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.8</span>, <span class='st'>"cm"</span><span class='op'>)</span></span>
<span>      <span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="pie-chart-sizes-legend">Pie-chart sizes legend</h4>
<p>I created a custom size legend showing what different pie chart radii represent, using half-circles with dotted lines to labels. It was not easy to find start = and end = values in order to create left semi-circles that start from the same y and finish in different increasingly y values. Finally it worked with start = -pi and end = 0 values.</p>
<p>Also I had to include inherit.aes = FALSE since I set coordinates before for creating the general map, so there were no crossing between both different aesthetics. Geom_text() add value labels for each circle size, geom_segment() joins those labels with the semi-circles. Annotation adds the main title for the legend.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>final_map</span> <span class='op'>&lt;-</span> <span class='va'>final_map</span> <span class='op'>+</span> </span>
<span>  <span class='fu'>ggforce</span><span class='fu'>::</span><span class='fu'><a href='https://ggforce.data-imaginist.com/reference/geom_arc_bar.html'>geom_arc_bar</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>legend_data</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span></span>
<span>      x0 <span class='op'>=</span> <span class='va'>x</span>,</span>
<span>      y0 <span class='op'>=</span> <span class='va'>y</span>,</span>
<span>      r0 <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>      r <span class='op'>=</span> <span class='va'>radius</span>,</span>
<span>      start <span class='op'>=</span> <span class='op'>-</span><span class='va'>pi</span>,      </span>
<span>      end <span class='op'>=</span> <span class='fl'>0</span>,      </span>
<span>      inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>  <span class='co'># No crossing with the aesthetics of coord_sf</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    fill <span class='op'>=</span> <span class='cn'>NA</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.4</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>legend_data</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span></span>
<span>      x <span class='op'>=</span> <span class='va'>x</span>,                   </span>
<span>      xend <span class='op'>=</span> <span class='va'>x</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>radius</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>0.35</span>,   </span>
<span>      y <span class='op'>=</span> <span class='va'>y_tops</span>,                      </span>
<span>      yend <span class='op'>=</span> <span class='va'>y_tops</span>           </span>
<span>    <span class='op'>)</span>,</span>
<span>    linetype <span class='op'>=</span> <span class='st'>"dotted"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>legend_data</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span></span>
<span>      x <span class='op'>=</span> <span class='va'>x</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>radius</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>0.15</span>,     </span>
<span>      y <span class='op'>=</span> <span class='va'>y_tops</span>,                      <span class='co'># Top part</span></span>
<span>      label <span class='op'>=</span> <span class='va'>etiqueta</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>1</span>,                        <span class='co'># Right side</span></span>
<span>    size <span class='op'>=</span> <span class='fl'>2.5</span>, <span class='co'># 4</span></span>
<span>    family <span class='op'>=</span> <span class='st'>"Lexend"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>11</span>,  </span>
<span>    y <span class='op'>=</span> <span class='fl'>43.65</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"MANIFESTACIONES\n2022"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>3.5</span>, <span class='co'># 6</span></span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0.5</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"plain"</span>,</span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="map-coordinates">Map coordinates</h4>
<p>I set the map extent to focus on the Iberian Peninsula</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>final_map</span> <span class='op'>&lt;-</span> <span class='va'>final_map</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsf.html'>coord_sf</a></span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>11.7</span>, <span class='fl'>3.8</span><span class='op'>)</span>, ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>35.2</span>, <span class='fl'>44</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="text-annotations">Text Annotations</h4>
<p>I used geom_text() to set all the written info and placed them through x = and y = values as in the original graph.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>final_map</span> <span class='op'>&lt;-</span> <span class='va'>final_map</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>        data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>          x <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>          y <span class='op'>=</span> <span class='fl'>44</span>,</span>
<span>          label <span class='op'>=</span> <span class='st'>"MANIFESTACIONES SEGÚN MOTIVACIÓN"</span></span>
<span>        <span class='op'>)</span>,</span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, label <span class='op'>=</span> <span class='va'>label</span><span class='op'>)</span>,</span>
<span>        size <span class='op'>=</span> <span class='fl'>5</span>, <span class='co'># 8</span></span>
<span>        fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>        hjust <span class='op'>=</span> <span class='fl'>1</span>,           <span class='co'># Right side</span></span>
<span>        vjust <span class='op'>=</span> <span class='fl'>1</span>,           <span class='co'># Top side</span></span>
<span>        color <span class='op'>=</span> <span class='st'>"black"</span></span>
<span>      <span class='op'>)</span> <span class='op'>+</span></span>
<span>      </span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>      data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>        x <span class='op'>=</span> <span class='fl'>4.15</span>,</span>
<span>        y <span class='op'>=</span> <span class='fl'>35.38</span>,</span>
<span>        label <span class='op'>=</span> <span class='st'>"Fuente: Anuario estadístico del Ministerio del Interior 2022"</span></span>
<span>      <span class='op'>)</span>,</span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, label <span class='op'>=</span> <span class='va'>label</span><span class='op'>)</span>,</span>
<span>      size <span class='op'>=</span> <span class='fl'>2.5</span>, <span class='co'># 4                  </span></span>
<span>      family <span class='op'>=</span> <span class='st'>"Lexend"</span>,</span>
<span>      hjust <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>      vjust <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>      color <span class='op'>=</span> <span class='st'>"black"</span></span>
<span>    <span class='op'>)</span> <span class='op'>+</span></span>
<span>    </span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>      data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>        x <span class='op'>=</span> <span class='fl'>4.15</span>,</span>
<span>        y <span class='op'>=</span> <span class='fl'>34.99</span>,              </span>
<span>        label <span class='op'>=</span> <span class='st'>"Atlas Nacional de España (ANE) CC BY 4.0 ign.es\n\nParticipantes:www.ign.es/resources/ane/participantes.pdf"</span></span>
<span>      <span class='op'>)</span>,</span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, label <span class='op'>=</span> <span class='va'>label</span><span class='op'>)</span>,</span>
<span>      size <span class='op'>=</span> <span class='fl'>2.5</span>, <span class='co'># 4</span></span>
<span>      family <span class='op'>=</span> <span class='st'>"Lexend"</span>,</span>
<span>      hjust <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>      vjust <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>      color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>      lineheight <span class='op'>=</span> <span class='fl'>0.4</span></span>
<span>    <span class='op'>)</span> <span class='op'>+</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>      data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>        x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>12.2</span>,</span>
<span>        y <span class='op'>=</span> <span class='fl'>37</span>,              </span>
<span>        label <span class='op'>=</span> <span class='st'>"*Incluye inmigración, droga y\n\ndelincuencia, apoyo a grupos\n\nterroristas, contra el terrorismo,\n\ntemas nacionalistas o 1ª de mayo\n\n\nCataluña y País Vasco sin datos"</span></span>
<span>      <span class='op'>)</span>,</span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, label <span class='op'>=</span> <span class='va'>label</span><span class='op'>)</span>,</span>
<span>      size <span class='op'>=</span> <span class='fl'>2.5</span>, <span class='co'># 4</span></span>
<span>      family <span class='op'>=</span> <span class='st'>"Lexend"</span>,</span>
<span>      hjust <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>      vjust <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>      color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>      lineheight <span class='op'>=</span> <span class='fl'>0.5</span>, </span>
<span>    <span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="visual-theming">Visual Theming</h4>
<p>The styling begins with theme_void(), which removes all default ggplot2 elements to provide a clean canvas, then adds a beige background to both the panel (where data is drawn) and plot areas (the entire graphic object).</p>
<p>Custom theme settings are made: background colors (white plot, light blue panel), legend positioning (left side, vertically centered) and other settings (no title, transparent background), font family (“Lexend”) and sizes. This code chunk applies comprehensive visual styling to the ggplot object g through the theme system.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span>    <span class='va'>final_map</span> <span class='op'>&lt;-</span> <span class='va'>final_map</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_void</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>      plot.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"#ffffff"</span>, </span>
<span>                                     color <span class='op'>=</span> <span class='st'>"#ffffff"</span>,</span>
<span>                                     linewidth <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>,</span>
<span>      panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"#e6ffff"</span> <span class='op'>)</span>,</span>
<span>      plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>5</span><span class='op'>)</span>,</span>
<span>      </span>
<span>      legend.spacing.y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.8</span>, <span class='st'>"cm"</span><span class='op'>)</span>,</span>
<span>      </span>
<span>      legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.012</span>, <span class='fl'>0.52</span><span class='op'>)</span>,</span>
<span>      legend.justification <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.5</span><span class='op'>)</span>,</span>
<span>      </span>
<span>      legend.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span></span>
<span>        size <span class='op'>=</span> <span class='fl'>7.5</span>, <span class='co'># 11.5 # hay que ajustar los valores a la escala de showtext() </span></span>
<span>        family <span class='op'>=</span> <span class='st'>"Lexend"</span>,</span>
<span>        lineheight <span class='op'>=</span> <span class='fl'>0.9</span></span>
<span>        <span class='op'>)</span>,</span>
<span>      </span>
<span>      legend.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>      legend.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>      </span>
<span>      legend.key <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span></span>
<span>    fill <span class='op'>=</span> <span class='st'>"#e6ffff"</span>,</span>
<span>    color <span class='op'>=</span> <span class='cn'>NA</span> <span class='op'>)</span></span>
<span>    <span class='op'>)</span> </span></code></pre>
</div>
</div>
<h4 id="canary-islands-inset-map">Canary Islands inset map</h4>
<p>I added the created canary islands map as a GROB (graphical object) in the bottom left corner of the general map. The chunk header specifies output parameters with fig.width=12, fig.height=7 and fig.showtext=TRUE to enable custom fonts.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Adding Grob (Canary island map)</span></span>
<span><span class='va'>final_map</span> <span class='op'>&lt;-</span> <span class='va'>final_map</span> <span class='op'>+</span> </span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_custom.html'>annotation_custom</a></span><span class='op'>(</span></span>
<span>    grob <span class='op'>=</span> <span class='va'>grob_canarias</span>,</span>
<span>    xmin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>12.87</span>,   </span>
<span>    xmax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>6.63</span>,    </span>
<span>    ymin <span class='op'>=</span> <span class='fl'>34.47</span>,    </span>
<span>    ymax <span class='op'>=</span> <span class='fl'>36.8</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>final_map</span></span></code></pre>
</div>
<p><img src="100453622_files/figure-html5/unnamed-chunk-18-1.png" width="1152" data-distill-preview=1 /></p>
</div>
<h3 id="alternative-graph-version">Alternative graph version</h3>
<p>Through this alternative data visualization I focused on how the distribution of protest motives varies across Spanish regions by comparing each region’s frequency percentage for a given motive to the national average.</p>
<p>I used data of the statistical yearbook on protest from the Spanish Ministry of Interior from 2024 instead of 2022 because of having more current relevance.</p>
<p>I also aggregated the data by autonomous community rather than province, re-grouped motives and focused only on the ten most frequent and relevant ones.</p>
<h4 id="fonts-import">Fonts import</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/showtext/man/showtext_auto.html'>showtext_auto</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/sysfonts/man/font_add_google.html'>font_add_google</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"Gravitas One"</span>, </span>
<span>                family <span class='op'>=</span> <span class='st'>"Gravitas"</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/sysfonts/man/font_add_google.html'>font_add_google</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"Lora"</span>, </span>
<span>                family <span class='op'>=</span> <span class='st'>"Lora"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="data-import-1">Data Import</h4>
<p>I added the data, created a tibble and filtered only the autonomous communities. I did not include the autonomous cities Ceuta and Melilla to avoid small-sample distortions. As very small regions, these autonomous cities register far fewer protests in absolute terms than other territories (approximately 70 annually versus hundreds in larger communities). This creates a methodological problem: when small numbers dominate the denominator, any category can appear disproportionately important. For example, if 50 of 70 total protests address labor-economic issues, this motive would rank at the top—not because it reflects genuine regional prioritization, but because the small demographic base amplifies what would otherwise be modest variation. Including these cities would thus introduce a scale-driven bias that obscures meaningful geographic patterns.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>improvdata</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span><span class='st'>"ImprovementDataBase.xlsx"</span>, </span>
<span>                   sheet <span class='op'>=</span> <span class='st'>"TABLA 1-3-7"</span>,</span>
<span>                   skip <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='co'># skipping the title</span></span>
<span></span>
<span></span>
<span><span class='va'>improvdata</span> <span class='op'>&lt;-</span> <span class='va'>improvdata</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>`Autonomous Communities` <span class='op'>=</span> <span class='va'>`Comunidad autónoma y provincia`</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>improvdata</span> <span class='op'>&lt;-</span> <span class='va'>improvdata</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>`Autonomous Communities`</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"Andalucía"</span>,</span>
<span>    <span class='st'>"Aragón"</span>,</span>
<span>    <span class='st'>"Asturias, Principado de"</span>,</span>
<span>    <span class='st'>"Balears, Illes"</span>,</span>
<span>    <span class='st'>"Canarias"</span>,</span>
<span>    <span class='st'>"Cantabria"</span>,</span>
<span>    <span class='st'>"Castilla y León"</span>,</span>
<span>    <span class='st'>"Castilla-La Mancha"</span>,</span>
<span>    <span class='st'>"Comunitat Valenciana"</span>,</span>
<span>    <span class='st'>"Extremadura"</span>,</span>
<span>    <span class='st'>"Galicia"</span>,</span>
<span>    <span class='st'>"Madrid, Comunidad de"</span>,</span>
<span>    <span class='st'>"Murcia, Región de"</span>,</span>
<span>    <span class='st'>"Navarra, Comunidad Foral de"</span>,</span>
<span>    <span class='st'>"Rioja, La"</span></span>
<span>  <span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="re-grouping-protest-motives">Re-grouping protest motives</h4>
<p>I regrouped and re-write all the categories. I grouped together very similar motifs that could be more functional under a single motif that brings them together. For example, I joined “Climate change” and ‘Environmentalism’ under the single motive “Environmental matters”), or “Human rights”, “Against hate, racism and xenophobia” and “Insubordination” under the same category “Human Rights”. Also there are categories that are not meaningful on their own; for example, the category “Insubordination” has only one registered protest, so that is why I also added it to “Human Rights.”</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>improvdata</span> <span class='op'>&lt;-</span> <span class='va'>improvdata</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>`Labour-Economic` <span class='op'>=</span> <span class='va'>`Motivos laborales / económicos`</span>,</span>
<span>                                   `Political-Legislative` <span class='op'>=</span> <span class='va'>`Contra medidas políticas / legislativas`</span>,</span>
<span>                                   `Healthcare` <span class='op'>=</span> <span class='va'>`Motivos sanitarios`</span>,</span>
<span>                                   `Neighborhood Affairs` <span class='op'>=</span> <span class='va'>`Movilizaciones vecinales`</span>,</span>
<span>                                   `Against Crime` <span class='op'>=</span> <span class='va'>`Contra la droga / delincuencia`</span>,</span>
<span>                                   `Education` <span class='op'>=</span> <span class='va'>`Movilizaciones enseñanza / educación`</span>,</span>
<span>                                   `Nationalism` <span class='op'>=</span> <span class='va'>`Temas nacionalistas`</span>,</span>
<span>                                   `International Phenomena` <span class='op'>=</span> <span class='va'>`Asuntos internacionales`</span>,</span>
<span>                                   `Commemorative Days` <span class='op'>=</span> <span class='va'>`Conmemoración/ homenajes`</span>,</span>
<span>                                   `Religion` <span class='op'>=</span> <span class='va'>`Temas religiosos`</span>,</span>
<span>                                   `Feminism` <span class='op'>=</span> <span class='va'>`Contra violencia de género`</span>,</span>
<span>                                   `Other motives*` <span class='op'>=</span> <span class='va'>`Otras`</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>improvdata</span> <span class='op'>&lt;-</span> <span class='va'>improvdata</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/across.html'>across</a></span><span class='op'>(</span></span>
<span>    <span class='op'>-</span><span class='va'>`Autonomous Communities`</span>,</span>
<span>    <span class='va'>as.numeric</span></span>
<span>  <span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>improvdata</span> <span class='op'>&lt;-</span> <span class='va'>improvdata</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>`Enviromental Matters` <span class='op'>=</span> <span class='va'>`Ecologismo`</span> <span class='op'>+</span> <span class='va'>`Cambio climático`</span>,</span>
<span>         `Human Rights` <span class='op'>=</span> <span class='va'>`Derechos humanos`</span> <span class='op'>+</span> <span class='va'>`Contra el odio, racismo, xenofobia, etc.`</span> <span class='op'>+</span> <span class='va'>`Insumisión`</span>,</span>
<span>         `Terrorism`<span class='op'>=</span> <span class='va'>Terrorismo</span> <span class='op'>+</span> <span class='va'>`Contra la radicalización violenta`</span> <span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>Ecologismo</span>, <span class='op'>-</span><span class='va'>`Cambio climático`</span>, <span class='op'>-</span><span class='va'>`Derechos humanos`</span>, <span class='op'>-</span><span class='va'>`Contra el odio, racismo, xenofobia, etc.`</span>, <span class='op'>-</span><span class='va'>`Insumisión`</span>, <span class='op'>-</span><span class='va'>Terrorismo</span>, <span class='op'>-</span><span class='va'>`Contra la radicalización violenta`</span><span class='op'>)</span> </span>
<span></span>
<span><span class='va'>improvdata</span> <span class='op'>&lt;-</span> <span class='va'>improvdata</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/relocate.html'>relocate</a></span><span class='op'>(</span><span class='va'>Total</span>, .after <span class='op'>=</span> <span class='fu'><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/relocate.html'>relocate</a></span><span class='op'>(</span><span class='va'>`Other motives*`</span>, .before <span class='op'>=</span> <span class='va'>Total</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="reshaping-data-and-calculating-percentages">Reshaping data and calculating percentages</h4>
<p>Transforms the data from wide to long format, where each row represents one CCAA-motive combination. Calculates the percentage of protests for each motive relative to the total protests in each autonomous community:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>datos_graphs</span> <span class='op'>&lt;-</span> <span class='va'>improvdata</span> <span class='op'>|&gt;</span></span>
<span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span></span>
<span>    cols <span class='op'>=</span> <span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>`Autonomous Communities`</span>, <span class='va'>Total</span><span class='op'>)</span>,  </span>
<span>    names_to <span class='op'>=</span> <span class='st'>"Motivo"</span>,</span>
<span>    values_to <span class='op'>=</span> <span class='st'>"Frecuencia"</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    Porcentaje <span class='op'>=</span> <span class='op'>(</span><span class='va'>Frecuencia</span> <span class='op'>/</span> <span class='va'>Total</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>100</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>`Autonomous Communities`</span>, <span class='va'>Motivo</span>, <span class='va'>Porcentaje</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="filtering-and-sorting-top-motives">Filtering and sorting top motives</h4>
<p>Filters the dataset to include only the 10 most relevant protest motives, excluding less frequent categories.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>datos_graphs</span> <span class='op'>&lt;-</span> <span class='va'>datos_graphs</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Motivo</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>  <span class='st'>"Labour-Economic"</span>,</span>
<span>  <span class='st'>"Other motives*"</span>,</span>
<span>  <span class='st'>"Political-Legislative"</span>,</span>
<span>  <span class='st'>"Neighborhood Affairs"</span>,</span>
<span>  <span class='st'>"International Phenomena"</span>,</span>
<span>  <span class='st'>"Healthcare"</span>,</span>
<span>  <span class='st'>"Feminism"</span>,</span>
<span>  <span class='st'>"Human Rights"</span>,</span>
<span>  <span class='st'>"Education"</span>,</span>
<span>  <span class='st'>"Enviromental Matters"</span></span>
<span><span class='op'>)</span><span class='op'>)</span> </span>
<span></span>
<span><span class='co'># Ordering for most to least frequent</span></span>
<span><span class='va'>datos_graphs</span> <span class='op'>&lt;-</span> <span class='va'>datos_graphs</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>Motivo</span>, <span class='va'>`Autonomous Communities`</span>, <span class='va'>Porcentaje</span><span class='op'>)</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>Motivo</span>, <span class='va'>`Autonomous Communities`</span><span class='op'>)</span> </span></code></pre>
</div>
</div>
<h4 id="calculating-national-averages-and-divergences">Calculating national averages and Divergences</h4>
<p>I calculated the national average percentage for each protest motive by aggregating data across all autonomous communities. This serves as the baseline for comparing regional variations. Then I joined the regional percentages with national averages, adding the baseline comparison value to each row.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>national_average</span> <span class='op'>&lt;-</span> <span class='va'>improvdata</span> <span class='op'>|&gt;</span></span>
<span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span></span>
<span>    cols <span class='op'>=</span> <span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>`Autonomous Communities`</span>, <span class='va'>Total</span><span class='op'>)</span>,</span>
<span>    names_to <span class='op'>=</span> <span class='st'>"Motivo"</span>,</span>
<span>    values_to <span class='op'>=</span> <span class='st'>"Frecuencia"</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>Motivo</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span></span>
<span>    Frecuencia_Total <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>Frecuencia</span><span class='op'>)</span>,</span>
<span>    Total_General <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>Total</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    Media_Nacional_pct <span class='op'>=</span> <span class='op'>(</span><span class='va'>Frecuencia_Total</span> <span class='op'>/</span> <span class='va'>Total_General</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>100</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>Motivo</span>, <span class='va'>Media_Nacional_pct</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Joinning everything in the same dataframe</span></span>
<span><span class='va'>datos_graphs</span> <span class='op'>&lt;-</span> <span class='va'>datos_graphs</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>national_average</span>, by <span class='op'>=</span> <span class='st'>"Motivo"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Creating divergence column and ordering its values</span></span>
<span><span class='va'>datos_graphs</span> <span class='op'>&lt;-</span> <span class='va'>datos_graphs</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Divergencia <span class='op'>=</span> <span class='va'>Porcentaje</span> <span class='op'>-</span> <span class='va'>Media_Nacional_pct</span>,</span>
<span>         CCAA_ordenada <span class='op'>=</span> <span class='fu'><a href='https://juliasilge.github.io/tidytext/reference/reorder_within.html'>reorder_within</a></span><span class='op'>(</span><span class='va'>`Autonomous Communities`</span>, <span class='va'>Divergencia</span>, <span class='va'>Motivo</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="standardizing-ccaa-names">Standardizing CCAA names</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>datos_graphs</span> <span class='op'>&lt;-</span> <span class='va'>datos_graphs</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    `Autonomous Communities` <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/recode.html'>recode</a></span><span class='op'>(</span></span>
<span>      <span class='va'>`Autonomous Communities`</span>,</span>
<span>      <span class='st'>"Murcia, Región de"</span> <span class='op'>=</span> <span class='st'>"Murcia"</span>,</span>
<span>      <span class='st'>"Navarra, Comunidad Foral de"</span> <span class='op'>=</span> <span class='st'>"Navarra"</span>,</span>
<span>      <span class='st'>"Madrid, Comunidad de"</span>    <span class='op'>=</span> <span class='st'>"Madrid"</span>,</span>
<span>      <span class='st'>"Asturias, Principado de"</span>  <span class='op'>=</span> <span class='st'>"Asturias"</span>,</span>
<span>      <span class='st'>"Balears, Illes"</span> <span class='op'>=</span> <span class='st'>"Baleares"</span>,</span>
<span>      <span class='st'>"Rioja, La"</span> <span class='op'>=</span> <span class='st'>"La Rioja"</span>,</span>
<span>      <span class='st'>"Comunitat Valenciana"</span> <span class='op'>=</span> <span class='st'>"C. Valenciana"</span>,</span>
<span>      <span class='st'>"Castilla y León"</span> <span class='op'>=</span> <span class='st'>"C. y León"</span>,</span>
<span>      <span class='st'>"Castilla-La Mancha"</span> <span class='op'>=</span> <span class='st'>"C - La Mancha"</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="definning-color-palette">Definning color palette</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>colores_CCAA</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>  <span class='st'>"Andalucía"</span> <span class='op'>=</span> <span class='st'>"#EFCE7B"</span>,</span>
<span>  <span class='st'>"Aragón"</span> <span class='op'>=</span> <span class='st'>"#2B2B23"</span>,</span>
<span>  <span class='st'>"Asturias"</span> <span class='op'>=</span> <span class='st'>"#238BB0"</span>,</span>
<span>  <span class='st'>"Balears"</span> <span class='op'>=</span> <span class='st'>"#D8560E"</span>,</span>
<span>  <span class='st'>"Canarias"</span> <span class='op'>=</span> <span class='st'>"#B28622"</span>,</span>
<span>  <span class='st'>"Cantabria"</span> <span class='op'>=</span> <span class='st'>"#92A2A6"</span>,</span>
<span>  <span class='st'>"C. y León"</span> <span class='op'>=</span> <span class='st'>"#849E15"</span>,</span>
<span>  <span class='st'>"C - La Mancha"</span> <span class='op'>=</span> <span class='st'>"#6D1F42"</span>,</span>
<span>  <span class='st'>"C. Valenciana"</span> <span class='op'>=</span> <span class='st'>"#876929"</span>,</span>
<span>  <span class='st'>"Extremadura"</span> <span class='op'>=</span> <span class='st'>"#25533F"</span>,</span>
<span>    <span class='st'>"Galicia"</span> <span class='op'>=</span> <span class='st'>"#F4BEAE"</span>,</span>
<span>    <span class='st'>"Madrid"</span> <span class='op'>=</span> <span class='st'>"#105666"</span>,</span>
<span>    <span class='st'>"Navarra"</span> <span class='op'>=</span> <span class='st'>"#976D90"</span>,</span>
<span>    <span class='st'>"La Rioja"</span> <span class='op'>=</span> <span class='st'>"#D9CBC2"</span>,</span>
<span>    <span class='st'>"Murcia"</span> <span class='op'>=</span> <span class='st'>"#112250"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="creating-facet-labels-with-average-and-ordering-them-by-frequency">Creating facet labels with average and ordering them by frequency</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Creating text labels with national average value for each motive</span></span>
<span><span class='va'>datos_graphs</span> <span class='op'>&lt;-</span> <span class='va'>datos_graphs</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    Motivo_label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>Motivo</span>, <span class='st'>"\n(avg: "</span>, </span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>Media_Nacional_pct</span>, <span class='fl'>1</span><span class='op'>)</span>, </span>
<span>      <span class='st'>"%)"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Ordering graphs from highest to lowest national average</span></span>
<span><span class='va'>datos_graphs</span> <span class='op'>&lt;-</span> <span class='va'>datos_graphs</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    Motivo_label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span></span>
<span>      <span class='va'>Motivo_label</span>,</span>
<span>      levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>Motivo_label</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>Media_Nacional_pct</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 id="plotting-the-graph">Plotting the graph</h3>
<p>This code creates a faceted bar chart displaying how each autonomous community’s protest distribution deviates from the national average across different motives.</p>
<h4 id="base-layer-and-geometries">Base layer and geometries</h4>
<p>I created horizontal bars showing divergence values, colored by autonomous community. A vertical line at x=0 represents the national average baseline for each motive.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>g</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>datos_graphs</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Divergencia</span>, y <span class='op'>=</span> <span class='va'>CCAA_ordenada</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Creating color-filled bars with CCAA categories</span></span>
<span><span class='va'>g</span> <span class='op'>&lt;-</span> <span class='va'>g</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_col</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='va'>`Autonomous Communities`</span><span class='op'>)</span>, width <span class='op'>=</span> <span class='fl'>0.85</span>, alpha <span class='op'>=</span> <span class='fl'>0.85</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Creating middle-line representing average values</span></span>
<span><span class='va'>g</span> <span class='op'>&lt;-</span> <span class='va'>g</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='fl'>0</span>, linewidth <span class='op'>=</span> <span class='fl'>0.3</span>, color <span class='op'>=</span> <span class='st'>"#6B6B6B"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="faceting">Faceting</h4>
<p>Splitted the visualization into separate panels (one per motive), arranged in 2 rows and 5 columns. Each panel has independent Y-axis ordering based on divergence values.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>g</span> <span class='op'>&lt;-</span> <span class='va'>g</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>facet_wrap</a></span><span class='op'>(</span><span class='op'>~</span> <span class='va'>Motivo_label</span>, ncol <span class='op'>=</span> <span class='fl'>5</span>, scales <span class='op'>=</span> <span class='st'>"free_y"</span><span class='op'>)</span> </span></code></pre>
</div>
</div>
<h4 id="color-scales-and-axes">Color scales and axes</h4>
<p>I applied the custom CCAA color palette and I also created a second color scale for text labels, distinguishing values above (dark green) and below (dark red) the national average.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>g</span> <span class='op'>&lt;-</span> <span class='va'>g</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>colores_CCAA</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>labels <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span><span class='op'>(</span><span class='st'>"%+.1f"</span>, <span class='va'>x</span><span class='op'>)</span>,</span>
<span>                     expand <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/expansion.html'>expansion</a></span><span class='op'>(</span>mult <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://juliasilge.github.io/tidytext/reference/reorder_within.html'>scale_y_reordered</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>g</span> <span class='op'>&lt;-</span> <span class='va'>g</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_color_manual</a></span><span class='op'>(</span></span>
<span>  values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Above"</span> <span class='op'>=</span> <span class='st'>"#0B3D0B"</span>, <span class='st'>"Below"</span> <span class='op'>=</span> <span class='st'>"#5C0000"</span><span class='op'>)</span>,</span>
<span>  labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Above"</span> <span class='op'>=</span> <span class='st'>"Above avg"</span>, <span class='st'>"Below"</span> <span class='op'>=</span> <span class='st'>"Below avg"</span><span class='op'>)</span>,</span>
<span>  name <span class='op'>=</span> <span class='st'>"AVG Divergence"</span>  <span class='co'># Nombre de la segunda leyenda</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="labels-and-annotations">Labels and annotations</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Labs </span></span>
<span><span class='va'>g</span> <span class='op'>&lt;-</span> <span class='va'>g</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span></span>
<span>  title <span class='op'>=</span> <span class='st'>"Divergences in Protest Activity and Motives Across Spanish Autonomous Communities, 2024"</span>, </span>
<span>  x <span class='op'>=</span> <span class='cn'>NULL</span>, </span>
<span>  y <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span> </span>
<span></span>
<span><span class='co'># Text</span></span>
<span><span class='va'>g</span> <span class='op'>&lt;-</span> <span class='va'>g</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span></span>
<span>    label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>Porcentaje</span>, <span class='fl'>1</span><span class='op'>)</span>, <span class='st'>"%"</span><span class='op'>)</span>,</span>
<span>    x <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>Divergencia</span> <span class='op'>&gt;=</span> <span class='fl'>0</span>, <span class='fl'>1.3</span>, <span class='op'>-</span><span class='fl'>0.3</span><span class='op'>)</span>,  <span class='co'># Ajustar según lado</span></span>
<span>    color <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>Divergencia</span> <span class='op'>&gt;=</span> <span class='fl'>0</span>, <span class='st'>"Above"</span>, <span class='st'>"Below"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span>,</span>
<span>  size <span class='op'>=</span> <span class='fl'>2.5</span>,</span>
<span>  family <span class='op'>=</span> <span class='st'>"Lora"</span>,</span>
<span>  key_glyph <span class='op'>=</span> <span class='st'>"point"</span></span>
<span><span class='op'>)</span> </span></code></pre>
</div>
</div>
<h4 id="legend-customization-1">Legend customization</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Guides</span></span>
<span><span class='va'>g</span> <span class='op'>&lt;-</span> <span class='va'>g</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span></span>
<span>  fill <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guide_legend.html'>guide_legend</a></span><span class='op'>(</span></span>
<span>    nrow <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>    label.position <span class='op'>=</span> <span class='st'>"bottom"</span><span class='op'>)</span>,</span>
<span>  color <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guide_legend.html'>guide_legend</a></span><span class='op'>(</span></span>
<span>    nrow <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>    label.position <span class='op'>=</span> <span class='st'>"bottom"</span>,</span>
<span>    order <span class='op'>=</span> <span class='fl'>2</span>,  <span class='co'># Segunda leyenda</span></span>
<span>    override.aes <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span></span>
<span>      shape <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>24</span>,<span class='fl'>25</span><span class='op'>)</span>,          </span>
<span>      size <span class='op'>=</span> <span class='fl'>3.5</span>,</span>
<span>      fill <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#0B3D0B"</span>, <span class='st'>"#5C0000"</span><span class='op'>)</span><span class='op'>)</span>         </span>
<span>  <span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="theme-and-styling">Theme and styling</h4>
<p>This code chunk applies comprehensive visual styling to the ggplot object g through the theme system. The chunk header specifies output parameters with fig.width=16, fig.height=10 for physical dimensions, dpi=150 for resolution, and fig.showtext=TRUE to enable custom fonts.</p>
<p>The styling begins with theme_void(), which removes all default ggplot2 elements to provide a clean canvas, then adds a warm beige background (#EFE7DA) to both the panel (where data is drawn) and plot areas (the entire graphic object). Layout parameters include a 1.5 aspect ratio to maintain consistent panel proportions across facets, 0.25cm spacing between faceted panels, and margin padding (10 points on most sides, 15 on bottom) to create breathing room around content.</p>
<p>The text hierarchy uses three distinct font families. The legend is configured horizontally at the bottom with centered alignment and no title.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Themes </span></span>
<span><span class='va'>g</span> <span class='op'>&lt;-</span> <span class='va'>g</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_void</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    panel.spacing <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.25</span>, <span class='st'>"cm"</span><span class='op'>)</span>,</span>
<span>    plot.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"#EFE7DA"</span><span class='op'>)</span>,</span>
<span>    panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"#EFE7DA"</span> <span class='op'>)</span>,</span>
<span>    plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>15</span>, <span class='fl'>10</span><span class='op'>)</span>,</span>
<span>    aspect.ratio <span class='op'>=</span> <span class='fl'>1.5</span>,</span>
<span>    plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span></span>
<span>      size <span class='op'>=</span> <span class='fl'>13.5</span>, </span>
<span>      family <span class='op'>=</span> <span class='st'>"Gravitas"</span>,</span>
<span>      hjust <span class='op'>=</span> <span class='fl'>0.5</span>,        </span>
<span>      margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>b <span class='op'>=</span> <span class='fl'>15</span><span class='op'>)</span>  </span>
<span>    <span class='op'>)</span>,</span>
<span>    strip.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span></span>
<span>      size <span class='op'>=</span> <span class='fl'>8.5</span>,  </span>
<span>      family <span class='op'>=</span> <span class='st'>"Lora"</span>,</span>
<span>      face <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>      hjust <span class='op'>=</span> <span class='fl'>0.5</span>,</span>
<span>      margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>b <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>,</span>
<span>      color <span class='op'>=</span> <span class='st'>"#3D211A"</span>,</span>
<span>      <span class='op'>)</span>,</span>
<span>    plot.caption <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span></span>
<span>      hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.13</span>,              </span>
<span>      size <span class='op'>=</span> <span class='fl'>10</span>,              </span>
<span>      family <span class='op'>=</span> <span class='st'>"Mulish"</span>,</span>
<span>      margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>18</span><span class='op'>)</span> </span>
<span>    <span class='op'>)</span>,</span>
<span>    legend.position <span class='op'>=</span> <span class='st'>"bottom"</span>,</span>
<span>    legend.direction <span class='op'>=</span> <span class='st'>"horizontal"</span>,</span>
<span>    legend.box <span class='op'>=</span> <span class='st'>"horizontal"</span>,</span>
<span>    legend.justification <span class='op'>=</span> <span class='st'>"center"</span>,  </span>
<span>    legend.box.just <span class='op'>=</span> <span class='st'>"center"</span>,</span>
<span>    legend.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    legend.spacing.x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='st'>"cm"</span><span class='op'>)</span>,</span>
<span>    legend.key.spacing.x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.15</span>, <span class='st'>"cm"</span><span class='op'>)</span>,</span>
<span>    legend.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>15</span><span class='op'>)</span>,</span>
<span>    legend.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span></span>
<span>    size <span class='op'>=</span> <span class='fl'>8</span>,</span>
<span>    face <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"Lora"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span></span>
<span>  <span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='va'>g</span></span></code></pre>
</div>
<p><img src="100453622_files/figure-html5/unnamed-chunk-28-1.png" width="2400" data-distill-preview=1 /></p>
</div>
<h3 id="limitations-and-conclusions">Limitations and conclusions</h3>
<p>The initial graph presented several visualization challenges: overlapping segmented pie charts made individual regions difficult to differentiate, while simultaneously attempting to convey multiple data dimensions (geographic location, protest volume, and categorical distribution) resulted in visual overload. The redesign aimed to address these issues by creating a more intuitive visualization featuring professional typography, harmonious colors, and clear visual hierarchy.</p>
<p>Nevertheless, the “Other Motives” problem is a clear statistical limitation due to we can’t fully understand the whole protest motive distribution along the country because we can’t tell what type of protests do the second largest category nationwide includes. This limits motive distribution interpretation. Also not being able to access to Catalonia and Basque country data restricts the understanding of how protest motives vary across regions in the whole country.</p>
<p>Overall, this data restructuring and categorical redefinition of protest activity aims to clarify patterns in Spanish civil mobilization, helping identify what concerns citizens most and how the country’s cultural and geographic heterogeneity shapes regional variations in political behavior through a visually clearer and cleaner graph.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
