<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>European Immigration Attitudes and Origins Visualization</title>

  <meta property="description" itemprop="description" content="This project recreates and then reimagines a circular barchart showing European countries&#39; immigration attitudes and top immigrant origin countries. All data is from 2018."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2026-01-07"/>
  <meta property="article:created" itemprop="dateCreated" content="2026-01-07"/>
  <meta name="article:author" content="Olivia Blantz"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="European Immigration Attitudes and Origins Visualization"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="This project recreates and then reimagines a circular barchart showing European countries&#39; immigration attitudes and top immigrant origin countries. All data is from 2018."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="European Immigration Attitudes and Origins Visualization"/>
  <meta property="twitter:description" content="This project recreates and then reimagines a circular barchart showing European countries&#39; immigration attitudes and top immigrant origin countries. All data is from 2018."/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","categories","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["European Immigration Attitudes and Origins Visualization"]},{"type":"character","attributes":{},"value":["This project recreates and then reimagines a circular barchart showing European countries' immigration attitudes and top immigrant origin countries. All data is from 2018.  \n"]},{"type":"character","attributes":{},"value":["2025"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Olivia Blantz"]}]}]},{"type":"character","attributes":{},"value":["2026-01-07"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["100570651_files/anchor-4.2.2/anchor.min.js","100570651_files/bowser-1.9.3/bowser.min.js","100570651_files/distill-2.2.21/template.v2.js","100570651_files/figure-html5/imp-print-1.png","100570651_files/figure-html5/print-rec-1.png","100570651_files/header-attrs-2.29/header-attrs.js","100570651_files/jquery-3.6.0/jquery-3.6.0.js","100570651_files/jquery-3.6.0/jquery-3.6.0.min.js","100570651_files/jquery-3.6.0/jquery-3.6.0.min.map","100570651_files/popper-2.6.0/popper.min.js","100570651_files/tippy-6.2.7/tippy-bundle.umd.min.js","100570651_files/tippy-6.2.7/tippy-light-border.css","100570651_files/tippy-6.2.7/tippy.css","100570651_files/tippy-6.2.7/tippy.umd.min.js","100570651_files/webcomponents-2.0.0/webcomponents.js","country_attitudes_clean.csv","original_graph.png","top5_citizenship_by_country.csv"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  hr.section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    margin: 0px;
  }


  d-byline {
    border-top: none;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
    border-top: none;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  /* tweak for Pandoc numbered line within distill */
  d-article pre.numberSource code > span {
      left: -2em;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // separator
    var separator = '<hr class="section-separator" style="clear: both"/>';
    // prepend separator above appendix
    $('.d-byline').before(separator);
    $('.d-article').before(separator);

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme, except when numbering line
    // in code chunk
    $('pre:not(.numberLines) code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        var author_name = front_matter.authors[i].author
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="100570651_files/header-attrs-2.29/header-attrs.js"></script>
  <script src="100570651_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="100570651_files/popper-2.6.0/popper.min.js"></script>
  <link href="100570651_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="100570651_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="100570651_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="100570651_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="100570651_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="100570651_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="100570651_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"European Immigration Attitudes and Origins Visualization","description":"This project recreates and then reimagines a circular barchart showing European countries' immigration attitudes and top immigrant origin countries. All data is from 2018.","authors":[{"author":"Olivia Blantz","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2026-01-07T00:00:00.000+01:00","citationText":"Blantz, 2026"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>European Immigration Attitudes and Origins Visualization</h1>

<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt-tag">2025</div>
</div>
<!--/radix_placeholder_categories-->
<p><p>This project recreates and then reimagines a circular barchart showing European countries’ immigration attitudes and top immigrant origin countries. All data is from 2018.</p></p>
</div>

<div class="d-byline">

  Olivia Blantz

<br/>2026-01-07
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#introduction" id="toc-introduction">Introduction</a></li>
<li><a href="#original-graph" id="toc-original-graph">Original Graph</a></li>
<li><a href="#recreation" id="toc-recreation">Recreation</a>
<ul>
<li><a href="#libraries" id="toc-libraries">Libraries</a></li>
<li><a href="#font-setup" id="toc-font-setup">Font Setup</a></li>
<li><a href="#data-preparation" id="toc-data-preparation">Data Preparation</a></li>
<li><a href="#graph-element-preparation" id="toc-graph-element-preparation">Graph Element Preparation</a></li>
<li><a href="#building-the-plot" id="toc-building-the-plot">Building the Plot</a></li>
<li><a href="#final-recreation" id="toc-final-recreation">Final Recreation</a></li>
</ul></li>
<li><a href="#improvement" id="toc-improvement">Improvement</a>
<ul>
<li><a href="#improvement-introduction" id="toc-improvement-introduction">Improvement Introduction</a></li>
<li><a href="#libraries-1" id="toc-libraries-1">Libraries</a></li>
<li><a href="#graph-preparation" id="toc-graph-preparation">Graph Preparation</a></li>
<li><a href="#building-scatterplot" id="toc-building-scatterplot">Building Scatterplot</a></li>
<li><a href="#final-improvement-plot" id="toc-final-improvement-plot">Final Improvement Plot</a></li>
<li><a href="#final-notes" id="toc-final-notes">Final Notes</a></li>
</ul></li>
</ul>
</nav>
</div>
<h2 id="introduction">Introduction</h2>
<p>This tutorial recreates and then re-imagines a circular bar chart visualization showing European countries’ attitudes toward immigration alongside their top 5 immigrant origin countries. The original graph, created by Reddit user killeradoom, combines 2018 data from the European Social Survey and Eurostat to present European immigration patterns.</p>
<h2 id="original-graph">Original Graph</h2>
<figure>
<img src="original_graph.png" class="external" style="width:100.0%" alt="Original chart. Source: Reddit user killeradoom, data from European Social Survey and Eurostat 2018" />
<figcaption aria-hidden="true">Original chart. Source: Reddit user killeradoom, data from European Social Survey and Eurostat 2018</figcaption>
</figure>
<p>The original visualization presents a double “layered” circular bar chart. The graphs inner circle show European countries sentiments towards immigrants, as depicted by a blue to red color scale (informed by European Social Survey data). The outer circle displays a bar chart representing the top 5 immigration populations residing in each country, with each bar colored according the immigrant origin countries’ continent. According to the original creator, it was made using Flourish. I chose this chart because, while aesthetically pleasing due to its mandala-like appearance, it is difficult to interpret due to it’s circular shape and doesn’t immediately reveal any interesting data trends.</p>
<h2 id="recreation">Recreation</h2>
<h3 id="libraries">Libraries</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://scales.r-lib.org'>scales</a></span><span class='op'>)</span>     <span class='co'># For color gradients</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://eliocamp.github.io/ggnewscale/'>ggnewscale</a></span><span class='op'>)</span> </span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/yixuan/showtext'>showtext</a></span><span class='op'>)</span>   <span class='co'># For custom fonts (google fonts)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://patchwork.data-imaginist.com'>patchwork</a></span><span class='op'>)</span>  <span class='co'># For legends</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/GuangchuangYu/shadowtext/'>shadowtext</a></span><span class='op'>)</span> <span class='co'># For creating white outline for labels</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://glue.tidyverse.org/'>glue</a></span><span class='op'>)</span>       <span class='co'># For dynamic labels</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://wilkelab.org/ggtext/'>ggtext</a></span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 id="font-setup">Font Setup</h3>
<p>The font “Oswald” was identified as the font most similar to the original graph by Google Fonts.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Add Oswald font from Google Fonts</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/sysfonts/man/font_add_google.html'>font_add_google</a></span><span class='op'>(</span><span class='st'>"Oswald"</span>, <span class='st'>"oswald"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/showtext/man/showtext_auto.html'>showtext_auto</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/showtext/man/showtext_opts.html'>showtext_opts</a></span><span class='op'>(</span>dpi <span class='op'>=</span> <span class='fl'>300</span><span class='op'>)</span>  <span class='co'># Matching the ggsave DPI setting</span></span></code></pre>
</div>
</div>
<h3 id="data-preparation">Data Preparation</h3>
<h4 id="ess-data-inner-circle-data">ESS Data: Inner Circle Data</h4>
<p>Information for the sentiment scale of immigrant recipient countries is informed by the European Social Survey (round 9, 2018). Because the original graph is from Reddit, I could not be sure how the original attitude scale was calculated. This was my best attempt at using the currently available data, including: selecting relevant variables, normalizing them, and finding each country level average.</p>
<p>Here, I will leave this un-run code to transparently show how I cleaned by data without having to attach the original large file.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Load ESS attitude data</span></span>
<span><span class='va'>ess9</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_csv</a></span><span class='op'>(</span><span class='st'>"ESS9e03_2.csv"</span><span class='op'>)</span></span>
<span><span class='co'>#including the larger file to explain my data cleaning process</span></span>
<span></span>
<span><span class='co'># I am using all survey questions regarding immigration and the design weight variable</span></span>
<span><span class='va'>ess_attitudes_original</span> <span class='op'>&lt;-</span> <span class='va'>ess9</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span></span>
<span>    <span class='va'>cntry</span>,      <span class='co'>#Country</span></span>
<span>    <span class='va'>dweight</span>,    <span class='co'># Design weight</span></span>
<span>    <span class='co'># Is/Does immigration.... </span></span>
<span>    <span class='va'>imbgeco</span>,    <span class='co'># good for economy? (1-10)</span></span>
<span>    <span class='va'>imwbcnt</span>,    <span class='co'># country a better/worse place to live? (1 = worse, 10 = better)</span></span>
<span>    <span class='va'>imueclt</span>,    <span class='co'># enrich cultural life? (1-10)</span></span>
<span>    <span class='co'>#...next questions are on different scale and will be reversed! </span></span>
<span>    <span class='co'>#1 = most positive towards immigration </span></span>
<span>    <span class='co'>#Our country should... </span></span>
<span>    <span class='va'>imsmetn</span>,    <span class='co'># Allow same ethnic group (1-4)</span></span>
<span>    <span class='va'>imdfetn</span>,    <span class='co'># Allow different ethnic group (1-4)</span></span>
<span>    <span class='va'>impcntr</span>     <span class='co'># Allow from poorer countries (1-4)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># Now, reverse scale for last 3 questions where higher score = more positive</span></span>
<span><span class='va'>ess_attitudes_rev</span> <span class='op'>&lt;-</span> <span class='va'>ess_attitudes_original</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    imsmetn_rev <span class='op'>=</span> <span class='fl'>5</span> <span class='op'>-</span> <span class='va'>imsmetn</span>,</span>
<span>    imdfetn_rev <span class='op'>=</span> <span class='fl'>5</span> <span class='op'>-</span> <span class='va'>imdfetn</span>,</span>
<span>    impcntr_rev <span class='op'>=</span> <span class='fl'>5</span> <span class='op'>-</span> <span class='va'>impcntr</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># calculate country-level average attitudes</span></span>
<span><span class='va'>country_attitudes</span> <span class='op'>&lt;-</span> <span class='va'>ess_attitudes_rev</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rowwise.html'>rowwise</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># normalize each question on a 0-1 scale</span></span>
<span>    imbgeco_norm <span class='op'>=</span> <span class='va'>imbgeco</span> <span class='op'>/</span> <span class='fl'>10</span>,           </span>
<span>    imwbcnt_norm <span class='op'>=</span> <span class='va'>imwbcnt</span> <span class='op'>/</span> <span class='fl'>10</span>,           </span>
<span>    imueclt_norm <span class='op'>=</span> <span class='va'>imueclt</span> <span class='op'>/</span> <span class='fl'>10</span>,           </span>
<span>    imsmetn_norm <span class='op'>=</span> <span class='op'>(</span><span class='va'>imsmetn_rev</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>3</span>, </span>
<span>    imdfetn_norm <span class='op'>=</span> <span class='op'>(</span><span class='va'>imdfetn_rev</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>3</span>,  </span>
<span>    impcntr_norm <span class='op'>=</span> <span class='op'>(</span><span class='va'>impcntr_rev</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>3</span>,  </span>
<span>    <span class='co'># average all 6 normalized values across individual respondents</span></span>
<span>    person_avg <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>imbgeco_norm</span>, <span class='va'>imwbcnt_norm</span>, <span class='va'>imueclt_norm</span>, </span>
<span>                        <span class='va'>imsmetn_norm</span>, <span class='va'>imdfetn_norm</span>, <span class='va'>impcntr_norm</span><span class='op'>)</span>, </span>
<span>                      na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>cntry</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span> <span class='co'>#creating average respondent attitude per receiving COUNTRY</span></span>
<span>    <span class='co'># WEIGHTED mean using dweight</span></span>
<span>    avg_attitude <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>person_avg</span> <span class='op'>*</span> <span class='va'>dweight</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>/</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>dweight</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    attitude_normalized <span class='op'>=</span> <span class='op'>(</span><span class='va'>avg_attitude</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>avg_attitude</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>/</span> </span>
<span>      <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>avg_attitude</span><span class='op'>)</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>avg_attitude</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'>#write_csv(country_attitudes, "country_attitudes_clean.csv")</span></span></code></pre>
</div>
</div>
<p>The result of this cleaning is what will be used for the recreation. Here,the clean data is loaded to start the recreation process.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>country_attitudes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_csv</a></span><span class='op'>(</span><span class='st'>"country_attitudes_clean.csv"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="eurostat-outer-circle-data">Eurostat: Outer Circle Data</h4>
<p>The data for the outer circle of the graph comes from Eurostat (2018). This data shows the top 5 immigrant populations in each recipient country, and their makeup as a percentage of the total immigrant population. This was much more straight forward than the ESS attitude calculation. Here, I merged the csv with the ESS data, added their full names corresponding to their country codes for labeling, and created a function to classify each country by continent which will later determine the color of each bar.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># load Eurostat immigration data</span></span>
<span><span class='va'>immigration_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_csv</a></span><span class='op'>(</span><span class='st'>"top5_citizenship_by_country.csv"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># merge data sets to a combined data set, reference column = the receiving country (inner circle)</span></span>
<span><span class='va'>combined_data</span> <span class='op'>&lt;-</span> <span class='va'>immigration_data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>country_attitudes</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"destination_country"</span> <span class='op'>=</span> <span class='st'>"cntry"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/drop_na.html'>drop_na</a></span><span class='op'>(</span><span class='op'>)</span> <span class='co'>#not all countries represented </span></span>
<span></span>
<span><span class='co'># adds the full receiving country names - so they can later appear as labels</span></span>
<span><span class='va'>combined_data</span> <span class='op'>&lt;-</span> <span class='va'>combined_data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    full_name <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"AT"</span> <span class='op'>~</span> <span class='st'>"Austria"</span>,</span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"BE"</span> <span class='op'>~</span> <span class='st'>"Belgium"</span>,</span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"CZ"</span> <span class='op'>~</span> <span class='st'>"Czechia"</span>,</span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"DE"</span> <span class='op'>~</span> <span class='st'>"Germany"</span>,</span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"DK"</span> <span class='op'>~</span> <span class='st'>"Denmark"</span>,</span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"ES"</span> <span class='op'>~</span> <span class='st'>"Spain"</span>,</span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"FI"</span> <span class='op'>~</span> <span class='st'>"Finland"</span>,</span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"FR"</span> <span class='op'>~</span> <span class='st'>"France"</span>,</span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"HU"</span> <span class='op'>~</span> <span class='st'>"Hungary"</span>,</span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"IE"</span> <span class='op'>~</span> <span class='st'>"Ireland"</span>,</span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"IS"</span> <span class='op'>~</span> <span class='st'>"Iceland"</span>,</span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"IT"</span> <span class='op'>~</span> <span class='st'>"Italy"</span>,</span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"NL"</span> <span class='op'>~</span> <span class='st'>"Netherlands"</span>,</span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"NO"</span> <span class='op'>~</span> <span class='st'>"Norway"</span>,</span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"PT"</span> <span class='op'>~</span> <span class='st'>"Portugal"</span>,</span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"SE"</span> <span class='op'>~</span> <span class='st'>"Sweden"</span>,</span>
<span>      <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='va'>destination_country</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># next, classify origin countries by continent for coloring</span></span>
<span><span class='co'># create a function to sort them also using case_when </span></span>
<span></span>
<span><span class='va'>classify_continent</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>code</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='va'>europe</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"AL"</span>, <span class='st'>"BA"</span>, <span class='st'>"DE"</span>, <span class='st'>"DK"</span>, <span class='st'>"EE"</span>, <span class='st'>"FI"</span>, <span class='st'>"FR"</span>, <span class='st'>"HR"</span>, <span class='st'>"IT"</span>, </span>
<span>              <span class='st'>"LT"</span>, <span class='st'>"LV"</span>, <span class='st'>"NL"</span>, <span class='st'>"PL"</span>, <span class='st'>"PT"</span>, <span class='st'>"RO"</span>, <span class='st'>"RS"</span>, <span class='st'>"SE"</span>, <span class='st'>"SK"</span>, </span>
<span>              <span class='st'>"TR"</span>, <span class='st'>"UA"</span>, <span class='st'>"UK"</span><span class='op'>)</span></span>
<span>  <span class='va'>africa</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"CV"</span>, <span class='st'>"DZ"</span>, <span class='st'>"ER"</span>, <span class='st'>"MA"</span>, <span class='st'>"SO"</span><span class='op'>)</span></span>
<span>  <span class='va'>asia</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"AF"</span>, <span class='st'>"CN"</span>, <span class='st'>"IN"</span>, <span class='st'>"IQ"</span>, <span class='st'>"RU"</span>, <span class='st'>"VN"</span><span class='op'>)</span></span>
<span>  <span class='va'>s_america</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"BR"</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>    <span class='va'>code</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>europe</span> <span class='op'>~</span> <span class='st'>"Europe"</span>,</span>
<span>    <span class='va'>code</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>africa</span> <span class='op'>~</span> <span class='st'>"Africa"</span>,</span>
<span>    <span class='va'>code</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>asia</span> <span class='op'>~</span> <span class='st'>"Asia"</span>,</span>
<span>    <span class='va'>code</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>s_america</span> <span class='op'>~</span> <span class='st'>"South America"</span>,</span>
<span>    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='st'>"Other"</span></span>
<span>  <span class='op'>)</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='co'>#finally, add to the combined_data </span></span>
<span><span class='va'>combined_data</span> <span class='op'>&lt;-</span> <span class='va'>combined_data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>continent <span class='op'>=</span> <span class='fu'>classify_continent</span><span class='op'>(</span><span class='va'>citizenship</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="ordering-data">Ordering Data</h4>
<p>The next step after compiling a complete data frame was ordering the data of the inner circle by their attitudes. To inform this section, I followed <a href="https://r-graph-gallery.com/297-circular-barplot-with-groups.html">tutorial 297 “Ordering Data”</a> from the Data to Viz website’s section on circular bar charts.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#new element with countries ordered by their attitudes</span></span>
<span><span class='co'>#includes also the countries' full names</span></span>
<span><span class='va'>country_order</span> <span class='op'>&lt;-</span> <span class='va'>combined_data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/distinct.html'>distinct</a></span><span class='op'>(</span><span class='va'>destination_country</span>, <span class='va'>avg_attitude</span>, <span class='va'>attitude_normalized</span>, <span class='va'>full_name</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>attitude_normalized</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span>   <span class='co'># order by attitude in DESCENDING order </span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>country_id <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/row_number.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>  <span class='co'># assign each receiving country an ID for easy coding by order</span></span>
<span></span>
<span><span class='co'># join country ID back to main data</span></span>
<span><span class='co'># left join to bring the order back into our combined data </span></span>
<span><span class='co'># joined by receiving country</span></span>
<span><span class='va'>combined_data</span> <span class='op'>&lt;-</span> <span class='va'>combined_data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>country_order</span> <span class='op'>|&gt;</span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>destination_country</span>, <span class='va'>country_id</span><span class='op'>)</span>, </span>
<span>            by <span class='op'>=</span> <span class='st'>"destination_country"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># from tutorial 297 </span></span>
<span><span class='co'># arranging each immigrant citizenship by percentage of immigrant population </span></span>
<span><span class='co'># done WITHIN receiving country that are ordered (desc) by attitude</span></span>
<span><span class='va'>combined_data</span> <span class='op'>&lt;-</span> <span class='va'>combined_data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>country_id</span>, <span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>percentage</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 id="graph-element-preparation">Graph Element Preparation</h3>
<h4 id="gaps-between-bars">Gaps Between Bars</h4>
<p>Next, I had to assign each country a unique x position. This section was also informed by <a href="https://r-graph-gallery.com/297-circular-barplot-with-groups.html">tutorial 297 “Add a Gap”</a> from the Data to Viz R Graph Gallery. It’s vital that each bar has it’s exact position and unique sequential ID. Also, empty gaps are created to give space between bars when mapping.
This section begins the creation of the final data frame used to plot the recreation, called “data”.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Assign unique ID to each bar</span></span>
<span><span class='co'># This gives, "Each bar... a unique x position" (tutorial 297)</span></span>
<span><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='va'>combined_data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    id <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/row_number.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span>  <span class='co'># sequential ID</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># calculate empty bars between groups</span></span>
<span><span class='co'># "Data to viz" suggests adding empty rows to create gaps</span></span>
<span></span>
<span><span class='va'>empty_bar</span> <span class='op'>&lt;-</span> <span class='fl'>2.5</span>  <span class='co'># number of empty positions between groups indicates the size of each gap</span></span>
<span></span>
<span><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='va'>data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># from tutorial 297: we create spacing through position calculation</span></span>
<span>    bar_position <span class='op'>=</span> <span class='va'>id</span> <span class='op'>*</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>+</span> <span class='va'>empty_bar</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="labels-positions-and-angles">Labels: Positions and Angles</h4>
<p>This section codes for the unique angels of all the country names in the original graph. Each lies on a radial line coming from the center point and extending outwards. <a href="https://r-graph-gallery.com/296-add-labels-to-circular-barplot.html">Tutorial 296</a> from the Data to Viz circular bar plot section informed this section: that each label must be calculated and it starts with computing it’s specific angle. This tutorial also provided me a specific formula for calculating angles in circular bar plots. Here, I also added the full names of each immigrant origin country.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># calculate center position for each destination country "group"</span></span>
<span><span class='va'>country_positions</span> <span class='op'>&lt;-</span> <span class='va'>data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>destination_country</span>, <span class='va'>country_id</span>, <span class='va'>full_name</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span></span>
<span>    center_position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>bar_position</span><span class='op'>)</span>,  <span class='co'># Average position of group</span></span>
<span>    .groups <span class='op'>=</span> <span class='st'>"drop"</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>country_order</span> <span class='op'>|&gt;</span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>destination_country</span>, <span class='va'>attitude_normalized</span><span class='op'>)</span>, </span>
<span>            by <span class='op'>=</span> <span class='st'>"destination_country"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># calculate the unique "number" (refers to row) of each bar in our data</span></span>
<span><span class='va'>number_of_bar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>country_positions</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># angle formula from tutorial 296:</span></span>
<span><span class='co'># "angle &lt;- 90 - 360 * (label_data$id-0.5) / TOTAL positions</span></span>
<span><span class='co'># "we subtract 0.5 because the letter must have the angle of the center of the bars"</span></span>
<span></span>
<span><span class='va'>country_positions</span> <span class='op'>&lt;-</span> <span class='va'>country_positions</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># calculate angle based on actual position in the full circle</span></span>
<span>    total_positions <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>$</span><span class='va'>bar_position</span><span class='op'>)</span>,</span>
<span>    base_angle <span class='op'>=</span> <span class='fl'>90</span> <span class='op'>-</span> <span class='fl'>360</span> <span class='op'>*</span> <span class='op'>(</span><span class='va'>center_position</span> <span class='op'>-</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>/</span> <span class='va'>total_positions</span>,</span>
<span>    angle <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>      <span class='va'>base_angle</span> <span class='op'>&lt;</span> <span class='op'>-</span><span class='fl'>90</span> <span class='op'>|</span> <span class='va'>base_angle</span> <span class='op'>&gt;</span> <span class='fl'>90</span> <span class='op'>~</span> <span class='va'>base_angle</span> <span class='op'>+</span> <span class='fl'>180</span>,</span>
<span>      <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='va'>base_angle</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    hjust_receiving <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>      <span class='va'>base_angle</span> <span class='op'>&lt;</span> <span class='op'>-</span><span class='fl'>90</span> <span class='op'>|</span> <span class='va'>base_angle</span> <span class='op'>&gt;</span> <span class='fl'>90</span> <span class='op'>~</span> <span class='fl'>1</span>,</span>
<span>      <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='fl'>0</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># adds center_position to main data for connecting lines</span></span>
<span><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='va'>data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>country_positions</span> <span class='op'>|&gt;</span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>destination_country</span>, <span class='va'>center_position</span><span class='op'>)</span>,</span>
<span>            by <span class='op'>=</span> <span class='st'>"destination_country"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># calculate angles for individual bars </span></span>
<span><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='va'>data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    base_bar_angle <span class='op'>=</span> <span class='fl'>90</span> <span class='op'>-</span> <span class='fl'>360</span> <span class='op'>*</span> <span class='op'>(</span><span class='va'>bar_position</span> <span class='op'>-</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>/</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>bar_position</span><span class='op'>)</span>,</span>
<span>    bar_angle <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>      <span class='va'>base_bar_angle</span> <span class='op'>&lt;</span> <span class='op'>-</span><span class='fl'>90</span> <span class='op'>|</span> <span class='va'>base_bar_angle</span> <span class='op'>&gt;</span> <span class='fl'>90</span> <span class='op'>~</span> <span class='va'>base_bar_angle</span> <span class='op'>+</span> <span class='fl'>180</span>,</span>
<span>      <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='va'>base_bar_angle</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    hjust_bar <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>      <span class='va'>base_bar_angle</span> <span class='op'>&lt;</span> <span class='op'>-</span><span class='fl'>90</span> <span class='op'>|</span> <span class='va'>base_bar_angle</span> <span class='op'>&gt;</span> <span class='fl'>90</span> <span class='op'>~</span> <span class='fl'>1</span>,</span>
<span>      <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='fl'>0</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># also adding origin country full names</span></span>
<span><span class='va'>origin_country_names</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>  <span class='st'>"AL"</span> <span class='op'>=</span> <span class='st'>"Albania"</span>, </span>
<span>  <span class='st'>"BA"</span> <span class='op'>=</span> <span class='st'>"Bosnia"</span>, </span>
<span>  <span class='st'>"DE"</span> <span class='op'>=</span> <span class='st'>"Germany"</span>, </span>
<span>  <span class='st'>"DK"</span> <span class='op'>=</span> <span class='st'>"Denmark"</span>, </span>
<span>  <span class='st'>"EE"</span> <span class='op'>=</span> <span class='st'>"Estonia"</span>, </span>
<span>  <span class='st'>"FI"</span> <span class='op'>=</span> <span class='st'>"Finland"</span>, </span>
<span>  <span class='st'>"FR"</span> <span class='op'>=</span> <span class='st'>"France"</span>,</span>
<span>  <span class='st'>"HR"</span> <span class='op'>=</span> <span class='st'>"Croatia"</span>, </span>
<span>  <span class='st'>"IT"</span> <span class='op'>=</span> <span class='st'>"Italy"</span>, </span>
<span>  <span class='st'>"LT"</span> <span class='op'>=</span> <span class='st'>"Lithuania"</span>, </span>
<span>  <span class='st'>"LV"</span> <span class='op'>=</span> <span class='st'>"Latvia"</span>,</span>
<span>  <span class='st'>"NL"</span> <span class='op'>=</span> <span class='st'>"Netherlands"</span>, </span>
<span>  <span class='st'>"PL"</span> <span class='op'>=</span> <span class='st'>"Poland"</span>, </span>
<span>  <span class='st'>"PT"</span> <span class='op'>=</span> <span class='st'>"Portugal"</span>, </span>
<span>  <span class='st'>"RO"</span> <span class='op'>=</span> <span class='st'>"Romania"</span>,</span>
<span>  <span class='st'>"RS"</span> <span class='op'>=</span> <span class='st'>"Serbia"</span>, </span>
<span>  <span class='st'>"SE"</span> <span class='op'>=</span> <span class='st'>"Sweden"</span>, </span>
<span>  <span class='st'>"SK"</span> <span class='op'>=</span> <span class='st'>"Slovakia"</span>, </span>
<span>  <span class='st'>"TR"</span> <span class='op'>=</span> <span class='st'>"Turkey"</span>,</span>
<span>  <span class='st'>"UA"</span> <span class='op'>=</span> <span class='st'>"Ukraine"</span>, </span>
<span>  <span class='st'>"UK"</span> <span class='op'>=</span> <span class='st'>"UK"</span>,</span>
<span>  <span class='st'>"CV"</span> <span class='op'>=</span> <span class='st'>"Cape Verde"</span>, </span>
<span>  <span class='st'>"DZ"</span> <span class='op'>=</span> <span class='st'>"Algeria"</span>, </span>
<span>  <span class='st'>"ER"</span> <span class='op'>=</span> <span class='st'>"Eritrea"</span>,</span>
<span>  <span class='st'>"MA"</span> <span class='op'>=</span> <span class='st'>"Morocco"</span>,</span>
<span>  <span class='st'>"SO"</span> <span class='op'>=</span> <span class='st'>"Somalia"</span>, </span>
<span>  <span class='st'>"AF"</span> <span class='op'>=</span> <span class='st'>"Afghanistan"</span>, </span>
<span>  <span class='st'>"CN"</span> <span class='op'>=</span> <span class='st'>"China"</span>, </span>
<span>  <span class='st'>"IN"</span> <span class='op'>=</span> <span class='st'>"India"</span>,</span>
<span>  <span class='st'>"IQ"</span> <span class='op'>=</span> <span class='st'>"Iraq"</span>, </span>
<span>  <span class='st'>"RU"</span> <span class='op'>=</span> <span class='st'>"Russia"</span>,</span>
<span>  <span class='st'>"VN"</span> <span class='op'>=</span> <span class='st'>"Vietnam"</span>, </span>
<span>  <span class='st'>"BR"</span> <span class='op'>=</span> <span class='st'>"Brazil"</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#adding origin country full names to data  </span></span>
<span><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='va'>data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>origin_full_name <span class='op'>=</span> <span class='va'>origin_country_names</span><span class='op'>[</span><span class='va'>citizenship</span><span class='op'>]</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="gradient-colors">Gradient Colors</h4>
<p>The next step is to define the colors for the “attitude-scale”, which informs the colors of the inner circle country labels as well as the corresponding dots. The color codes used are taken directly from original image with a color picker.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># uses scale_fill_gradient2() </span></span>
<span></span>
<span><span class='co'># label colors for receiving country labels only</span></span>
<span><span class='va'>pal</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://scales.r-lib.org/reference/pal_gradient_n.html'>gradient_n_pal</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#be0e01"</span>, <span class='st'>"#810180"</span>, <span class='st'>"#0e00c3"</span><span class='op'>)</span>, </span>
<span>                      values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.5</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>country_positions</span> <span class='op'>&lt;-</span> <span class='va'>country_positions</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># Rescale for label colors only </span></span>
<span>    rescaled <span class='op'>=</span> <span class='op'>(</span><span class='va'>attitude_normalized</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>attitude_normalized</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>/</span> </span>
<span>      <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>attitude_normalized</span><span class='op'>)</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>attitude_normalized</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    label_color <span class='op'>=</span> <span class='fu'>pal</span><span class='op'>(</span><span class='va'>rescaled</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 id="building-the-plot">Building the Plot</h3>
<p>Now with all our data and elements fully prepared, we can start the process of recreating the visual graph.</p>
<h4 id="coord_polar">Coord_polar</h4>
<p>The first step is to utilize the coord_polar function. This step follows <a href="https://r-graph-gallery.com/295-basic-circular-barplot.html">tutorial 295</a>. Essentially, the plot is created the same as a standard bar chart, and the function is used to wrap the chart into a circle.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span><span class='co'>## coord_polar() to make the chart circular</span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_radial.html'>coord_polar</a></span><span class='op'>(</span>theta <span class='op'>=</span> <span class='st'>"x"</span>, start <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># set axis limits</span></span>
<span>  <span class='co'># tutorial 295: states the importance of the ylim() argument </span></span>
<span>  <span class='co'>#if ylim starts at 0 then the bars start at the center of the circle, ours need to be large</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>50</span>, <span class='fl'>220</span><span class='op'>)</span>, expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>   <span class='co'># this is my limit to show all elements of graph </span></span></code></pre>
</div>
</div>
<h4 id="stylistic-elements">Stylistic Elements</h4>
<p>Here we graph the central dot of the “mandala” shape, the attitude dots which are colored according to the countries attitudes towards immigration, and the radial lines from the center (including those from the center and those from the receiving countries to their corresponding immigration bars).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># 1: center dot</span></span>
<span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>0</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>50</span><span class='op'>)</span>, size <span class='op'>=</span> <span class='fl'>2</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span><span class='co'># 2: radial lines from center </span></span>
<span><span class='co'># these go from central dot to the attitude dots </span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>country_positions</span>,</span>
<span>             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>center_position</span>, xend <span class='op'>=</span> <span class='va'>center_position</span>, </span>
<span>                 y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>50</span>, yend <span class='op'>=</span> <span class='fl'>50</span><span class='op'>)</span>,</span>
<span>             color <span class='op'>=</span> <span class='st'>"black"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.6</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span><span class='co'># 3a: singular lines extending from attitude dots to our "split point"</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>country_positions</span>,</span>
<span>               <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>center_position</span>, xend <span class='op'>=</span> <span class='va'>center_position</span>,</span>
<span>                   y <span class='op'>=</span> <span class='fl'>50</span>, yend <span class='op'>=</span> <span class='fl'>75</span><span class='op'>)</span>,  </span>
<span>               color <span class='op'>=</span> <span class='st'>"black"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.6</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span><span class='co'># 3b: lines from determined "split point" connecting to the outer bars</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>data</span>,</span>
<span>               <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>center_position</span>, xend <span class='op'>=</span> <span class='va'>bar_position</span>,</span>
<span>                   y <span class='op'>=</span> <span class='fl'>60</span>, yend <span class='op'>=</span> <span class='fl'>130</span><span class='op'>)</span>, <span class='co'>#starting at "split point", ending at base of bars</span></span>
<span>               color <span class='op'>=</span> <span class='st'>"black"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.4</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span><span class='co'># 4: attitude dots with gradient colors </span></span>
<span><span class='co'># using attitude_normalized directly with scale_fill_gradient2 </span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>country_positions</span>,</span>
<span>             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>center_position</span>, y <span class='op'>=</span> <span class='fl'>40</span>, <span class='co'>#position on radial lines</span></span>
<span>                  fill <span class='op'>=</span> <span class='va'>attitude_normalized</span><span class='op'>)</span>,</span>
<span>             size <span class='op'>=</span> <span class='fl'>4</span>, shape <span class='op'>=</span> <span class='fl'>21</span>, stroke <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span><span class='co'># fill scale for attitude dots </span></span>
<span>  <span class='co'>#these are mapped here at the end so that they sit on TOP of the lines! </span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_gradient.html'>scale_fill_gradient2</a></span><span class='op'>(</span></span>
<span>    low <span class='op'>=</span> <span class='st'>"#be0e01"</span>, </span>
<span>    mid <span class='op'>=</span> <span class='st'>"#810180"</span>, </span>
<span>    high <span class='op'>=</span> <span class='st'>"#0e01c2"</span>,</span>
<span>    midpoint <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/median.html'>median</a></span><span class='op'>(</span><span class='va'>country_positions</span><span class='op'>$</span><span class='va'>attitude_normalized</span><span class='op'>)</span>,</span>
<span>    <span class='co'># Re-scale to use full color range</span></span>
<span>    limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>country_positions</span><span class='op'>$</span><span class='va'>attitude_normalized</span><span class='op'>)</span>, <span class='co'>#to show variety in color!</span></span>
<span>    guide <span class='op'>=</span> <span class='st'>"none"</span></span>
<span>  <span class='op'>)</span> </span></code></pre>
</div>
</div>
<h4 id="recieving-country-labels">Recieving Country Labels</h4>
<p>This section maps the inner ring country labels. It also uses the shadow text function to create the labels with a white outline for increased legibility.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># 5: receiving country labels (gradient colored)</span></span>
<span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/shadowtext/man/geom_shadowtext.html'>geom_shadowtext</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>country_positions</span>, <span class='co'>#shadowtext package for white outline</span></span>
<span>                  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>center_position</span>, y <span class='op'>=</span> <span class='fl'>50</span>,</span>
<span>                      label <span class='op'>=</span> <span class='va'>full_name</span>,</span>
<span>                      color <span class='op'>=</span> <span class='va'>label_color</span>,</span>
<span>                      angle <span class='op'>=</span> <span class='va'>angle</span>,</span>
<span>                      hjust <span class='op'>=</span> <span class='va'>hjust_receiving</span><span class='op'>)</span>,</span>
<span>                  size <span class='op'>=</span> <span class='fl'>2.75</span>, </span>
<span>                  fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>                  bg.colour <span class='op'>=</span> <span class='st'>"white"</span>,  <span class='co'># white outline color</span></span>
<span>                  bg.r <span class='op'>=</span> <span class='fl'>0.15</span>,          <span class='co'># outline thickness </span></span>
<span>                  family <span class='op'>=</span> <span class='st'>"oswald"</span><span class='op'>)</span> <span class='op'>+</span>  <span class='co'># same font as rest of graph</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_identity.html'>scale_color_identity</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>  <span class='co'># to use the gradient color scale </span></span>
<span>  <span class='fu'><a href='https://eliocamp.github.io/ggnewscale/reference/new_scale.html'>new_scale_color</a></span><span class='op'>(</span><span class='op'>)</span>     <span class='co'># to reset for next color scale </span></span></code></pre>
</div>
</div>
<h4 id="outer-barchart">Outer Barchart</h4>
<p>This section maps the outer ringer of bar charts. It originally drew from <a href="https://r-graph-gallery.com/295-basic-circular-barplot.html">tutorial 295</a> and <a href="https://r-graph-gallery.com/297-circular-barplot-with-groups.html">tutorial 297</a> which teach the use of geom_bar or geom_col for the creation of circular bar charts. However, I needed to use geom_segment to avoid the “coning” effect that is unavoidable when using geom_bar or geom_col. Instead of using geom_bar with stat=“identity”, which is recommended in the tutorial, I used geom_segment to have precise control over bar positioning.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># 6: bar charts</span></span>
<span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>data</span>, <span class='co'>#segment instead of bar/col</span></span>
<span>             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>bar_position</span>,</span>
<span>                 xend <span class='op'>=</span> <span class='va'>bar_position</span>,</span>
<span>                 y <span class='op'>=</span> <span class='fl'>130</span>,</span>
<span>                 yend <span class='op'>=</span> <span class='fl'>130</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>percentage</span> <span class='op'>*</span> <span class='fl'>1.7</span><span class='op'>)</span>, <span class='co'>#"bar" length</span></span>
<span>                 color <span class='op'>=</span> <span class='va'>continent</span><span class='op'>)</span>, <span class='co'>#colored by continent </span></span>
<span>             linewidth <span class='op'>=</span> <span class='fl'>5</span>, </span>
<span>             lineend <span class='op'>=</span> <span class='st'>"butt"</span><span class='op'>)</span> <span class='op'>+</span> <span class='co'>#this create a flat and straight end to the "bars"</span></span>
<span>  </span>
<span>  <span class='co'>#continent color categories</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_color_manual</a></span><span class='op'>(</span> <span class='co'>#colors taken from original graph with color picker</span></span>
<span>    values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>      <span class='st'>"Europe"</span> <span class='op'>=</span> <span class='st'>"#010f7a"</span>, </span>
<span>      <span class='st'>"Africa"</span> <span class='op'>=</span> <span class='st'>"#da7100"</span>, </span>
<span>      <span class='st'>"Asia"</span> <span class='op'>=</span> <span class='st'>"#700004"</span>, </span>
<span>      <span class='st'>"South America"</span> <span class='op'>=</span> <span class='st'>"#015e1a"</span></span>
<span>    <span class='op'>)</span>, </span>
<span>    name <span class='op'>=</span> <span class='st'>""</span></span>
<span>  <span class='op'>)</span> </span></code></pre>
</div>
</div>
<h4 id="barchart-labels">Barchart Labels</h4>
<p>This section creates the labels for the outer ring, which extend from the end of each bar chart. This involves using tools from <a href="https://r-graph-gallery.com/296-add-labels-to-circular-barplot.html">tutorial 296</a> “labels with angle aesthetics”. These labels must have both the country labels and also their percentage of the total immigrant population.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># 8: origin country labels on bars</span></span>
<span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>data</span>,</span>
<span>          <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>bar_position</span>,</span>
<span>              y <span class='op'>=</span> <span class='fl'>130</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>percentage</span> <span class='op'>*</span> <span class='fl'>1.7</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>5</span>,</span>
<span>              label <span class='op'>=</span> <span class='fu'><a href='https://glue.tidyverse.org/reference/glue.html'>glue</a></span><span class='op'>(</span><span class='st'>"{round(percentage, 1)}% {origin_full_name}"</span><span class='op'>)</span>, <span class='co'>#adds in percentage</span></span>
<span>              color <span class='op'>=</span> <span class='va'>continent</span>, <span class='co'># colored by the continent</span></span>
<span>              angle <span class='op'>=</span> <span class='va'>bar_angle</span>, <span class='co'># on same radial angle as the corresponding bar</span></span>
<span>              hjust <span class='op'>=</span> <span class='va'>hjust_bar</span><span class='op'>)</span>,</span>
<span>          size <span class='op'>=</span> <span class='fl'>3</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span> </span></code></pre>
</div>
</div>
<h4 id="theme-and-nontitles">Theme and (Non)Titles</h4>
<p>Here, I set the theme of the graph and also set the groundwork for the titles. The font is Oswald taken from Google Fonts. The title and subtitles are added in the next section to ensure the legends fall below the titles but above the graph.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#9: theme </span></span>
<span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_void</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> <span class='co'>#all white background</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    plot.title <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>26</span>, hjust <span class='op'>=</span> <span class='fl'>0.5</span>,</span>
<span>                                  margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>5</span>, b <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>,</span>
<span>                                  family <span class='op'>=</span> <span class='st'>"oswald"</span><span class='op'>)</span>,</span>
<span>    plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>18</span>, hjust <span class='op'>=</span> <span class='fl'>0.5</span>,</span>
<span>                                     margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>1</span>, b <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>,</span>
<span>                                     family <span class='op'>=</span> <span class='st'>"oswald"</span><span class='op'>)</span>,</span>
<span>    text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"oswald"</span><span class='op'>)</span>,</span>
<span>    legend.position <span class='op'>=</span> <span class='st'>"none"</span>,</span>
<span>    plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>10</span>, r <span class='op'>=</span> <span class='fl'>0</span>, b <span class='op'>=</span> <span class='fl'>0</span>, l <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span></span>
<span>    <span class='co'>#right now we leave these null! </span></span>
<span>    <span class='co'>#to make sure the legends appear under the title, we will use patchwork later </span></span>
<span>    title <span class='op'>=</span> <span class='cn'>NULL</span>, </span>
<span>    subtitle <span class='op'>=</span> <span class='cn'>NULL</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="legends">Legends</h4>
<p>Here, patchwork is used to create the two distinct legends (1 for continent classification and 1 for attitude scale). Also, using patchwork ensures the legends are accurately placed under the title and subtitle. After creating the legends,they are joined together before combining into the main plot. Finally, the title and subtitle are added as well.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#10: legends</span></span>
<span></span>
<span><span class='co'># legend 1: attitude gradient scale </span></span>
<span><span class='va'>legend1_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>50</span>, each <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, times <span class='op'>=</span> <span class='fl'>50</span><span class='op'>)</span><span class='op'>)</span>  <span class='co'>#1:50 determining length being about half of plot width, and repeating y for thickness</span></span>
<span><span class='va'>legend1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>legend1_data</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, fill <span class='op'>=</span> <span class='va'>x</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_tile.html'>geom_tile</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_gradient.html'>scale_fill_gradient2</a></span><span class='op'>(</span>low <span class='op'>=</span> <span class='st'>"#be0e01"</span>, mid <span class='op'>=</span> <span class='st'>"#810180"</span>, high <span class='op'>=</span> <span class='st'>"#0e01c2"</span>, </span>
<span>                       midpoint <span class='op'>=</span> <span class='fl'>25</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>1</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.2</span>, label <span class='op'>=</span> <span class='st'>"Worsens my\ncountry"</span>, <span class='co'>#\n to create unique break</span></span>
<span>           <span class='co'>#x sets position of text under the legend</span></span>
<span>           hjust <span class='op'>=</span> <span class='fl'>0</span>, vjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>, family <span class='op'>=</span> <span class='st'>"oswald"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>25</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.3</span>, label <span class='op'>=</span> <span class='st'>"Neutral"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>0.5</span>, vjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>, family <span class='op'>=</span> <span class='st'>"oswald"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>50</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.3</span>, label <span class='op'>=</span> <span class='st'>"Improves my\ncountry"</span>, </span>
<span>           hjust <span class='op'>=</span> <span class='fl'>1</span>, vjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>, family <span class='op'>=</span> <span class='st'>"oswald"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span>ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1.5</span>, <span class='fl'>4</span><span class='op'>)</span>, clip <span class='op'>=</span> <span class='st'>"off"</span><span class='op'>)</span> <span class='op'>+</span>  <span class='co'># extend y-axis to show labels below</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_void</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span>,</span>
<span>        plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>  <span class='co'>#trying to make 0 for scaling</span></span>
<span></span>
<span><span class='co'># legend 2: continent category with colors</span></span>
<span><span class='va'>legend2_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span> </span>
<span>  continent <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Europe"</span>, <span class='st'>"Africa"</span>, <span class='st'>"Asia"</span>, <span class='st'>"South America"</span><span class='op'>)</span>,</span>
<span>  color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#010f7a"</span>, <span class='st'>"#da7100"</span>, <span class='st'>"#700004"</span>, <span class='st'>"#015e1a"</span><span class='op'>)</span>,</span>
<span>  x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>3</span>, <span class='fl'>5</span>, <span class='fl'>7</span><span class='op'>)</span>,  <span class='co'># spread to fit labels between squares </span></span>
<span>  y <span class='op'>=</span> <span class='fl'>1</span></span>
<span><span class='op'>)</span></span>
<span><span class='va'>legend2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span></span>
<span>  <span class='va'>legend2_data</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, fill <span class='op'>=</span> <span class='va'>continent</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_tile.html'>geom_tile</a></span><span class='op'>(</span></span>
<span>    width <span class='op'>=</span> <span class='fl'>0.8</span>, height <span class='op'>=</span> <span class='fl'>0.8</span>, color <span class='op'>=</span> <span class='st'>"black"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span> <span class='op'>+</span>  <span class='co'># width = height to create squares</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span> <span class='op'>+</span> <span class='fl'>0.5</span>, y <span class='op'>=</span> <span class='va'>y</span>, label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"-"</span>, <span class='va'>continent</span><span class='op'>)</span><span class='op'>)</span>, <span class='co'>#"-"  is also added before each continent name</span></span>
<span>            hjust <span class='op'>=</span> <span class='fl'>0</span>, vjust <span class='op'>=</span> <span class='fl'>0.5</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>, family <span class='op'>=</span> <span class='st'>"oswald"</span><span class='op'>)</span> <span class='op'>+</span>  <span class='co'># labels to the right of the squares</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Europe"</span> <span class='op'>=</span> <span class='st'>"#010f7a"</span>, <span class='st'>"Africa"</span> <span class='op'>=</span> <span class='st'>"#da7100"</span>, </span>
<span>                               <span class='st'>"Asia"</span> <span class='op'>=</span> <span class='st'>"#700004"</span>, <span class='st'>"South America"</span> <span class='op'>=</span> <span class='st'>"#015e1a"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='co'>#filled according to continent</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>9.5</span><span class='op'>)</span>, ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>1.5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_void</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span>,</span>
<span>        plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='co'>#trying to make 0 for scaling</span></span>
<span></span>
<span><span class='co'># combine legends side by side before combining to main plot</span></span>
<span><span class='va'>legends</span> <span class='op'>&lt;-</span> <span class='va'>legend1</span> <span class='op'>+</span> <span class='va'>legend2</span> <span class='op'>+</span> <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_layout.html'>plot_layout</a></span><span class='op'>(</span>widths <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1.25</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># combine legends to the main plot </span></span>
<span><span class='va'>final_plot</span> <span class='op'>&lt;-</span> <span class='va'>legends</span> <span class='op'>/</span> <span class='va'>p</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_layout.html'>plot_layout</a></span><span class='op'>(</span>heights <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_annotation.html'>plot_annotation</a></span><span class='op'>(</span></span>
<span>    title <span class='op'>=</span> <span class='st'>"**Where do most immigrants of these European countries originate from?**"</span>,</span>
<span>    subtitle <span class='op'>=</span> <span class='st'>"Arranged by their citizens' feelings towards immigrants, together with the top 5 countries of origin"</span>,</span>
<span>    theme <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>      plot.title <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>19</span>, hjust <span class='op'>=</span> <span class='fl'>0.5</span>,</span>
<span>                                    margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>5</span>, b <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>,</span>
<span>                                    family <span class='op'>=</span> <span class='st'>"oswald"</span><span class='op'>)</span>,</span>
<span>      plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>14</span>, hjust <span class='op'>=</span> <span class='fl'>0.5</span>,</span>
<span>                                       margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>1</span>, b <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>,</span>
<span>                                       family <span class='op'>=</span> <span class='st'>"oswald"</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 id="final-recreation">Final Recreation</h3>
<p>Here, we print to see our final product.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># 11: display plot </span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>final_plot</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="100570651_files/figure-html5/print-rec-1.png" width="100%" data-distill-preview=1 style="display: block; margin: auto;" /></p>
</div>
<h2 id="improvement">Improvement</h2>
<h3 id="improvement-introduction">Improvement Introduction</h3>
<p>While visually pleasing, the original graph doesn’t immediately reveal any interesting trends in the data. Therefore, for my improvement, I decided to make a scatter plot that more clearly shows a hidden trend in the data: a relationship between attitudes towards immigration and geographical distance. I utilized the previous elements of content classification and immigrants origins, but I made changes to the way we see them. My goals was to tell a more interesting story with the data.</p>
<p>First, I calculated the immigrants average distance to their home country from their new country of residence, using the coordinates of capital cities. This average distance is displayed on the X-axis. The Y axis still demonstrates the sentiment scores of recipients countries, from most negative being (at 0) to most positive. I also created a color classification, that divides immigrant destination countries into a simplified two categories: one receiving their top 5 immigration populations only from other European countries, and the other receiving immigrants from multiple continents.</p>
<p>It’s important to note that my final model found an R correlation of only 0.54. For some fields this might be considered not as impressive, but I found it higher than expected as a single variable predictor in the social sciences. Furthermore, it is extremely difficult to predict something as nuanced as a “sentiment”.</p>
<p>There are many limitations to the model explained more thoroughly throughout this tutorial, including: the use of capital cities as approximations for distance calculations, and the exclusion of Brazilian immigrants living in Portugal.</p>
<h3 id="libraries-1">Libraries</h3>
<p>The first step of the improvement is to load the new needed libraries. This includes the rnaturalearth and geosphere packages which will be used to calculate the average distances between destination countries and immigrants home countries.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>geosphere</span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggrepel.slowkow.com/'>ggrepel</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/yixuan/showtext'>showtext</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://docs.ropensci.org/rnaturalearth/'>rnaturalearth</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://docs.ropensci.org/rnaturalearthdata/'>rnaturalearthdata</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://r-spatial.github.io/sf/'>sf</a></span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 id="graph-preparation">Graph Preparation</h3>
<h4 id="font-set-up">Font Set-up</h4>
<p>I decided to use a different font for my recreation. Because the new graph will be a regression model, my goal was to chose an academic looking font that is easy to read. I chose to us “Marcellus” from Google_fonts.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/sysfonts/man/font_add_google.html'>font_add_google</a></span><span class='op'>(</span><span class='st'>"Marcellus"</span>, <span class='st'>"marcellus"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/showtext/man/showtext_auto.html'>showtext_auto</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/showtext/man/showtext_opts.html'>showtext_opts</a></span><span class='op'>(</span>dpi <span class='op'>=</span> <span class='fl'>300</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="coordinates-from-natural-earth-database">Coordinates from Natural Earth Database</h4>
<p>Next, the coordinates of capital cities for each receiving country and immigrant origin country are found using Natural Earth, which is a free map database. Coordinates of capital cities are used for approximation. It is important to not that GB is representing the UK in the Natural Earth database.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#download a data set of all populated places (cities) in the world from natural earth, saved as "cities"</span></span>
<span><span class='va'>cities</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://docs.ropensci.org/rnaturalearth/reference/ne_download.html'>ne_download</a></span><span class='op'>(</span>scale <span class='op'>=</span> <span class='fl'>110</span>, type <span class='op'>=</span> <span class='st'>'populated_places'</span>, </span>
<span>                      category <span class='op'>=</span> <span class='st'>'cultural'</span>, returnclass <span class='op'>=</span> <span class='st'>'sf'</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>capitals_raw</span> <span class='op'>&lt;-</span> <span class='va'>cities</span> <span class='op'>|&gt;</span> <span class='co'>#this filters for capital cities</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>FEATURECLA</span> <span class='op'>==</span> <span class='st'>"Admin-0 capital"</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_geometry.html'>st_drop_geometry</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>NAME</span>, <span class='va'>ISO_A2</span>, <span class='va'>LATITUDE</span>, <span class='va'>LONGITUDE</span><span class='op'>)</span> <span class='co'># this selects the relevant variables. </span></span>
<span></span>
<span><span class='va'>needed_countries</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span> <span class='co'>#selecting the countries I need from my original data set </span></span>
<span>  <span class='st'>"AT"</span>, <span class='st'>"BE"</span>, <span class='st'>"CZ"</span>, <span class='st'>"DE"</span>, <span class='st'>"DK"</span>, <span class='st'>"ES"</span>, </span>
<span>  <span class='st'>"FI"</span>, <span class='st'>"FR"</span>, <span class='st'>"HU"</span>, <span class='st'>"IE"</span>, <span class='st'>"IS"</span>, <span class='st'>"IT"</span>, </span>
<span>  <span class='st'>"NL"</span>, <span class='st'>"NO"</span>, <span class='st'>"PT"</span>, <span class='st'>"SE"</span>,<span class='st'>"AL"</span>, <span class='st'>"BA"</span>, </span>
<span>  <span class='st'>"EE"</span>, <span class='st'>"HR"</span>, <span class='st'>"LT"</span>, <span class='st'>"LV"</span>, <span class='st'>"PL"</span>, <span class='st'>"RO"</span>, </span>
<span>  <span class='st'>"RS"</span>, <span class='st'>"SK"</span>, <span class='st'>"TR"</span>, <span class='st'>"UA"</span>, <span class='st'>"GB"</span>, <span class='co'>#GB = UK in this package </span></span>
<span>  <span class='st'>"CV"</span>, <span class='st'>"DZ"</span>, <span class='st'>"ER"</span>, <span class='st'>"MA"</span>, <span class='st'>"SO"</span>, <span class='st'>"AF"</span>, </span>
<span>  <span class='st'>"CN"</span>, <span class='st'>"IN"</span>, <span class='st'>"IQ"</span>, <span class='st'>"RU"</span>, <span class='st'>"VN"</span>, <span class='st'>"BR"</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>country_coords</span> <span class='op'>&lt;-</span> <span class='va'>capitals_raw</span> <span class='op'>|&gt;</span> <span class='co'># keeps the capital cities from the countries above</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>ISO_A2</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>needed_countries</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    country_code <span class='op'>=</span> <span class='va'>ISO_A2</span>,</span>
<span>    lat <span class='op'>=</span> <span class='va'>LATITUDE</span>,</span>
<span>    lon <span class='op'>=</span> <span class='va'>LONGITUDE</span>,</span>
<span>    capital_name <span class='op'>=</span> <span class='va'>NAME</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>country_code</span>, <span class='va'>capital_name</span>, <span class='va'>lat</span>, <span class='va'>lon</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='kw'>if</span><span class='op'>(</span><span class='st'>"GB"</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>country_coords</span><span class='op'>$</span><span class='va'>country_code</span><span class='op'>)</span> <span class='op'>{</span> <span class='co'>#coding for UK instead of GB</span></span>
<span>  <span class='va'>country_coords</span> <span class='op'>&lt;-</span> <span class='va'>country_coords</span> <span class='op'>|&gt;</span> </span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>country_code <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>country_code</span> <span class='op'>==</span> <span class='st'>"GB"</span>, <span class='st'>"UK"</span>, <span class='va'>country_code</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span></code></pre>
</div>
</div>
<h4 id="calculating-new-metrics">Calculating New Metrics</h4>
<p>This section uses distHaversine and coordinates from capital cities to calculate the distances between each immigrant origin country and it’s corresponding destination. Then, it calculates the average distance “home” for immigrants in the top 5 most common immigrant populations for each of our destination countries. Furthermore, it calculates other important variables such as max and min distance, the percentage of immigrants from Europe vs not from Europe in each receiving country, as well as the absolute count of immigrants within the top 5 immigrant populations for each country. This final metric will be important for determining the size of our dots. Essentially, this section calculates the summary statistics of my data.
It’s important to note that I made the conscious chose to exclude Brazilian immigrants in Portugal from the data. This was due to the fact it was the only South American country represented in the data, and the fact that these two cultures share a common native language. I was concerned it would have a significant effect on our findings.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># population volume and continent diversity classification</span></span>
<span><span class='va'>destination_metrics</span> <span class='op'>&lt;-</span> <span class='va'>combined_data</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='co'>#this matches each DESTINATION country with it's capital</span></span>
<span>    <span class='va'>country_coords</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"destination_country"</span> <span class='op'>=</span> <span class='st'>"country_code"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span></span>
<span>    dest_lat <span class='op'>=</span> <span class='va'>lat</span>, dest_lon <span class='op'>=</span> <span class='va'>lon</span>, dest_capital <span class='op'>=</span> <span class='va'>capital_name</span><span class='op'>)</span> <span class='op'>|&gt;</span> <span class='co'>#renames columns</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='co'>#matches IMMIGRANTS country with coordinates of capital cities</span></span>
<span>    <span class='va'>country_coords</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"citizenship"</span> <span class='op'>=</span> <span class='st'>"country_code"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span></span>
<span>    origin_lat <span class='op'>=</span> <span class='va'>lat</span>, origin_lon <span class='op'>=</span> <span class='va'>lon</span>, origin_capital <span class='op'>=</span> <span class='va'>capital_name</span><span class='op'>)</span> <span class='op'>|&gt;</span> <span class='co'>#renames columns</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rowwise.html'>rowwise</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span> <span class='co'>#calculates the distance between each immigrant origin and it's destination country</span></span>
<span>    distance_km <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/geosphere/man/distHaversine.html'>distHaversine</a></span><span class='op'>(</span> </span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>dest_lon</span>, <span class='va'>dest_lat</span><span class='op'>)</span>,</span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>origin_lon</span>, <span class='va'>origin_lat</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span> <span class='op'>/</span> <span class='fl'>1000</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>citizenship</span> <span class='op'>!=</span> <span class='st'>"BR"</span><span class='op'>)</span> <span class='op'>|&gt;</span> <span class='co'>#filters out Brazilian immigrants</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>destination_country</span>, <span class='va'>avg_attitude</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span> <span class='co'>#calculating... </span></span>
<span>    avg_distance <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/weighted.mean.html'>weighted.mean</a></span><span class='op'>(</span><span class='va'>distance_km</span>, w <span class='op'>=</span> <span class='va'>percentage</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, <span class='co'>#avg distance</span></span>
<span>    max_distance <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>distance_km</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, <span class='co'>#max distance</span></span>
<span>    min_distance <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>distance_km</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, <span class='co'>#min distance</span></span>
<span>    num_continents <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/n_distinct.html'>n_distinct</a></span><span class='op'>(</span><span class='va'>continent</span><span class='op'>)</span>, <span class='co'>#how many distinct continents in each country's top 5 immigrant pops</span></span>
<span>    pct_europe <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>percentage</span><span class='op'>[</span><span class='va'>continent</span> <span class='op'>==</span> <span class='st'>"Europe"</span><span class='op'>]</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, <span class='co'>#percentage top 5 immigrants from Europe</span></span>
<span>    pct_non_europe <span class='op'>=</span> <span class='fl'>100</span> <span class='op'>-</span> <span class='va'>pct_europe</span>, <span class='co'>#percentage top 5 immigrants NOT from Europe</span></span>
<span>    top5_population_total <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>population</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, <span class='co'>#sum of top 5 immigrant pops</span></span>
<span>    .groups <span class='op'>=</span> <span class='st'>"drop"</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='va'>destination_metrics</span> <span class='op'>&lt;-</span> <span class='va'>destination_metrics</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    full_name <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span> <span class='co'>#converting country codes to full names</span></span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"AT"</span> <span class='op'>~</span> <span class='st'>"Austria"</span>,</span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"BE"</span> <span class='op'>~</span> <span class='st'>"Belgium"</span>,</span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"CZ"</span> <span class='op'>~</span> <span class='st'>"Czechia"</span>,</span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"DE"</span> <span class='op'>~</span> <span class='st'>"Germany"</span>,</span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"DK"</span> <span class='op'>~</span> <span class='st'>"Denmark"</span>,</span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"ES"</span> <span class='op'>~</span> <span class='st'>"Spain"</span>,</span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"FI"</span> <span class='op'>~</span> <span class='st'>"Finland"</span>,</span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"FR"</span> <span class='op'>~</span> <span class='st'>"France"</span>,</span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"HU"</span> <span class='op'>~</span> <span class='st'>"Hungary"</span>,</span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"IE"</span> <span class='op'>~</span> <span class='st'>"Ireland"</span>,</span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"IS"</span> <span class='op'>~</span> <span class='st'>"Iceland"</span>,</span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"IT"</span> <span class='op'>~</span> <span class='st'>"Italy"</span>,</span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"NL"</span> <span class='op'>~</span> <span class='st'>"Netherlands"</span>,</span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"NO"</span> <span class='op'>~</span> <span class='st'>"Norway"</span>,</span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"PT"</span> <span class='op'>~</span> <span class='st'>"Portugal"</span>,</span>
<span>      <span class='va'>destination_country</span> <span class='op'>==</span> <span class='st'>"SE"</span> <span class='op'>~</span> <span class='st'>"Sweden"</span>,</span>
<span>      <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='va'>destination_country</span></span>
<span>    <span class='op'>)</span>, <span class='co'>#countries labeled as either "Europe Only" or "Multiple Continents"</span></span>
<span>    diversity_type <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>num_continents</span> <span class='op'>==</span> <span class='fl'>1</span>, <span class='st'>"Europe Only"</span>, <span class='st'>"Multiple Continents"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='co'>#this determines whether their top 5 immigrant pops come all come from europe or not. </span></span></code></pre>
</div>
</div>
<h4 id="correlation-code">Correlation Code</h4>
<p>This code calculates the correlation coefficient between the two variables of interest: the attitude of countries towards immigration and the average distance between immigrants home country and their destination country. It leaves us with 0.54, meaning that countries with more distant immigrant populations tend to have more positive attitudes toward immigration.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>cor_avg_distance</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>destination_metrics</span><span class='op'>$</span><span class='va'>avg_attitude</span>, </span>
<span>                        <span class='va'>destination_metrics</span><span class='op'>$</span><span class='va'>avg_distance</span>, </span>
<span>                        use <span class='op'>=</span> <span class='st'>"complete.obs"</span><span class='op'>)</span> <span class='co'># we will only use rows with both variables available</span></span></code></pre>
</div>
</div>
<h3 id="building-scatterplot">Building Scatterplot</h3>
<h4 id="background-grid-gradient">Background Grid Gradient</h4>
<p>This section calculates the range for the x and y axis so that the background grid can be appropriately graphed and filled with a gradient color reflecting sentiments towards immigrants ( reflecting the measurement scale on the y axis)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># defines the plot ranges for ...</span></span>
<span><span class='va'>attitude_range</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>destination_metrics</span><span class='op'>$</span><span class='va'>avg_attitude</span><span class='op'>)</span> <span class='co'>#y axis</span></span>
<span><span class='va'>distance_range</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>destination_metrics</span><span class='op'>$</span><span class='va'>avg_distance</span><span class='op'>)</span> <span class='co'>#x axis</span></span>
<span></span>
<span><span class='va'>background_grid</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span><span class='op'>(</span></span>
<span>  <span class='co'># x axis: starts at 0 km and extend slightly past the max distance</span></span>
<span>  avg_distance <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='va'>distance_range</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span> <span class='op'>*</span> <span class='fl'>1.05</span>, length.out <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>,</span>
<span>  <span class='co'># y axis: covers the entire normalized attitude range from 0 to 1</span></span>
<span>  avg_attitude <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, length.out <span class='op'>=</span> <span class='fl'>200</span><span class='op'>)</span> </span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="principle-elements">Principle Elements</h4>
<p>This section builds the principle elements of the plot. This includes it’s axis, it’s gradient background, quadrant lines, the regression line and the points which have their size reflecting the total immigrant population count (in the top 5 immigrant populations).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>plot_distance</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>destination_metrics</span>, <span class='co'># our data</span></span>
<span>                        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>avg_distance</span>, y <span class='op'>=</span> <span class='va'>avg_attitude</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># sets up the x and y axis</span></span>
<span>  </span>
<span>  <span class='co'># 1: creates small tiles that cover the entire background with the gradient based on avg_attitude</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_tile.html'>geom_tile</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>background_grid</span>, </span>
<span>            <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>avg_distance</span>, y <span class='op'>=</span> <span class='va'>avg_attitude</span>, fill <span class='op'>=</span> <span class='va'>avg_attitude</span><span class='op'>)</span>,</span>
<span>            alpha <span class='op'>=</span> <span class='fl'>0.15</span><span class='op'>)</span> <span class='op'>+</span> <span class='co'>#alpha sets transparency</span></span>
<span>  </span>
<span>  <span class='co'># 2: defines the fill scale for the background gradient with scale_fill_gradient2</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_gradient.html'>scale_fill_gradient2</a></span><span class='op'>(</span></span>
<span>    low <span class='op'>=</span> <span class='st'>"#be0e01"</span>, <span class='co'># most negative attitudes</span></span>
<span>    mid <span class='op'>=</span> <span class='st'>"white"</span>, <span class='co'># neutral attitude</span></span>
<span>    high <span class='op'>=</span> <span class='st'>"#27AE60"</span>, <span class='co'># most positive attitudes</span></span>
<span>    midpoint <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/median.html'>median</a></span><span class='op'>(</span><span class='va'>destination_metrics</span><span class='op'>$</span><span class='va'>avg_attitude</span><span class='op'>)</span>, </span>
<span>    guide <span class='op'>=</span> <span class='st'>"none"</span> <span class='co'># indicates for no legend to be included</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span></span>
<span>  <span class='co'># 3: resets new_scale_color() to change colors for lines and points</span></span>
<span>  <span class='fu'>ggnewscale</span><span class='fu'>::</span><span class='fu'><a href='https://eliocamp.github.io/ggnewscale/reference/new_scale.html'>new_scale_color</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  </span>
<span>  <span class='co'># 4: divides graph into quadrants</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/median.html'>median</a></span><span class='op'>(</span><span class='va'>destination_metrics</span><span class='op'>$</span><span class='va'>avg_attitude</span><span class='op'>)</span>, <span class='co'>#horizontal line</span></span>
<span>             linetype <span class='op'>=</span> <span class='st'>"longdash"</span>, color <span class='op'>=</span> <span class='st'>"grey40"</span>, alpha <span class='op'>=</span> <span class='fl'>0.7</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/median.html'>median</a></span><span class='op'>(</span><span class='va'>destination_metrics</span><span class='op'>$</span><span class='va'>avg_distance</span><span class='op'>)</span>, <span class='co'>#vertical line</span></span>
<span>             linetype <span class='op'>=</span> <span class='st'>"longdash"</span>, color <span class='op'>=</span> <span class='st'>"grey40"</span>, alpha <span class='op'>=</span> <span class='fl'>0.7</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>### adding the regression line and points</span></span>
<span><span class='va'>plot_distance</span> <span class='op'>&lt;-</span> <span class='va'>plot_distance</span> <span class='op'>+</span></span>
<span>  <span class='co'># 5: adds the linear model line</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"lm"</span>, </span>
<span>              color <span class='op'>=</span> <span class='st'>"#1F7A8C"</span>, </span>
<span>              linewidth <span class='op'>=</span> <span class='fl'>0.5</span>, </span>
<span>              alpha <span class='op'>=</span> <span class='fl'>0.15</span>,</span>
<span>              fullrange <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>+</span> <span class='co'># stretches to cover whole graph</span></span>
<span>  <span class='co'># 6: adds the points </span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='va'>top5_population_total</span>, <span class='co'># dots relative to pop size</span></span>
<span>                 color <span class='op'>=</span> <span class='va'>diversity_type</span><span class='op'>)</span>,</span>
<span>             alpha <span class='op'>=</span> <span class='fl'>0.8</span>,</span>
<span>             stroke <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="attitude-and-country-label-annotations">Attitude and Country Label Annotations</h4>
<p>This step adds individual annotations to indicate more clearly the attitude gradient on the y axis. It also individually adds the country annotation labels to give the graph a cleaner look and ensure more accurate placement, especially for dots which lie close together.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>plot_distance</span> <span class='op'>&lt;-</span> <span class='va'>plot_distance</span> <span class='op'>+</span> </span>
<span>  <span class='co'># adds "Negative Attitude" label </span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>350</span>, y <span class='op'>=</span> <span class='fl'>0.45</span>, label <span class='op'>=</span> <span class='st'>"'Worsens My Country'"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span>, family <span class='op'>=</span> <span class='st'>"marcellus"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># adds "Positive Attitude" label </span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>350</span>, y <span class='op'>=</span> <span class='fl'>0.85</span>, label <span class='op'>=</span> <span class='st'>"'Improves My Country'"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span>, family <span class='op'>=</span> <span class='st'>"marcellus"</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  </span>
<span>  <span class='co'># adds country labels </span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>740</span>, y <span class='op'>=</span> <span class='fl'>0.585</span>, label <span class='op'>=</span> <span class='st'>"Austria"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span>, family <span class='op'>=</span> <span class='st'>"marcellus"</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>940</span>, y <span class='op'>=</span> <span class='fl'>0.6</span>, label <span class='op'>=</span> <span class='st'>"Belgium"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span>, family <span class='op'>=</span> <span class='st'>"marcellus"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2111</span>, y <span class='op'>=</span> <span class='fl'>0.48</span>, label <span class='op'>=</span> <span class='st'>"Czechia"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span>, family <span class='op'>=</span> <span class='st'>"marcellus"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>1000</span>, y <span class='op'>=</span> <span class='fl'>0.645</span>, label <span class='op'>=</span> <span class='st'>"Denmark"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span>, family <span class='op'>=</span> <span class='st'>"marcellus"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>1163</span> , y <span class='op'>=</span> <span class='fl'>0.593</span>, label <span class='op'>=</span> <span class='st'>"Finland"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span>, family <span class='op'>=</span> <span class='st'>"marcellus"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>1602</span>, y <span class='op'>=</span> <span class='fl'>0.59</span>, label <span class='op'>=</span> <span class='st'>"France"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span>, family <span class='op'>=</span> <span class='st'>"marcellus"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>1338</span>, y <span class='op'>=</span> <span class='fl'>0.7</span>, label <span class='op'>=</span> <span class='st'>"Germany"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span>, family <span class='op'>=</span> <span class='st'>"marcellus"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2450</span>, y <span class='op'>=</span> <span class='fl'>0.73</span>, label <span class='op'>=</span> <span class='st'>"Hungary"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span>, family <span class='op'>=</span> <span class='st'>"marcellus"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2800</span>, y <span class='op'>=</span> <span class='fl'>0.815</span>, label <span class='op'>=</span> <span class='st'>"Iceland"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span>, family <span class='op'>=</span> <span class='st'>"marcellus"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2062</span>, y <span class='op'>=</span> <span class='fl'>0.705</span>, label <span class='op'>=</span> <span class='st'>"Ireland"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span>, family <span class='op'>=</span> <span class='st'>"marcellus"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span></span>
<span>   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2000</span>, y <span class='op'>=</span> <span class='fl'>0.615</span>, label <span class='op'>=</span> <span class='st'>"Italy"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span>, family <span class='op'>=</span> <span class='st'>"marcellus"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>     <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>1075</span> , y <span class='op'>=</span> <span class='fl'>0.6607</span>, label <span class='op'>=</span> <span class='st'>"Netherlands"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>2.5</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span>, family <span class='op'>=</span> <span class='st'>"marcellus"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>863</span> , y <span class='op'>=</span> <span class='fl'>0.71</span>, label <span class='op'>=</span> <span class='st'>"Norway"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span>, family <span class='op'>=</span> <span class='st'>"marcellus"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2808</span> , y <span class='op'>=</span> <span class='fl'>0.755</span>, label <span class='op'>=</span> <span class='st'>"Portugal"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span>, family <span class='op'>=</span> <span class='st'>"marcellus"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2243</span> , y <span class='op'>=</span> <span class='fl'>0.8</span>, label <span class='op'>=</span> <span class='st'>"Spain"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span>, family <span class='op'>=</span> <span class='st'>"marcellus"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>3081</span> , y <span class='op'>=</span> <span class='fl'>0.70</span>, label <span class='op'>=</span> <span class='st'>"Sweden"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span>, family <span class='op'>=</span> <span class='st'>"marcellus"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="scaling-and-legends-customization">Scaling and Legends Customization</h4>
<p>Here, the legend and coloring of the points are created. These colors are based on their continent classification according the continent of origins of the immigrant populations. The size of the dots represent the country’s top 5 immigrant population size. The stylistic choice was made to remove the Y axis labeling details.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># continent diversity coloring </span></span>
<span><span class='va'>plot_distance</span> <span class='op'>&lt;-</span> <span class='va'>plot_distance</span> <span class='op'>+</span> </span>
<span>   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_color_manual</a></span><span class='op'>(</span></span>
<span>    values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Multiple Continents"</span> <span class='op'>=</span> <span class='st'>"#DA4167"</span>, <span class='st'>"Europe Only"</span><span class='op'>=</span> <span class='st'>"#0e00c3"</span><span class='op'>)</span>,</span>
<span>        name <span class='op'>=</span> <span class='st'>"Diversity of Immigrant Origins: Top 5 Populations"</span>,</span>
<span>    guide <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guide_legend.html'>guide_legend</a></span><span class='op'>(</span>override.aes <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>10</span>, shape <span class='op'>=</span> <span class='fl'>15</span><span class='op'>)</span><span class='op'>)</span>  <span class='co'>#overrides to create big legend, also using a square (as indicates in shape)</span></span>
<span>  <span class='op'>)</span> </span>
<span></span>
<span><span class='co'># dot size scale for population volume</span></span>
<span><span class='va'>plot_distance</span> <span class='op'>&lt;-</span> <span class='va'>plot_distance</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_size.html'>scale_size_continuous</a></span><span class='op'>(</span>range <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1.5</span>, <span class='fl'>12.5</span><span class='op'>)</span>, <span class='co'># controls dot size scale</span></span>
<span>                        name <span class='op'>=</span> <span class='st'>"Immigrant Count: Top 5 Populations"</span>, <span class='co'># legend title</span></span>
<span>                        labels <span class='op'>=</span> <span class='fu'><a href='https://scales.r-lib.org/reference/label_number.html'>label_number</a></span><span class='op'>(</span>big.mark <span class='op'>=</span> <span class='st'>","</span>, suffix <span class='op'>=</span> <span class='st'>" people"</span>, scale_cut <span class='op'>=</span> <span class='fu'><a href='https://scales.r-lib.org/reference/number.html'>cut_short_scale</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>, <span class='co'># adds commas, adds "people", uses abbrevs.</span></span>
<span>                        guide <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guide_legend.html'>guide_legend</a></span><span class='op'>(</span>override.aes <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>shape <span class='op'>=</span> <span class='fl'>1</span>, fill <span class='op'>=</span> <span class='cn'>NA</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='co'># only black outline</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'><a href='https://scales.r-lib.org/reference/comma.html'>comma_format</a></span><span class='op'>(</span>suffix <span class='op'>=</span> <span class='st'>" km"</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># creates x axis formats for labels</span></span>
<span></span>
<span><span class='co'># removes y-axis details</span></span>
<span><span class='va'>plot_distance</span> <span class='op'>&lt;-</span> <span class='va'>plot_distance</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span></span>
<span>    breaks <span class='op'>=</span> <span class='cn'>NULL</span>  <span class='co'># remove all Y axis labels - already added as annotations</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="theme">Theme</h4>
<p>This section applies the minimal theme, as well as a few customizations of the sizes, spaces, and colors for all text elements of the graph.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>plot_distance</span> <span class='op'>&lt;-</span> <span class='va'>plot_distance</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    <span class='co'># global font</span></span>
<span>    text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"marcellus"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># titles</span></span>
<span>    plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>13</span>, face <span class='op'>=</span> <span class='st'>"bold"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>b <span class='op'>=</span> <span class='fl'>2.5</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>10</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>b <span class='op'>=</span> <span class='fl'>7.5</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    plot.caption <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>7.5</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, color <span class='op'>=</span> <span class='st'>"grey40"</span>, margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    <span class='co'># axes</span></span>
<span>    axis.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>9</span>, face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>,</span>
<span>    axis.title.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>7.5</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    axis.title.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>r <span class='op'>=</span> <span class='fl'>7.5</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    axis.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>9</span><span class='op'>)</span>,</span>
<span>    <span class='co'># legends</span></span>
<span>    legend.position <span class='op'>=</span> <span class='st'>"right"</span>,</span>
<span>    legend.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>8.5</span>, face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>,</span>
<span>    legend.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>8.5</span><span class='op'>)</span>,</span>
<span>    legend.spacing.y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='st'>"cm"</span><span class='op'>)</span>,</span>
<span>    legend.key.size <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.6</span>, <span class='st'>"cm"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># grid and background</span></span>
<span>    panel.grid.major.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    panel.grid.major.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"grey80"</span>, linetype <span class='op'>=</span> <span class='st'>"dotted"</span><span class='op'>)</span>,</span>
<span>    plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>10</span><span class='op'>)</span>,</span>
<span>    plot.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"white"</span>, color <span class='op'>=</span> <span class='cn'>NA</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="titles">Titles</h4>
<p>This section specifies our titles and graph labels.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>plot_distance</span> <span class='op'>&lt;-</span> <span class='va'>plot_distance</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span></span>
<span>    title <span class='op'>=</span> <span class='st'>"Immigration Attitudes, Geographic Distance, and Immigrant Volume in Europe"</span>,</span>
<span>    subtitle <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span><span class='op'>(</span><span class='st'>"Correlation: r = %.2f | R² = %.2f"</span>, <span class='va'>cor_avg_distance</span>, <span class='va'>cor_avg_distance</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>,</span>
<span>    x <span class='op'>=</span> <span class='st'>"Average Distance from Top 5 Immigrant Countries (km)"</span>,</span>
<span>    y <span class='op'>=</span> <span class='st'>"Attitude Towards Immigration"</span>,</span>
<span>    caption <span class='op'>=</span> <span class='st'>"Data: ESS (Round 9) &amp; Eurostat 2018 | Coordinates: Natural Earth Data Database | Brazilian Immigrants Excluded"</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<h4 id="visible-plotting-window">Visible Plotting Window</h4>
<p>This section solidifies the visual plotting window, or what can be seen after the code is run.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>plot_distance</span> <span class='op'>&lt;-</span> <span class='va'>plot_distance</span> <span class='op'>+</span> </span>
<span>  <span class='co'># Use coord_cartesian to control the visible region</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span> <span class='co'>#zooms our view</span></span>
<span>    ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.4</span>, <span class='fl'>0.9</span><span class='op'>)</span>, <span class='co'>#limits of attitude scale shown in plot</span></span>
<span>    expand <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 id="final-improvement-plot">Final Improvement Plot</h3>
<p>Here, we print the final product.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>plot_distance</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="100570651_files/figure-html5/imp-print-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<h3 id="final-notes">Final Notes</h3>
<p>The found correlation in the improvement could be due to many reasons. For example, a selection effect. This could mean that immigrants who travel further distances may be more highly motivated or skilled, which could lead to more positive perceptions. Another possibility is geographical tensions. This would suggest that countries that are closer geographically might have historical tensions that influence immigration tolerance. Finally, economic factors could influence immigration patterns, as countries that attract long-distance immigrants might have stronger economies that make people feel more secure about immigration.</p>
<p>Despite the uncertainty about what causes the observed correlation, the improved graph accomplishes the goal of showing a more obvious trend in attitudes towards immigration in Europe. This project shows how visualization choices have a direct impact on how we understand data, and how R can be used as a tool to extract and examine trends that are not immediately visible.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
