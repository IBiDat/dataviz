<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>Nation-Wide Blackout in Spain</title>

  <meta property="description" itemprop="description" content="Tracking the generation and storage of energy in Spain April 28th, 2025."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2025-12-11"/>
  <meta property="article:created" itemprop="dateCreated" content="2025-12-11"/>
  <meta name="article:author" content="Amelia Shuler"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Nation-Wide Blackout in Spain"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Tracking the generation and storage of energy in Spain April 28th, 2025."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Nation-Wide Blackout in Spain"/>
  <meta property="twitter:description" content="Tracking the generation and storage of energy in Spain April 28th, 2025."/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","categories","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["Nation-Wide Blackout in Spain"]},{"type":"character","attributes":{},"value":["Tracking the generation and storage of energy in Spain April 28th, 2025.\n"]},{"type":"character","attributes":{},"value":["2025"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Amelia Shuler"]}]}]},{"type":"character","attributes":{},"value":["2025-12-11"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["100575891_files/anchor-4.2.2/anchor.min.js","100575891_files/bowser-1.9.3/bowser.min.js","100575891_files/data/Custom-Report-2025-04-28-Estructura de almacenamiento (MW).csv","100575891_files/data/Custom-Report-2025-04-28-Estructura de generación (MW).csv","100575891_files/data/Custom-Report-2025-04-28-Seguimiento de la demanda de energía eléctrica (MW).csv","100575891_files/distill-2.2.21/template.v2.js","100575891_files/figure-html5/basic_plot-1.png","100575891_files/figure-html5/basic_theming-1.png","100575891_files/figure-html5/external_annotations-1.png","100575891_files/figure-html5/imported_energy-1.png","100575891_files/figure-html5/improvement-1.png","100575891_files/figure-html5/improvement-2.png","100575891_files/figure-html5/internal_annotations-1.png","100575891_files/figure-html5/main_plot-1.png","100575891_files/figure-html5/non_renewable-1.png","100575891_files/figure-html5/renewable-1.png","100575891_files/figure-html5/scaling-1.png","100575891_files/figure-html5/side_rail-1.png","100575891_files/figure-html5/stored_energy-1.png","100575891_files/figure-html5/unnamed-chunk-1-1.png","100575891_files/figure-html5/unnamed-chunk-10-1.png","100575891_files/figure-html5/unnamed-chunk-11-1.png","100575891_files/figure-html5/unnamed-chunk-19-1.png","100575891_files/figure-html5/unnamed-chunk-19-2.png","100575891_files/figure-html5/unnamed-chunk-21-1.png","100575891_files/figure-html5/unnamed-chunk-22-1.png","100575891_files/figure-html5/unnamed-chunk-23-1.png","100575891_files/figure-html5/unnamed-chunk-24-1.png","100575891_files/figure-html5/unnamed-chunk-24-2.png","100575891_files/figure-html5/unnamed-chunk-25-1.png","100575891_files/figure-html5/unnamed-chunk-25-2.png","100575891_files/figure-html5/unnamed-chunk-26-1.png","100575891_files/figure-html5/unnamed-chunk-26-2.png","100575891_files/figure-html5/unnamed-chunk-5-1.png","100575891_files/figure-html5/unnamed-chunk-6-1.png","100575891_files/figure-html5/unnamed-chunk-7-1.png","100575891_files/figure-html5/unnamed-chunk-8-1.png","100575891_files/figure-html5/unnamed-chunk-9-1.png","100575891_files/header-attrs-2.29/header-attrs.js","100575891_files/jquery-3.6.0/jquery-3.6.0.js","100575891_files/jquery-3.6.0/jquery-3.6.0.min.js","100575891_files/jquery-3.6.0/jquery-3.6.0.min.map","100575891_files/popper-2.6.0/popper.min.js","100575891_files/tippy-6.2.7/tippy-bundle.umd.min.js","100575891_files/tippy-6.2.7/tippy-light-border.css","100575891_files/tippy-6.2.7/tippy.css","100575891_files/tippy-6.2.7/tippy.umd.min.js","100575891_files/webcomponents-2.0.0/webcomponents.js","images/annotation-issues.gif","images/import-export-issues.png","images/improvement.png","images/original-chart.png","images/replicated-chart.png"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  hr.section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    margin: 0px;
  }


  d-byline {
    border-top: none;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
    border-top: none;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  /* tweak for Pandoc numbered line within distill */
  d-article pre.numberSource code > span {
      left: -2em;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // separator
    var separator = '<hr class="section-separator" style="clear: both"/>';
    // prepend separator above appendix
    $('.d-byline').before(separator);
    $('.d-article').before(separator);

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme, except when numbering line
    // in code chunk
    $('pre:not(.numberLines) code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        var author_name = front_matter.authors[i].author
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="100575891_files/header-attrs-2.29/header-attrs.js"></script>
  <script src="100575891_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="100575891_files/popper-2.6.0/popper.min.js"></script>
  <link href="100575891_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="100575891_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="100575891_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="100575891_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="100575891_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="100575891_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="100575891_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Nation-Wide Blackout in Spain","description":"Tracking the generation and storage of energy in Spain April 28th, 2025.","authors":[{"author":"Amelia Shuler","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2025-12-11T00:00:00.000+01:00","citationText":"Shuler, 2025"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Nation-Wide Blackout in Spain</h1>

<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt-tag">2025</div>
</div>
<!--/radix_placeholder_categories-->
<p><p>Tracking the generation and storage of energy in Spain April 28th, 2025.</p></p>
</div>

<div class="d-byline">
  
  Amelia Shuler
  
<br/>2025-12-11
</div>

<div class="d-article">
<h1 id="introduction">Introduction</h1>
<p>On April 28th, 2025 starting at 12:33 CEST (local time), Spain, parts of Portugal, and parts of France suffered complete shutdown of the electricity grid which lasted roughly ten hours. Trains ceased to run, radio and cellular signals shut down, shops returned to a cash-based system, and Spain’s nuclear power plants were taken off the grid automatically. The BBC estimates that the blackout caused a €1.6 billion hit to the economy.</p>
<p>Hours after the collapse, constituents demanded answers and looked to Spain’s sole Transmission System Operator (TSO), Red Eléctrica. The company is responsible for transmitting, organizing, and securing electrical supply to all of mainland Spain and the islands. On April 28th and the following days, there was a frenzy of press conferences, news announcements, and statements from Red Eléctrica to answer the question: how did this happen?</p>
<p>Red Eléctrica has <a href="https://demanda.ree.es/visiona/peninsula/nacionalau/acumulada/2025-04-28">publicly available generation data</a> that tracks types of generation and storage. The Europa Press quickly used this data <a href="https://www.europapress.es/economia/noticia-graficos-asi-desplomo-energia-electrica-apagon-20250429111043.html#google_vignette">to create graphics</a> hoping to provide context to the blackout. On April 29th, they published an area graph of generation and storage of energy in Spain during the blackout.</p>
<h2 id="original-graph">Original Graph</h2>
<figure>
<img src="images/original-chart.png" class="external" style="width:100.0%" alt="Original chart. Source: https://www.europapress.es/economia/noticia-graficos-asi-desplomo-energia-electrica-apagon-20250429111043.html" />
<figcaption aria-hidden="true">Original chart. Source: <a href="https://www.europapress.es/economia/noticia-graficos-asi-desplomo-energia-electrica-apagon-20250429111043.html" class="uri">https://www.europapress.es/economia/noticia-graficos-asi-desplomo-energia-electrica-apagon-20250429111043.html</a></figcaption>
</figure>
<p>There are some obvious issues with this graph: it’s density of information makes it difficult to read and comprehend. With 15 types of energy and storage being tracked, along with marking the blackout time and line of real demand, there is a lot of information here that is missing context.</p>
<p>However, there are larger issues when the graph is studied in more detail. As seen later on, the data is manipulated (without disclosure). The lines pointing to “Turbinación bombeo” and “Consumo bombeo” do not align with their labels. There are a number of areas without labels, such as the light green part in the upper left hand corner. All of these leave much room for improvement, which will be seen after the recreation.</p>
<h1 id="libraries">Libraries</h1>
<p><code>Tidyverse</code> cleaned and modified the data.</p>
<p><code>Lubridate</code> handled the x axis which was date-time.</p>
<p><code>GGplot2</code> provided the graphics.</p>
<p><code>Scales</code> allows some styling of the scales.</p>
<p><code>Patchwork</code> is relevant for the improvement, as it allows graphs to be plotted side-by-side.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://lubridate.tidyverse.org'>lubridate</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://scales.r-lib.org'>scales</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://patchwork.data-imaginist.com'>patchwork</a></span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h1 id="data">Data</h1>
<h2 id="data-access">Data Access</h2>
<p>As mentioned before, Red Eléctrica <a href="https://demanda.ree.es/visiona/peninsula/nacionalau/acumulada/2025-04-28">offers access</a> to their historical generation and storage data as convenient .csv files. While most of the data is contained in “Estructura de generación”, “Estructura de almacenamiento” provided turbinación bombeo, consumo bombeo, entrega de baterías, and carga de baterías. “Seguimiento de la demanda de energía eléctria” provided the data for the “real demand” line.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>generacion</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100575891_files/data/Custom-Report-2025-04-28-Estructura de generación (MW).csv"</span><span class='op'>)</span></span>
<span><span class='va'>almacenamiento</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100575891_files/data/Custom-Report-2025-04-28-Estructura de almacenamiento (MW).csv"</span><span class='op'>)</span></span>
<span><span class='va'>demanda</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100575891_files/data/Custom-Report-2025-04-28-Seguimiento de la demanda de energía eléctrica (MW).csv"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h2 id="issues-with-the-data-used-in-the-graph">Issues with the Data Used in the Graph</h2>
<p>When looking at the original graph and the replicated graph, it is clear the data is not the same.</p>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Original Graph</th>
<th>Replicated Graph</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><img src="images/original-chart.png" class="external" style="width:100.0%" alt="Original chart. Source: https://www.europapress.es/economia/noticia-graficos-asi-desplomo-energia-electrica-apagon-20250429111043.html" /></td>
<td><img src="images/replicated-chart.png" class="external" style="width:100.0%" alt="Replicated chart." /></td>
</tr>
</tbody>
</table>
<p>The left half of the graph, the data before the blackout, is nearly identical between the original graph and the replicated graph. The right half of the graph, after the blackout, is starkly different. The prevailing theory is that the data was manipulated in the original graph in order to better distinguish the labeling. In the replicated graph, some areas are too small to properly label. However, the original graph makes no indication of this change in the graph or in the accompanying webpage. It also lists the x axis as the same time frames, and the y axis as the same scales. Since replicating the modification would be a game of trial and error - not to mention unethical - it was excluded from the replication. The replicated graph uses the original, unedited data gathered from Red Eléctrica.</p>
<h2 id="data-cleanup">Data Cleanup</h2>
<p>The original graph uses a subset of variables from the generation and demand data sets. These datasets were also combined into one using “Hora” or hour.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># --------</span></span>
<span><span class='co'># Remove Unnecessary Columns</span></span>
<span><span class='co'># --------</span></span>
<span></span>
<span><span class='va'>generacion</span> <span class='op'>&lt;-</span> <span class='va'>generacion</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span></span>
<span>    <span class='va'>Hora</span>,</span>
<span>    <span class='va'>Marruecos.importación</span>,</span>
<span>    <span class='va'>Portugal.importación</span>,</span>
<span>    <span class='va'>Francia.importación</span>,</span>
<span>    <span class='va'>Térmica.renovable</span>,</span>
<span>    <span class='va'>Solar.térmica</span>,</span>
<span>    <span class='va'>Solar.fotovoltaica</span>,</span>
<span>    <span class='va'>Eólica</span>,</span>
<span>    <span class='va'>Cogeneración.y.residuos</span>,</span>
<span>    <span class='va'>Turbina.de.gas</span>,</span>
<span>    <span class='va'>Motores.diésel</span>,</span>
<span>    <span class='va'>Turbina.de.vapor</span>,</span>
<span>    <span class='va'>Ciclo.combinado</span>,</span>
<span>    <span class='va'>Carbón</span>,</span>
<span>    <span class='va'>Nuclear</span>,</span>
<span>    <span class='va'>Hidráulica</span>,</span>
<span>    <span class='va'>Francia.exportación</span>,</span>
<span>    <span class='va'>Marruecos.exportación</span>,</span>
<span>    <span class='va'>Portugal.exportación</span>,</span>
<span>    <span class='va'>Andorra.exportación</span><span class='op'>)</span></span>
<span><span class='va'>demanda</span> <span class='op'>&lt;-</span> <span class='va'>demanda</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>Hora</span>, <span class='va'>Real</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># --------</span></span>
<span><span class='co'># Combining Data</span></span>
<span><span class='co'># --------</span></span>
<span></span>
<span><span class='va'>full_data</span> <span class='op'>&lt;-</span> <span class='va'>generacion</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>full_join</a></span><span class='op'>(</span><span class='va'>almacenamiento</span>, by <span class='op'>=</span> <span class='st'>"Hora"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># --------</span></span>
<span><span class='co'># Pivot Longer</span></span>
<span><span class='co'># --------</span></span>
<span></span>
<span><span class='va'>full_data</span> <span class='op'>&lt;-</span> <span class='va'>full_data</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span></span>
<span>    cols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>      <span class='va'>Marruecos.importación</span>,</span>
<span>      <span class='va'>Portugal.importación</span>,</span>
<span>      <span class='va'>Francia.importación</span>,</span>
<span>      <span class='va'>Térmica.renovable</span>,</span>
<span>      <span class='va'>Solar.térmica</span>,</span>
<span>      <span class='va'>Solar.fotovoltaica</span>,</span>
<span>      <span class='va'>Eólica</span>,</span>
<span>      <span class='va'>Cogeneración.y.residuos</span>,</span>
<span>      <span class='va'>Turbina.de.gas</span>,</span>
<span>      <span class='va'>Motores.diésel</span>,</span>
<span>      <span class='va'>Turbina.de.vapor</span>,</span>
<span>      <span class='va'>Ciclo.combinado</span>,</span>
<span>      <span class='va'>Carbón</span>,</span>
<span>      <span class='va'>Nuclear</span>,</span>
<span>      <span class='va'>Turbinación.bombeo</span>,</span>
<span>      <span class='va'>Entrega.de.baterías</span>,</span>
<span>      <span class='va'>Hidráulica</span>,</span>
<span>      <span class='va'>Carga.de.baterías</span>,</span>
<span>      <span class='va'>Consumo.bombeo</span>,</span>
<span>      <span class='va'>Francia.exportación</span>,</span>
<span>      <span class='va'>Marruecos.exportación</span>,</span>
<span>      <span class='va'>Portugal.exportación</span>,</span>
<span>      <span class='va'>Andorra.exportación</span><span class='op'>)</span>,</span>
<span>    names_to <span class='op'>=</span> <span class='st'>"Type"</span>,</span>
<span>    values_to <span class='op'>=</span> <span class='st'>"Rating"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>The variable “Type” was set as a factor to properly order the areas as they appear in the graph. “Rating” was ensured to be numeric for the y graph, and “Hora” was set to a date-time variable with as.POSIXct().</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># --------</span></span>
<span><span class='co'># Set Type as Factor</span></span>
<span><span class='co'># --------</span></span>
<span></span>
<span><span class='va'>full_data</span><span class='op'>$</span><span class='va'>Type</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>full_data</span><span class='op'>$</span><span class='va'>Type</span>, ordered <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span>
<span><span class='va'>full_data</span> <span class='op'>&lt;-</span> <span class='va'>full_data</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    Type <span class='op'>=</span> <span class='fu'><a href='https://forcats.tidyverse.org/reference/fct_relevel.html'>fct_relevel</a></span><span class='op'>(</span><span class='va'>Type</span>,</span>
<span>                       <span class='st'>"Marruecos.importación"</span>,</span>
<span>                       <span class='st'>"Portugal.importación"</span>,</span>
<span>                       <span class='st'>"Francia.importación"</span>,</span>
<span>                       <span class='st'>"Térmica.renovable"</span>,</span>
<span>                       <span class='st'>"Solar.térmica"</span>,</span>
<span>                       <span class='st'>"Solar.fotovoltaica"</span>,</span>
<span>                       <span class='st'>"Eólica"</span>,</span>
<span>                       <span class='st'>"Hidráulica"</span>,</span>
<span>                       <span class='st'>"Cogeneración.y.residuos"</span>,</span>
<span>                       <span class='st'>"Ciclo.combinado"</span>,</span>
<span>                       <span class='st'>"Carbón"</span>,</span>
<span>                       <span class='st'>"Nuclear"</span>,</span>
<span>                       <span class='st'>"Turbinación.bombeo"</span>,</span>
<span>                       <span class='st'>"Turbina.de.gas"</span>,</span>
<span>                       <span class='st'>"Motores.diésel"</span>,</span>
<span>                       <span class='st'>"Turbina.de.vapor"</span>,</span>
<span>                       <span class='st'>"Entrega.de.baterías"</span>,</span>
<span>                       <span class='st'>"Carga.de.baterías"</span>,</span>
<span>                       <span class='st'>"Andorra.exportación"</span>,</span>
<span>                       <span class='st'>"Marruecos.exportación"</span>,</span>
<span>                       <span class='st'>"Portugal.exportación"</span>,</span>
<span>                       <span class='st'>"Francia.exportación"</span>,</span>
<span>                       <span class='st'>"Consumo.bombeo"</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># --------</span></span>
<span><span class='co'># Set Rating as Numeric</span></span>
<span><span class='co'># --------</span></span>
<span></span>
<span><span class='va'>full_data</span><span class='op'>$</span><span class='va'>Rating</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>full_data</span><span class='op'>$</span><span class='va'>Rating</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># --------</span></span>
<span><span class='co'># Set Real as Numeric</span></span>
<span><span class='co'># --------</span></span>
<span></span>
<span><span class='va'>demanda</span><span class='op'>$</span><span class='va'>Real</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>demanda</span><span class='op'>$</span><span class='va'>Real</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># --------</span></span>
<span><span class='co'># Set Hora as Date</span></span>
<span><span class='co'># --------</span></span>
<span></span>
<span><span class='va'>full_data</span> <span class='op'>&lt;-</span> <span class='va'>full_data</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    Hora <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='va'>Hora</span>, format <span class='op'>=</span> <span class='st'>"%Y-%m-%d %H:%M"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span><span class='va'>demanda</span> <span class='op'>&lt;-</span> <span class='va'>demanda</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    Hora <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='va'>Hora</span>, format <span class='op'>=</span> <span class='st'>"%Y-%m-%d %H:%M"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<p>In the end, full_data represents the energy production and storage. It consists of three variables:</p>
<p>Hora &lt;- The date and time of the reading</p>
<p>Type &lt;- The type of energy being generated.</p>
<p>Rating &lt;- The rating of the type of energy.</p>
<p>“Demanda” has the date and time of the energy demand, and the variable “real” represents the real demand for energy in megawatts.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>full_data</span></span></code></pre>
</div>
<pre><code># A tibble: 8,303 × 3
   Hora                Type                    Rating
   &lt;dttm&gt;              &lt;fct&gt;                    &lt;dbl&gt;
 1 2025-04-27 21:00:00 Marruecos.importación        0
 2 2025-04-27 21:00:00 Portugal.importación      1724
 3 2025-04-27 21:00:00 Francia.importación          0
 4 2025-04-27 21:00:00 Térmica.renovable          531
 5 2025-04-27 21:00:00 Solar.térmica              866
 6 2025-04-27 21:00:00 Solar.fotovoltaica         340
 7 2025-04-27 21:00:00 Eólica                    7327
 8 2025-04-27 21:00:00 Cogeneración.y.residuos   1643
 9 2025-04-27 21:00:00 Turbina.de.gas              95
10 2025-04-27 21:00:00 Motores.diésel             336
# ℹ 8,293 more rows</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>demanda</span></span></code></pre>
</div>
<pre><code>                   Hora  Real
1   2025-04-27 21:00:00 27386
2   2025-04-27 21:05:00 27868
3   2025-04-27 21:10:00 28254
4   2025-04-27 21:15:00 28301
5   2025-04-27 21:20:00 28718
6   2025-04-27 21:25:00 28946
7   2025-04-27 21:30:00 28920
8   2025-04-27 21:35:00 28745
9   2025-04-27 21:40:00 28539
10  2025-04-27 21:45:00 28547
11  2025-04-27 21:50:00 28493
12  2025-04-27 21:55:00 28697
13  2025-04-27 22:00:00 28453
14  2025-04-27 22:05:00 28588
15  2025-04-27 22:10:00 28342
16  2025-04-27 22:15:00 28284
17  2025-04-27 22:20:00 27878
18  2025-04-27 22:25:00 27837
19  2025-04-27 22:30:00 27200
20  2025-04-27 22:35:00 26962
21  2025-04-27 22:40:00 27125
22  2025-04-27 22:45:00 27020
23  2025-04-27 22:50:00 26895
24  2025-04-27 22:55:00 26504
25  2025-04-27 23:00:00 26404
26  2025-04-27 23:05:00 26009
27  2025-04-27 23:10:00 25700
28  2025-04-27 23:15:00 25402
29  2025-04-27 23:20:00 25400
30  2025-04-27 23:25:00 25315
31  2025-04-27 23:30:00 25256
32  2025-04-27 23:35:00 24796
33  2025-04-27 23:40:00 24708
34  2025-04-27 23:45:00 24372
35  2025-04-27 23:50:00 24133
36  2025-04-27 23:55:00 23976
37  2025-04-28 00:00:00 23921
38  2025-04-28 00:05:00 23694
39  2025-04-28 00:10:00 23620
40  2025-04-28 00:15:00 23485
41  2025-04-28 00:20:00 23618
42  2025-04-28 00:25:00 23569
43  2025-04-28 00:30:00 23456
44  2025-04-28 00:35:00 23324
45  2025-04-28 00:40:00 22976
46  2025-04-28 00:45:00 22614
47  2025-04-28 00:50:00 22613
48  2025-04-28 00:55:00 22655
49  2025-04-28 01:00:00 22606
50  2025-04-28 01:05:00 22634
51  2025-04-28 01:10:00 22374
52  2025-04-28 01:15:00 22312
53  2025-04-28 01:20:00 22330
54  2025-04-28 01:25:00 22532
55  2025-04-28 01:30:00 22182
56  2025-04-28 01:35:00 22114
57  2025-04-28 01:40:00 21857
58  2025-04-28 01:45:00 21814
59  2025-04-28 01:50:00 21699
60  2025-04-28 01:55:00 21779
61  2025-04-28 02:00:00 21741
62  2025-04-28 02:05:00 21464
63  2025-04-28 02:10:00 21455
64  2025-04-28 02:15:00 21220
65  2025-04-28 02:20:00 21303
66  2025-04-28 02:25:00 21420
67  2025-04-28 02:30:00 21311
68  2025-04-28 02:35:00 21160
69  2025-04-28 02:40:00 20942
70  2025-04-28 02:45:00 21066
71  2025-04-28 02:50:00 20928
72  2025-04-28 02:55:00 21202
73  2025-04-28 03:00:00 21014
74  2025-04-28 03:05:00 20900
75  2025-04-28 03:10:00 20944
76  2025-04-28 03:15:00 20910
77  2025-04-28 03:20:00 20830
78  2025-04-28 03:25:00 20792
79  2025-04-28 03:30:00 20909
80  2025-04-28 03:35:00 20789
81  2025-04-28 03:40:00 20810
82  2025-04-28 03:45:00 20641
83  2025-04-28 03:50:00 20629
84  2025-04-28 03:55:00 20690
85  2025-04-28 04:00:00 20729
86  2025-04-28 04:05:00 20576
87  2025-04-28 04:10:00 20646
88  2025-04-28 04:15:00 20956
89  2025-04-28 04:20:00 21009
90  2025-04-28 04:25:00 20840
91  2025-04-28 04:30:00 20855
92  2025-04-28 04:35:00 20895
93  2025-04-28 04:40:00 20777
94  2025-04-28 04:45:00 20723
95  2025-04-28 04:50:00 20666
96  2025-04-28 04:55:00 20799
97  2025-04-28 05:00:00 20984
98  2025-04-28 05:05:00 21240
99  2025-04-28 05:10:00 21354
100 2025-04-28 05:15:00 21319
101 2025-04-28 05:20:00 21394
102 2025-04-28 05:25:00 21532
103 2025-04-28 05:30:00 21797
104 2025-04-28 05:35:00 21610
105 2025-04-28 05:40:00 21631
106 2025-04-28 05:45:00 21949
107 2025-04-28 05:50:00 21958
108 2025-04-28 05:55:00 22436
109 2025-04-28 06:00:00 22581
110 2025-04-28 06:05:00 23163
111 2025-04-28 06:10:00 23577
112 2025-04-28 06:15:00 23908
113 2025-04-28 06:20:00 24117
114 2025-04-28 06:25:00 24256
115 2025-04-28 06:30:00 24411
116 2025-04-28 06:35:00 24781
117 2025-04-28 06:40:00 25091
118 2025-04-28 06:45:00 25177
119 2025-04-28 06:50:00 25461
120 2025-04-28 06:55:00 25621
121 2025-04-28 07:00:00 26125
122 2025-04-28 07:05:00 26615
123 2025-04-28 07:10:00 26939
124 2025-04-28 07:15:00 27247
125 2025-04-28 07:20:00 27316
126 2025-04-28 07:25:00 27557
127 2025-04-28 07:30:00 27717
128 2025-04-28 07:35:00 27830
129 2025-04-28 07:40:00 27865
130 2025-04-28 07:45:00 28136
131 2025-04-28 07:50:00 28293
132 2025-04-28 07:55:00 28515
133 2025-04-28 08:00:00 28551
134 2025-04-28 08:05:00 28736
135 2025-04-28 08:10:00 29136
136 2025-04-28 08:15:00 29182
137 2025-04-28 08:20:00 29169
138 2025-04-28 08:25:00 29325
139 2025-04-28 08:30:00 29255
140 2025-04-28 08:35:00 29062
141 2025-04-28 08:40:00 29003
142 2025-04-28 08:45:00 28898
143 2025-04-28 08:50:00 28963
144 2025-04-28 08:55:00 28897
145 2025-04-28 09:00:00 28913
146 2025-04-28 09:05:00 28770
147 2025-04-28 09:10:00 28758
148 2025-04-28 09:15:00 28854
149 2025-04-28 09:20:00 28883
150 2025-04-28 09:25:00 28483
151 2025-04-28 09:30:00 28615
152 2025-04-28 09:35:00 28571
153 2025-04-28 09:40:00 28456
154 2025-04-28 09:45:00 28579
155 2025-04-28 09:50:00 28300
156 2025-04-28 09:55:00 28477
157 2025-04-28 10:00:00 28146
158 2025-04-28 10:05:00 28119
159 2025-04-28 10:10:00 28189
160 2025-04-28 10:15:00 27949
161 2025-04-28 10:20:00 27773
162 2025-04-28 10:25:00 27763
163 2025-04-28 10:30:00 27639
164 2025-04-28 10:35:00 27843
165 2025-04-28 10:40:00 27911
166 2025-04-28 10:45:00 27704
167 2025-04-28 10:50:00 27576
168 2025-04-28 10:55:00 27177
169 2025-04-28 11:00:00 26992
170 2025-04-28 11:05:00 27560
171 2025-04-28 11:10:00 28158
172 2025-04-28 11:15:00 27634
173 2025-04-28 11:20:00 27158
174 2025-04-28 11:25:00 27077
175 2025-04-28 11:30:00 27153
176 2025-04-28 11:35:00 26890
177 2025-04-28 11:40:00 26983
178 2025-04-28 11:45:00 26968
179 2025-04-28 11:50:00 26803
180 2025-04-28 11:55:00 26458
181 2025-04-28 12:00:00 26503
182 2025-04-28 12:05:00 26408
183 2025-04-28 12:10:00 27150
184 2025-04-28 12:15:00 26892
185 2025-04-28 12:20:00 26898
186 2025-04-28 12:25:00 27075
187 2025-04-28 12:30:00 26968
188 2025-04-28 12:35:00  1785
189 2025-04-28 12:40:00  1778
190 2025-04-28 12:45:00  1771
191 2025-04-28 12:50:00  1771
192 2025-04-28 12:55:00  1769
193 2025-04-28 13:00:00  1791
194 2025-04-28 13:05:00  1807
195 2025-04-28 13:10:00  1984
196 2025-04-28 13:15:00  2012
197 2025-04-28 13:20:00  2034
198 2025-04-28 13:25:00  2027
199 2025-04-28 13:30:00  2089
200 2025-04-28 13:35:00  2156
201 2025-04-28 13:40:00  2194
202 2025-04-28 13:45:00  2307
203 2025-04-28 13:50:00  2373
204 2025-04-28 13:55:00  2434
205 2025-04-28 14:00:00  2476
206 2025-04-28 14:05:00  2499
207 2025-04-28 14:10:00  2548
208 2025-04-28 14:15:00  2641
209 2025-04-28 14:20:00  2692
210 2025-04-28 14:25:00  2738
211 2025-04-28 14:30:00  2764
212 2025-04-28 14:35:00  2775
213 2025-04-28 14:40:00  2816
214 2025-04-28 14:45:00  2886
215 2025-04-28 14:50:00  2972
216 2025-04-28 14:55:00  3053
217 2025-04-28 15:00:00  3092
218 2025-04-28 15:05:00  3217
219 2025-04-28 15:10:00  3288
220 2025-04-28 15:15:00  3331
221 2025-04-28 15:20:00  3415
222 2025-04-28 15:25:00  3498
223 2025-04-28 15:30:00  3680
224 2025-04-28 15:35:00  3791
225 2025-04-28 15:40:00  3827
226 2025-04-28 15:45:00  3924
227 2025-04-28 15:50:00  4024
228 2025-04-28 15:55:00  4151
229 2025-04-28 16:00:00  4255
230 2025-04-28 16:05:00  4253
231 2025-04-28 16:10:00  4426
232 2025-04-28 16:15:00  4445
233 2025-04-28 16:20:00  4450
234 2025-04-28 16:25:00  4499
235 2025-04-28 16:30:00  4531
236 2025-04-28 16:35:00  4650
237 2025-04-28 16:40:00  4705
238 2025-04-28 16:45:00  4794
239 2025-04-28 16:50:00  4926
240 2025-04-28 16:55:00  4963
241 2025-04-28 17:00:00  5102
242 2025-04-28 17:05:00  5233
243 2025-04-28 17:10:00  5402
244 2025-04-28 17:15:00  5523
245 2025-04-28 17:20:00  5660
246 2025-04-28 17:25:00  5908
247 2025-04-28 17:30:00  6194
248 2025-04-28 17:35:00  6421
249 2025-04-28 17:40:00  6717
250 2025-04-28 17:45:00  7068
251 2025-04-28 17:50:00  7252
252 2025-04-28 17:55:00  7550
253 2025-04-28 18:00:00  7771
254 2025-04-28 18:05:00  8231
255 2025-04-28 18:10:00  8371
256 2025-04-28 18:15:00  8525
257 2025-04-28 18:20:00  8620
258 2025-04-28 18:25:00  8741
259 2025-04-28 18:30:00  8955
260 2025-04-28 18:35:00  8898
261 2025-04-28 18:40:00  8882
262 2025-04-28 18:45:00  9244
263 2025-04-28 18:50:00  9427
264 2025-04-28 18:55:00  9563
265 2025-04-28 19:00:00  9899
266 2025-04-28 19:05:00 10042
267 2025-04-28 19:10:00 10187
268 2025-04-28 19:15:00 10366
269 2025-04-28 19:20:00 10466
270 2025-04-28 19:25:00 10554
271 2025-04-28 19:30:00 10694
272 2025-04-28 19:35:00 10790
273 2025-04-28 19:40:00 10895
274 2025-04-28 19:45:00 10946
275 2025-04-28 19:50:00 10973
276 2025-04-28 19:55:00 11122
277 2025-04-28 20:00:00 11496
278 2025-04-28 20:05:00 11790
279 2025-04-28 20:10:00 12119
280 2025-04-28 20:15:00 12336
281 2025-04-28 20:20:00 12501
282 2025-04-28 20:25:00 12778
283 2025-04-28 20:30:00 13048
284 2025-04-28 20:35:00 13307
285 2025-04-28 20:40:00 13721
286 2025-04-28 20:45:00 14263
287 2025-04-28 20:50:00 14727
288 2025-04-28 20:55:00 15054
289 2025-04-28 21:00:00 15298
290 2025-04-28 21:05:00 15450
291 2025-04-28 21:10:00 15437
292 2025-04-28 21:15:00 15413
293 2025-04-28 21:20:00 15348
294 2025-04-28 21:25:00 15319
295 2025-04-28 21:30:00 15336
296 2025-04-28 21:35:00 15460
297 2025-04-28 21:40:00 15541
298 2025-04-28 21:45:00 15720
299 2025-04-28 21:50:00 15895
300 2025-04-28 21:55:00 16009
301 2025-04-28 22:00:00 16167
302 2025-04-28 22:05:00 16383
303 2025-04-28 22:10:00 16400
304 2025-04-28 22:15:00 16648
305 2025-04-28 22:20:00 16900
306 2025-04-28 22:25:00 16873
307 2025-04-28 22:30:00 16737
308 2025-04-28 22:35:00 16695
309 2025-04-28 22:40:00 16727
310 2025-04-28 22:45:00 16557
311 2025-04-28 22:50:00 16606
312 2025-04-28 22:55:00 16632
313 2025-04-28 23:00:00 16657
314 2025-04-28 23:05:00 16614
315 2025-04-28 23:10:00 16777
316 2025-04-28 23:15:00 16928
317 2025-04-28 23:20:00 16920
318 2025-04-28 23:25:00 16825
319 2025-04-28 23:30:00 17022
320 2025-04-28 23:35:00 16948
321 2025-04-28 23:40:00 16912
322 2025-04-28 23:45:00 17046
323 2025-04-28 23:50:00 16924
324 2025-04-28 23:55:00 17019
325 2025-04-29 00:00:00 16858
326 2025-04-29 00:05:00 16898
327 2025-04-29 00:10:00 16813
328 2025-04-29 00:15:00 16788
329 2025-04-29 00:20:00 16775
330 2025-04-29 00:25:00 16743
331 2025-04-29 00:30:00 16665
332 2025-04-29 00:35:00 16602
333 2025-04-29 00:40:00 16582
334 2025-04-29 00:45:00 16557
335 2025-04-29 00:50:00 16685
336 2025-04-29 00:55:00 16406
337 2025-04-29 01:00:00 16411
338 2025-04-29 01:05:00 16461
339 2025-04-29 01:10:00 16452
340 2025-04-29 01:15:00 16326
341 2025-04-29 01:20:00 16673
342 2025-04-29 01:25:00 16631
343 2025-04-29 01:30:00 16473
344 2025-04-29 01:35:00 16460
345 2025-04-29 01:40:00 16484
346 2025-04-29 01:45:00 16443
347 2025-04-29 01:50:00 16431
348 2025-04-29 01:55:00 16384
349 2025-04-29 02:00:00 16270
350 2025-04-29 02:05:00 16179
351 2025-04-29 02:10:00 16053
352 2025-04-29 02:15:00 15505
353 2025-04-29 02:20:00 15446
354 2025-04-29 02:25:00 15408
355 2025-04-29 02:30:00 16172
356 2025-04-29 02:35:00 16204
357 2025-04-29 02:40:00 16206
358 2025-04-29 02:45:00 16211
359 2025-04-29 02:50:00 16327
360 2025-04-29 02:55:00 16399
361 2025-04-29 03:00:00 16291</code></pre>
</div>
<h1 id="creating-the-plot">Creating the Plot</h1>
<h2 id="fonts">Fonts</h2>
<p>The original fonts in the graph were Avenir Next. However, due to licensing and copyright, it was replaced with Roboto from Google fonts which has open licensing.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>sysfonts</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/sysfonts/man/font_add_google.html'>font_add_google</a></span><span class='op'>(</span><span class='st'>"Roboto"</span>, family<span class='op'>=</span><span class='st'>"roboto"</span><span class='op'>)</span></span>
<span><span class='fu'>showtext</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/showtext/man/showtext_auto.html'>showtext_auto</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h2 id="geom-area">Geom Area</h2>
<p>GGplot was used to set the x axis as time, the y axis as Rating (in Megawatts), and fill to Type. The lines were colored to white to match the original graph.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>final</span> <span class='op'>&lt;-</span></span>
<span>  <span class='co'># data</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># area lines </span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_ribbon.html'>geom_area</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>full_data</span>, </span>
<span>         <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span></span>
<span>           x <span class='op'>=</span> <span class='va'>Hora</span>,</span>
<span>           y <span class='op'>=</span> <span class='va'>Rating</span>,</span>
<span>           fill <span class='op'>=</span> <span class='va'>Type</span><span class='op'>)</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"white"</span>, <span class='co'># line color</span></span>
<span>    lwd <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span> <span class='co'># line width</span></span>
<span><span class='va'>final</span></span></code></pre>
</div>
<p><img src="100575891_files/figure-html5/basic_plot-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<h2 id="scales">Scales</h2>
<p>Colors were manually set using scale_fill_manual. The legend and labels for the scales were removed.</p>
<p>The limits for the y scale were set to -10,000 and 40,000 to match the graph. The separator for thousands, “,”, was changed to “.” to match the graph.</p>
<p>The x scale limits were set in date and time format. The division was also set to 2 hours to have the correct number of breaks. Finally, the formatting was set to only show the time.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>final</span> <span class='op'>&lt;-</span> <span class='va'>final</span> <span class='op'>+</span></span>
<span>    <span class='co'># colors</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>    Marruecos.importación <span class='op'>=</span> <span class='st'>"#d68888"</span>,</span>
<span>    Portugal.importación <span class='op'>=</span> <span class='st'>"#91b086"</span>,</span>
<span>    Francia.importación <span class='op'>=</span>  <span class='st'>"#809ad3"</span>,</span>
<span>    Térmica.renovable <span class='op'>=</span> <span class='st'>"#9e00ff"</span>,</span>
<span>    Solar.térmica <span class='op'>=</span> <span class='st'>"#ff0400"</span>,</span>
<span>    Solar.fotovoltaica <span class='op'>=</span> <span class='st'>"#e58401"</span>,</span>
<span>    Eólica <span class='op'>=</span> <span class='st'>"#70b026"</span>,</span>
<span>    Cogeneración.y.residuos <span class='op'>=</span> <span class='st'>"#d6a1d7"</span>,</span>
<span>    Turbina.de.gas <span class='op'>=</span> <span class='st'>"#ab2822"</span>,</span>
<span>    Motores.diésel <span class='op'>=</span> <span class='st'>"#92a59f"</span>,</span>
<span>    Turbina.de.vapor <span class='op'>=</span> <span class='st'>"#aa8f2e"</span>,</span>
<span>    Ciclo.combinado <span class='op'>=</span> <span class='st'>"#ffcc66"</span>,</span>
<span>    Carbón <span class='op'>=</span> <span class='st'>"#ad5a32"</span>,</span>
<span>    Nuclear <span class='op'>=</span> <span class='st'>"#474296"</span>,</span>
<span>    Turbinación.bombeo <span class='op'>=</span> <span class='st'>"#007cf8"</span>,</span>
<span>    Entrega.de.baterías <span class='op'>=</span> <span class='st'>"#2a6495"</span>,</span>
<span>    Hidráulica <span class='op'>=</span> <span class='st'>"#018fd1"</span>,</span>
<span>    Carga.de.baterías <span class='op'>=</span> <span class='st'>"#a3c0d8"</span>,</span>
<span>    Consumo.bombeo <span class='op'>=</span> <span class='st'>"#3b68bd"</span>,</span>
<span>    Francia.exportación <span class='op'>=</span> <span class='st'>"#0035a7"</span>,</span>
<span>    Marruecos.exportación <span class='op'>=</span> <span class='st'>"#b91017"</span>,</span>
<span>    Portugal.exportación <span class='op'>=</span> <span class='st'>"#006600"</span>,</span>
<span>    Andorra.exportación <span class='op'>=</span> <span class='st'>"#211e83"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_fixed.html'>coord_fixed</a></span><span class='op'>(</span>ratio <span class='op'>=</span> <span class='fl'>1</span>, xlim <span class='op'>=</span> <span class='cn'>NULL</span>, ylim <span class='op'>=</span> <span class='cn'>NULL</span>, expand <span class='op'>=</span> <span class='cn'>TRUE</span>, clip <span class='op'>=</span> <span class='st'>"off"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># remove legend</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># remove labels for scales</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>       y <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># adds . to y scale</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span></span>
<span>    labels <span class='op'>=</span> <span class='fu'><a href='https://scales.r-lib.org/reference/label_number.html'>label_number</a></span><span class='op'>(</span>big.mark <span class='op'>=</span> <span class='st'>"."</span>, decimal.mark <span class='op'>=</span> <span class='st'>","</span><span class='op'>)</span>,</span>
<span>    limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>10000</span>, <span class='fl'>40000</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># sets x scale</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_date.html'>scale_x_datetime</a></span><span class='op'>(</span></span>
<span>    breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span></span>
<span>      from <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 00:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>      to   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>      by   <span class='op'>=</span> <span class='st'>"2 hours"</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    labels <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='st'>"%H:%M"</span><span class='op'>)</span>,</span>
<span>    limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-27 23:45"</span>, tz<span class='op'>=</span><span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:30"</span>, tz<span class='op'>=</span><span class='st'>"Europe/Madrid"</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span><span class='va'>final</span></span></code></pre>
</div>
<p><img src="100575891_files/figure-html5/scaling-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<h2 id="theme">Theme</h2>
<p>The theme removed the plot’s grid lines, changed the color of the axis, modified the tick length and color, and set a global default for the fonts. It also modified the padding in order to add space for the external annotations.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>final</span> <span class='op'>&lt;-</span> <span class='va'>final</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    <span class='co'># removes background grey</span></span>
<span>    panel.background <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"white"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># changes line color</span></span>
<span>    panel.grid.major.y <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#d6d6d6"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span>,</span>
<span>    <span class='co'># remove axis tick y</span></span>
<span>    axis.ticks.y <span class='op'>=</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#ffffff"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># changes axis tick color</span></span>
<span>    axis.ticks.x <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#b8b8b8"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>,</span>
<span>    <span class='co'># changes axis length</span></span>
<span>    axis.ticks.length <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>.3</span>, <span class='st'>"cm"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># changes axis line</span></span>
<span>    axis.line <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#b8b8b8"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span>,</span>
<span>    <span class='co'># remove x grid</span></span>
<span>    panel.grid.major.x <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#ffffff00"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># set global font family</span></span>
<span>    text <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"roboto"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># set title size and weight</span></span>
<span>    plot.title <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>14</span>, face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>,</span>
<span>    plot.title.position <span class='op'>=</span> <span class='st'>"plot"</span>,</span>
<span>    <span class='co'># set x and y axis color</span></span>
<span>    axis.text <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#b8b8b8"</span><span class='op'>)</span>,</span>
<span>    axis.text.x <span class='op'>=</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># set caption color</span></span>
<span>    plot.caption <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#b8b8b8"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># padding of plot</span></span>
<span>    plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>15</span>, <span class='co'># top</span></span>
<span>                         <span class='fl'>90</span>, <span class='co'># right</span></span>
<span>                         <span class='fl'>45</span>, <span class='co'># bottom</span></span>
<span>                         <span class='fl'>15</span> <span class='co'># left</span></span>
<span>    <span class='op'>)</span></span>
<span>    <span class='op'>)</span></span>
<span><span class='va'>final</span></span></code></pre>
</div>
<p><img src="100575891_files/figure-html5/basic_theming-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<h2 id="internal-annotations">Internal Annotations</h2>
<p>The most difficult part of this graph were annotations set outside the plot of the graph. Four functions were attempted: <code>annotate()</code>, <code>annotation_custom()</code>, <code>grid.text()</code> and <code>geom_text()</code>. <code>Annotate()</code> worked well for annotations within the plot. However, it did not appear when the x and y values of the annotation were pushed beyond the limits of the plot. <code>Annotation_custom()</code> required the use of <code>unit(value, NPC)</code> as the x and y coordinate values. This meant that the text would respond to the preview panel size and not stay fixed to the graph.</p>
<figure>
<img src="images/annotation-issues.gif" class="external" style="width:100.0%" alt="Annotation Issues." />
<figcaption aria-hidden="true">Annotation Issues.</figcaption>
</figure>
<p>It also was struggling to work with <code>coord_cartesian(clip = "off")</code> meaning it would not appear even with clipping was off. <code>Grid.text()</code> was working with <code>coord_cartesian(clip = "off")</code>, however it still required the use of <code>unit(value, NPC)</code>, meaning it would respond with the browser size.</p>
<p>Finally, <code>geom_text()</code> and <code>geom_segment()</code> were used to add lines and words outside of the plot. While this resulted in a file of 5.2 MB, it allowed the graph to annotations needed outside of the plot while maintaining the as.POSIXct x scale units.</p>
<p>Each internal text annotation was given an x and y coordinate, a text color, a size, and a label. Each internal line annotation was given an x and y coordinate, an ending x and y coordinate, a line color of black, and a line width of 0.2.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>final</span> <span class='op'>&lt;-</span> <span class='va'>final</span> <span class='op'>+</span></span>
<span>  <span class='co'># demanda real line</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>demanda</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Hora</span>, y <span class='op'>=</span> <span class='va'>Real</span><span class='op'>)</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># title</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Estructura de generación y almacenamiento de energía en España durante el apagón"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># annotations</span></span>
<span>  <span class='co'># apagón</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span></span>
<span>      x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 12:32"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>      xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 12:32"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>      y <span class='op'>=</span> <span class='fl'>35000</span>,</span>
<span>      yend <span class='op'>=</span> <span class='op'>-</span><span class='fl'>10000</span><span class='op'>)</span>,</span>
<span>    linetype <span class='op'>=</span> <span class='st'>"dashed"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.6</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 12:32"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>37000</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Apagón"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># demanda real</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 17:45"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>20500</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Demanda real"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    geom <span class='op'>=</span> <span class='st'>"curve"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 17:35"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 19:35"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>19500</span>,</span>
<span>    yend <span class='op'>=</span> <span class='fl'>11500</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.15</span>, <span class='st'>"cm"</span><span class='op'>)</span>, type<span class='op'>=</span><span class='st'>"closed"</span><span class='op'>)</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    geom <span class='op'>=</span> <span class='st'>"point"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 19:55"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>11250</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>1.5</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># francia importacion</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 15:20"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>14500</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Francia \nimportación"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#809ad3"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>2.7</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0.5</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 15:35"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 18:35"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>13000</span>,</span>
<span>    yend <span class='op'>=</span> <span class='fl'>8000</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Marruecos importación</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 22:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>22500</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Marruecos \nimportación"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#d68888"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>2.7</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0.5</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 22:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 21:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>21000</span>,</span>
<span>    yend <span class='op'>=</span> <span class='fl'>15000</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># francia exportacion</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 02:15"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>9000</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Francia \nexportación"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#0035a7"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>2.7</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0.5</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 02:15"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 02:15"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>2000</span>,</span>
<span>    yend <span class='op'>=</span> <span class='op'>-</span><span class='fl'>7500</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># marruecos exportacion</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 07:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>8000</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Marruecos \nexportación"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#b91017"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>2.7</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0.5</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 08:15"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 10:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>7000</span>,</span>
<span>    yend <span class='op'>=</span> <span class='op'>-</span><span class='fl'>5000</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># portugal exportacion</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 10:25"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>10000</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Portugal \nexportación"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#006600"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>2.7</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0.5</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 10:25"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 10:35"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>9000</span>,</span>
<span>    yend <span class='op'>=</span> <span class='op'>-</span><span class='fl'>5000</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># turbinacion bombeo</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 16:45"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>5000</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Turbinación \nbombeo"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#007cf8"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>2.7</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0.5</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 19:45"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 19:45"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>4000</span>,</span>
<span>    yend <span class='op'>=</span> <span class='fl'>1300</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Consumo bombeo</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 22:45"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>5000</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Consumo \nbombeo"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#007cf8"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>2.7</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0.5</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>  <span class='op'>)</span></span>
<span><span class='va'>final</span></span></code></pre>
</div>
<p><img src="100575891_files/figure-html5/internal_annotations-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<h2 id="external-annotations">External Annotations</h2>
<p>Each external text annotation was removed of data, given an x and y coordinate, a text color, a size, label, font family, line height, and horizontal adjustment (to ensure proper alignment). While line height, size, and font family could’ve been combined into a global class, preliminary investigations did not yield a straightforward way to do this.</p>
<p>Each external line annotation was an x and y coordinate, an ending x and y coordinate, and a line width. Again, line width could’ve been combined into a global class, but preliminary investigations proved unfruitful.</p>
<p>Finally, the title was treated with <code>ggtitle()</code> instead of <code>geom_text()</code>. Initially, <code>geom_text()</code> was struggling to push the title so far out of the y axis, and <code>ggtitle()</code> was working better.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>final</span> <span class='op'>&lt;-</span> <span class='va'>final</span> <span class='op'>+</span></span>
<span>  <span class='co'># caption line</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-27 21:40"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 03:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>20000</span>,</span>
<span>    yend <span class='op'>=</span> <span class='op'>-</span><span class='fl'>20000</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#e2e2e2"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># caption text</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span> <span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:30"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>21500</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Fuente: Red Elétrica - EpData 2025"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#b8b8b8"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>2.7</span></span>
<span>  <span class='op'>)</span>  <span class='op'>+</span></span>
<span>  <span class='co'># termica renovable text</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:30"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>22500</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Térmica \nrenovable"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#9e00ff"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>2.7</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"roboto"</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># solar termica text</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 01:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>19000</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Solar \ntérmica"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#ff0400"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>2.7</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"roboto"</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># solar fotovoltaica text</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:55"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>16000</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Solar \nfotovoltaica"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#e58401"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>2.7</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"roboto"</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># eólica text</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:55"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>13500</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Eólica"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#70b026"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>2.7</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"roboto"</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># hidráulica text</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:55"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>11500</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Hidráulica"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#018fd1"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>2.7</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"roboto"</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># cogeneracion y residuos text</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:55"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>9000</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Cogeneración \ny residuos"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#d6a1d7"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>2.7</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"roboto"</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Ciclo combinado</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:55"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>2000</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Cogeneración \ny residuos"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#ab9559"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>2.7</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"roboto"</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># line consumo bombeo</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:25"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:30"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>200</span>,</span>
<span>    yend <span class='op'>=</span> <span class='op'>-</span><span class='fl'>4000</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.1</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># line ciclo combinado</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:45"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>4000</span>,</span>
<span>    yend <span class='op'>=</span> <span class='fl'>2500</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.1</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># line cogeneracion y residuos</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:45"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>9800</span>,</span>
<span>    yend <span class='op'>=</span> <span class='fl'>9500</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.1</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># line hidraulica</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:45"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>13000</span>,</span>
<span>    yend <span class='op'>=</span> <span class='fl'>12000</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.1</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># line eolica</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:45"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>17500</span>,</span>
<span>    yend <span class='op'>=</span> <span class='fl'>13500</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.1</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># line solar fotovoltaica </span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:45"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>17500</span>,</span>
<span>    yend <span class='op'>=</span> <span class='fl'>16000</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.1</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># line solar termica</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:45"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>17500</span>,</span>
<span>    yend <span class='op'>=</span> <span class='fl'>19000</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.1</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># line termica renovable</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:45"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>17500</span>,</span>
<span>    yend <span class='op'>=</span> <span class='fl'>22000</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.1</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># title line</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-27 21:40"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 03:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>43000</span>,</span>
<span>    yend <span class='op'>=</span> <span class='fl'>43000</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.3</span></span>
<span>  <span class='op'>)</span></span>
<span><span class='va'>final</span></span></code></pre>
</div>
<p><img src="100575891_files/figure-html5/external_annotations-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<h1 id="improvement">Improvement</h1>
<h2 id="visual-critique-of-existing-graph">Visual Critique of Existing Graph</h2>
<p>While an area graph is the correct choice for this kind of data - it shows how types of energy, represented as areas, are contributing to the whole of the production, the overarching area - there are too many variables in the graph to make sense of the data.</p>
<p>The other issues with this graph - misplaced annotations and missing annotations - are addressed in the improvement.</p>
<h2 id="audience-analysis">Audience Analysis</h2>
<p>The original graph was <a href="https://www.europapress.es/economia/noticia-graficos-asi-desplomo-energia-electrica-apagon-20250429111043.html#google_vignette">published by Europa Press</a>, a Spanish news source. It is assumed this graph was intended for a general audience, with limited understanding of energy production and storage. The main goal is to understand what types of energy were being produced at the time of and shortly after the blackout.</p>
<p>While usually the graph would be replicated and improved in Spanish to match the source, since this is an English-speaking masters program, the graph improvement was completed in English.</p>
<h2 id="variable-analysis">Variable Analysis</h2>
<p>The original graph replication was completed without detailed analysis of the variables. In order to improve the graph, the variables of the original data sets were analyzed to determine if any excluded would be relevant, and to determine how to better categorize the data.</p>
<h3 id="demanda">Demanda</h3>
<p>Real &lt;- Real represents the actual demand for energy from Spanish households, businesses, municipal buildings, hospitals, and other constituents. This is measured using meters and sensors.</p>
<p>Prevista &lt;- Prevista is the forecasted demand set by Red Eléctrica. This is predicted based on historical patterns, weather, and yesterday’s demand.</p>
<p>Programada &lt;- Programada represents the planned demand in the market. This is the energy that has been planned and agreed upon by energy providers. It determines which plants will run and provide energy.</p>
<h3 id="almacenamiento">Almacenamiento</h3>
<p>Turbinación.bombeo &lt;- Pumped-hydro storage is a system with water stored at two heights. When energy needs to be generated, the system pushes water from the higher reservoir to the lower reservoir. This is called pumped-hydro generation (turbinación bombeo) and tracks the energy generated from the system. That is why it is positive or zero.</p>
<p>Consumo.bombeo &lt;- Pumped-hydro storage is a system with water stored at two heights. When there is extra energy in the grid from other sources, the system pushes water from the lower reservoir to the higher reservoir. This is called pumping consumption (Consumo bombeo) and tracks the energy spent to store excess energy in this way. That is why it is always negative, since it is taking energy from the grid.</p>
<p>Entrega.de.baterías &lt;- Battery energy storage systems (BESS) are similar to pumped-hydro storage. Battery discharge (entrega de baterías) means energy is being delivered to the system from storage.</p>
<p>Carga.de.baterías &lt;- Excess energy is being stored in batteries. Both battery discharge and battery charging values are extremely low (-5 to 10), which means they will not be well represented in a plot with the other variables.</p>
<h3 id="generación">Generación</h3>
<p>Eólica &lt;- Eólica is the energy being generated by wind power. This makes up a large portion of Spain’s energy production. This is considered a renewable energy source.</p>
<p>Nuclear &lt;- Nuclear is the energy being generated by nuclear power. While not the first or second energy source, it still makes up a large portion of Spain’s energy production.</p>
<p>Carbón &lt;- Carbón is the energy being generated by coal. This is not a large energy source for Spain.</p>
<p>Ciclo.combinado &lt;- Ciclo combinado represents the energy produced by gas power plants. This is a larger producer than nuclear, but not as productive as wind or solar. This is not considered a renewable energy source.</p>
<p>Intercambios.int &lt;- This is the net exchange of energy between countries, however it does not equal the net exchange of imports and exports for Andorra, France, Morocco, and Portugal, so it must be including other countries. This is not an energy source, but rather represents a flow of energy.</p>
<p>Solar.fotovoltaica &lt;- This is the energy produced by solar panels. It’s output can be volatile since it relies on sunshine. Around noon, this hit a peak production of 17,000 MW. It is a renewable energy.</p>
<p>Solar.térmica &lt;- This is also solar energy, but with a different process. Mirrors are used to concentrate sunlight, use heat to produce steam, and use that steam to drive a turbine. This is a more stable type of solar energy, but its peak output was only 1,000 MW, much less than that of solar panels.</p>
<p>Térmica.renovable &lt;- This is energy produced by burning biomass (agricultural waste or wood pellets), biogas (a renewable gas fuel produced when organic material, such as that in landfills, breaks down without oxygen), and renewable waste. The energy is then used to power a turbine. It is considered renewable since the fuel is replenished biologically. It is not a major energy source for Spain.</p>
<p>Motores.diesels &lt;- This is the energy produced by diesel power plants, similar to ciclo.combinado, but represents a very small portion of Spain’s energy production.</p>
<p>Turbina.de.gas &lt;- Gas turbine is a device that converts gas, usually natural gas, into mechanical energy that drives a generator and produces electricity. It also makes up a small portion of Spain’s energy production.</p>
<p>Tubrina.de.vapor &lt;- Steam turbine is similar the gas turbine, but it uses thermal steam to power the generator. The source of the steam can be fossil fuels, nuclear energy, or solar power. It also represents a small portion of Spain’s energy production.</p>
<p>Generación.auxiliar &lt;- This is energy produced by backup equipment in a facility, plant, or system. Since it is zero, we will remove it from the data set.</p>
<p>Cogeneracion.y.residuos &lt;- This is similar to the process of Renewable thermal energy in that it burns a fuel source to produce heat that is converted to energy, however the process itself produces electricity and the sources do not have to be renewable. The sources burned could be natural gas, diesel, biomass, or municipal solid waste. This represents a larger portion of Spain’s energy production.</p>
<p>Hidráulica &lt;- This energy is produced from a water-powered turbine, usually from a natural source such as a river or reservoir. This is a huge part of Spain’s energy production.</p>
<p>Imports and Exports &lt;- Portugal, France, Andorra, and Morocco have variables for both imports and exports. The importation of energy is energy that is imported into the country to be used by the system. The exportation of energy is energy being sold or delivered out of Spain for use elsewhere. In this data set, the importation variables are all positive (or zero) and the exportation variables are all negative (or zero).</p>
<h2 id="data-changes">Data Changes</h2>
<p>Re-importing the data allows for reprocessing.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># --------</span></span>
<span><span class='co'># Import Data</span></span>
<span><span class='co'># --------</span></span>
<span></span>
<span><span class='va'>generacion</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100575891_files/data/Custom-Report-2025-04-28-Estructura de generación (MW).csv"</span><span class='op'>)</span></span>
<span><span class='va'>almacenamiento</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100575891_files/data/Custom-Report-2025-04-28-Estructura de almacenamiento (MW).csv"</span><span class='op'>)</span></span>
<span><span class='va'>demanda</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100575891_files/data/Custom-Report-2025-04-28-Seguimiento de la demanda de energía eléctrica (MW).csv"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>From this analysis, it is clear that two erroneous data points were included: consumo bombeo and carga de baterías. These are distinct from the rest of the included data points because they are not ways of producing energy, and represent one half of a process to store energy. The mixing of storage and production makes the original graph dense and difficult to interpret. These data points will not be included in the improved version.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># --------</span></span>
<span><span class='co'># Remove Unnecessary Columns</span></span>
<span><span class='co'># --------</span></span>
<span></span>
<span><span class='va'>generacion</span> <span class='op'>&lt;-</span> <span class='va'>generacion</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>Intercambios.int</span>, <span class='op'>-</span><span class='va'>Generación.auxiliar</span><span class='op'>)</span></span>
<span><span class='va'>demanda</span> <span class='op'>&lt;-</span> <span class='va'>demanda</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>Hora</span>, <span class='va'>Real</span><span class='op'>)</span></span>
<span><span class='va'>almacenamiento</span> <span class='op'>&lt;-</span> <span class='va'>almacenamiento</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>Carga.de.baterías</span>, <span class='op'>-</span><span class='va'>Consumo.bombeo</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Imports and Exports are represented by separate areas. However, they are two halves of the same data point and should be treated as such. Additionally, this can be confirmed by looking at the data itself, where a missing value from Andorra imports is made up for with a value in Andorra exports. See the example below.</p>
<figure>
<img src="images/import-export-issues.png" class="external" style="width:100.0%" alt="Import and Export Values from Red Eléctrica." />
<figcaption aria-hidden="true">Import and Export Values from Red Eléctrica.</figcaption>
</figure>
<p>In the improved version, imports and exports are combined.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># --------</span></span>
<span><span class='co'># Combining Imports with the Exports</span></span>
<span><span class='co'># --------</span></span>
<span></span>
<span><span class='va'>generacion</span> <span class='op'>&lt;-</span> <span class='va'>generacion</span> <span class='op'>|&gt;</span></span>
<span>  <span class='co'># andorra</span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/unite.html'>unite</a></span><span class='op'>(</span><span class='va'>Andorra</span>, <span class='va'>Andorra.importación</span>, <span class='va'>Andorra.exportación</span>, sep <span class='op'>=</span> <span class='st'>"_"</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Andorra <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace</a></span><span class='op'>(</span><span class='va'>Andorra</span>, <span class='st'>"0_0"</span>, <span class='st'>"0"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Andorra <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace</a></span><span class='op'>(</span><span class='va'>Andorra</span>, <span class='st'>"0_"</span>, <span class='st'>""</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Andorra <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace</a></span><span class='op'>(</span><span class='va'>Andorra</span>, <span class='st'>"_0"</span>, <span class='st'>""</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='co'># morocco</span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/unite.html'>unite</a></span><span class='op'>(</span><span class='va'>Marruecos</span>, <span class='va'>Marruecos.importación</span>, <span class='va'>Marruecos.exportación</span>, sep <span class='op'>=</span> <span class='st'>"_"</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Marruecos <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace</a></span><span class='op'>(</span><span class='va'>Marruecos</span>, <span class='st'>"0_0"</span>, <span class='st'>"0"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Marruecos <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace</a></span><span class='op'>(</span><span class='va'>Marruecos</span>, <span class='st'>"0_"</span>, <span class='st'>""</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Marruecos <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace</a></span><span class='op'>(</span><span class='va'>Marruecos</span>, <span class='st'>"_0"</span>, <span class='st'>""</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='co'># france</span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/unite.html'>unite</a></span><span class='op'>(</span><span class='va'>Francia</span>, <span class='va'>Francia.importación</span>, <span class='va'>Francia.exportación</span>, sep <span class='op'>=</span> <span class='st'>"_"</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Francia <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace</a></span><span class='op'>(</span><span class='va'>Francia</span>, <span class='st'>"0_0"</span>, <span class='st'>"0"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Francia <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace</a></span><span class='op'>(</span><span class='va'>Francia</span>, <span class='st'>"0_"</span>, <span class='st'>""</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Francia <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace</a></span><span class='op'>(</span><span class='va'>Francia</span>, <span class='st'>"_0"</span>, <span class='st'>""</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='co'># portugal</span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/unite.html'>unite</a></span><span class='op'>(</span><span class='va'>Portugal</span>, <span class='va'>Portugal.importación</span>, <span class='va'>Portugal.exportación</span>, sep <span class='op'>=</span> <span class='st'>"_"</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Portugal <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace</a></span><span class='op'>(</span><span class='va'>Portugal</span>, <span class='st'>"0_0"</span>, <span class='st'>"0"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Portugal <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace</a></span><span class='op'>(</span><span class='va'>Portugal</span>, <span class='st'>"0_"</span>, <span class='st'>""</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Portugal <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace</a></span><span class='op'>(</span><span class='va'>Portugal</span>, <span class='st'>"_0"</span>, <span class='st'>""</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>The general public will not care to make the distinction between Solar panels and solar processed with mirrors. Both solars are combined.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># --------</span></span>
<span><span class='co'># Combine Solar</span></span>
<span><span class='co'># --------</span></span>
<span></span>
<span><span class='va'>generacion</span> <span class='op'>&lt;-</span> <span class='va'>generacion</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Solar <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowSums</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/across.html'>across</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>Solar.fotovoltaica</span>, <span class='va'>Solar.térmica</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>Solar.fotovoltaica</span>, <span class='op'>-</span><span class='va'>Solar.térmica</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>These altered data points need to be converted to numerical variables.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># --------</span></span>
<span><span class='co'># Convert it to numeric</span></span>
<span><span class='co'># --------</span></span>
<span></span>
<span><span class='va'>generacion</span><span class='op'>$</span><span class='va'>Andorra</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>generacion</span><span class='op'>$</span><span class='va'>Andorra</span><span class='op'>)</span></span>
<span><span class='va'>generacion</span><span class='op'>$</span><span class='va'>Portugal</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>generacion</span><span class='op'>$</span><span class='va'>Portugal</span><span class='op'>)</span></span>
<span><span class='va'>generacion</span><span class='op'>$</span><span class='va'>Marruecos</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>generacion</span><span class='op'>$</span><span class='va'>Marruecos</span><span class='op'>)</span></span>
<span><span class='va'>generacion</span><span class='op'>$</span><span class='va'>Francia</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>generacion</span><span class='op'>$</span><span class='va'>Francia</span><span class='op'>)</span></span>
<span><span class='va'>generacion</span><span class='op'>$</span><span class='va'>Solar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>generacion</span><span class='op'>$</span><span class='va'>Solar</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>The same combining of data sets is completed as before.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># --------</span></span>
<span><span class='co'># Combining Data sets</span></span>
<span><span class='co'># --------</span></span>
<span></span>
<span><span class='va'>combined_data</span> <span class='op'>&lt;-</span> <span class='va'>generacion</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>full_join</a></span><span class='op'>(</span><span class='va'>almacenamiento</span>, by <span class='op'>=</span> <span class='st'>"Hora"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>For the improvement, four graphs will be needed. One to combine Renewable, Non-renewable, stored energy, and imported energy sources and three others to break out the categories by sub-categories.</p>
<figure>
<img src="images/improvement.png" class="external" style="width:100.0%" alt="Improvement." />
<figcaption aria-hidden="true">Improvement.</figcaption>
</figure>
<p>The below code combines the sub-categories into the broader categories of Renewable, non-renewable, stored energy use, and imported energy use. The data is then transformed to have tidy data, and refactored to set the correct order.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># --------</span></span>
<span><span class='co'># Data Subset 1</span></span>
<span><span class='co'># --------</span></span>
<span></span>
<span><span class='va'>subset1</span> <span class='op'>&lt;-</span> <span class='va'>combined_data</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Renewable <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowSums</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/across.html'>across</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>Hidráulica</span>, <span class='va'>Eólica</span>, <span class='va'>Solar</span>, <span class='va'>Térmica.renovable</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>Hidráulica</span>, <span class='op'>-</span><span class='va'>Eólica</span>, <span class='op'>-</span><span class='va'>Solar</span>, <span class='op'>-</span><span class='va'>Térmica.renovable</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Non_Renewable <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowSums</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/across.html'>across</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>Ciclo.combinado</span>, <span class='va'>Nuclear</span>, <span class='va'>Cogeneración.y.residuos</span>,</span>
<span>                                      <span class='va'>Motores.diésel</span>, <span class='va'>Carbón</span>, <span class='va'>Turbina.de.gas</span>, <span class='va'>Turbina.de.vapor</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>Ciclo.combinado</span>, <span class='op'>-</span><span class='va'>Nuclear</span>, <span class='op'>-</span><span class='va'>Cogeneración.y.residuos</span>,</span>
<span>         <span class='op'>-</span><span class='va'>Motores.diésel</span>, <span class='op'>-</span><span class='va'>Carbón</span>, <span class='op'>-</span><span class='va'>Turbina.de.gas</span>, <span class='op'>-</span><span class='va'>Turbina.de.vapor</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Stored_Energy <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowSums</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/across.html'>across</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>Turbinación.bombeo</span>, <span class='va'>Entrega.de.baterías</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>Turbinación.bombeo</span>, <span class='op'>-</span><span class='va'>Entrega.de.baterías</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Imported_Energy <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowSums</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/across.html'>across</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>Portugal</span>, <span class='va'>Francia</span>, <span class='va'>Andorra</span>, <span class='va'>Marruecos</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>Portugal</span>, <span class='op'>-</span><span class='va'>Francia</span>, <span class='op'>-</span><span class='va'>Andorra</span>, <span class='op'>-</span><span class='va'>Marruecos</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># --------</span></span>
<span><span class='co'># Pivot Longer - Subset 1</span></span>
<span><span class='co'># --------</span></span>
<span></span>
<span><span class='va'>subset1</span> <span class='op'>&lt;-</span> <span class='va'>subset1</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span></span>
<span>    cols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>      <span class='va'>Renewable</span>,</span>
<span>      <span class='va'>Non_Renewable</span>,</span>
<span>      <span class='va'>Stored_Energy</span>,</span>
<span>      <span class='va'>Imported_Energy</span><span class='op'>)</span>,</span>
<span>    names_to <span class='op'>=</span> <span class='st'>"Type"</span>,</span>
<span>    values_to <span class='op'>=</span> <span class='st'>"Rating"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># --------</span></span>
<span><span class='co'># Refactor Subset 1</span></span>
<span><span class='co'># --------</span></span>
<span></span>
<span><span class='va'>subset1</span><span class='op'>$</span><span class='va'>Type</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>subset1</span><span class='op'>$</span><span class='va'>Type</span>, ordered <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span>
<span><span class='va'>subset1</span> <span class='op'>&lt;-</span> <span class='va'>subset1</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    Type <span class='op'>=</span> <span class='fu'><a href='https://forcats.tidyverse.org/reference/fct_relevel.html'>fct_relevel</a></span><span class='op'>(</span><span class='va'>Type</span>,</span>
<span>                       <span class='st'>"Renewable"</span>,</span>
<span>                       <span class='st'>"Non_Renewable"</span>,</span>
<span>                       <span class='st'>"Stored_Energy"</span>,</span>
<span>                       <span class='st'>"Imported_Energy"</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># --------</span></span>
<span><span class='co'># Set Rating as Numeric - Subset 1</span></span>
<span><span class='co'># --------</span></span>
<span></span>
<span><span class='va'>subset1</span><span class='op'>$</span><span class='va'>Rating</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>subset1</span><span class='op'>$</span><span class='va'>Rating</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># --------</span></span>
<span><span class='co'># Set Hora as Date - Subset 1</span></span>
<span><span class='co'># --------</span></span>
<span></span>
<span><span class='va'>subset1</span> <span class='op'>&lt;-</span> <span class='va'>subset1</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    Hora <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='va'>Hora</span>, format <span class='op'>=</span> <span class='st'>"%Y-%m-%d %H:%M"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span><span class='va'>demanda</span> <span class='op'>&lt;-</span> <span class='va'>demanda</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    Hora <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='va'>Hora</span>, format <span class='op'>=</span> <span class='st'>"%Y-%m-%d %H:%M"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Pre-processing of the full_data data set is completed to be able to process it into smaller categories.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># --------</span></span>
<span><span class='co'># Pivot Longer</span></span>
<span><span class='co'># --------</span></span>
<span></span>
<span><span class='va'>full_data</span> <span class='op'>&lt;-</span> <span class='va'>combined_data</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span></span>
<span>    cols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>      <span class='va'>Térmica.renovable</span>,</span>
<span>      <span class='va'>Solar</span>,</span>
<span>      <span class='va'>Eólica</span>,</span>
<span>      <span class='va'>Cogeneración.y.residuos</span>,</span>
<span>      <span class='va'>Turbina.de.gas</span>,</span>
<span>      <span class='va'>Motores.diésel</span>,</span>
<span>      <span class='va'>Turbina.de.vapor</span>,</span>
<span>      <span class='va'>Ciclo.combinado</span>,</span>
<span>      <span class='va'>Carbón</span>,</span>
<span>      <span class='va'>Nuclear</span>,</span>
<span>      <span class='va'>Hidráulica</span>,</span>
<span>      <span class='va'>Francia</span>,</span>
<span>      <span class='va'>Marruecos</span>,</span>
<span>      <span class='va'>Portugal</span>,</span>
<span>      <span class='va'>Andorra</span>,</span>
<span>      <span class='va'>Turbinación.bombeo</span>,</span>
<span>      <span class='va'>Entrega.de.baterías</span><span class='op'>)</span>,</span>
<span>    names_to <span class='op'>=</span> <span class='st'>"Type"</span>,</span>
<span>    values_to <span class='op'>=</span> <span class='st'>"Rating"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># --------</span></span>
<span><span class='co'># Set Type as Factor</span></span>
<span><span class='co'># --------</span></span>
<span></span>
<span><span class='va'>full_data</span><span class='op'>$</span><span class='va'>Type</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>full_data</span><span class='op'>$</span><span class='va'>Type</span>, ordered <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span>
<span><span class='va'>full_data</span> <span class='op'>&lt;-</span> <span class='va'>full_data</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    Type <span class='op'>=</span> <span class='fu'><a href='https://forcats.tidyverse.org/reference/fct_relevel.html'>fct_relevel</a></span><span class='op'>(</span><span class='va'>Type</span>,</span>
<span>                       <span class='st'>"Hidráulica"</span>,</span>
<span>                       <span class='st'>"Ciclo.combinado"</span>,</span>
<span>                       <span class='st'>"Eólica"</span>,</span>
<span>                       <span class='st'>"Solar"</span>,</span>
<span>                       <span class='st'>"Nuclear"</span>,</span>
<span>                       <span class='st'>"Cogeneración.y.residuos"</span>,</span>
<span>                       <span class='st'>"Turbinación.bombeo"</span>,</span>
<span>                       <span class='st'>"Motores.diésel"</span>,</span>
<span>                       <span class='st'>"Térmica.renovable"</span>,</span>
<span>                       <span class='st'>"Carbón"</span>,</span>
<span>                       <span class='st'>"Turbina.de.gas"</span>,</span>
<span>                       <span class='st'>"Turbina.de.vapor"</span>,</span>
<span>                       <span class='st'>"Entrega.de.baterías"</span>,</span>
<span>                       <span class='st'>"Portugal"</span>,</span>
<span>                       <span class='st'>"Francia"</span>,</span>
<span>                       <span class='st'>"Andorra"</span>,</span>
<span>                       <span class='st'>"Marruecos"</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># --------</span></span>
<span><span class='co'># Set Rating as Numeric</span></span>
<span><span class='co'># --------</span></span>
<span></span>
<span><span class='va'>full_data</span><span class='op'>$</span><span class='va'>Rating</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>full_data</span><span class='op'>$</span><span class='va'>Rating</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># --------</span></span>
<span><span class='co'># Set Hora as Date</span></span>
<span><span class='co'># --------</span></span>
<span></span>
<span><span class='va'>full_data</span> <span class='op'>&lt;-</span> <span class='va'>full_data</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    Hora <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='va'>Hora</span>, format <span class='op'>=</span> <span class='st'>"%Y-%m-%d %H:%M"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<p>The data is divided into four subsets in order to build the four smaller graphs.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># --------</span></span>
<span><span class='co'># Renewable Subset</span></span>
<span><span class='co'># --------</span></span>
<span></span>
<span><span class='va'>renewable_data</span> <span class='op'>&lt;-</span> <span class='va'>full_data</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span> <span class='op'>(</span><span class='va'>Type</span> <span class='op'>==</span> <span class='st'>"Hidráulica"</span> <span class='op'>|</span> <span class='va'>Type</span> <span class='op'>==</span> <span class='st'>"Eólica"</span> <span class='op'>|</span> <span class='va'>Type</span> <span class='op'>==</span> <span class='st'>"Solar"</span> <span class='op'>|</span> <span class='va'>Type</span> <span class='op'>==</span> <span class='st'>"Térmica.renovable"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># --------</span></span>
<span><span class='co'># Non_renewable Subset</span></span>
<span><span class='co'># --------</span></span>
<span></span>
<span><span class='va'>non_renewable_data</span> <span class='op'>&lt;-</span> <span class='va'>full_data</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span> <span class='op'>(</span><span class='va'>Type</span> <span class='op'>==</span> <span class='st'>"Ciclo.combinado"</span> <span class='op'>|</span> <span class='va'>Type</span> <span class='op'>==</span> <span class='st'>"Nuclear"</span> <span class='op'>|</span> <span class='va'>Type</span> <span class='op'>==</span> <span class='st'>"Cogeneración.y.residuos"</span></span>
<span>          <span class='op'>|</span> <span class='va'>Type</span> <span class='op'>==</span> <span class='st'>"Motores.diésel"</span> <span class='op'>|</span> <span class='va'>Type</span> <span class='op'>==</span> <span class='st'>"Carbón"</span> <span class='op'>|</span> <span class='va'>Type</span> <span class='op'>==</span> <span class='st'>"Turbina.de.gas"</span></span>
<span>          <span class='op'>|</span> <span class='va'>Type</span> <span class='op'>==</span> <span class='st'>"Turbina.de.vapor"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># --------</span></span>
<span><span class='co'># Stored_Energy Subset</span></span>
<span><span class='co'># --------</span></span>
<span></span>
<span><span class='va'>stored_energy_data</span> <span class='op'>&lt;-</span> <span class='va'>full_data</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span> <span class='op'>(</span><span class='va'>Type</span> <span class='op'>==</span> <span class='st'>"Turbinación.bombeo"</span> <span class='op'>|</span> <span class='va'>Type</span> <span class='op'>==</span> <span class='st'>"Entrega.de.baterías"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># --------</span></span>
<span><span class='co'># Imported_Energy Subset</span></span>
<span><span class='co'># --------</span></span>
<span></span>
<span><span class='va'>imported_energy_data</span> <span class='op'>&lt;-</span> <span class='va'>full_data</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span> <span class='op'>(</span><span class='va'>Type</span> <span class='op'>==</span> <span class='st'>"Portugal"</span> <span class='op'>|</span> <span class='va'>Type</span> <span class='op'>==</span> <span class='st'>"Francia"</span> <span class='op'>|</span> <span class='va'>Type</span> <span class='op'>==</span> <span class='st'>"Andorra"</span></span>
<span>          <span class='op'>|</span> <span class='va'>Type</span> <span class='op'>==</span> <span class='st'>"Marruecos"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h2 id="main-plot">Main Plot</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># --------</span></span>
<span><span class='co'># Main Plot</span></span>
<span><span class='co'># --------</span></span>
<span><span class='va'>combined</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='co'># data</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># area lines </span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_ribbon.html'>geom_area</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>subset1</span>, </span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span></span>
<span>      x <span class='op'>=</span> <span class='va'>Hora</span>,</span>
<span>      y <span class='op'>=</span> <span class='va'>Rating</span>,</span>
<span>      fill <span class='op'>=</span> <span class='va'>Type</span><span class='op'>)</span>,</span>
<span>    lwd <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>+</span> <span class='co'># line width</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>demanda</span>, </span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span></span>
<span>      x <span class='op'>=</span> <span class='va'>Hora</span>,</span>
<span>      y <span class='op'>=</span> <span class='va'>Real</span><span class='op'>)</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span> <span class='op'>+</span> <span class='co'># line width</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span>clip <span class='op'>=</span> <span class='st'>"off"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># remove legend</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># remove labels for scales</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>       y <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># sets x scale</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_date.html'>scale_x_datetime</a></span><span class='op'>(</span></span>
<span>    breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span></span>
<span>      from <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 00:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>      to   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>      by   <span class='op'>=</span> <span class='st'>"2 hours"</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    labels <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='st'>"%H:%M"</span><span class='op'>)</span>,</span>
<span>    limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-27 23:45"</span>, tz<span class='op'>=</span><span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:30"</span>, tz<span class='op'>=</span><span class='st'>"Europe/Madrid"</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='co'># colors</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>    Renewable <span class='op'>=</span> <span class='st'>"#38761d"</span>,</span>
<span>    Non_Renewable <span class='op'>=</span> <span class='st'>"#073259"</span>,</span>
<span>    Stored_Energy <span class='op'>=</span> <span class='st'>"#595959"</span>,</span>
<span>    Imported_Energy <span class='op'>=</span> <span class='st'>"#741b47"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>  <span class='co'># removes background grey</span></span>
<span>  panel.background <span class='op'>=</span> </span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"white"</span><span class='op'>)</span>,</span>
<span>  <span class='co'># changes line color</span></span>
<span>  panel.grid.major.y <span class='op'>=</span> </span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#d6d6d6"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span>,</span>
<span>  <span class='co'># remove axis tick y</span></span>
<span>  axis.ticks.y <span class='op'>=</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#ffffff"</span><span class='op'>)</span>,</span>
<span>  <span class='co'># changes axis tick color</span></span>
<span>  axis.ticks.x <span class='op'>=</span> </span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#b8b8b8"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>,</span>
<span>  <span class='co'># changes axis length</span></span>
<span>  axis.ticks.length <span class='op'>=</span> </span>
<span>    <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>.3</span>, <span class='st'>"cm"</span><span class='op'>)</span>,</span>
<span>  <span class='co'># changes axis line</span></span>
<span>  axis.line <span class='op'>=</span> </span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#b8b8b8"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span>,</span>
<span>  <span class='co'># remove x grid</span></span>
<span>  panel.grid.major.x <span class='op'>=</span> </span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#ffffff00"</span><span class='op'>)</span>,</span>
<span>  <span class='co'># set global font family</span></span>
<span>  text <span class='op'>=</span> </span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"roboto"</span><span class='op'>)</span>,</span>
<span>  <span class='co'># set title size and weight</span></span>
<span>  plot.title <span class='op'>=</span> </span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>14</span>, face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>,</span>
<span>  plot.title.position <span class='op'>=</span> <span class='st'>"plot"</span>,</span>
<span>  <span class='co'># set x and y axis color</span></span>
<span>  axis.text <span class='op'>=</span> </span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#b8b8b8"</span><span class='op'>)</span>,</span>
<span>  axis.text.x <span class='op'>=</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>,</span>
<span>  <span class='co'># set caption color</span></span>
<span>  plot.caption <span class='op'>=</span> </span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#b8b8b8"</span><span class='op'>)</span></span>
<span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 13:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>19000</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Renewable Energy"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#38761d"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>2.5</span><span class='op'>)</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 13:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>11000</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Non-Renewable Energy"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#073259"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>2.5</span><span class='op'>)</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 13:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>27000</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Demand in Real Time"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#000000"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>2.5</span><span class='op'>)</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span></span>
<span>      x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 12:32"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>      xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 12:32"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>      y <span class='op'>=</span> <span class='fl'>35000</span>,</span>
<span>      yend <span class='op'>=</span> <span class='op'>-</span><span class='fl'>10000</span><span class='op'>)</span>,</span>
<span>    linetype <span class='op'>=</span> <span class='st'>"dashed"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.6</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 12:35"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>35500</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Blackout"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#000000"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>2.5</span><span class='op'>)</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0.5</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># demand in real time</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 12:25"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 12:45"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>27000</span>,</span>
<span>    yend <span class='op'>=</span> <span class='fl'>27000</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 16:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>4000</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Stored Energy"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#595959"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>2.5</span><span class='op'>)</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0.5</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 20:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>6000</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Imported Energy"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#741b47"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>2.5</span><span class='op'>)</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0.5</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># renewable</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 12:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 12:45"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>19000</span>,</span>
<span>    yend <span class='op'>=</span> <span class='fl'>19000</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># non renewable</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 12:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 12:45"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>11000</span>,</span>
<span>    yend <span class='op'>=</span> <span class='fl'>11000</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 16:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 16:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>1000</span>,</span>
<span>    yend <span class='op'>=</span> <span class='op'>-</span><span class='fl'>3500</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 20:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 20:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>500</span>,</span>
<span>    yend <span class='op'>=</span> <span class='op'>-</span><span class='fl'>5500</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span></span>
<span><span class='va'>combined</span></span></code></pre>
</div>
<p><img src="100575891_files/figure-html5/main_plot-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<h2 id="renewable-plot">Renewable Plot</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># --------</span></span>
<span><span class='co'># Renewable Plot</span></span>
<span><span class='co'># --------</span></span>
<span><span class='va'>renewable</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='co'># data</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># area lines </span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_ribbon.html'>geom_area</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>renewable_data</span>, </span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span></span>
<span>      x <span class='op'>=</span> <span class='va'>Hora</span>,</span>
<span>      y <span class='op'>=</span> <span class='va'>Rating</span>,</span>
<span>      fill <span class='op'>=</span> <span class='va'>Type</span><span class='op'>)</span>,</span>
<span>    lwd <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>+</span> <span class='co'># line width</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span>clip <span class='op'>=</span> <span class='st'>"off"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># remove legend</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># remove labels for scales</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>       y <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>       title <span class='op'>=</span> <span class='st'>"Renewable Energy"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># sets x scale</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_date.html'>scale_x_datetime</a></span><span class='op'>(</span></span>
<span>    breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span></span>
<span>      from <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 00:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>      to   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>      by   <span class='op'>=</span> <span class='st'>"2 hours"</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    labels <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='st'>"%H:%M"</span><span class='op'>)</span>,</span>
<span>    limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-27 23:45"</span>, tz<span class='op'>=</span><span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:30"</span>, tz<span class='op'>=</span><span class='st'>"Europe/Madrid"</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='co'># colors</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>    Hidráulica <span class='op'>=</span> <span class='st'>"#38761d"</span>,</span>
<span>    Eólica <span class='op'>=</span> <span class='st'>"#60914a"</span>,</span>
<span>    Solar <span class='op'>=</span> <span class='st'>"#88ad77"</span>,</span>
<span>    Térmica.renovable <span class='op'>=</span> <span class='st'>"#afc8a5"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    <span class='co'># removes background grey</span></span>
<span>    panel.background <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"white"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># changes line color</span></span>
<span>    panel.grid.major.y <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#d6d6d6"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span>,</span>
<span>    <span class='co'># remove axis tick y</span></span>
<span>    axis.ticks.y <span class='op'>=</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#ffffff"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># changes axis tick color</span></span>
<span>    axis.ticks.x <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#b8b8b8"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>,</span>
<span>    <span class='co'># changes axis length</span></span>
<span>    axis.ticks.length <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>.3</span>, <span class='st'>"cm"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># changes axis line</span></span>
<span>    axis.line <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#b8b8b8"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span>,</span>
<span>    <span class='co'># remove x grid</span></span>
<span>    panel.grid.major.x <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#ffffff00"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># set global font family</span></span>
<span>    text <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"roboto"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># set title size and weight</span></span>
<span>    plot.title <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>14</span>, face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>,</span>
<span>    plot.title.position <span class='op'>=</span> <span class='st'>"plot"</span>,</span>
<span>    <span class='co'># set x and y axis color</span></span>
<span>    axis.text <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#b8b8b8"</span><span class='op'>)</span>,</span>
<span>    axis.text.x <span class='op'>=</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># set caption color</span></span>
<span>    plot.caption <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#b8b8b8"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 13:30"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>25000</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Water Turbine"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#000000"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>2.5</span><span class='op'>)</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 13:30"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>22000</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Wind"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#000000"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>2.5</span><span class='op'>)</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 13:30"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>19000</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Solar"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#000000"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>2.5</span><span class='op'>)</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 13:30"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>7000</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Renewable \nThermal"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#000000"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>2.5</span><span class='op'>)</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 11:35"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 13:15"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>25000</span>,</span>
<span>    yend <span class='op'>=</span> <span class='fl'>25000</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 11:35"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 13:15"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>22000</span>,</span>
<span>    yend <span class='op'>=</span> <span class='fl'>22000</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 11:35"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 13:15"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>19000</span>,</span>
<span>    yend <span class='op'>=</span> <span class='fl'>19000</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 11:30"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 13:15"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>200</span>,</span>
<span>    yend <span class='op'>=</span> <span class='fl'>7000</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span></span>
<span><span class='va'>renewable</span></span></code></pre>
</div>
<p><img src="100575891_files/figure-html5/renewable-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<h2 id="non-renewable-plot">Non-Renewable Plot</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># --------</span></span>
<span><span class='co'># Non_Renewable Plot</span></span>
<span><span class='co'># --------</span></span>
<span><span class='va'>non_renewable</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='co'># data</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># area lines </span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_ribbon.html'>geom_area</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>non_renewable_data</span>, </span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span></span>
<span>      x <span class='op'>=</span> <span class='va'>Hora</span>,</span>
<span>      y <span class='op'>=</span> <span class='va'>Rating</span>,</span>
<span>      fill <span class='op'>=</span> <span class='va'>Type</span><span class='op'>)</span>,</span>
<span>    lwd <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>+</span> <span class='co'># line width</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span>clip <span class='op'>=</span> <span class='st'>"off"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># remove legend</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># remove labels for scales</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>       y <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>       title <span class='op'>=</span> <span class='st'>"Non-Renewable Energy"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># sets x scale</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_date.html'>scale_x_datetime</a></span><span class='op'>(</span></span>
<span>    breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span></span>
<span>      from <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 00:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>      to   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>      by   <span class='op'>=</span> <span class='st'>"2 hours"</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    labels <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='st'>"%H:%M"</span><span class='op'>)</span>,</span>
<span>    limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-27 23:45"</span>, tz<span class='op'>=</span><span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:30"</span>, tz<span class='op'>=</span><span class='st'>"Europe/Madrid"</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='co'># colors</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>    Ciclo.combinado <span class='op'>=</span> <span class='st'>"#073259"</span>,</span>
<span>    Nuclear <span class='op'>=</span> <span class='st'>"#094276"</span>,</span>
<span>    Cogeneración.y.residuos <span class='op'>=</span> <span class='st'>"#0b5394"</span>,</span>
<span>    Motores.diésel <span class='op'>=</span> <span class='st'>"#3c75a9"</span>,</span>
<span>    Carbón <span class='op'>=</span> <span class='st'>"#6d98bf"</span>,</span>
<span>    Turbina.de.gas <span class='op'>=</span> <span class='st'>"#9dbad4"</span>,</span>
<span>    Turbina.de.vapor <span class='op'>=</span> <span class='st'>"#ceddea"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    <span class='co'># removes background grey</span></span>
<span>    panel.background <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"white"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># changes line color</span></span>
<span>    panel.grid.major.y <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#d6d6d6"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span>,</span>
<span>    <span class='co'># remove axis tick y</span></span>
<span>    axis.ticks.y <span class='op'>=</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#ffffff"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># changes axis tick color</span></span>
<span>    axis.ticks.x <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#b8b8b8"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>,</span>
<span>    <span class='co'># changes axis length</span></span>
<span>    axis.ticks.length <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>.3</span>, <span class='st'>"cm"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># changes axis line</span></span>
<span>    axis.line <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#b8b8b8"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span>,</span>
<span>    <span class='co'># remove x grid</span></span>
<span>    panel.grid.major.x <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#ffffff00"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># set global font family</span></span>
<span>    text <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"roboto"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># set title size and weight</span></span>
<span>    plot.title <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>14</span>, face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>,</span>
<span>    plot.title.position <span class='op'>=</span> <span class='st'>"plot"</span>,</span>
<span>    <span class='co'># set x and y axis color</span></span>
<span>    axis.text <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#b8b8b8"</span><span class='op'>)</span>,</span>
<span>    axis.text.x <span class='op'>=</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># set caption color</span></span>
<span>    plot.caption <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#b8b8b8"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 01:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>12000</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Water Turbine"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#000000"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>2.5</span><span class='op'>)</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0.5</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 06:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>11000</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Gas Power Plants"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#000000"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>2.5</span><span class='op'>)</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0.5</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 12:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>10000</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Nuclear"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#000000"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>2.5</span><span class='op'>)</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0.5</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 15:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>3000</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Combined Heat \nand Power"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#000000"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>2.5</span><span class='op'>)</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0.5</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 18:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>8000</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Coal"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#000000"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>2.5</span><span class='op'>)</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0.5</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 20:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>10000</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Gas Turbine"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#000000"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>2.5</span><span class='op'>)</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0.5</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 23:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>12000</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Steam Turbine"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#000000"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>2.5</span><span class='op'>)</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0.5</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># water turbine</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 01:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 01:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>11500</span>,</span>
<span>    yend <span class='op'>=</span> <span class='fl'>9000</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># gas power plants</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 06:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 06:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>10500</span>,</span>
<span>    yend <span class='op'>=</span> <span class='fl'>5000</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># nuclear</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 12:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 12:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>9500</span>,</span>
<span>    yend <span class='op'>=</span> <span class='fl'>2000</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># combined heat and power</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 15:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 15:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>400</span>,</span>
<span>    yend <span class='op'>=</span> <span class='fl'>2500</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># coal</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 18:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 18:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>7500</span>,</span>
<span>    yend <span class='op'>=</span> <span class='fl'>200</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># gas turbine</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 20:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 20:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>9500</span>,</span>
<span>    yend <span class='op'>=</span> <span class='fl'>200</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># steam turbine</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 23:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 23:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>11500</span>,</span>
<span>    yend <span class='op'>=</span> <span class='fl'>100</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span></span>
<span><span class='va'>non_renewable</span></span></code></pre>
</div>
<p><img src="100575891_files/figure-html5/non_renewable-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<h2 id="stored-energy-plot">Stored Energy Plot</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># --------</span></span>
<span><span class='co'># Stored_Energy Plot</span></span>
<span><span class='co'># --------</span></span>
<span><span class='va'>stored_energy</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='co'># data</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># area lines </span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_ribbon.html'>geom_area</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>stored_energy_data</span>, </span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span></span>
<span>      x <span class='op'>=</span> <span class='va'>Hora</span>,</span>
<span>      y <span class='op'>=</span> <span class='va'>Rating</span>,</span>
<span>      fill <span class='op'>=</span> <span class='va'>Type</span><span class='op'>)</span>,</span>
<span>    lwd <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>+</span> <span class='co'># line width</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span>clip <span class='op'>=</span> <span class='st'>"off"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># remove legend</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># remove labels for scales</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>       y <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>       title <span class='op'>=</span> <span class='st'>"Stored Energy"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># sets x scale</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_date.html'>scale_x_datetime</a></span><span class='op'>(</span></span>
<span>    breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span></span>
<span>      from <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 00:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>      to   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>      by   <span class='op'>=</span> <span class='st'>"2 hours"</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    labels <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='st'>"%H:%M"</span><span class='op'>)</span>,</span>
<span>    limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-27 23:45"</span>, tz<span class='op'>=</span><span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:30"</span>, tz<span class='op'>=</span><span class='st'>"Europe/Madrid"</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='co'># colors</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>    Turbinación.bombeo <span class='op'>=</span> <span class='st'>"#595959"</span>,</span>
<span>    Entrega.de.baterías <span class='op'>=</span> <span class='st'>"#000000"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    <span class='co'># removes background grey</span></span>
<span>    panel.background <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"white"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># changes line color</span></span>
<span>    panel.grid.major.y <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#d6d6d6"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span>,</span>
<span>    <span class='co'># remove axis tick y</span></span>
<span>    axis.ticks.y <span class='op'>=</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#ffffff"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># changes axis tick color</span></span>
<span>    axis.ticks.x <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#b8b8b8"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>,</span>
<span>    <span class='co'># changes axis length</span></span>
<span>    axis.ticks.length <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>.3</span>, <span class='st'>"cm"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># changes axis line</span></span>
<span>    axis.line <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#b8b8b8"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span>,</span>
<span>    <span class='co'># remove x grid</span></span>
<span>    panel.grid.major.x <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#ffffff00"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># set global font family</span></span>
<span>    text <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"roboto"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># set title size and weight</span></span>
<span>    plot.title <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>14</span>, face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>,</span>
<span>    plot.title.position <span class='op'>=</span> <span class='st'>"plot"</span>,</span>
<span>    <span class='co'># set x and y axis color</span></span>
<span>    axis.text <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#b8b8b8"</span><span class='op'>)</span>,</span>
<span>    axis.text.x <span class='op'>=</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># set caption color</span></span>
<span>    plot.caption <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#b8b8b8"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 7:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>2300</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Pumped-Hydro Generation"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#000000"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>2.5</span><span class='op'>)</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0.5</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 7:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 7:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>2250</span>,</span>
<span>    yend <span class='op'>=</span> <span class='fl'>600</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 14:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>1900</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Battery Discharge"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#000000"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>2.5</span><span class='op'>)</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0.5</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 14:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 14:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>1850</span>,</span>
<span>    yend <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span></span>
<span><span class='va'>stored_energy</span></span></code></pre>
</div>
<p><img src="100575891_files/figure-html5/stored_energy-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<h2 id="imported-energy">Imported Energy</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># --------</span></span>
<span><span class='co'># Imported_Energy Plot</span></span>
<span><span class='co'># --------</span></span>
<span><span class='va'>imported_energy</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='co'># data</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># area lines </span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_ribbon.html'>geom_area</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>imported_energy_data</span>, </span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span></span>
<span>      x <span class='op'>=</span> <span class='va'>Hora</span>,</span>
<span>      y <span class='op'>=</span> <span class='va'>Rating</span>,</span>
<span>      fill <span class='op'>=</span> <span class='va'>Type</span><span class='op'>)</span>,</span>
<span>    lwd <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>+</span> <span class='co'># line width</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span>clip <span class='op'>=</span> <span class='st'>"off"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># remove legend</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># remove labels for scales</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>       y <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>       title <span class='op'>=</span> <span class='st'>"Imported Energy"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># sets x scale</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_date.html'>scale_x_datetime</a></span><span class='op'>(</span></span>
<span>    breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span></span>
<span>      from <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 00:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>      to   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>      by   <span class='op'>=</span> <span class='st'>"2 hours"</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    labels <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='st'>"%H:%M"</span><span class='op'>)</span>,</span>
<span>    limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-27 23:45"</span>, tz<span class='op'>=</span><span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-29 00:30"</span>, tz<span class='op'>=</span><span class='st'>"Europe/Madrid"</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='co'># colors</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>    Portugal <span class='op'>=</span> <span class='st'>"#741b47"</span>,</span>
<span>    Francia <span class='op'>=</span> <span class='st'>"#90496c"</span>,</span>
<span>    Andorra <span class='op'>=</span> <span class='st'>"#ac7691"</span>,</span>
<span>    Marruecos <span class='op'>=</span> <span class='st'>"#c7a4b5"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    <span class='co'># removes background grey</span></span>
<span>    panel.background <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"white"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># changes line color</span></span>
<span>    panel.grid.major.y <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#d6d6d6"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span>,</span>
<span>    <span class='co'># remove axis tick y</span></span>
<span>    axis.ticks.y <span class='op'>=</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#ffffff"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># changes axis tick color</span></span>
<span>    axis.ticks.x <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#b8b8b8"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>,</span>
<span>    <span class='co'># changes axis length</span></span>
<span>    axis.ticks.length <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>.3</span>, <span class='st'>"cm"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># changes axis line</span></span>
<span>    axis.line <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#b8b8b8"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span>,</span>
<span>    <span class='co'># remove x grid</span></span>
<span>    panel.grid.major.x <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#ffffff00"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># set global font family</span></span>
<span>    text <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"roboto"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># set title size and weight</span></span>
<span>    plot.title <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>14</span>, face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>,</span>
<span>    plot.title.position <span class='op'>=</span> <span class='st'>"plot"</span>,</span>
<span>    <span class='co'># set x and y axis color</span></span>
<span>    axis.text <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#b8b8b8"</span><span class='op'>)</span>,</span>
<span>    axis.text.x <span class='op'>=</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>,</span>
<span>    <span class='co'># set caption color</span></span>
<span>    plot.caption <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#b8b8b8"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 13:30"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>3000</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Portugal"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#000000"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>2.5</span><span class='op'>)</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 13:30"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1750</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"France"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#000000"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>2.5</span><span class='op'>)</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 12:45"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>1000</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Andorra"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#000000"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>2.5</span><span class='op'>)</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0.5</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 13:30"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>500</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Morocco"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#000000"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>2.5</span><span class='op'>)</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.8</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Portugal</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 12:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 13:15"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>3000</span>,</span>
<span>    yend <span class='op'>=</span> <span class='op'>-</span><span class='fl'>3000</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># France</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 11:30"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 13:15"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1750</span>,</span>
<span>    yend <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1750</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span>  <span class='op'>+</span></span>
<span>  <span class='co'># Andorra</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 12:45"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 12:45"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>    yend <span class='op'>=</span> <span class='fl'>900</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Morocco</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 12:00"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span><span class='op'>(</span><span class='st'>"2025-04-28 13:15"</span>, tz <span class='op'>=</span> <span class='st'>"Europe/Madrid"</span><span class='op'>)</span>,</span>
<span>    y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>500</span>,</span>
<span>    yend <span class='op'>=</span> <span class='op'>-</span><span class='fl'>500</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span></span>
<span><span class='va'>imported_energy</span></span></code></pre>
</div>
<p><img src="100575891_files/figure-html5/imported_energy-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<h2 id="combining-the-plots">Combining the Plots</h2>
<p>In the original, there was only one ggplot needed to reconstruct the graph. This new version has four graphs laid out with a title across the top. Patchwork was utilized to combine the graphs.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>siderail</span> <span class='op'>&lt;-</span> <span class='va'>renewable</span> <span class='op'>/</span> <span class='va'>non_renewable</span> <span class='op'>/</span> <span class='va'>imported_energy</span> <span class='op'>/</span> <span class='va'>stored_energy</span></span>
<span><span class='va'>siderail</span></span></code></pre>
</div>
<p><img src="100575891_files/figure-html5/side_rail-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>improved</span> <span class='op'>&lt;-</span> <span class='va'>combined</span> <span class='op'>+</span> <span class='va'>siderail</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_layout.html'>plot_layout</a></span><span class='op'>(</span>ncol <span class='op'>=</span> <span class='fl'>2</span>, widths <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_annotation.html'>plot_annotation</a></span><span class='op'>(</span></span>
<span>    title <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_wrap.html'>str_wrap</a></span><span class='op'>(</span><span class='st'>"Energy Production during the April 28th Blackout in Spain"</span>, width <span class='op'>=</span> <span class='fl'>39</span><span class='op'>)</span>, </span>
<span>  theme <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span></span>
<span>      family <span class='op'>=</span> <span class='st'>"roboto"</span>,</span>
<span>      size <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>rel</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span>,</span>
<span>      face <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>      hjust <span class='op'>=</span> <span class='fl'>0</span></span>
<span>    <span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>improved</span></span></code></pre>
</div>
<p><img src="100575891_files/figure-html5/improvement-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
