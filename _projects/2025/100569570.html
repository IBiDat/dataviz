<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>Film Dialogue: Screenplay Dialogue by Gender</title>

  <meta property="description" itemprop="description" content="20,000 Screenplays Dialogue Broken-down by Gender."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2025-12-14"/>
  <meta property="article:created" itemprop="dateCreated" content="2025-12-14"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Film Dialogue: Screenplay Dialogue by Gender"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="20,000 Screenplays Dialogue Broken-down by Gender."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Film Dialogue: Screenplay Dialogue by Gender"/>
  <meta property="twitter:description" content="20,000 Screenplays Dialogue Broken-down by Gender."/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","categories","date","output"]}},"value":[{"type":"character","attributes":{},"value":["Film Dialogue: Screenplay Dialogue by Gender"]},{"type":"character","attributes":{},"value":["20,000 Screenplays Dialogue Broken-down by Gender."]},{"type":"character","attributes":{},"value":["2025"]},{"type":"character","attributes":{},"value":["2025-12-14"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["100569570_files/anchor-4.2.2/anchor.min.js","100569570_files/bowser-1.9.3/bowser.min.js","100569570_files/distill-2.2.21/template.v2.js","100569570_files/figure-html5/unnamed-chunk-3-1.png","100569570_files/figure-html5/unnamed-chunk-4-1.png","100569570_files/figure-html5/unnamed-chunk-5-1.png","100569570_files/figure-html5/unnamed-chunk-6-1.png","100569570_files/figure-html5/unnamed-chunk-7-1.png","100569570_files/figure-html5/unnamed-chunk-8-1.png","100569570_files/figure-html5/unnamed-chunk-9-1.png","100569570_files/header-attrs-2.29/header-attrs.js","100569570_files/jquery-3.6.0/jquery-3.6.0.js","100569570_files/jquery-3.6.0/jquery-3.6.0.min.js","100569570_files/jquery-3.6.0/jquery-3.6.0.min.map","100569570_files/popper-2.6.0/popper.min.js","100569570_files/tippy-6.2.7/tippy-bundle.umd.min.js","100569570_files/tippy-6.2.7/tippy-light-border.css","100569570_files/tippy-6.2.7/tippy.css","100569570_files/tippy-6.2.7/tippy.umd.min.js","100569570_files/webcomponents-2.0.0/webcomponents.js","Adsız/CopyOfEkran Resmi 2025-11-25 14.34.08.png","Adsız/Ekran Resmi 2025-11-25 14.34.08.png","Adsız/final_graph_image.png","Adsız/images/clipboard-895983681.png","Adsız/prince.png","Adsız/princess.png","Adsız/Sude_Boz_Graph_files/figure-html/unnamed-chunk-10-1.png","Adsız/Sude_Boz_Graph_files/figure-html/unnamed-chunk-11-1.png","Adsız/Sude_Boz_Graph_files/figure-html/unnamed-chunk-5-1.png","Adsız/Sude_Boz_Graph_files/figure-html/unnamed-chunk-6-1.png","Adsız/Sude_Boz_Graph_files/figure-html/unnamed-chunk-7-1.png","Adsız/Sude_Boz_Graph_files/figure-html/unnamed-chunk-8-1.png","Adsız/Sude_Boz_Graph_files/figure-html/unnamed-chunk-9-1.png","Adsız/Sude_Boz_Graph_files/libs/bootstrap/bootstrap-c0367b04c37547644fece4185067e4a7.min.css","Adsız/Sude_Boz_Graph_files/libs/bootstrap/bootstrap-icons.css","Adsız/Sude_Boz_Graph_files/libs/bootstrap/bootstrap-icons.woff","Adsız/Sude_Boz_Graph_files/libs/bootstrap/bootstrap.min.js","Adsız/Sude_Boz_Graph_files/libs/clipboard/clipboard.min.js","Adsız/Sude_Boz_Graph_files/libs/quarto-html/anchor.min.js","Adsız/Sude_Boz_Graph_files/libs/quarto-html/popper.min.js","Adsız/Sude_Boz_Graph_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css","Adsız/Sude_Boz_Graph_files/libs/quarto-html/quarto.js","Adsız/Sude_Boz_Graph_files/libs/quarto-html/tippy.css","Adsız/Sude_Boz_Graph_files/libs/quarto-html/tippy.umd.min.js","Adsız/Sude_Boz_Graph.html","Adsız/Sude_Boz_Graph.qmd","Ekran Resmi 2025-11-25 14.34.08.png","images/clipboard-1644346589.png","prince.png","princess.png"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  hr.section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    margin: 0px;
  }


  d-byline {
    border-top: none;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
    border-top: none;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  /* tweak for Pandoc numbered line within distill */
  d-article pre.numberSource code > span {
      left: -2em;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // separator
    var separator = '<hr class="section-separator" style="clear: both"/>';
    // prepend separator above appendix
    $('.d-byline').before(separator);
    $('.d-article').before(separator);

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme, except when numbering line
    // in code chunk
    $('pre:not(.numberLines) code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        var author_name = front_matter.authors[i].author
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="100569570_files/header-attrs-2.29/header-attrs.js"></script>
  <script src="100569570_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="100569570_files/popper-2.6.0/popper.min.js"></script>
  <link href="100569570_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="100569570_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="100569570_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="100569570_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="100569570_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="100569570_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="100569570_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Film Dialogue: Screenplay Dialogue by Gender","description":"20,000 Screenplays Dialogue Broken-down by Gender.","authors":[],"publishedDate":"2025-12-14T00:00:00.000+01:00"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Film Dialogue: Screenplay Dialogue by Gender</h1>

<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt-tag">2025</div>
</div>
<!--/radix_placeholder_categories-->
<p>20,000 Screenplays Dialogue Broken-down by Gender.</p>
</div>


<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#film-dialogue" id="toc-film-dialogue"><code>FILM DIALOGUE</code></a>
<ul>
<li><a href="#from-2000-screenplays-broken-down-by-gender-and-age" id="toc-from-2000-screenplays-broken-down-by-gender-and-age">from 2,000 screenplays, Broken Down by Gender and Age</a></li>
</ul></li>
<li><a href="#section" id="toc-section"></a>
<ul>
<li><a href="#introduction" id="toc-introduction">Introduction</a></li>
<li><a href="#replication" id="toc-replication">REPLICATION</a>
<ul>
<li><a href="#men-have---60-dialogue" id="toc-men-have---60-dialogue">1. Men Have +/- 60 Dialogue</a></li>
<li><a href="#gender-balance---10" id="toc-gender-balance---10">2. Gender Balance +/- 10</a></li>
<li><a href="#women-have---60-dialogue" id="toc-women-have---60-dialogue">3. Women Have +/- 60 Dialogue</a></li>
</ul></li>
<li><a href="#improvement" id="toc-improvement">IMPROVEMENT</a>
<ul>
<li><a href="#a-men-have---60-dialogue-improvement" id="toc-a-men-have---60-dialogue-improvement">1.a Men Have +/- 60 Dialogue IMPROVEMENT</a></li>
<li><a href="#a-women-have---60-dialogue-improvement" id="toc-a-women-have---60-dialogue-improvement">3.a Women Have +/- 60 Dialogue IMPROVEMENT</a></li>
<li><a href="#final-graph" id="toc-final-graph">FINAL GRAPH</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
</div>
<p>Anderson, H., &amp; Daniels, M. (2016, April). <em>Film dialogue from 2,000 screenplays, broken down by gender and age</em>. The Pudding. <a href="https://pudding.cool/2017/03/film-dialogue/?utm_source=chatgpt.com">https://pudding.cool/2017/03/film-dialogue/</a></p>
<h1 id="film-dialogue"><code>FILM DIALOGUE</code></h1>
<h2 id="from-2000-screenplays-broken-down-by-gender-and-age">from 2,000 screenplays, Broken Down by Gender and Age</h2>
<h1 id="section"></h1>
<h3 id="introduction">Introduction</h3>
<p>Recently, Hollywood movies has been criticized for widespread sexism and racism where most discussions are around on the idea that white men dominate film roles and dialogues. However, these arguments mostly depend on opinions and observations rather than data, which prevents any genuinely informed conversation. How many movies are actually about men? What changes by genre, era, or box-office revenue? What circumstances generate more diversity?</p>
<p>The researchers of this visualization did not set out trying to prove anything, but rather compile real data. They framed it as a census rather than a study. So their way was searching 8,000 screenplays and matched each character’s lines to an actor. From there, they complied the number of words spoken by male and female characters across more or less 2,000 films.</p>
<p>Therefore, this project is going to replicate examining the dialogue by gender for Disney films.</p>
<p><img src="images/clipboard-1644346589.png" />On January 2016, researchers reported that men speak more often than women in Disney’s princess films (Anderson &amp; Daniels, 2016). They validated the claim and doubled the sample size to 30 Disney films, including Pixar. The outcome shows 22 of 30 Disney films have a male majority of dialogue. Even films with female leads, such as Mulan, the dialogue swings male. Mushu, her protector dragon, has 50% more words of dialogue than Mulan herself.</p>
<p>The dataset has limitations. Like Mulan where a story may focus on a particular character even if this emphasis isn’t evident in the dialogue. Moreover, the analysis relies on screenplays, which are not exact representations of the final film.</p>
<h2 id="replication">REPLICATION</h2>
<h3 id="men-have---60-dialogue">1. Men Have +/- 60 Dialogue</h3>
<p>First, in order to create the graph, we load the libraries we are going to use throughout this project:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Set up environment</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://readr.tidyverse.org'>readr</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://stringr.tidyverse.org'>stringr</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://scales.r-lib.org'>scales</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://docs.ropensci.org/magick/'>magick</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://wilkelab.org/cowplot/'>cowplot</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/yixuan/showtext'>showtext</a></span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/sysfonts/man/font_add_google.html'>font_add_google</a></span><span class='op'>(</span><span class='st'>"Poppins"</span>, <span class='st'>"Poppins"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/sysfonts/man/font_add_google.html'>font_add_google</a></span><span class='op'>(</span><span class='st'>"Merriweather"</span>, <span class='st'>"merriweather"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/showtext/man/showtext_auto.html'>showtext_auto</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Later, we load the dataset that we found from Pandas Basics (<a href="https://melaniewalsh.github.io/Intro-Cultural-Analytics/03-Data-Analysis/02-Pandas-Basics-Part2.html" class="uri">https://melaniewalsh.github.io/Intro-Cultural-Analytics/03-Data-Analysis/02-Pandas-Basics-Part2.html</a>)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#Loading data</span></span>
<span><span class='va'>char_url</span>  <span class='op'>&lt;-</span> <span class='st'>"https://raw.githubusercontent.com/matthewfdaniels/scripts/master/character_list5.csv"</span></span>
<span><span class='va'>meta_url</span>  <span class='op'>&lt;-</span> <span class='st'>"https://raw.githubusercontent.com/matthewfdaniels/scripts/master/meta_data7.csv"</span></span>
<span></span>
<span><span class='va'>characters</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_csv</a></span><span class='op'>(</span><span class='va'>char_url</span><span class='op'>)</span></span>
<span><span class='va'>metadata</span>   <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_csv</a></span><span class='op'>(</span><span class='va'>meta_url</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Data Processing</span></span>
<span><span class='va'>film_order</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>  <span class='st'>"The Jungle Book"</span>, <span class='st'>"Monsters, Inc."</span>, <span class='st'>"Up"</span>, <span class='st'>"Toy Story"</span>, <span class='st'>"The Rescuers Down Under"</span>, </span>
<span>  <span class='st'>"Aladdin"</span>, <span class='st'>"Holes"</span>, <span class='st'>"Cars 2"</span>, <span class='st'>"The Lion King"</span>, <span class='st'>"Ratatouille"</span>, </span>
<span>  <span class='st'>"Something Wicked This Way Comes"</span>, <span class='st'>"Monsters University"</span>, <span class='st'>"Hercules"</span>, <span class='st'>"Hunchback Of Notre Dame"</span>, </span>
<span>  <span class='st'>"Toy Story 3"</span>, <span class='st'>"Finding Nemo"</span>, <span class='st'>"Mulan"</span>, <span class='st'>"Star Wars: Episode VII - The Force Awakens"</span>, </span>
<span>  <span class='st'>"Beauty And The Beast"</span>, <span class='st'>"The Little Mermaid"</span>, <span class='st'>"Wreck-It Ralph"</span>, <span class='st'>"Mighty Joe Young"</span>, </span>
<span>  <span class='st'>"Pocahontas"</span><span class='op'>)</span> <span class='co'># ordering films manually </span></span>
<span></span>
<span><span class='co'># Defining custom vectors to manually resolve sorting ties in percentages</span></span>
<span><span class='va'>order_87_percent</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>  <span class='st'>"The Lion King"</span>, <span class='st'>"Ratatouille"</span>, <span class='st'>"Something Wicked This Way Comes"</span>, <span class='st'>"Monsters University"</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># Order for films around 75%</span></span>
<span><span class='va'>order_75_percent</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>  <span class='st'>"Toy Story 3"</span>, <span class='st'>"Finding Nemo"</span>, <span class='st'>"Mulan"</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='va'>dialogue_data</span> <span class='op'>&lt;-</span> <span class='va'>characters</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>gender</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"m"</span>, <span class='st'>"f"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span>   <span class='co'># Filter ingfor only male and female characters</span></span>
<span></span>
<span> <span class='co'># Calculating total words spoken per film (script_id) and gender </span></span>
<span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>script_id</span>, <span class='va'>gender</span><span class='op'>)</span> <span class='op'>|&gt;</span>  </span>
<span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>words <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>words</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, .groups <span class='op'>=</span> <span class='st'>'drop'</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span></span>
<span> <span class='co'># Pivot to create separate columns for male and female word counts</span></span>
<span><span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_wider.html'>pivot_wider</a></span><span class='op'>(</span></span>
<span>  names_from <span class='op'>=</span> <span class='va'>gender</span>,</span>
<span>  values_from <span class='op'>=</span> <span class='va'>words</span>,</span>
<span>  values_fill <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>  names_prefix <span class='op'>=</span> <span class='st'>"words_"</span></span>
<span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span></span>
<span>  <span class='co'># Calculating total words and percentages</span></span>
<span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>  words_total <span class='op'>=</span> <span class='va'>words_m</span> <span class='op'>+</span> <span class='va'>words_f</span>,</span>
<span>  male_percent <span class='op'>=</span> <span class='va'>words_m</span> <span class='op'>/</span> <span class='va'>words_total</span>,</span>
<span>  female_percent <span class='op'>=</span> <span class='va'>words_f</span> <span class='op'>/</span> <span class='va'>words_total</span></span>
<span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>words_total</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span></span>
<span>  <span class='co'># Joning metadata for the titles of the films by script_id since it is the key</span></span>
<span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>metadata</span>, by <span class='op'>=</span> <span class='st'>"script_id"</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>title</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  </span>
<span>  <span class='co'># Filtering only film_order </span></span>
<span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>title</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>film_order</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  </span>
<span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>  custom_rank <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>    <span class='va'>title</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>order_87_percent</span> <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/match.html'>match</a></span><span class='op'>(</span><span class='va'>title</span>, <span class='va'>order_87_percent</span><span class='op'>)</span>,</span>
<span>    <span class='va'>title</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>order_75_percent</span> <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/match.html'>match</a></span><span class='op'>(</span><span class='va'>title</span>, <span class='va'>order_75_percent</span><span class='op'>)</span>,</span>
<span>    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='fl'>999</span></span>
<span>  <span class='op'>)</span></span>
<span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  </span>
<span>  <span class='co'># Sorting data primarily by male percentage (descending)</span></span>
<span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>male_percent</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span> <span class='co'># Final data preparation for the plot</span></span>
<span><span class='va'>top_dialogue_data</span> <span class='op'>&lt;-</span> <span class='va'>dialogue_data</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>male_percent</span><span class='op'>)</span>, <span class='va'>custom_rank</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>plot_data</span> <span class='op'>&lt;-</span> <span class='va'>top_dialogue_data</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>title</span>, <span class='va'>female_percent</span>, <span class='va'>male_percent</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  </span>
<span>  <span class='co'># Converting data back to long format for ggplot stacked bar chart</span></span>
<span><span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span></span>
<span>  cols<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>male_percent</span>, <span class='va'>female_percent</span><span class='op'>)</span>,</span>
<span>  names_to <span class='op'>=</span> <span class='st'>"gender"</span>,</span>
<span>  values_to <span class='op'>=</span> <span class='st'>"percentage"</span></span>
<span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  </span>
<span>  <span class='co'># Set gender as a factor with specific levels for color mapping and stacking order</span></span>
<span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>  gender <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>gender</span>,</span>
<span>                  levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"female_percent"</span>, <span class='st'>"male_percent"</span><span class='op'>)</span>,</span>
<span>                  labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Female Dialogue"</span>, <span class='st'>"Male Dialogue"</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># Critical part: Setting movie titles as a factor with levels in the desired chart order.</span></span>
<span></span>
<span><span class='va'>plot_data</span><span class='op'>$</span><span class='va'>title</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span></span>
<span>  <span class='va'>plot_data</span><span class='op'>$</span><span class='va'>title</span>,</span>
<span>  levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>top_dialogue_data</span><span class='op'>$</span><span class='va'>title</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class='co'># Color palettes and gradiants</span></span>
<span><span class='va'>palette</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#356df4"</span>, <span class='st'>"#dba0a0"</span>, <span class='st'>"#a9bffe"</span>, <span class='st'>"#2b2b2b"</span>, <span class='st'>"#e5e8f2"</span>, </span>
<span>             <span class='st'>"#858485"</span>, <span class='st'>"#517fed"</span>, <span class='st'>"#ccbaba"</span>, <span class='st'>"#2261fa"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Number of films</span></span>
<span><span class='va'>n_films</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>plot_data</span><span class='op'>$</span><span class='va'>title</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Gradient blues for male dialogue </span></span>
<span><span class='va'>male_colors</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#a9bffe"</span>,<span class='st'>"#517fed"</span>, <span class='st'>"#2261fa"</span>,<span class='st'>"#356df4"</span><span class='op'>)</span></span>
<span><span class='op'>)</span><span class='op'>(</span><span class='va'>n_films</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Gradient peach/pink for female dialogue </span></span>
<span><span class='va'>female_colors</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#dba0a0"</span>, <span class='st'>"#ccbaba"</span><span class='op'>)</span></span>
<span><span class='op'>)</span><span class='op'>(</span><span class='va'>n_films</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#Assigning gradient color per film</span></span>
<span><span class='va'>plot_data</span> <span class='op'>&lt;-</span> <span class='va'>plot_data</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    title_index <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='va'>title</span><span class='op'>)</span>,</span>
<span>    fill_color  <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span></span>
<span>      <span class='va'>gender</span> <span class='op'>==</span> <span class='st'>"Male Dialogue"</span>,</span>
<span>      <span class='va'>male_colors</span><span class='op'>[</span><span class='va'>title_index</span><span class='op'>]</span>,</span>
<span>      <span class='va'>female_colors</span><span class='op'>[</span><span class='va'>title_index</span><span class='op'>]</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'>#----------------</span></span>
<span><span class='co'>#Visualization</span></span>
<span><span class='co'>#----------------</span></span>
<span></span>
<span><span class='va'>fifty_fifty_line</span> <span class='op'>&lt;-</span> <span class='fl'>0.50</span></span>
<span></span>
<span><span class='va'>men_graph</span><span class='op'>&lt;-</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>plot_data</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>percentage</span>, y <span class='op'>=</span> <span class='va'>title</span>, fill <span class='op'>=</span> <span class='va'>fill_color</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></span><span class='op'>(</span>stat <span class='op'>=</span> <span class='st'>"identity"</span>, position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_stack.html'>position_stack</a></span><span class='op'>(</span>reverse <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, width <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span> <span class='op'>+</span> <span class='co'>#creating stack horizontal bar chart</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>fifty_fifty_line</span>, </span>
<span>             linetype <span class='op'>=</span> <span class='st'>"solid"</span>, </span>
<span>             color <span class='op'>=</span> <span class='st'>"#858485"</span>, </span>
<span>             linewidth <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span> <span class='co'># Adding the 50/50 vertical reference line</span></span>
<span>  <span class='co'># Special label for "98% MALE DIALOGUE"</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>top_dialogue_data</span> <span class='op'>|&gt;</span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>male_percent</span>, <span class='fl'>2</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0.98</span> <span class='op'>~</span> <span class='st'>"98% MALE\nDIALOGUE"</span>,</span>
<span>        <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='cn'>NA_character_</span></span>
<span>      <span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>label</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>1.01</span>, y <span class='op'>=</span> <span class='fl'>20.8</span>, label <span class='op'>=</span> <span class='va'>label</span><span class='op'>)</span>,</span>
<span>    inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#356df4"</span>, </span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>    size <span class='op'>=</span> <span class='fl'>2.3</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"Poppins"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Add percentage labels (90%, 87%, 75%, 69%)</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>top_dialogue_data</span> <span class='op'>|&gt;</span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>male_percent</span>, <span class='fl'>2</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0.98</span> <span class='op'>~</span> <span class='cn'>NA_character_</span>,</span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>male_percent</span>, <span class='fl'>2</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0.90</span> <span class='op'>~</span> <span class='st'>"90%"</span>,</span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>male_percent</span>, <span class='fl'>2</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0.87</span> <span class='op'>&amp;</span> <span class='va'>title</span> <span class='op'>==</span> <span class='st'>"Ratatouille"</span> <span class='op'>~</span> <span class='st'>"87%"</span>,</span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>male_percent</span>, <span class='fl'>2</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0.75</span> <span class='op'>&amp;</span> <span class='va'>title</span> <span class='op'>==</span> <span class='st'>"Mulan"</span> <span class='op'>~</span> <span class='st'>"75%"</span>,</span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>male_percent</span>, <span class='fl'>2</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0.69</span> <span class='op'>~</span> <span class='st'>"69%"</span>,</span>
<span>        <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='cn'>NA_character_</span></span>
<span>      <span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>label</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>1.02</span>, </span>
<span>        y <span class='op'>=</span> <span class='va'>title</span>,</span>
<span>        label <span class='op'>=</span> <span class='va'>label</span><span class='op'>)</span>,</span>
<span>    inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#356df4"</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_identity.html'>scale_fill_identity</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> <span class='co'>#using identity scale for gradient colors</span></span>
<span>  </span>
<span>  <span class='co'># Y-axis configuration</span></span>
<span>   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_discrete.html'>scale_y_discrete</a></span><span class='op'>(</span>limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>top_dialogue_data</span><span class='op'>$</span><span class='va'>title</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>                   expand <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/expansion.html'>expansion</a></span><span class='op'>(</span>add <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># X-axis configuration with 50/50 at top</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"50/50"</span> <span class='op'>=</span> <span class='st'>"50/50"</span><span class='op'>)</span>, </span>
<span>                     breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span><span class='op'>)</span>,  </span>
<span>                     limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1.08</span><span class='op'>)</span>,</span>
<span>                     position <span class='op'>=</span> <span class='st'>"top"</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  </span>
<span>  <span class='co'># Set titles and labels</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span></span>
<span>    title <span class='op'>=</span> <span class='st'>"Men have 60%+ Dialogue"</span>,</span>
<span>    x <span class='op'>=</span> <span class='st'>""</span>,</span>
<span>    y <span class='op'>=</span> <span class='st'>""</span>,</span>
<span>    fill <span class='op'>=</span> <span class='st'>""</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Applying and customizing the theme</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"merriweather"</span>, color <span class='op'>=</span> <span class='st'>"#356df4"</span>, </span>
<span>                              face <span class='op'>=</span> <span class='st'>"bold"</span>, hjust <span class='op'>=</span> <span class='fl'>0.5</span>, </span>
<span>                              margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>b <span class='op'>=</span> <span class='fl'>12</span>, unit <span class='op'>=</span> <span class='st'>"pt"</span><span class='op'>)</span>, size <span class='op'>=</span> <span class='fl'>16</span><span class='op'>)</span>,</span>
<span>    axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>10</span>, color <span class='op'>=</span> <span class='st'>"black"</span>, </span>
<span>                               margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>b <span class='op'>=</span> <span class='fl'>12</span>, unit <span class='op'>=</span> <span class='st'>"pt"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"merriweather"</span>, size <span class='op'>=</span> <span class='fl'>12</span>, </span>
<span>                               color <span class='op'>=</span> <span class='st'>"black"</span>, face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>,</span>
<span>    panel.grid.major <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    panel.grid.minor <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    legend.position <span class='op'>=</span> <span class='st'>"none"</span>,</span>
<span>    plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>20</span>, <span class='fl'>10</span>, <span class='fl'>0</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span><span class='va'>men_graph</span></span></code></pre>
</div>
<p><img src="100569570_files/figure-html5/unnamed-chunk-3-1.png" width="624" /></p>
</div>
<h3 id="gender-balance---10">2. Gender Balance +/- 10</h3>
<p>This graph shows us gender balance around -/+ 10 percent of four films, which are <strong><em>Frozen, The Incredibles, Into the Woods, Tarzan.</em></strong></p>
<p>Starting with setting up the data and environment</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>gender_film</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='va'>metadata</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>title</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span> <span class='st'>"Frozen"</span>, <span class='st'>"The Incredibles"</span>, <span class='st'>"Into the Woods"</span>, <span class='st'>"Tarzan"</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Targeting list of films for the "Gender Balance" chart</span></span>
<span></span>
<span><span class='va'>target_movies</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Frozen"</span>, <span class='st'>"The Incredibles"</span>, <span class='st'>"Into the Woods"</span>, <span class='st'>"Tarzan"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Data processing and joining#</span></span>
<span><span class='co'># Filter metadata to get script_ids for the target movies</span></span>
<span><span class='va'>gender_film_ids</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='va'>metadata</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>title</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>target_movies</span><span class='op'>)</span>  <span class='op'>|&gt;</span> </span>
<span>   <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>script_id</span>, <span class='va'>title</span><span class='op'>)</span>       <span class='co'># Selecting only the join key and the title</span></span>
<span></span>
<span><span class='co'># Calculating dialogue percentages for the target movies</span></span>
<span><span class='va'>dialogue_data_balanced</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='va'>characters</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>inner_join</a></span><span class='op'>(</span><span class='va'>gender_film_ids</span>, by <span class='op'>=</span> <span class='st'>"script_id"</span><span class='op'>)</span> <span class='op'>|&gt;</span>  <span class='co'># Join with filtered metadata to include only target movies</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>gender</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"m"</span>, <span class='st'>"f"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span> <span class='co'># filtering male and female genders</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>title</span>, <span class='va'>gender</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>                         <span class='co'># Sum the word counts for dialogue</span></span>
<span>    total_words <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>words</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,</span>
<span>    .groups <span class='op'>=</span> <span class='st'>'drop_last'</span>            <span class='co'># Maintain grouping by title</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>                            <span class='co'># Calculating the percentages</span></span>
<span>    movie_total_words <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>total_words</span><span class='op'>)</span>,</span>
<span>    percentage <span class='op'>=</span> <span class='va'>total_words</span> <span class='op'>/</span> <span class='va'>movie_total_words</span> <span class='op'>*</span> <span class='fl'>100</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#----Plot data preparation----</span></span>
<span><span class='va'>plot_data_balance</span> <span class='op'>&lt;-</span> <span class='va'>dialogue_data_balanced</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># Setting movie titles as a factor with specific levels for consistent sorting</span></span>
<span>    title <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>title</span>, levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Frozen"</span>, <span class='st'>"The Incredibles"</span>, <span class='st'>"Into the Woods"</span>, <span class='st'>"Tarzan"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    <span class='co'># Set gender as a factor</span></span>
<span>    gender <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>gender</span>, levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"f"</span>, <span class='st'>"m"</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># Extract and round the percentages for the Frozen label</span></span>
<span><span class='va'>frozen_male_perc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>plot_data_balance</span><span class='op'>[</span><span class='va'>plot_data_balance</span><span class='op'>$</span><span class='va'>title</span> <span class='op'>==</span> <span class='st'>"Frozen"</span> <span class='op'>&amp;</span> <span class='va'>plot_data_balance</span><span class='op'>$</span><span class='va'>gender</span> <span class='op'>==</span> <span class='st'>"m"</span>, <span class='op'>]</span><span class='op'>$</span><span class='va'>percentage</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span></span>
<span><span class='va'>frozen_female_perc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>plot_data_balance</span><span class='op'>[</span><span class='va'>plot_data_balance</span><span class='op'>$</span><span class='va'>title</span> <span class='op'>==</span> <span class='st'>"Frozen"</span> <span class='op'>&amp;</span> <span class='va'>plot_data_balance</span><span class='op'>$</span><span class='va'>gender</span> <span class='op'>==</span> <span class='st'>"f"</span>, <span class='op'>]</span><span class='op'>$</span><span class='va'>percentage</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#---- Color Palette----</span></span>
<span></span>
<span><span class='va'>palette_balance</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#7193e4"</span>, <span class='st'>"#6a8fe6"</span>,<span class='st'>"#7c9ae3"</span>, <span class='st'>"#e67e7e"</span>, <span class='st'>"#272727"</span>, <span class='st'>"#dad9dc"</span>, </span>
<span>                     <span class='st'>"#7798e3"</span>, <span class='st'>"#818082"</span>, <span class='st'>"#e77b7b"</span>, <span class='st'>"#e28a8a"</span>, <span class='st'>"#e48483"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Number of films</span></span>
<span><span class='va'>n_films_balance</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>plot_data_balance</span><span class='op'>$</span><span class='va'>title</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Gradient blues for male dialogue</span></span>
<span><span class='va'>male_colors_balance</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#6a8fe6"</span>,<span class='st'>"#7193e4"</span>, <span class='st'>"#7798e3"</span>, <span class='st'>"#7c9ae3"</span><span class='op'>)</span></span>
<span><span class='op'>)</span><span class='op'>(</span><span class='va'>n_films_balance</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Gradient pink/red for female dialogue</span></span>
<span><span class='va'>female_colors_balance</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span> <span class='st'>"#e28a8a"</span>,<span class='st'>"#e48483"</span>,<span class='st'>"#e67e7e"</span>, <span class='st'>"#e77b7b"</span><span class='op'>)</span></span>
<span><span class='op'>)</span><span class='op'>(</span><span class='va'>n_films_balance</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Assign gradient colors per film and gender</span></span>
<span><span class='va'>plot_data_balance</span> <span class='op'>&lt;-</span> <span class='va'>plot_data_balance</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    title_index <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='va'>title</span><span class='op'>)</span>,</span>
<span>    fill_color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span></span>
<span>      <span class='va'>gender</span> <span class='op'>==</span> <span class='st'>"m"</span>,</span>
<span>      <span class='va'>male_colors_balance</span><span class='op'>[</span><span class='va'>title_index</span><span class='op'>]</span>,</span>
<span>      <span class='va'>female_colors_balance</span><span class='op'>[</span><span class='va'>title_index</span><span class='op'>]</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'>#----------------</span></span>
<span><span class='co'>#Visualization</span></span>
<span><span class='co'>#----------------</span></span>
<span></span>
<span><span class='va'>gender_balance_graph</span><span class='op'>&lt;-</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>plot_data_balance</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>percentage</span>, y <span class='op'>=</span> <span class='va'>title</span>, fill <span class='op'>=</span> <span class='va'>fill_color</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></span><span class='op'>(</span>stat <span class='op'>=</span> <span class='st'>"identity"</span>,position <span class='op'>=</span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_stack.html'>position_stack</a></span><span class='op'>(</span>reverse <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, width <span class='op'>=</span> <span class='fl'>0.7</span><span class='op'>)</span> <span class='op'>+</span>  <span class='co'>#Creating the horizontal stacked bars</span></span>
<span>  </span>
<span>   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='fl'>50</span>, </span>
<span>              linetype <span class='op'>=</span> <span class='st'>"solid"</span>,</span>
<span>              color <span class='op'>=</span> <span class='st'>"#818082"</span>, </span>
<span>              linewidth <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_identity.html'>scale_fill_identity</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  </span>
<span>  <span class='co'># Adding the Two-Color Percentage Label for Frozen</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>plot_data_balance</span> <span class='op'>|&gt;</span>  </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>title</span> <span class='op'>==</span> <span class='st'>"Frozen"</span> <span class='op'>&amp;</span> <span class='va'>gender</span> <span class='op'>==</span> <span class='st'>"m"</span><span class='op'>)</span>,</span>
<span>    label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>frozen_male_perc</span>, <span class='st'>"%"</span><span class='op'>)</span>,</span>
<span>    x <span class='op'>=</span> <span class='fl'>101</span>, </span>
<span>    color <span class='op'>=</span> <span class='st'>"#2362fa"</span>,  </span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>plot_data_balance</span> <span class='op'>|&gt;</span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>title</span> <span class='op'>==</span> <span class='st'>"Frozen"</span> <span class='op'>&amp;</span> <span class='va'>gender</span> <span class='op'>==</span> <span class='st'>"f"</span><span class='op'>)</span>,</span>
<span>    label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>" / "</span>, <span class='va'>frozen_female_perc</span>, <span class='st'>"%"</span><span class='op'>)</span>,</span>
<span>    x <span class='op'>=</span> <span class='fl'>110</span>, </span>
<span>    color <span class='op'>=</span> <span class='st'>"#e94b55"</span>,  </span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Add the "50/50" text annotation</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>50</span>, y <span class='op'>=</span> <span class='fl'>4.5</span>, label <span class='op'>=</span> <span class='st'>"50/50"</span>, color <span class='op'>=</span> <span class='st'>"#818082"</span>, size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Extend X-axis limits</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>115</span><span class='op'>)</span>, position <span class='op'>=</span> <span class='st'>"top"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Reversing the Y-axis order</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_discrete.html'>scale_y_discrete</a></span><span class='op'>(</span>limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>plot_data_balance</span><span class='op'>$</span><span class='va'>title</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Titles and Labels</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span></span>
<span>    title <span class='op'>=</span> <span class='st'>"Gender Balance, +/- 10%"</span>,</span>
<span>    y <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>    x <span class='op'>=</span> <span class='cn'>NULL</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Theme Customization</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    legend.position <span class='op'>=</span> <span class='st'>"none"</span>,</span>
<span>    plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"merriweather"</span>,</span>
<span>                              hjust <span class='op'>=</span> <span class='fl'>0.5</span>, </span>
<span>                              size <span class='op'>=</span> <span class='fl'>18</span>, </span>
<span>                              face <span class='op'>=</span> <span class='st'>"bold"</span>, </span>
<span>                              color <span class='op'>=</span> <span class='st'>"#272727"</span><span class='op'>)</span>,  </span>
<span>    axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>, </span>
<span>    axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"merriweather"</span>,</span>
<span>                               size <span class='op'>=</span> <span class='fl'>12</span>, </span>
<span>                               face <span class='op'>=</span> <span class='st'>"bold"</span>, </span>
<span>                               color <span class='op'>=</span> <span class='st'>"#272727"</span><span class='op'>)</span>,</span>
<span>    panel.grid.major <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    panel.grid.minor <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>50</span>, <span class='fl'>10</span>, <span class='fl'>10</span><span class='op'>)</span> </span>
<span>  <span class='op'>)</span></span>
<span><span class='va'>gender_balance_graph</span></span></code></pre>
</div>
<p><img src="100569570_files/figure-html5/unnamed-chunk-4-1.png" width="624" /></p>
</div>
<h3 id="women-have---60-dialogue">3. Women Have +/- 60 Dialogue</h3>
<p>Lastly, we are having a graph that shows women dialogue around -/+ 60 percent of four films, which are <strong><em>Inside Out, Alice in Wonderland, Maleficent”, Sleeping Beauty.</em></strong></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>target_women_film</span> <span class='op'>&lt;-</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Inside Out"</span>, <span class='st'>"Alice in Wonderland"</span>, <span class='st'>"Maleficent"</span>, <span class='st'>"Sleeping Beauty"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Calculating Dialogue Data (Reusing the structure from the Men's chart) </span></span>
<span><span class='co'># which ensures we have male_percent and female_percent columns</span></span>
<span></span>
<span><span class='va'>dialogue_data_women</span> <span class='op'>&lt;-</span> <span class='va'>characters</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>gender</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"f"</span>, <span class='st'>"m"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>script_id</span>, <span class='va'>gender</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>words <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>words</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, .groups <span class='op'>=</span> <span class='st'>'drop'</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_wider.html'>pivot_wider</a></span><span class='op'>(</span></span>
<span>    names_from <span class='op'>=</span> <span class='va'>gender</span>,</span>
<span>    values_from <span class='op'>=</span> <span class='va'>words</span>,</span>
<span>    values_fill <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>    names_prefix <span class='op'>=</span> <span class='st'>"words_"</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    words_total <span class='op'>=</span> <span class='va'>words_m</span> <span class='op'>+</span> <span class='va'>words_f</span>,</span>
<span>    male_percent <span class='op'>=</span> <span class='va'>words_m</span> <span class='op'>/</span> <span class='va'>words_total</span> <span class='op'>*</span> <span class='fl'>100</span>,      <span class='co'># Calculate as percentages (0-100)</span></span>
<span>    female_percent <span class='op'>=</span> <span class='va'>words_f</span> <span class='op'>/</span> <span class='va'>words_total</span> <span class='op'>*</span> <span class='fl'>100</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>words_total</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>metadata</span>, by <span class='op'>=</span> <span class='st'>"script_id"</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>title</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  </span>
<span>  <span class='co'>#Critical Filter: Keeping only movies where women have 60% or more dialogue</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>female_percent</span> <span class='op'>&gt;=</span> <span class='fl'>60</span> <span class='op'>&amp;</span> <span class='va'>title</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>target_women_film</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>female_percent</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># Sort by descending female percentage (highest dominance at the top)</span></span>
<span></span>
<span><span class='co'>#---- Color Palette--</span></span>
<span><span class='va'>palette_women</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#8ea5de"</span>, <span class='st'>"#8fa7dc"</span>, <span class='st'>"#95aadb"</span>, <span class='st'>"#97abda"</span>,</span>
<span>                   <span class='st'>"#ed6a6a"</span>, <span class='st'>"#ed6969"</span>, <span class='st'>"#ef6465"</span>, <span class='st'>"#ef6262"</span>,</span>
<span>                   <span class='st'>"#ff3334"</span>, <span class='st'>"#9b9aa1"</span>, <span class='st'>"#050505"</span>, <span class='st'>"#2562fa"</span>, </span>
<span>                   <span class='st'>"#e94953"</span><span class='op'>)</span></span>
<span><span class='va'>n_films_women</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>dialogue_data_women</span><span class='op'>$</span><span class='va'>title</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>male_colors_women</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#8ea5de"</span>, <span class='st'>"#8fa7dc"</span>, <span class='st'>"#95aadb"</span>, <span class='st'>"#97abda"</span><span class='op'>)</span></span>
<span><span class='op'>)</span><span class='op'>(</span><span class='va'>n_films_women</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>female_colors_women</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#ed6a6a"</span>, <span class='st'>"#ed6969"</span>, <span class='st'>"#ef6465"</span>, <span class='st'>"#ef6262"</span><span class='op'>)</span></span>
<span><span class='op'>)</span><span class='op'>(</span><span class='va'>n_films_women</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># --- Preparing for Plotting ---</span></span>
<span><span class='va'>plot_data_women</span> <span class='op'>&lt;-</span> <span class='va'>dialogue_data_women</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>title</span>, <span class='va'>female_percent</span>, <span class='va'>male_percent</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span></span>
<span>    cols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>male_percent</span>, <span class='va'>female_percent</span><span class='op'>)</span>,</span>
<span>    names_to <span class='op'>=</span> <span class='st'>"gender"</span>,</span>
<span>    values_to <span class='op'>=</span> <span class='st'>"percentage"</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    gender <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>gender</span>, </span>
<span>                    levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"female_percent"</span>, <span class='st'>"male_percent"</span><span class='op'>)</span>, </span>
<span>                    labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Female Dialogue"</span>, <span class='st'>"Male Dialogue"</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># Set factor levels for the Y-axis</span></span>
<span><span class='va'>plot_data_women</span><span class='op'>$</span><span class='va'>title</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>plot_data_women</span><span class='op'>$</span><span class='va'>title</span>, </span>
<span>                                levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>dialogue_data_women</span><span class='op'>$</span><span class='va'>title</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Assigning gradient colors per film and gender</span></span>
<span><span class='va'>plot_data_women</span> <span class='op'>&lt;-</span> <span class='va'>plot_data_women</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    title_index <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='va'>title</span><span class='op'>)</span>,</span>
<span>    fill_color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span></span>
<span>      <span class='va'>gender</span> <span class='op'>==</span> <span class='st'>"Male Dialogue"</span>,</span>
<span>      <span class='va'>male_colors_women</span><span class='op'>[</span><span class='va'>title_index</span><span class='op'>]</span>,</span>
<span>      <span class='va'>female_colors_women</span><span class='op'>[</span><span class='va'>title_index</span><span class='op'>]</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># --- Extract Custom Label Variables (Inside Out) ---</span></span>
<span><span class='va'>inside_out_male_perc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>dialogue_data_women</span><span class='op'>[</span><span class='va'>dialogue_data_women</span><span class='op'>$</span><span class='va'>title</span> <span class='op'>==</span> <span class='st'>"Inside Out"</span>, <span class='op'>]</span><span class='op'>$</span><span class='va'>male_percent</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span></span>
<span><span class='va'>inside_out_female_perc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>dialogue_data_women</span><span class='op'>[</span><span class='va'>dialogue_data_women</span><span class='op'>$</span><span class='va'>title</span> <span class='op'>==</span> <span class='st'>"Inside Out"</span>, <span class='op'>]</span><span class='op'>$</span><span class='va'>female_percent</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span></span>
<span></span>
<span><span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>inside_out_male_perc</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='va'>inside_out_male_perc</span> <span class='op'>&lt;-</span> <span class='fl'>36</span></span>
<span>  <span class='va'>inside_out_female_perc</span> <span class='op'>&lt;-</span> <span class='fl'>64</span> </span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='va'>fifty_fifty_line</span> <span class='op'>&lt;-</span> <span class='fl'>50</span></span>
<span></span>
<span><span class='co'>#----------------</span></span>
<span><span class='co'>#Visualization</span></span>
<span><span class='co'>#----------------</span></span>
<span></span>
<span><span class='va'>women_graph</span> <span class='op'>&lt;-</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>plot_data_women</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>percentage</span>, y <span class='op'>=</span> <span class='va'>title</span>, fill <span class='op'>=</span> <span class='va'>fill_color</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Creating the stacked horizontal bar chart</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></span><span class='op'>(</span>stat <span class='op'>=</span> <span class='st'>"identity"</span>, position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_stack.html'>position_stack</a></span><span class='op'>(</span>reverse <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, width <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Add the 50/50 vertical reference line</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>fifty_fifty_line</span>, </span>
<span>             linetype <span class='op'>=</span> <span class='st'>"solid"</span>, </span>
<span>             color <span class='op'>=</span> <span class='st'>"#9b9aa1"</span>, </span>
<span>             linewidth <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'>#scale for gradient colors</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_identity.html'>scale_fill_identity</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Adding the two-color percentage </span></span>
<span>  <span class='co'># Male percentage label</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>plot_data_women</span> <span class='op'>|&gt;</span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>title</span> <span class='op'>==</span> <span class='st'>"Inside Out"</span> <span class='op'>&amp;</span> <span class='va'>gender</span> <span class='op'>==</span> <span class='st'>"Male Dialogue"</span><span class='op'>)</span>,</span>
<span>    label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>inside_out_male_perc</span>, <span class='st'>"%"</span><span class='op'>)</span>,</span>
<span>    x <span class='op'>=</span> <span class='fl'>101</span>, </span>
<span>    color <span class='op'>=</span> <span class='st'>"#2562fa"</span>, </span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Female percentage label</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>plot_data_women</span> <span class='op'>|&gt;</span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>title</span> <span class='op'>==</span> <span class='st'>"Inside Out"</span> <span class='op'>&amp;</span> <span class='va'>gender</span> <span class='op'>==</span> <span class='st'>"Female Dialogue"</span><span class='op'>)</span>,</span>
<span>    label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>" / "</span>, <span class='va'>inside_out_female_perc</span>, <span class='st'>"%"</span><span class='op'>)</span>,</span>
<span>    x <span class='op'>=</span> <span class='fl'>109</span>, </span>
<span>    color <span class='op'>=</span> <span class='st'>"#e94953"</span>, </span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span><span class='co'># Extending x-axis limits</span></span>
<span>   </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"50/50"</span> <span class='op'>=</span> <span class='st'>"50/50"</span><span class='op'>)</span>, </span>
<span>                     breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span><span class='op'>)</span>,  </span>
<span>                     limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>115</span><span class='op'>)</span>,</span>
<span>                     position <span class='op'>=</span> <span class='st'>"top"</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>    <span class='co'># Add the "50/50" text annotation</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>50</span>, y <span class='op'>=</span> <span class='fl'>4.55</span>, label <span class='op'>=</span> <span class='st'>"50/50"</span>, color <span class='op'>=</span> <span class='st'>"#9b9aa1"</span>, size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Y-axis order</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_discrete.html'>scale_y_discrete</a></span><span class='op'>(</span>limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>plot_data_women</span><span class='op'>$</span><span class='va'>title</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Titles and labels</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span></span>
<span>    title <span class='op'>=</span> <span class='st'>"Women have 60%+ Dialogue"</span>,</span>
<span>    x <span class='op'>=</span> <span class='st'>""</span>, </span>
<span>    y <span class='op'>=</span> <span class='st'>""</span>, </span>
<span>    fill <span class='op'>=</span> <span class='st'>""</span> </span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Theme customization</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"merriweather"</span>, color <span class='op'>=</span> <span class='st'>"#ff3334"</span>, face <span class='op'>=</span> <span class='st'>"bold"</span>, hjust <span class='op'>=</span> <span class='fl'>0.5</span>, size <span class='op'>=</span> <span class='fl'>16</span><span class='op'>)</span>,</span>
<span>    axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"merriweather"</span>, size <span class='op'>=</span> <span class='fl'>12</span>, color <span class='op'>=</span> <span class='st'>"black"</span>, face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>, </span>
<span>    panel.grid.major <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>, </span>
<span>    panel.grid.minor <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>, </span>
<span>    legend.position <span class='op'>=</span> <span class='st'>"none"</span>, </span>
<span>    plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>50</span>, <span class='fl'>10</span>, <span class='fl'>10</span><span class='op'>)</span> </span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='va'>women_graph</span></span></code></pre>
</div>
<p><img src="100569570_files/figure-html5/unnamed-chunk-5-1.png" width="624" /></p>
</div>
<hr />
<h2 id="improvement">IMPROVEMENT</h2>
<ul>
<li><p>Men graph improvement</p></li>
<li><p>Women graph improvement</p></li>
</ul>
<h3 id="a-men-have---60-dialogue-improvement">1.a Men Have +/- 60 Dialogue IMPROVEMENT</h3>
<p>Since this graph aims to show the criticism of how Disney movies are gendered through the dialogues of male and female characters, I believe it could be improved by adding the years of the movies to allow for a comparison over time to see how the situation changes. Additionally, including the characters from the movies would help represent which percentage belongs to each gender.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>film_order</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>  <span class='st'>"The Jungle Book"</span>, <span class='st'>"Monsters, Inc."</span>, <span class='st'>"Up"</span>, <span class='st'>"Toy Story"</span>, <span class='st'>"The Rescuers Down Under"</span>, </span>
<span>  <span class='st'>"Aladdin"</span>, <span class='st'>"Holes"</span>, <span class='st'>"Cars 2"</span>, <span class='st'>"The Lion King"</span>, <span class='st'>"Ratatouille"</span>, </span>
<span>  <span class='st'>"Something Wicked This Way Comes"</span>, <span class='st'>"Monsters University"</span>, <span class='st'>"Hercules"</span>, <span class='st'>"Hunchback Of Notre Dame"</span>,   <span class='st'>"Toy Story 3"</span>, <span class='st'>"Finding Nemo"</span>, <span class='st'>"Mulan"</span>, <span class='st'>"Star Wars: Episode VII - The Force Awakens"</span>, </span>
<span>  <span class='st'>"Beauty And The Beast"</span>, <span class='st'>"The Little Mermaid"</span>, <span class='st'>"Wreck-It Ralph"</span>, <span class='st'>"Mighty Joe Young"</span>, </span>
<span>  <span class='st'>"Pocahontas"</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>order_87_percent</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"The Lion King"</span>, <span class='st'>"Ratatouille"</span>, </span>
<span>                      <span class='st'>"Something Wicked This Way Comes"</span>, <span class='st'>"Monsters University"</span><span class='op'>)</span></span>
<span><span class='va'>order_75_percent</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Toy Story 3"</span>, <span class='st'>"Finding Nemo"</span>, <span class='st'>"Mulan"</span><span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='co'>#New step for improvement : Calculating top characters</span></span>
<span></span>
<span><span class='co'>#Find the name of the top speaking Male and Female for each script</span></span>
<span><span class='va'>top_chars_by_movie</span> <span class='op'>&lt;-</span> <span class='va'>characters</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>gender</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"m"</span>, <span class='st'>"f"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='co'># Join metadata early to filter by your specific film list</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>metadata</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>script_id</span>, <span class='va'>title</span><span class='op'>)</span>, by <span class='op'>=</span> <span class='st'>"script_id"</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>title</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>film_order</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>script_id</span>, <span class='va'>title</span>, <span class='va'>gender</span>, <span class='va'>imdb_character_name</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>words <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>words</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, .groups <span class='op'>=</span> <span class='st'>'drop'</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>script_id</span>, <span class='va'>gender</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/slice.html'>slice_max</a></span><span class='op'>(</span><span class='va'>words</span>, n <span class='op'>=</span> <span class='fl'>1</span>, with_ties <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>|&gt;</span> <span class='co'># Get top 1 per gender</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>script_id</span>, <span class='va'>gender</span>, <span class='va'>imdb_character_name</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_wider.html'>pivot_wider</a></span><span class='op'>(</span></span>
<span>    names_from <span class='op'>=</span> <span class='va'>gender</span>,</span>
<span>    values_from <span class='op'>=</span> <span class='va'>imdb_character_name</span>,</span>
<span>    names_prefix <span class='op'>=</span> <span class='st'>"top_"</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='co'>#Main data processing</span></span>
<span></span>
<span><span class='va'>dialogue_data</span> <span class='op'>&lt;-</span> <span class='va'>characters</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>gender</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"m"</span>, <span class='st'>"f"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>script_id</span>, <span class='va'>gender</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>words <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>words</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, .groups <span class='op'>=</span> <span class='st'>'drop'</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_wider.html'>pivot_wider</a></span><span class='op'>(</span></span>
<span>    names_from <span class='op'>=</span> <span class='va'>gender</span>, values_from <span class='op'>=</span> <span class='va'>words</span>, values_fill <span class='op'>=</span> <span class='fl'>0</span>, names_prefix <span class='op'>=</span> <span class='st'>"words_"</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    words_total <span class='op'>=</span> <span class='va'>words_m</span> <span class='op'>+</span> <span class='va'>words_f</span>,</span>
<span>    male_percent <span class='op'>=</span> <span class='va'>words_m</span> <span class='op'>/</span> <span class='va'>words_total</span>,</span>
<span>    female_percent <span class='op'>=</span> <span class='va'>words_f</span> <span class='op'>/</span> <span class='va'>words_total</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>words_total</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>metadata</span>, by <span class='op'>=</span> <span class='st'>"script_id"</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>top_chars_by_movie</span>, by <span class='op'>=</span> <span class='st'>"script_id"</span><span class='op'>)</span> <span class='op'>|&gt;</span>  <span class='co'># Join the TOP CHARACTERS calculated above</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>title</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>title</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>film_order</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    custom_rank <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>      <span class='va'>title</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>order_87_percent</span> <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/match.html'>match</a></span><span class='op'>(</span><span class='va'>title</span>, <span class='va'>order_87_percent</span><span class='op'>)</span>,</span>
<span>      <span class='va'>title</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>order_75_percent</span> <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/match.html'>match</a></span><span class='op'>(</span><span class='va'>title</span>, <span class='va'>order_75_percent</span><span class='op'>)</span>,</span>
<span>      <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='fl'>999</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>male_percent</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='va'>top_dialogue_data</span> <span class='op'>&lt;-</span> <span class='va'>dialogue_data</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>male_percent</span><span class='op'>)</span>, <span class='va'>custom_rank</span><span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='va'>plot_data</span> <span class='op'>&lt;-</span> <span class='va'>top_dialogue_data</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>title</span>, <span class='va'>female_percent</span>, <span class='va'>male_percent</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span></span>
<span>    cols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>male_percent</span>, <span class='va'>female_percent</span><span class='op'>)</span>,</span>
<span>    names_to <span class='op'>=</span> <span class='st'>"gender"</span>,</span>
<span>    values_to <span class='op'>=</span> <span class='st'>"percentage"</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    gender <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>gender</span>,</span>
<span>                    levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"female_percent"</span>, <span class='st'>"male_percent"</span><span class='op'>)</span>,</span>
<span>                    labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Female Dialogue"</span>, <span class='st'>"Male Dialogue"</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='va'>plot_data</span><span class='op'>$</span><span class='va'>title</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span></span>
<span>  <span class='va'>plot_data</span><span class='op'>$</span><span class='va'>title</span>,</span>
<span>  levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>top_dialogue_data</span><span class='op'>$</span><span class='va'>title</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='co'>#Color Palette</span></span>
<span></span>
<span><span class='va'>n_films</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>plot_data</span><span class='op'>$</span><span class='va'>title</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>male_colors</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#a9bffe"</span>,<span class='st'>"#517fed"</span>, <span class='st'>"#2261fa"</span>,<span class='st'>"#356df4"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>(</span><span class='va'>n_films</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>female_colors</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#dba0a0"</span>, <span class='st'>"#ccbaba"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>(</span><span class='va'>n_films</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>plot_data</span> <span class='op'>&lt;-</span> <span class='va'>plot_data</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    title_index <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='va'>title</span><span class='op'>)</span>,</span>
<span>    fill_color  <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span></span>
<span>      <span class='va'>gender</span> <span class='op'>==</span> <span class='st'>"Male Dialogue"</span>,</span>
<span>      <span class='va'>male_colors</span><span class='op'>[</span><span class='va'>title_index</span><span class='op'>]</span>,</span>
<span>      <span class='va'>female_colors</span><span class='op'>[</span><span class='va'>title_index</span><span class='op'>]</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='co'>#----------------</span></span>
<span><span class='co'>#Visualization</span></span>
<span><span class='co'>#----------------</span></span>
<span></span>
<span><span class='va'>fifty_fifty_line</span> <span class='op'>&lt;-</span> <span class='fl'>0.50</span></span>
<span></span>
<span><span class='va'>men_graph_imp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>plot_data</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>percentage</span>, y <span class='op'>=</span> <span class='va'>title</span>, fill <span class='op'>=</span> <span class='va'>fill_color</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'>#Stacked Bars (Reverse = TRUE puts Male/Blue on the Left)</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></span><span class='op'>(</span>stat <span class='op'>=</span> <span class='st'>"identity"</span>, position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_stack.html'>position_stack</a></span><span class='op'>(</span>reverse <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, width <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  </span>
<span>  <span class='co'>#50/50 Line</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>fifty_fifty_line</span>, linetype <span class='op'>=</span> <span class='st'>"solid"</span>, color <span class='op'>=</span> <span class='st'>"#858485"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  </span>
<span>  <span class='co'>#Adding years</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>top_dialogue_data</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>0.005</span>, y <span class='op'>=</span> <span class='va'>title</span>, label <span class='op'>=</span> <span class='va'>year</span><span class='op'>)</span>, </span>
<span>    inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"white"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>2</span>, family <span class='op'>=</span> <span class='st'>"Poppins"</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'>#Adding male character names </span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>top_dialogue_data</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>0.49</span>, y <span class='op'>=</span> <span class='va'>title</span>, label <span class='op'>=</span> <span class='va'>top_m</span><span class='op'>)</span>, </span>
<span>    inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"white"</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>2</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span>, family <span class='op'>=</span> <span class='st'>"Poppins"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'>#Adding female character names </span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>top_dialogue_data</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>0.51</span>, y <span class='op'>=</span> <span class='va'>title</span>, label <span class='op'>=</span> <span class='va'>top_f</span><span class='op'>)</span>, </span>
<span>    inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"white"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>2</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span>, family <span class='op'>=</span> <span class='st'>"Poppins"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span></span>
<span>  <span class='co'>#Special label for "98% MALE DIALOGUE"</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>top_dialogue_data</span> <span class='op'>|&gt;</span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>male_percent</span>, <span class='fl'>2</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0.98</span> <span class='op'>~</span> <span class='st'>"98% MALE\nDIALOGUE"</span>,</span>
<span>        <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='cn'>NA_character_</span></span>
<span>      <span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>label</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>1.01</span>, y <span class='op'>=</span> <span class='fl'>20.8</span>, label <span class='op'>=</span> <span class='va'>label</span><span class='op'>)</span>,</span>
<span>    inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#356df4"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>2.3</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span>, family <span class='op'>=</span> <span class='st'>"Poppins"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'>#Add percentage labels (90%, 87%, 75%, 69%)</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>top_dialogue_data</span> <span class='op'>|&gt;</span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>male_percent</span>, <span class='fl'>2</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0.98</span> <span class='op'>~</span> <span class='cn'>NA_character_</span>,</span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>male_percent</span>, <span class='fl'>2</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0.90</span> <span class='op'>~</span> <span class='st'>"90%"</span>,</span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>male_percent</span>, <span class='fl'>2</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0.87</span> <span class='op'>&amp;</span> <span class='va'>title</span> <span class='op'>==</span> <span class='st'>"Ratatouille"</span> <span class='op'>~</span> <span class='st'>"87%"</span>,</span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>male_percent</span>, <span class='fl'>2</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0.75</span> <span class='op'>&amp;</span> <span class='va'>title</span> <span class='op'>==</span> <span class='st'>"Mulan"</span> <span class='op'>~</span> <span class='st'>"75%"</span>,</span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>male_percent</span>, <span class='fl'>2</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0.69</span> <span class='op'>~</span> <span class='st'>"69%"</span>,</span>
<span>        <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='cn'>NA_character_</span></span>
<span>      <span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>label</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>1.02</span>, y <span class='op'>=</span> <span class='va'>title</span>, label <span class='op'>=</span> <span class='va'>label</span><span class='op'>)</span>,</span>
<span>    inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#356df4"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span>, family <span class='op'>=</span> <span class='st'>"Poppins"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Scales</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_identity.html'>scale_fill_identity</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_discrete.html'>scale_y_discrete</a></span><span class='op'>(</span>limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>top_dialogue_data</span><span class='op'>$</span><span class='va'>title</span><span class='op'>)</span><span class='op'>)</span>, expand <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/expansion.html'>expansion</a></span><span class='op'>(</span>add <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"50/50"</span> <span class='op'>=</span> <span class='st'>"50/50"</span><span class='op'>)</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span><span class='op'>)</span>, limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1.15</span><span class='op'>)</span>, position <span class='op'>=</span> <span class='st'>"top"</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  </span>
<span>  <span class='co'># Titles and labels</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span></span>
<span>    title <span class='op'>=</span> <span class='st'>"Men have 60%+ Dialogue"</span>,</span>
<span>    x <span class='op'>=</span> <span class='st'>""</span>, </span>
<span>    y <span class='op'>=</span> <span class='st'>""</span>, </span>
<span>    fill <span class='op'>=</span> <span class='st'>""</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Theme</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"merriweather"</span>,</span>
<span>                              color <span class='op'>=</span> <span class='st'>"#356df4"</span>,</span>
<span>                              face <span class='op'>=</span> <span class='st'>"bold"</span>, </span>
<span>                              hjust <span class='op'>=</span> <span class='fl'>0.5</span>, </span>
<span>                              margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>b <span class='op'>=</span> <span class='fl'>12</span>, unit <span class='op'>=</span> <span class='st'>"pt"</span><span class='op'>)</span>, </span>
<span>                              size <span class='op'>=</span> <span class='fl'>16</span><span class='op'>)</span>,</span>
<span>    axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>5</span>, color <span class='op'>=</span> <span class='st'>"black"</span>, </span>
<span>                               margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>b <span class='op'>=</span> <span class='fl'>12</span>, unit <span class='op'>=</span> <span class='st'>"pt"</span><span class='op'>)</span>, </span>
<span>                               family <span class='op'>=</span> <span class='st'>"Poppins"</span><span class='op'>)</span>,</span>
<span>    axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"merriweather"</span>, </span>
<span>                               size <span class='op'>=</span> <span class='fl'>12</span>, </span>
<span>                               color <span class='op'>=</span> <span class='st'>"black"</span>, </span>
<span>                               face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>,</span>
<span>    panel.grid.major <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    panel.grid.minor <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    legend.position <span class='op'>=</span> <span class='st'>"none"</span>,</span>
<span>    plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>20</span>, <span class='fl'>10</span>, <span class='fl'>0</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='va'>men_graph_imp</span></span></code></pre>
</div>
<p><img src="100569570_files/figure-html5/unnamed-chunk-6-1.png" width="624" /></p>
</div>
<hr />
<h3 id="a-women-have---60-dialogue-improvement">3.a Women Have +/- 60 Dialogue IMPROVEMENT</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Data Preparation</span></span>
<span></span>
<span><span class='va'>target_women_film</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Inside Out"</span>, <span class='st'>"Alice in Wonderland"</span>, <span class='st'>"Maleficent"</span>, <span class='st'>"Sleeping Beauty"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Calculate top characters for women films </span></span>
<span><span class='co'># Find the name of the top speaking Male and Female for each script in the target list</span></span>
<span><span class='va'>top_chars_women</span> <span class='op'>&lt;-</span> <span class='va'>characters</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>gender</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"m"</span>, <span class='st'>"f"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>metadata</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>script_id</span>, <span class='va'>title</span><span class='op'>)</span>, by <span class='op'>=</span> <span class='st'>"script_id"</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>title</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>target_women_film</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>script_id</span>, <span class='va'>title</span>, <span class='va'>gender</span>, <span class='va'>imdb_character_name</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>words <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>words</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, .groups <span class='op'>=</span> <span class='st'>'drop'</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>script_id</span>, <span class='va'>gender</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/slice.html'>slice_max</a></span><span class='op'>(</span><span class='va'>words</span>, n <span class='op'>=</span> <span class='fl'>1</span>, with_ties <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>script_id</span>, <span class='va'>gender</span>, <span class='va'>imdb_character_name</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_wider.html'>pivot_wider</a></span><span class='op'>(</span></span>
<span>    names_from <span class='op'>=</span> <span class='va'>gender</span>,</span>
<span>    values_from <span class='op'>=</span> <span class='va'>imdb_character_name</span>,</span>
<span>    names_prefix <span class='op'>=</span> <span class='st'>"top_"</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'>#Calculating Dialogue data</span></span>
<span><span class='va'>dialogue_data_women</span> <span class='op'>&lt;-</span> <span class='va'>characters</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>gender</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"f"</span>, <span class='st'>"m"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>script_id</span>, <span class='va'>gender</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>words <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>words</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, .groups <span class='op'>=</span> <span class='st'>'drop'</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_wider.html'>pivot_wider</a></span><span class='op'>(</span></span>
<span>    names_from <span class='op'>=</span> <span class='va'>gender</span>,</span>
<span>    values_from <span class='op'>=</span> <span class='va'>words</span>,</span>
<span>    values_fill <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>    names_prefix <span class='op'>=</span> <span class='st'>"words_"</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    words_total <span class='op'>=</span> <span class='va'>words_m</span> <span class='op'>+</span> <span class='va'>words_f</span>,</span>
<span>    male_percent <span class='op'>=</span> <span class='va'>words_m</span> <span class='op'>/</span> <span class='va'>words_total</span> <span class='op'>*</span> <span class='fl'>100</span>,      </span>
<span>    female_percent <span class='op'>=</span> <span class='va'>words_f</span> <span class='op'>/</span> <span class='va'>words_total</span> <span class='op'>*</span> <span class='fl'>100</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>words_total</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>metadata</span>, by <span class='op'>=</span> <span class='st'>"script_id"</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='co'># JOIN TOP CHARACTERS HERE</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>top_chars_women</span>, by <span class='op'>=</span> <span class='st'>"script_id"</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>title</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>female_percent</span> <span class='op'>&gt;=</span> <span class='fl'>60</span> <span class='op'>&amp;</span> <span class='va'>title</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>target_women_film</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>female_percent</span><span class='op'>)</span><span class='op'>)</span> </span>
<span></span>
<span><span class='co'># Color Palette</span></span>
<span></span>
<span><span class='va'>palette_women</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#8ea5de"</span>, <span class='st'>"#8fa7dc"</span>, <span class='st'>"#95aadb"</span>, <span class='st'>"#97abda"</span>,</span>
<span>                   <span class='st'>"#ed6a6a"</span>, <span class='st'>"#ed6969"</span>, <span class='st'>"#ef6465"</span>, <span class='st'>"#ef6262"</span>,</span>
<span>                   <span class='st'>"#ff3334"</span>, <span class='st'>"#9b9aa1"</span>, <span class='st'>"#050505"</span>, <span class='st'>"#2562fa"</span>, </span>
<span>                   <span class='st'>"#e94953"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>n_films_women</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>dialogue_data_women</span><span class='op'>$</span><span class='va'>title</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>male_colors_women</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#8ea5de"</span>, <span class='st'>"#8fa7dc"</span>, <span class='st'>"#95aadb"</span>, <span class='st'>"#97abda"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>(</span><span class='va'>n_films_women</span><span class='op'>)</span></span>
<span><span class='va'>female_colors_women</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#ed6a6a"</span>, <span class='st'>"#ed6969"</span>, <span class='st'>"#ef6465"</span>, <span class='st'>"#ef6262"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>(</span><span class='va'>n_films_women</span><span class='op'>)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class='co'>#Preparing plot data</span></span>
<span><span class='va'>plot_data_women</span> <span class='op'>&lt;-</span> <span class='va'>dialogue_data_women</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>title</span>, <span class='va'>female_percent</span>, <span class='va'>male_percent</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span></span>
<span>    cols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>male_percent</span>, <span class='va'>female_percent</span><span class='op'>)</span>,</span>
<span>    names_to <span class='op'>=</span> <span class='st'>"gender"</span>,</span>
<span>    values_to <span class='op'>=</span> <span class='st'>"percentage"</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    gender <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>gender</span>, </span>
<span>                    levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"female_percent"</span>, <span class='st'>"male_percent"</span><span class='op'>)</span>, </span>
<span>                    labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Female Dialogue"</span>, <span class='st'>"Male Dialogue"</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># Setting factor levels for Y-axis</span></span>
<span><span class='va'>plot_data_women</span><span class='op'>$</span><span class='va'>title</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>plot_data_women</span><span class='op'>$</span><span class='va'>title</span>, levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>dialogue_data_women</span><span class='op'>$</span><span class='va'>title</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Assigning gradient colors</span></span>
<span><span class='va'>plot_data_women</span> <span class='op'>&lt;-</span> <span class='va'>plot_data_women</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    title_index <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='va'>title</span><span class='op'>)</span>,</span>
<span>    fill_color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span></span>
<span>      <span class='va'>gender</span> <span class='op'>==</span> <span class='st'>"Male Dialogue"</span>,</span>
<span>      <span class='va'>male_colors_women</span><span class='op'>[</span><span class='va'>title_index</span><span class='op'>]</span>,</span>
<span>      <span class='va'>female_colors_women</span><span class='op'>[</span><span class='va'>title_index</span><span class='op'>]</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># Extract labels for "Inside Out"</span></span>
<span><span class='va'>inside_out_male_perc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>dialogue_data_women</span><span class='op'>[</span><span class='va'>dialogue_data_women</span><span class='op'>$</span><span class='va'>title</span> <span class='op'>==</span> <span class='st'>"Inside Out"</span>, <span class='op'>]</span><span class='op'>$</span><span class='va'>male_percent</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span></span>
<span><span class='va'>inside_out_female_perc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>dialogue_data_women</span><span class='op'>[</span><span class='va'>dialogue_data_women</span><span class='op'>$</span><span class='va'>title</span> <span class='op'>==</span> <span class='st'>"Inside Out"</span>, <span class='op'>]</span><span class='op'>$</span><span class='va'>female_percent</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span></span>
<span></span>
<span><span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>inside_out_male_perc</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='va'>inside_out_male_perc</span> <span class='op'>&lt;-</span> <span class='fl'>36</span></span>
<span>  <span class='va'>inside_out_female_perc</span> <span class='op'>&lt;-</span> <span class='fl'>64</span> </span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='va'>fifty_fifty_line</span> <span class='op'>&lt;-</span> <span class='fl'>50</span></span>
<span></span>
<span></span>
<span><span class='co'>#----------------</span></span>
<span><span class='co'>#Visualization</span></span>
<span><span class='co'>#----------------</span></span>
<span></span>
<span></span>
<span><span class='va'>women_graph_imp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>plot_data_women</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>percentage</span>, y <span class='op'>=</span> <span class='va'>title</span>, fill <span class='op'>=</span> <span class='va'>fill_color</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></span><span class='op'>(</span>stat <span class='op'>=</span> <span class='st'>"identity"</span>, position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_stack.html'>position_stack</a></span><span class='op'>(</span>reverse <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, width <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># 50/50 Line</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>fifty_fifty_line</span>, linetype <span class='op'>=</span> <span class='st'>"solid"</span>, color <span class='op'>=</span> <span class='st'>"#9b9aa1"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Adding years </span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>dialogue_data_women</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>0.5</span>, y <span class='op'>=</span> <span class='va'>title</span>, label <span class='op'>=</span> <span class='va'>year</span><span class='op'>)</span>, </span>
<span>    inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"white"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span>, family <span class='op'>=</span> <span class='st'>"Poppins"</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># 4. ADD MALE CHARACTER NAMES (Left of 50/50 line, Right Aligned)</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>dialogue_data_women</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>49</span>, y <span class='op'>=</span> <span class='va'>title</span>, label <span class='op'>=</span> <span class='va'>top_m</span><span class='op'>)</span>, </span>
<span>    inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"white"</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>3</span>, family <span class='op'>=</span> <span class='st'>"Poppins"</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Adding female characters name </span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>dialogue_data_women</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>51</span>, y <span class='op'>=</span> <span class='va'>title</span>, label <span class='op'>=</span> <span class='va'>top_f</span><span class='op'>)</span>, </span>
<span>    inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"white"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span>, family <span class='op'>=</span> <span class='st'>"Poppins"</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span></span>
<span>  <span class='co'># Male percentage label </span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>plot_data_women</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>title</span> <span class='op'>==</span> <span class='st'>"Inside Out"</span> <span class='op'>&amp;</span> <span class='va'>gender</span> <span class='op'>==</span> <span class='st'>"Male Dialogue"</span><span class='op'>)</span>,</span>
<span>    label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>inside_out_male_perc</span>, <span class='st'>"%"</span><span class='op'>)</span>,</span>
<span>    x <span class='op'>=</span> <span class='fl'>101</span>, color <span class='op'>=</span> <span class='st'>"#2562fa"</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span>, size <span class='op'>=</span> <span class='fl'>4</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, family <span class='op'>=</span> <span class='st'>"Poppins"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Female percentage label </span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>plot_data_women</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>title</span> <span class='op'>==</span> <span class='st'>"Inside Out"</span> <span class='op'>&amp;</span> <span class='va'>gender</span> <span class='op'>==</span> <span class='st'>"Female Dialogue"</span><span class='op'>)</span>,</span>
<span>    label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>" / "</span>, <span class='va'>inside_out_female_perc</span>, <span class='st'>"%"</span><span class='op'>)</span>,</span>
<span>    x <span class='op'>=</span> <span class='fl'>109</span>, color <span class='op'>=</span> <span class='st'>"#e94953"</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span>, size <span class='op'>=</span> <span class='fl'>4</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, family <span class='op'>=</span> <span class='st'>"Poppins"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='co'># Scales and labels</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_identity.html'>scale_fill_identity</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"50/50"</span> <span class='op'>=</span> <span class='st'>"50/50"</span><span class='op'>)</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>50</span><span class='op'>)</span>, limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>120</span><span class='op'>)</span>, position <span class='op'>=</span> <span class='st'>"top"</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  </span>
<span>  <span class='co'># 50/50 Text</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>50</span>, y <span class='op'>=</span> <span class='fl'>4.55</span>, label <span class='op'>=</span> <span class='st'>"50/50"</span>, color <span class='op'>=</span> <span class='st'>"#9b9aa1"</span>, size <span class='op'>=</span> <span class='fl'>4</span>, family <span class='op'>=</span> <span class='st'>"Poppins"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_discrete.html'>scale_y_discrete</a></span><span class='op'>(</span>limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>plot_data_women</span><span class='op'>$</span><span class='va'>title</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span></span>
<span>    title <span class='op'>=</span> <span class='st'>"Women have 60%+ Dialogue"</span>,</span>
<span>    x <span class='op'>=</span> <span class='st'>""</span>, y <span class='op'>=</span> <span class='st'>""</span>, fill <span class='op'>=</span> <span class='st'>""</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"merriweather"</span>, color <span class='op'>=</span> <span class='st'>"#ff3334"</span>, face <span class='op'>=</span> <span class='st'>"bold"</span>, hjust <span class='op'>=</span> <span class='fl'>0.5</span>, size <span class='op'>=</span> <span class='fl'>16</span><span class='op'>)</span>,</span>
<span>    axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='co'># Hiding X axis text as requested in your previous code logic</span></span>
<span>    axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"merriweather"</span>, size <span class='op'>=</span> <span class='fl'>12</span>, color <span class='op'>=</span> <span class='st'>"black"</span>, face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>,</span>
<span>    panel.grid.major <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    panel.grid.minor <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    legend.position <span class='op'>=</span> <span class='st'>"none"</span>,</span>
<span>    plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>50</span>, <span class='fl'>10</span>, <span class='fl'>10</span> <span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>women_graph_imp</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="100569570_files/figure-html5/unnamed-chunk-7-1.png" width="624" /></p>
</div>
<h3 id="final-graph">FINAL GRAPH</h3>
<p>The final graph aims to display three graphs together using the cowplot package’s ggdraw to manually adjust the settings. Additionally, images of princesses and princes have been added using the magick package. Therefore, in this graph, we see the improved men’s and women’s graphs that we created earlier, with the years and top character names added for both genders. This enables us to make comparisons between years and understand which characters appear in the movies.</p>
<ul>
<li>First, adjusting the sizes of the men_graph_imp for the final graph to make it readable.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>fifty_fifty_line</span> <span class='op'>&lt;-</span> <span class='fl'>0.50</span></span>
<span></span>
<span><span class='va'>men_graph_imp_final</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>plot_data</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>percentage</span>, y <span class='op'>=</span> <span class='va'>title</span>, fill <span class='op'>=</span> <span class='va'>fill_color</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></span><span class='op'>(</span>stat <span class='op'>=</span> <span class='st'>"identity"</span>, position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_stack.html'>position_stack</a></span><span class='op'>(</span>reverse <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, width <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>fifty_fifty_line</span>, linetype <span class='op'>=</span> <span class='st'>"solid"</span>, color <span class='op'>=</span> <span class='st'>"#858485"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  </span>
<span> <span class='co'>#---Adjusted </span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>top_dialogue_data</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>0.005</span>, y <span class='op'>=</span> <span class='va'>title</span>, label <span class='op'>=</span> <span class='va'>year</span><span class='op'>)</span>, </span>
<span>    inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"white"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3.5</span>, family <span class='op'>=</span> <span class='st'>"Poppins"</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>top_dialogue_data</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>0.49</span>, y <span class='op'>=</span> <span class='va'>title</span>, label <span class='op'>=</span> <span class='va'>top_m</span><span class='op'>)</span>, </span>
<span>    inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"white"</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>3.5</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span>, family <span class='op'>=</span> <span class='st'>"Poppins"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>top_dialogue_data</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>0.51</span>, y <span class='op'>=</span> <span class='va'>title</span>, label <span class='op'>=</span> <span class='va'>top_f</span><span class='op'>)</span>, </span>
<span>    inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"white"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3.5</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span>, family <span class='op'>=</span> <span class='st'>"Poppins"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span><span class='co'>#---</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>top_dialogue_data</span> <span class='op'>|&gt;</span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>male_percent</span>, <span class='fl'>2</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0.98</span> <span class='op'>~</span> <span class='st'>"98% MALE\nDIALOGUE"</span>,</span>
<span>        <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='cn'>NA_character_</span></span>
<span>      <span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>label</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>1.01</span>, y <span class='op'>=</span> <span class='fl'>20.8</span>, label <span class='op'>=</span> <span class='va'>label</span><span class='op'>)</span>,</span>
<span>    inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#356df4"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>2.3</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span>, family <span class='op'>=</span> <span class='st'>"Poppins"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>top_dialogue_data</span> <span class='op'>|&gt;</span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>male_percent</span>, <span class='fl'>2</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0.98</span> <span class='op'>~</span> <span class='cn'>NA_character_</span>,</span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>male_percent</span>, <span class='fl'>2</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0.90</span> <span class='op'>~</span> <span class='st'>"90%"</span>,</span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>male_percent</span>, <span class='fl'>2</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0.87</span> <span class='op'>&amp;</span> <span class='va'>title</span> <span class='op'>==</span> <span class='st'>"Ratatouille"</span> <span class='op'>~</span> <span class='st'>"87%"</span>,</span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>male_percent</span>, <span class='fl'>2</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0.75</span> <span class='op'>&amp;</span> <span class='va'>title</span> <span class='op'>==</span> <span class='st'>"Mulan"</span> <span class='op'>~</span> <span class='st'>"75%"</span>,</span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>male_percent</span>, <span class='fl'>2</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0.69</span> <span class='op'>~</span> <span class='st'>"69%"</span>,</span>
<span>        <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='cn'>NA_character_</span></span>
<span>      <span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>label</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>1.02</span>, y <span class='op'>=</span> <span class='va'>title</span>, label <span class='op'>=</span> <span class='va'>label</span><span class='op'>)</span>,</span>
<span>    inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#356df4"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span>, family <span class='op'>=</span> <span class='st'>"Poppins"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_identity.html'>scale_fill_identity</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_discrete.html'>scale_y_discrete</a></span><span class='op'>(</span>limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>top_dialogue_data</span><span class='op'>$</span><span class='va'>title</span><span class='op'>)</span><span class='op'>)</span>, expand <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/expansion.html'>expansion</a></span><span class='op'>(</span>add <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"50/50"</span> <span class='op'>=</span> <span class='st'>"50/50"</span><span class='op'>)</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span><span class='op'>)</span>, limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1.15</span><span class='op'>)</span>, position <span class='op'>=</span> <span class='st'>"top"</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span></span>
<span>    title <span class='op'>=</span> <span class='st'>"Men have 60%+ Dialogue"</span>,</span>
<span>    x <span class='op'>=</span> <span class='st'>""</span>, </span>
<span>    y <span class='op'>=</span> <span class='st'>""</span>, </span>
<span>    fill <span class='op'>=</span> <span class='st'>""</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span></span>
<span>      family <span class='op'>=</span> <span class='st'>"merriweather"</span>, color <span class='op'>=</span> <span class='st'>"#356df4"</span>, face <span class='op'>=</span> <span class='st'>"bold"</span>, hjust <span class='op'>=</span> <span class='fl'>0.5</span>, </span>
<span>      margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>b <span class='op'>=</span> <span class='fl'>12</span>, unit <span class='op'>=</span> <span class='st'>"pt"</span><span class='op'>)</span>, size <span class='op'>=</span> <span class='fl'>16</span><span class='op'>)</span>,</span>
<span>    </span>
<span>    axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>5</span>, color <span class='op'>=</span> <span class='st'>"black"</span>, </span>
<span>                               margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>b <span class='op'>=</span> <span class='fl'>12</span>, unit <span class='op'>=</span> <span class='st'>"pt"</span><span class='op'>)</span>, family <span class='op'>=</span> <span class='st'>"Poppins"</span><span class='op'>)</span>,</span>
<span>    </span>
<span>    axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"merriweather"</span>, size <span class='op'>=</span> <span class='fl'>12</span>, </span>
<span>                               color <span class='op'>=</span> <span class='st'>"black"</span>, </span>
<span>                               face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>,</span>
<span>    </span>
<span>    panel.grid.major <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    panel.grid.minor <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    legend.position <span class='op'>=</span> <span class='st'>"none"</span>,</span>
<span>    plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>20</span>, <span class='fl'>10</span>, <span class='fl'>0</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='va'>men_graph_imp_final</span></span></code></pre>
</div>
<p><img src="100569570_files/figure-html5/unnamed-chunk-8-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/yixuan/showtext'>showtext</a></span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/sysfonts/man/font_add_google.html'>font_add_google</a></span><span class='op'>(</span><span class='st'>"Poppins"</span>, <span class='st'>"Poppins"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/sysfonts/man/font_add_google.html'>font_add_google</a></span><span class='op'>(</span><span class='st'>"Merriweather"</span>, <span class='st'>"merriweather"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/showtext/man/showtext_auto.html'>showtext_auto</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/showtext/man/showtext_opts.html'>showtext_opts</a></span><span class='op'>(</span>dpi <span class='op'>=</span> <span class='fl'>300</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>img_princess</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://docs.ropensci.org/magick/reference/editing.html'>image_read</a></span><span class='op'>(</span><span class='st'>"princess.png"</span><span class='op'>)</span> </span>
<span><span class='va'>img_prince</span>    <span class='op'>&lt;-</span> <span class='fu'><a href='https://docs.ropensci.org/magick/reference/editing.html'>image_read</a></span><span class='op'>(</span><span class='st'>"prince.png"</span><span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='va'>final_graph</span><span class='op'>&lt;-</span> </span>
<span>  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/ggdraw.html'>ggdraw</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/draw_plot.html'>draw_plot</a></span><span class='op'>(</span><span class='va'>men_graph_imp_final</span>, </span>
<span>            x <span class='op'>=</span> <span class='fl'>0</span>, y <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>            width <span class='op'>=</span> <span class='fl'>0.55</span>, height <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/draw_plot.html'>draw_plot</a></span><span class='op'>(</span><span class='va'>gender_balance_graph</span>, </span>
<span>            x <span class='op'>=</span> <span class='fl'>0.55</span>, y <span class='op'>=</span> <span class='fl'>0.5</span>, </span>
<span>            width <span class='op'>=</span> <span class='fl'>0.45</span>, height <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/draw_plot.html'>draw_plot</a></span><span class='op'>(</span><span class='va'>women_graph_imp</span>, </span>
<span>            x <span class='op'>=</span> <span class='fl'>0.51</span>, y <span class='op'>=</span> <span class='fl'>0.1</span>, </span>
<span>            width <span class='op'>=</span> <span class='fl'>0.5</span>, height <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    </span>
<span>  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/draw_image.html'>draw_image</a></span><span class='op'>(</span><span class='va'>img_princess</span>, x <span class='op'>=</span> <span class='fl'>0.04</span>, y <span class='op'>=</span> <span class='fl'>0.85</span>, width <span class='op'>=</span> <span class='fl'>0.25</span>, height <span class='op'>=</span> <span class='fl'>0.12</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/draw_image.html'>draw_image</a></span><span class='op'>(</span><span class='va'>img_prince</span>, x <span class='op'>=</span> <span class='fl'>0.7</span>, y <span class='op'>=</span> <span class='fl'>0.85</span>, width <span class='op'>=</span> <span class='fl'>0.25</span>, height <span class='op'>=</span> <span class='fl'>0.12</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/draw_label.html'>draw_label</a></span><span class='op'>(</span><span class='st'>"SCREENPLAY DIALOGUE\n             by GENDER"</span>, </span>
<span>             x <span class='op'>=</span> <span class='fl'>0.36</span>, </span>
<span>             y <span class='op'>=</span> <span class='fl'>0.9</span>, </span>
<span>             hjust <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>             fontfamily <span class='op'>=</span> <span class='st'>"merriweather"</span>,</span>
<span>            fontface <span class='op'>=</span> <span class='st'>"bold"</span>, </span>
<span>             size <span class='op'>=</span> <span class='fl'>25</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/draw_label.html'>draw_label</a></span><span class='op'>(</span><span class='st'>"2,000 Screenplays: Dialogue Broken-down by Gender"</span>, </span>
<span>             x <span class='op'>=</span> <span class='fl'>0.38</span>, </span>
<span>             y <span class='op'>=</span> <span class='fl'>0.82</span>, </span>
<span>             hjust <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>             fontfamily <span class='op'>=</span> <span class='st'>"merriweather"</span>,</span>
<span>             size <span class='op'>=</span> <span class='fl'>10</span>, </span>
<span>             color <span class='op'>=</span> <span class='st'>"grey50"</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>final_graph</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="100569570_files/figure-html5/unnamed-chunk-9-1.png" width="100%" /></p>
</div>
<p>Anderson, H., &amp; Daniels, M. (2016, April). <em>Film dialogue from 2,000 screenplays, broken down by gender and age</em>. The Pudding. <a href="https://pudding.cool/2017/03/film-dialogue/?utm_source=chatgpt.com">https://pudding.cool/2017/03/film-dialogue/</a></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
