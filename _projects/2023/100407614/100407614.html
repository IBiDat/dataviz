<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>Cigarettes Sales and Lung Cancer Mortality in the US</title>

  <meta property="description" itemprop="description" content="Every year, around 8 million people die prematurely as a result of smoking.&#10;In this case, examining the relationship across the cigarettes sales in men in the United States."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2024-01-18"/>
  <meta property="article:created" itemprop="dateCreated" content="2024-01-18"/>
  <meta name="article:author" content="Andrea Baños-Ramos"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Cigarettes Sales and Lung Cancer Mortality in the US"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Every year, around 8 million people die prematurely as a result of smoking.&#10;In this case, examining the relationship across the cigarettes sales in men in the United States."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Cigarettes Sales and Lung Cancer Mortality in the US"/>
  <meta property="twitter:description" content="Every year, around 8 million people die prematurely as a result of smoking.&#10;In this case, examining the relationship across the cigarettes sales in men in the United States."/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","categories","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["Cigarettes Sales and Lung Cancer Mortality in the US"]},{"type":"character","attributes":{},"value":["Every year, around 8 million people die prematurely as a result of smoking.\nIn this case, examining the relationship across the cigarettes sales in men in the United States.\n"]},{"type":"character","attributes":{},"value":["2023"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Andrea Baños-Ramos"]}]}]},{"type":"character","attributes":{},"value":["2024-01-18"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["100407614_files/anchor-4.2.2/anchor.min.js","100407614_files/bowser-1.9.3/bowser.min.js","100407614_files/distill-2.2.21/template.v2.js","100407614_files/figure-html5/unnamed-chunk-10-1.png","100407614_files/figure-html5/unnamed-chunk-11-1.png","100407614_files/figure-html5/unnamed-chunk-12-1.png","100407614_files/figure-html5/unnamed-chunk-13-1.png","100407614_files/figure-html5/unnamed-chunk-4-1.png","100407614_files/figure-html5/unnamed-chunk-4-2.png","100407614_files/figure-html5/unnamed-chunk-5-1.png","100407614_files/figure-html5/unnamed-chunk-5-2.png","100407614_files/figure-html5/unnamed-chunk-6-1.png","100407614_files/figure-html5/unnamed-chunk-8-1.png","100407614_files/header-attrs-2.24/header-attrs.js","100407614_files/header-attrs-2.25/header-attrs.js","100407614_files/jquery-3.6.0/jquery-3.6.0.js","100407614_files/jquery-3.6.0/jquery-3.6.0.min.js","100407614_files/jquery-3.6.0/jquery-3.6.0.min.map","100407614_files/popper-2.6.0/popper.min.js","100407614_files/tippy-6.2.7/tippy-bundle.umd.min.js","100407614_files/tippy-6.2.7/tippy-light-border.css","100407614_files/tippy-6.2.7/tippy.css","100407614_files/tippy-6.2.7/tippy.umd.min.js","100407614_files/webcomponents-2.0.0/webcomponents.js","lung-cancer-deaths-per-100000-by-sex-1950-2002.csv","sales-of-cigarettes-per-adult-per-day.csv","Smoking-and-lung-cancer-mortality-US-only.png"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  hr.section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    margin: 0px;
  }


  d-byline {
    border-top: none;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
    border-top: none;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  /* tweak for Pandoc numbered line within distill */
  d-article pre.numberSource code > span {
      left: -2em;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // separator
    var separator = '<hr class="section-separator" style="clear: both"/>';
    // prepend separator above appendix
    $('.d-byline').before(separator);
    $('.d-article').before(separator);

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme, except when numbering line
    // in code chunk
    $('pre:not(.numberLines) code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        var author_name = front_matter.authors[i].author
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="100407614_files/header-attrs-2.25/header-attrs.js"></script>
  <script src="100407614_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="100407614_files/popper-2.6.0/popper.min.js"></script>
  <link href="100407614_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="100407614_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="100407614_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="100407614_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="100407614_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="100407614_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="100407614_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Cigarettes Sales and Lung Cancer Mortality in the US","description":"Every year, around 8 million people die prematurely as a result of smoking.\nIn this case, examining the relationship across the cigarettes sales in men in the United States.","authors":[{"author":"Andrea Baños-Ramos","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2024-01-18T00:00:00.000+01:00","citationText":"Baños-Ramos, 2024"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Cigarettes Sales and Lung Cancer Mortality in the US</h1>

<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt-tag">2023</div>
</div>
<!--/radix_placeholder_categories-->
<p><p>Every year, around 8 million people die prematurely as a result of smoking.
In this case, examining the relationship across the cigarettes sales in men in the United States.</p></p>
</div>

<div class="d-byline">
  
  Andrea Baños-Ramos
  
<br/>2024-01-18
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#introduction-and-motivation" id="toc-introduction-and-motivation">Introduction and Motivation</a></li>
<li><a href="#replication-work" id="toc-replication-work">Replication work</a>
<ul>
<li><a href="#load-the-main-files" id="toc-load-the-main-files">Load the main files</a></li>
<li><a href="#load-the-libraries" id="toc-load-the-libraries">Load the libraries</a></li>
<li><a href="#data-generating-process" id="toc-data-generating-process">Data Generating Process</a></li>
<li><a href="#setting-the-individual-axes-coordinates-and-scales" id="toc-setting-the-individual-axes-coordinates-and-scales">Setting the individual axes, coordinates and scales</a></li>
<li><a href="#performing-simple-linear-graphs" id="toc-performing-simple-linear-graphs">Performing simple linear graphs</a></li>
<li><a href="#establishing-the-axes-coordinates-and-scales" id="toc-establishing-the-axes-coordinates-and-scales">Establishing the axes, coordinates and scales</a></li>
<li><a href="#rescaling-of-age_males_death-variable" id="toc-rescaling-of-age_males_death-variable">Rescaling of age_males_death variable</a></li>
<li><a href="#intersecting-charts-and-filtering-the-data" id="toc-intersecting-charts-and-filtering-the-data">Intersecting charts and filtering the data</a></li>
<li><a href="#selecting-the-suitable-font-style" id="toc-selecting-the-suitable-font-style">Selecting the suitable font style</a></li>
<li><a href="#modifying-the-appearance-of-the-axes-by-altering-the-color-and-size-of-their-titles" id="toc-modifying-the-appearance-of-the-axes-by-altering-the-color-and-size-of-their-titles">Modifying the appearance of the axes by altering the color and size of their titles</a></li>
<li><a href="#incorporating-annotations-on-the-most-relevant-dates" id="toc-incorporating-annotations-on-the-most-relevant-dates">Incorporating annotations on the most relevant dates</a></li>
</ul></li>
<li><a href="#enhancement-chart" id="toc-enhancement-chart">Enhancement Chart</a></li>
</ul>
</nav>
</div>
<h2 id="introduction-and-motivation">Introduction and Motivation</h2>
<p>The selected chart from Our World in Data explains the relationship that may exist between daily cigarette sales per adult and the lung cancer death rate per 100,000 men in the United States.</p>
<p>The consumption of cigarettes significantly increased in wealthy countries, including the United States, in the early 20th century. Similarly, lung cancer trends closely mirror those of smoking, although with a delay. We can observe how, from the second half of the 20th century, possibly reaching its peak, until now, the daily sales of cigarettes and the lung cancer death rate attributed to smoking have significantly decreased. Finally, the choice of this chart was driven by my concern for global health, aiming to investigate risk factors that significantly impact health and may even cause the death of millions of people.</p>
<figure>
<img src="Smoking-and-lung-cancer-mortality-US-only.png" class="external" alt="Smoking and lung cancer mortality in the US. Source: Our World in Data." />
<figcaption aria-hidden="true">Smoking and lung cancer mortality in the US. Source: Our World in Data.</figcaption>
</figure>
<h2 id="replication-work">Replication work</h2>
<h3 id="load-the-main-files">Load the main files</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>csv_file</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span><span class='st'>"sales-of-cigarettes-per-adult-per-day.csv"</span><span class='op'>)</span></span>
<span><span class='va'>csv_file2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span><span class='st'>"lung-cancer-deaths-per-100000-by-sex-1950-2002.csv"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 id="load-the-libraries">Load the libraries</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://wilkelab.org/ggtext/'>ggtext</a></span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 id="data-generating-process">Data Generating Process</h3>
<p>In order to carry out the replication process, I will clean the two databases, taking into account numerous variables such as entity (in this case, the country is the United States), year (ranging from 1900 to 2017), sales_cig (representing daily cigarette sales per adult), and age_males_death (indicating the rate of deaths in men attributed to lung cancer).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>sales</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>csv_file</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2767</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>]</span><span class='op'>)</span> <span class='co'># Data Frame (rectangular data structures)</span></span>
<span><span class='va'>sales_daily</span> <span class='op'>&lt;-</span> <span class='va'>sales</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Entity</span> <span class='op'>==</span> <span class='st'>"United States"</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>sales_cig <span class='op'>=</span> <span class='va'>Sales.of.cigarettes.per.adult.per.day..International.Smoking.Statistics..2017..</span>,</span>
<span>         entity <span class='op'>=</span> <span class='va'>Entity</span>, year <span class='op'>=</span> <span class='va'>Year</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>entity</span>, <span class='va'>year</span>, <span class='va'>sales_cig</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>cancer</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>csv_file2</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>4572</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>]</span><span class='op'>)</span></span>
<span><span class='va'>cancer_deaths</span> <span class='op'>&lt;-</span> <span class='va'>cancer</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Entity</span> <span class='op'>==</span> <span class='st'>"United States"</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>age_males_death <span class='op'>=</span> <span class='va'>age.standardized_death_rate_per_100k_male</span>,</span>
<span>         entity <span class='op'>=</span> <span class='va'>Entity</span>, year <span class='op'>=</span> <span class='va'>Year</span><span class='op'>)</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>entity</span>, <span class='va'>year</span>, <span class='va'>age_males_death</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 id="setting-the-individual-axes-coordinates-and-scales">Setting the individual axes, coordinates and scales</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>sales_daily</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>year</span>, <span class='va'>sales_cig</span><span class='op'>)</span></span>
<span><span class='va'>p</span></span></code></pre>
</div>
<img src="100407614_files/figure-html5/unnamed-chunk-4-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>q</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>cancer_deaths</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>year</span>, <span class='va'>age_males_death</span><span class='op'>)</span></span>
<span><span class='va'>q</span></span></code></pre>
</div>
<p><img src="100407614_files/figure-html5/unnamed-chunk-4-2.png" width="624" /></p>
</div>
<h3 id="performing-simple-linear-graphs">Performing simple linear graphs</h3>
<p>With ggplot, we can create a line chart using the sales_daily database, plotting the year on the x-axis and sales_cig on the y-axis, without any explanatory legend. The same approach is applied to ages_males_death using the cancer_deaths database.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>sales_daily</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>year</span>, <span class='va'>sales_cig</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#800080"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span></span>
<span><span class='va'>p</span></span></code></pre>
</div>
<img src="100407614_files/figure-html5/unnamed-chunk-5-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>q</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>cancer_deaths</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>year</span>, <span class='va'>age_males_death</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#CC0000"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span></span>
<span><span class='va'>q</span></span></code></pre>
</div>
<p><img src="100407614_files/figure-html5/unnamed-chunk-5-2.png" width="624" /></p>
</div>
<h3 id="establishing-the-axes-coordinates-and-scales">Establishing the axes, coordinates and scales</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>cross_chart</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span>clip <span class='op'>=</span> <span class='st'>"off"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span></span>
<span>    expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>, limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1900</span>, <span class='fl'>2015</span><span class='op'>)</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>1900</span>, <span class='fl'>2010</span>, by <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>        axis.text.y.right <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"0"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"1"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>2</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"2"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"3"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"4"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"5"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"6"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>7</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"7"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>8</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"8"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>9</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"9"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>10</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"10"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>11</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"11"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"0"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"5"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>2</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"10"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"15"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"20"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"25"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"30"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>7</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"35"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>8</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"40"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>9</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"45"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>10</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"50"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>11</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"55"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span></span>
<span>  <span class='op'>)</span></span>
<span><span class='va'>cross_chart</span></span></code></pre>
</div>
<p><img src="100407614_files/figure-html5/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<h3 id="rescaling-of-age_males_death-variable">Rescaling of age_males_death variable</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>new_min</span> <span class='op'>&lt;-</span> <span class='fl'>19.56</span></span>
<span><span class='va'>new_max</span> <span class='op'>&lt;-</span> <span class='fl'>55</span></span>
<span><span class='va'>age_males_death</span> <span class='op'>&lt;-</span> <span class='va'>cancer_deaths</span><span class='op'>$</span><span class='va'>age_males_death</span></span>
<span><span class='va'>old_min</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>age_males_death</span><span class='op'>)</span></span>
<span><span class='va'>old_max</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>age_males_death</span><span class='op'>)</span></span>
<span><span class='va'>age_males_death</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='op'>(</span><span class='op'>(</span><span class='va'>age_males_death</span><span class='op'>-</span><span class='va'>old_min</span><span class='op'>)</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>old_max</span> <span class='op'>-</span> <span class='va'>old_min</span><span class='op'>)</span><span class='op'>)</span></span>
<span>                    <span class='op'>*</span> <span class='op'>(</span><span class='va'>new_max</span> <span class='op'>-</span> <span class='va'>new_min</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>new_min</span></span>
<span><span class='va'>cancer_deaths</span><span class='op'>$</span><span class='va'>age_males_death</span> <span class='op'>&lt;-</span> <span class='va'>age_males_death</span></span></code></pre>
</div>
</div>
<h3 id="intersecting-charts-and-filtering-the-data">Intersecting charts and filtering the data</h3>
<p>To overlay the line charts, we scale them by dividing the maximum value of sales_cig and age_males_death. As we can observe, there is a small peak in the raw data, specifically in the series representing cigarette sales, indicating that the authors who generated this graph likely underwent some standardization process to address it.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>scale</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>sales_daily</span><span class='op'>$</span><span class='va'>sales_cig</span><span class='op'>)</span><span class='op'>/</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>cancer_deaths</span><span class='op'>$</span><span class='va'>age_males_death</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>cancer_deaths</span> <span class='op'>&lt;-</span> <span class='va'>cancer_deaths</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>age_males_death <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>year</span> <span class='op'>&gt;=</span> <span class='fl'>2016</span>, <span class='cn'>NA</span>, <span class='va'>age_males_death</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>cross_chart</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>sales_daily</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>year</span>, y <span class='op'>=</span> <span class='va'>sales_cig</span>, color <span class='op'>=</span> <span class='st'>"Sales of Cigarettes"</span><span class='op'>)</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>1</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>cancer_deaths</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>year</span>, y <span class='op'>=</span> <span class='va'>age_males_death</span> <span class='op'>*</span> <span class='va'>scale</span>, color <span class='op'>=</span> <span class='st'>"Cancer Deaths"</span><span class='op'>)</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>1</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span></span>
<span>    title <span class='op'>=</span> <span class='st'>"Cigarette sales and lung cancer mortality in the US"</span>,</span>
<span>    x <span class='op'>=</span> <span class='st'>"Year"</span>,</span>
<span>    y <span class='op'>=</span> <span class='st'>"Cigarettes sold per adult per day"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_color_manual</a></span><span class='op'>(</span></span>
<span>    values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sales of Cigarettes"</span> <span class='op'>=</span> <span class='st'>"#800080"</span>, </span>
<span>               <span class='st'>"Cancer Deaths"</span> <span class='op'>=</span> <span class='st'>"#CC0000"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span></span>
<span>    sec.axis <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/sec_axis.html'>sec_axis</a></span><span class='op'>(</span></span>
<span>      <span class='op'>~</span><span class='va'>.</span><span class='op'>/</span><span class='va'>scale</span>,</span>
<span>      breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>55</span>, by <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>,</span>
<span>      name <span class='op'>=</span> <span class='st'>"Rate of lung cancer deaths per 100,000 men"</span>,</span>
<span>      labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/comma.html'>number_format</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='fl'>11</span><span class='op'>)</span>, by <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span></span>
<span><span class='va'>cross_chart</span></span></code></pre>
</div>
<p><img src="100407614_files/figure-html5/unnamed-chunk-8-1.png" width="624" /></p>
</div>
<h3 id="selecting-the-suitable-font-style">Selecting the suitable font style</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>sysfonts</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/sysfonts/man/font_add_google.html'>font_add_google</a></span><span class='op'>(</span><span class='st'>"Playfair Display"</span>, family<span class='op'>=</span><span class='st'>"font_title"</span><span class='op'>)</span></span>
<span><span class='fu'>sysfonts</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/sysfonts/man/font_add_google.html'>font_add_google</a></span><span class='op'>(</span><span class='st'>"Lato"</span>, family<span class='op'>=</span><span class='st'>"font_y_axis"</span><span class='op'>)</span></span>
<span><span class='fu'>showtext</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/showtext/man/showtext_auto.html'>showtext_auto</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 id="modifying-the-appearance-of-the-axes-by-altering-the-color-and-size-of-their-titles">Modifying the appearance of the axes by altering the color and size of their titles</h3>
<p>To change the color of specific words in the title, we use the command span style, followed by theme(plot.title = element_markdown). To eliminate the distance between the first value on the x-axis and the origin, I use scale_x_continuous(expand = c(0, 0)). This setting removes the padding or expansion on the x-axis. Additionally, theme_minimal() is employed to eliminate non-essential elements in the plot, creating a clean and simple design. The breaks command is used to display numbers on each axis at intervals of 1, 5, or 10. Sec_axis is employed to align the second y-axis (on the right) to a scale that approximates the first y-axis (on the left). Finally, annotate is used to place the axis titles at the top left and top right.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>cross_chart</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>sales_daily</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>year</span>, y <span class='op'>=</span> <span class='va'>sales_cig</span>, color <span class='op'>=</span> <span class='st'>"Sales of Cigarettes"</span><span class='op'>)</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>1</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>cancer_deaths</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>year</span>, y <span class='op'>=</span> <span class='va'>age_males_death</span> <span class='op'>*</span> <span class='va'>scale</span>, </span>
<span>        color <span class='op'>=</span> <span class='st'>"Cancer Deaths"</span><span class='op'>)</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>1</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span></span>
<span>    title <span class='op'>=</span> <span class='st'>"&lt;span style='color:#800080'&gt;Cigarette sales&lt;/span&gt; &lt;span style='color:black'&gt;and&lt;/span&gt; &lt;span style='color:#CC0000'&gt;lung cancer mortality&lt;/span&gt; &lt;span style='color:black'&gt;in the US&lt;/span&gt;"</span>,</span>
<span>    x <span class='op'>=</span> <span class='st'>""</span>,</span>
<span>    y <span class='op'>=</span> <span class='st'>""</span>,</span>
<span>    caption <span class='op'>=</span> <span class='st'>"Data sources: International Smoking Statistics (2017): WHO Cancer Mortality Database (IARC). The death rate from lung-cancer is age-standardized."</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_color_manual</a></span><span class='op'>(</span></span>
<span>    values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sales of Cigarettes"</span> <span class='op'>=</span> <span class='st'>"#800080"</span>, </span>
<span>               <span class='st'>"Cancer Deaths"</span> <span class='op'>=</span> <span class='st'>"#CC0000"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span></span>
<span>    sec.axis <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/sec_axis.html'>sec_axis</a></span><span class='op'>(</span></span>
<span>      <span class='op'>~</span><span class='va'>.</span><span class='op'>/</span><span class='va'>scale</span>,</span>
<span>      breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>55</span>, by <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>,</span>
<span>      name <span class='op'>=</span> <span class='st'>""</span>,</span>
<span>      labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/comma.html'>number_format</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='fl'>11</span><span class='op'>)</span>, by <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span></span>
<span>    expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>    limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1900</span>, <span class='fl'>2018</span><span class='op'>)</span>,</span>
<span>    breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>1900</span>, <span class='fl'>2010</span>, by <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    legend.position <span class='op'>=</span> <span class='st'>"none"</span>,</span>
<span>    plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span></span>
<span>      color <span class='op'>=</span> <span class='st'>"#800080"</span>,</span>
<span>      hjust <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>      size <span class='op'>=</span> <span class='fl'>40</span>,</span>
<span>      margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>l <span class='op'>=</span> <span class='op'>-</span><span class='fl'>20</span><span class='op'>)</span>,</span>
<span>      family <span class='op'>=</span> <span class='st'>"font_title"</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>10</span>, r <span class='op'>=</span> <span class='fl'>10</span>, b <span class='op'>=</span> <span class='fl'>10</span>, l <span class='op'>=</span> <span class='fl'>20</span>, </span>
<span>                         unit <span class='op'>=</span> <span class='st'>"pt"</span><span class='op'>)</span>,</span>
<span>    axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>15</span>, hjust <span class='op'>=</span> <span class='fl'>0.25</span>, </span>
<span>                               family <span class='op'>=</span> <span class='st'>"font_y_axis"</span><span class='op'>)</span>,</span>
<span>    axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    axis.text.y.right <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    plot.caption <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span></span>
<span>      size <span class='op'>=</span> <span class='fl'>12</span>,</span>
<span>      hjust <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>      color <span class='op'>=</span> <span class='st'>"#5b5b5b"</span>,</span>
<span>      margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>l <span class='op'>=</span> <span class='op'>-</span><span class='fl'>20</span><span class='op'>)</span>,</span>
<span>      family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='cn'>Inf</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>12.5</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Rate of lung cancer deaths\nper 100,000 men"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#CC0000"</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.75</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>, </span>
<span>    y <span class='op'>=</span> <span class='fl'>12.5</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Cigarettes sold\nper adult per day"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0.17</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>6</span>, </span>
<span>    color <span class='op'>=</span> <span class='st'>"#800080"</span>, </span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.75</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span>clip <span class='op'>=</span> <span class='st'>"off"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"0"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>, color <span class='op'>=</span> <span class='st'>"#800080"</span>, </span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"1"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>, color <span class='op'>=</span> <span class='st'>"#800080"</span>, </span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>2</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"2"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>, color <span class='op'>=</span> <span class='st'>"#800080"</span>, </span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"3"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>, color <span class='op'>=</span> <span class='st'>"#800080"</span>, </span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"4"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>, color <span class='op'>=</span> <span class='st'>"#800080"</span>, </span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"5"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>, color <span class='op'>=</span> <span class='st'>"#800080"</span>, </span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"6"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>, color <span class='op'>=</span> <span class='st'>"#800080"</span>, </span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>7</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"7"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>, color <span class='op'>=</span> <span class='st'>"#800080"</span>, </span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>8</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"8"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>, color <span class='op'>=</span> <span class='st'>"#800080"</span>, </span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>9</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"9"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>, color <span class='op'>=</span> <span class='st'>"#800080"</span>, </span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>10</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"10"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>, color <span class='op'>=</span> <span class='st'>"#800080"</span>, </span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>11</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"11"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>, color <span class='op'>=</span> <span class='st'>"#800080"</span>, </span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"0"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>, color <span class='op'>=</span> <span class='st'>"#CC0000"</span>, </span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"5"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>, color <span class='op'>=</span> <span class='st'>"#CC0000"</span>, </span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>2</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"10"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>, color <span class='op'>=</span> <span class='st'>"#CC0000"</span>, </span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"15"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>, color <span class='op'>=</span> <span class='st'>"#CC0000"</span>, </span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"20"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>, color <span class='op'>=</span> <span class='st'>"#CC0000"</span>, </span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"25"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>, color <span class='op'>=</span> <span class='st'>"#CC0000"</span>, </span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"30"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>, color <span class='op'>=</span> <span class='st'>"#CC0000"</span>, </span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>7</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"35"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>, color <span class='op'>=</span> <span class='st'>"#CC0000"</span>, </span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>8</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"40"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>, color <span class='op'>=</span> <span class='st'>"#CC0000"</span>, </span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>9</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"45"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>, color <span class='op'>=</span> <span class='st'>"#CC0000"</span>, </span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>10</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"50"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>, color <span class='op'>=</span> <span class='st'>"#CC0000"</span>, </span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='cn'>Inf</span>, y <span class='op'>=</span> <span class='fl'>11</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"55"</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>6</span>, color <span class='op'>=</span> <span class='st'>"#CC0000"</span>, </span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span></span>
<span><span class='va'>cross_chart</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.title <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="100407614_files/figure-html5/unnamed-chunk-10-1.png" width="864" /></p>
</div>
<h3 id="incorporating-annotations-on-the-most-relevant-dates">Incorporating annotations on the most relevant dates</h3>
<p>Annotations are included using annotate(“text”), and arrows are added with annotate(“curve” or “segment”), depending on the shape of the arrow. The arrow command is used to specify the dimension and type of the arrowhead, in this case, it is a closed arrow. Finally, lineheight is used to determine the spacing between lines.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>cross_chart</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.title <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"curve"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fl'>1926.5</span>, xend <span class='op'>=</span> <span class='fl'>1929</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>5</span>, yend <span class='op'>=</span> <span class='fl'>4.4</span>,</span>
<span>    curvature <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.2</span>,</span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span></span>
<span>      type <span class='op'>=</span> <span class='st'>"closed"</span>,</span>
<span>      length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.015</span>, <span class='st'>"npc"</span><span class='op'>)</span>,</span>
<span>      angle <span class='op'>=</span> <span class='fl'>20</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fl'>1926</span>, y <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"1929: The Great Depression"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#5b5b5b"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"curve"</span>,</span>
<span>    x <span class='op'>=</span> <span class='fl'>1941.5</span>, xend <span class='op'>=</span> <span class='fl'>1944.5</span>,</span>
<span>    y <span class='op'>=</span> <span class='fl'>9.2</span>, yend <span class='op'>=</span> <span class='fl'>8.2</span>,</span>
<span>    curvature <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.2</span>,</span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span></span>
<span>      type <span class='op'>=</span> <span class='st'>"closed"</span>,</span>
<span>      length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.015</span>, <span class='st'>"npc"</span><span class='op'>)</span>,</span>
<span>      angle <span class='op'>=</span> <span class='fl'>20</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x<span class='op'>=</span><span class='fl'>1941</span>, y<span class='op'>=</span><span class='fl'>9.2</span>,</span>
<span>    hjust<span class='op'>=</span><span class='fl'>1</span>,</span>
<span>    label <span class='op'>=</span><span class='st'>"1945: The Second World War ends"</span>,</span>
<span>    color <span class='op'>=</span><span class='st'>"#5b5b5b"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"curve"</span>,</span>
<span>    x<span class='op'>=</span> <span class='fl'>1946.5</span>, xend <span class='op'>=</span> <span class='fl'>1949</span>,</span>
<span>    y<span class='op'>=</span><span class='fl'>10.6</span>, yend<span class='op'>=</span> <span class='fl'>9.6</span>,</span>
<span>    curvature <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.2</span>,</span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span></span>
<span>     type <span class='op'>=</span> <span class='st'>"closed"</span>,</span>
<span>     length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.015</span>, <span class='st'>"npc"</span><span class='op'>)</span>,</span>
<span>     angle <span class='op'>=</span> <span class='fl'>20</span></span>
<span>   <span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x<span class='op'>=</span><span class='fl'>1946</span>, y<span class='op'>=</span><span class='fl'>10.5</span>,</span>
<span>    hjust<span class='op'>=</span><span class='fl'>1</span>,</span>
<span>    label <span class='op'>=</span><span class='st'>"In the late 1940s and early 50s epidemiologists\n establish that smoking is harmful to people's health"</span>,</span>
<span>    color <span class='op'>=</span><span class='st'>"#5b5b5b"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.75</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"curve"</span>,</span>
<span>    x<span class='op'>=</span> <span class='fl'>1960.5</span>, xend <span class='op'>=</span> <span class='fl'>1964</span>,</span>
<span>    y<span class='op'>=</span><span class='fl'>11.65</span>, yend<span class='op'>=</span> <span class='fl'>10.9</span>,</span>
<span>    curvature <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.5</span>,</span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span></span>
<span>     type <span class='op'>=</span> <span class='st'>"closed"</span>,</span>
<span>     length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.015</span>, <span class='st'>"npc"</span><span class='op'>)</span>,</span>
<span>     angle <span class='op'>=</span> <span class='fl'>20</span></span>
<span>   <span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x<span class='op'>=</span><span class='fl'>1960</span>, y<span class='op'>=</span><span class='fl'>11.5</span>,</span>
<span>    hjust<span class='op'>=</span><span class='fl'>1</span>,</span>
<span>    label <span class='op'>=</span><span class='st'>"1964: Surgeon General's report links smoking\n to deaths from cancer and heart disease"</span>,</span>
<span>    color <span class='op'>=</span><span class='st'>"#5b5b5b"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.75</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"curve"</span>,</span>
<span>    x<span class='op'>=</span> <span class='fl'>1968.5</span>, xend <span class='op'>=</span> <span class='fl'>1970</span>,</span>
<span>    y<span class='op'>=</span><span class='fl'>12.2</span>, yend<span class='op'>=</span> <span class='fl'>10.3</span>,</span>
<span>    curvature <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.2</span>,</span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span></span>
<span>     type <span class='op'>=</span> <span class='st'>"closed"</span>,</span>
<span>     length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.015</span>, <span class='st'>"npc"</span><span class='op'>)</span>,</span>
<span>     angle <span class='op'>=</span> <span class='fl'>20</span></span>
<span>   <span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x<span class='op'>=</span><span class='fl'>1968</span>, y<span class='op'>=</span><span class='fl'>12.2</span>,</span>
<span>    hjust<span class='op'>=</span><span class='fl'>1</span>,</span>
<span>    label <span class='op'>=</span><span class='st'>"1970: the US bans cigarette ads on radio and television"</span>,</span>
<span>    color <span class='op'>=</span><span class='st'>"#5b5b5b"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x<span class='op'>=</span> <span class='fl'>1983</span>, xend <span class='op'>=</span> <span class='fl'>1983</span>,</span>
<span>    y<span class='op'>=</span><span class='fl'>8.35</span>, yend<span class='op'>=</span> <span class='fl'>9</span>,</span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span></span>
<span>     type <span class='op'>=</span> <span class='st'>"closed"</span>,</span>
<span>     length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.015</span>, <span class='st'>"npc"</span><span class='op'>)</span>,</span>
<span>     angle <span class='op'>=</span> <span class='fl'>20</span></span>
<span>   <span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x<span class='op'>=</span><span class='fl'>1983</span>, y<span class='op'>=</span><span class='fl'>8.3</span>,</span>
<span>    hjust<span class='op'>=</span><span class='fl'>0.9</span>, vjust<span class='op'>=</span><span class='fl'>1</span>,</span>
<span>    label <span class='op'>=</span><span class='st'>"1983: federal tax on\n cigarettes doubles"</span>,</span>
<span>    color <span class='op'>=</span><span class='st'>"#5b5b5b"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.75</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x<span class='op'>=</span> <span class='fl'>1986</span>, xend <span class='op'>=</span> <span class='fl'>1986</span>,</span>
<span>    y<span class='op'>=</span><span class='fl'>7.05</span>, yend<span class='op'>=</span> <span class='fl'>8.4</span>,</span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span></span>
<span>      type <span class='op'>=</span> <span class='st'>"closed"</span>,</span>
<span>      length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.015</span>, <span class='st'>"npc"</span><span class='op'>)</span>,</span>
<span>      angle <span class='op'>=</span> <span class='fl'>20</span></span>
<span>   <span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x<span class='op'>=</span><span class='fl'>1986</span>, y<span class='op'>=</span><span class='fl'>7.0</span>,</span>
<span>    hjust<span class='op'>=</span><span class='fl'>0.97</span>, vjust<span class='op'>=</span><span class='fl'>1</span>,</span>
<span>    label <span class='op'>=</span><span class='st'>"1986: Surgeon General's\n report on secondhamd-smoke"</span>,</span>
<span>    color <span class='op'>=</span><span class='st'>"#5b5b5b"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.75</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x<span class='op'>=</span> <span class='fl'>1991</span>, xend <span class='op'>=</span> <span class='fl'>1991</span>,</span>
<span>    y<span class='op'>=</span><span class='fl'>6.05</span>, yend<span class='op'>=</span> <span class='fl'>6.9</span>,</span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span></span>
<span>      type <span class='op'>=</span> <span class='st'>"closed"</span>,</span>
<span>      length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.015</span>, <span class='st'>"npc"</span><span class='op'>)</span>,</span>
<span>      angle <span class='op'>=</span> <span class='fl'>20</span></span>
<span>   <span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x<span class='op'>=</span><span class='fl'>1991</span>, y<span class='op'>=</span><span class='fl'>6</span>,</span>
<span>    hjust<span class='op'>=</span><span class='fl'>0.97</span>, vjust<span class='op'>=</span><span class='fl'>1</span>,</span>
<span>    label <span class='op'>=</span><span class='st'>"Increasing bans on inflight smoking"</span>,</span>
<span>    color <span class='op'>=</span><span class='st'>"#5b5b5b"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x<span class='op'>=</span> <span class='fl'>1995</span>, xend <span class='op'>=</span> <span class='fl'>1995</span>,</span>
<span>    y<span class='op'>=</span><span class='fl'>5.05</span>, yend<span class='op'>=</span> <span class='fl'>6.3</span>,</span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span></span>
<span>      type <span class='op'>=</span> <span class='st'>"closed"</span>,</span>
<span>      length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.015</span>, <span class='st'>"npc"</span><span class='op'>)</span>,</span>
<span>      angle <span class='op'>=</span> <span class='fl'>20</span></span>
<span>   <span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x<span class='op'>=</span><span class='fl'>1995</span>, y<span class='op'>=</span><span class='fl'>5</span>,</span>
<span>    hjust<span class='op'>=</span><span class='fl'>0.97</span>, vjust<span class='op'>=</span><span class='fl'>1</span>,</span>
<span>    label <span class='op'>=</span><span class='st'>"Nicotine replacement medications\n become widely available over the counter"</span>,</span>
<span>    color <span class='op'>=</span><span class='st'>"#5b5b5b"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.75</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x<span class='op'>=</span> <span class='fl'>1998</span>, xend <span class='op'>=</span> <span class='fl'>1998</span>,</span>
<span>    y<span class='op'>=</span><span class='fl'>4.05</span>, yend<span class='op'>=</span> <span class='fl'>5.8</span>,</span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span></span>
<span>      type <span class='op'>=</span> <span class='st'>"closed"</span>,</span>
<span>      length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.015</span>, <span class='st'>"npc"</span><span class='op'>)</span>,</span>
<span>      angle <span class='op'>=</span> <span class='fl'>20</span></span>
<span>   <span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x<span class='op'>=</span><span class='fl'>1998</span>, y<span class='op'>=</span><span class='fl'>4</span>,</span>
<span>    hjust<span class='op'>=</span><span class='fl'>0.97</span>, vjust<span class='op'>=</span><span class='fl'>1</span>,</span>
<span>    label <span class='op'>=</span><span class='st'>"1998: California bans smoking in restaurants"</span>,</span>
<span>    color <span class='op'>=</span><span class='st'>"#5b5b5b"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"segment"</span>,</span>
<span>    x<span class='op'>=</span> <span class='fl'>2009</span>, xend <span class='op'>=</span> <span class='fl'>2009</span>,</span>
<span>    y<span class='op'>=</span><span class='fl'>2.8</span>, yend<span class='op'>=</span> <span class='fl'>3.5</span>,</span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span></span>
<span>      type <span class='op'>=</span> <span class='st'>"closed"</span>,</span>
<span>      length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.015</span>, <span class='st'>"npc"</span><span class='op'>)</span>,</span>
<span>      angle <span class='op'>=</span> <span class='fl'>20</span></span>
<span>   <span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>,</span>
<span>    x<span class='op'>=</span><span class='fl'>2009</span>, y<span class='op'>=</span><span class='fl'>2.75</span>,</span>
<span>    hjust<span class='op'>=</span><span class='fl'>0.97</span>, vjust<span class='op'>=</span><span class='fl'>1</span>,</span>
<span>    label <span class='op'>=</span><span class='st'>"2009: federal tax increased again\n from $0.39 to $1.01 per pack"</span>,</span>
<span>    color <span class='op'>=</span><span class='st'>"#5b5b5b"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>    lineheight <span class='op'>=</span> <span class='fl'>0.75</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
<p><img src="100407614_files/figure-html5/unnamed-chunk-11-1.png" width="864" data-distill-preview=1 /></p>
</div>
<h2 id="enhancement-chart">Enhancement Chart</h2>
<p>As an improvement to the chart or an alternative visualization of these data, I have created a Correlation Connected Scatter to display the correlation between both series. As we can observe, it addresses the major issue we had previously, as all milestones are now marked on the same series, allowing us to attribute the effects correctly. This is achieved visually with the viridis color scale.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>merged_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/merge.html'>merge</a></span><span class='op'>(</span><span class='va'>sales_daily</span>, <span class='va'>cancer_deaths</span>, </span>
<span>                     by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"entity"</span>, <span class='st'>"year"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>merged_data</span><span class='op'>$</span><span class='va'>sales_cig</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 3.2</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>merged_data</span><span class='op'>$</span><span class='va'>sales_cig</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 11</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>merged_data</span><span class='op'>$</span><span class='va'>age_males_death</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 19.56</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>merged_data</span><span class='op'>$</span><span class='va'>age_males_death</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 55</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>viridis_color</span> <span class='op'>&lt;-</span> <span class='fu'>viridisLite</span><span class='fu'>::</span><span class='fu'><a href='https://sjmgarnier.github.io/viridisLite/reference/viridis.html'>viridis</a></span><span class='op'>(</span><span class='fl'>5</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>enhanc_chart</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>merged_data</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>sales_cig</span>, <span class='va'>age_males_death</span>, color <span class='op'>=</span> <span class='va'>year</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_viridis.html'>scale_color_viridis_c</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_path</a></span><span class='op'>(</span></span>
<span>    arrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span></span>
<span>    angle<span class='op'>=</span><span class='fl'>15</span>, type<span class='op'>=</span><span class='st'>"closed"</span>,</span>
<span>    length<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='st'>"inches"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_label</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>merged_data</span>,</span>
<span>                  <span class='va'>year</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1929</span>, <span class='fl'>1945</span>, <span class='fl'>1949</span>, <span class='fl'>1964</span>,</span>
<span>                              <span class='fl'>1970</span>, <span class='fl'>1983</span>, <span class='fl'>1986</span>, <span class='fl'>1992</span>,</span>
<span>                              <span class='fl'>1995</span>, <span class='fl'>1998</span>, <span class='fl'>2009</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>year</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span>clip <span class='op'>=</span> <span class='st'>"off"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span>        legend.justification<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span></span>
<span>    title <span class='op'>=</span> <span class='st'>"Correlation between Cigarette sales and Lung cancer mortality in the US"</span>,</span>
<span>    x <span class='op'>=</span> <span class='st'>"Cigarettes sold\nper adult per day"</span>,</span>
<span>    y <span class='op'>=</span> <span class='st'>"Rate of lung cancer deaths\nper 100,000 men"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>11</span>, by <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>20</span>, <span class='fl'>55</span>, by <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span>,</span>
<span>        plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>                                  size <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>                                  family <span class='op'>=</span> <span class='st'>"font_title"</span><span class='op'>)</span>,</span>
<span>        plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>10</span>, </span>
<span>                             r <span class='op'>=</span> <span class='fl'>20</span>, </span>
<span>                             b <span class='op'>=</span> <span class='fl'>10</span>,</span>
<span>                             l <span class='op'>=</span> <span class='fl'>20</span>,</span>
<span>                             unit <span class='op'>=</span> <span class='st'>"pt"</span><span class='op'>)</span>,</span>
<span>        axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>20</span>,</span>
<span>                                   color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span>,</span>
<span>        axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>20</span>, </span>
<span>                                   color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span>,</span>
<span>        axis.title.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>20</span>, </span>
<span>                                    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span><span class='op'>)</span>,</span>
<span>        axis.title.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>20</span>,</span>
<span>                                    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span><span class='op'>)</span><span class='op'>)</span> </span>
<span><span class='va'>enhanc_chart</span></span></code></pre>
</div>
<p><img src="100407614_files/figure-html5/unnamed-chunk-12-1.png" width="864" /></p>
</div>
<p>Adding the milestones in the same series:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>enhanc_chart</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_tile.html'>geom_rect</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>xmin <span class='op'>=</span> <span class='fl'>8.5</span>, xmax <span class='op'>=</span> <span class='fl'>10.78</span>, ymin <span class='op'>=</span> <span class='fl'>32.5</span>, ymax <span class='op'>=</span> <span class='fl'>35</span><span class='op'>)</span>,</span>
<span>    fill <span class='op'>=</span> <span class='st'>"transparent"</span>, color <span class='op'>=</span> <span class='va'>viridis_color</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, size <span class='op'>=</span> <span class='fl'>0.5</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>8.55</span>, y <span class='op'>=</span> <span class='fl'>33.75</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Surgeon General's report links smoking\nto deaths from cancer and heart disease"</span>,</span>
<span>    color <span class='op'>=</span> <span class='va'>viridis_color</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, size <span class='op'>=</span> <span class='fl'>5</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, lineheight <span class='op'>=</span> <span class='fl'>0.75</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_tile.html'>geom_rect</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>xmin <span class='op'>=</span> <span class='fl'>8.5</span>, xmax <span class='op'>=</span> <span class='fl'>10</span>, ymin <span class='op'>=</span> <span class='fl'>42.4</span>, ymax <span class='op'>=</span> <span class='fl'>44.9</span><span class='op'>)</span>,</span>
<span>    fill <span class='op'>=</span> <span class='st'>"transparent"</span>, color <span class='op'>=</span> <span class='va'>viridis_color</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, size <span class='op'>=</span> <span class='fl'>0.5</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>8.55</span>, y <span class='op'>=</span> <span class='fl'>43.65</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"The US bans cigarette ads\non radio and television"</span>,</span>
<span>    color <span class='op'>=</span> <span class='va'>viridis_color</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, size <span class='op'>=</span> <span class='fl'>5</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, lineheight <span class='op'>=</span> <span class='fl'>0.75</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_tile.html'>geom_rect</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>xmin <span class='op'>=</span> <span class='fl'>8.9</span>, xmax <span class='op'>=</span> <span class='fl'>10</span>, ymin <span class='op'>=</span> <span class='fl'>54.3</span>, ymax <span class='op'>=</span> <span class='fl'>56.8</span><span class='op'>)</span>,</span>
<span>    fill <span class='op'>=</span> <span class='st'>"transparent"</span>, color <span class='op'>=</span> <span class='va'>viridis_color</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>]</span>, size <span class='op'>=</span> <span class='fl'>0.5</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>8.95</span>, y <span class='op'>=</span> <span class='fl'>55.55</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Federal tax on\ncigarettes doubles"</span>,</span>
<span>    color <span class='op'>=</span> <span class='va'>viridis_color</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>]</span>, size <span class='op'>=</span> <span class='fl'>5</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, lineheight <span class='op'>=</span> <span class='fl'>0.75</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_tile.html'>geom_rect</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>xmin <span class='op'>=</span> <span class='fl'>7.35</span>, xmax <span class='op'>=</span> <span class='fl'>8.8</span>, ymin <span class='op'>=</span> <span class='fl'>50.5</span>, ymax <span class='op'>=</span> <span class='fl'>53</span><span class='op'>)</span>,</span>
<span>    fill <span class='op'>=</span> <span class='st'>"transparent"</span>, color <span class='op'>=</span> <span class='va'>viridis_color</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>]</span>, size <span class='op'>=</span> <span class='fl'>0.5</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>7.4</span>, y <span class='op'>=</span> <span class='fl'>51.75</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Surgeon General's report\non secondhand smoke"</span>,</span>
<span>    color <span class='op'>=</span> <span class='va'>viridis_color</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>]</span>, size <span class='op'>=</span> <span class='fl'>5</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, lineheight <span class='op'>=</span> <span class='fl'>0.75</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_tile.html'>geom_rect</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>xmin <span class='op'>=</span> <span class='fl'>5.85</span>, xmax <span class='op'>=</span> <span class='fl'>7</span>, ymin <span class='op'>=</span> <span class='fl'>53.7</span>, ymax <span class='op'>=</span> <span class='fl'>56.2</span><span class='op'>)</span>,</span>
<span>    fill <span class='op'>=</span> <span class='st'>"transparent"</span>, color <span class='op'>=</span> <span class='va'>viridis_color</span><span class='op'>[</span><span class='fl'>4</span><span class='op'>]</span>, size <span class='op'>=</span> <span class='fl'>0.5</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>5.9</span>, y <span class='op'>=</span> <span class='fl'>54.95</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Increasing bans\non inflight smoking"</span>,</span>
<span>    color <span class='op'>=</span> <span class='va'>viridis_color</span><span class='op'>[</span><span class='fl'>4</span><span class='op'>]</span>, size <span class='op'>=</span> <span class='fl'>5</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, lineheight <span class='op'>=</span> <span class='fl'>0.75</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_tile.html'>geom_rect</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>xmin <span class='op'>=</span> <span class='fl'>3.95</span>, xmax <span class='op'>=</span> <span class='fl'>6.35</span>, ymin <span class='op'>=</span> <span class='fl'>49.55</span>, ymax <span class='op'>=</span> <span class='fl'>52.05</span><span class='op'>)</span>,</span>
<span>    fill <span class='op'>=</span> <span class='st'>"transparent"</span>, color <span class='op'>=</span> <span class='va'>viridis_color</span><span class='op'>[</span><span class='fl'>4</span><span class='op'>]</span>, size <span class='op'>=</span> <span class='fl'>0.5</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>4</span>, y <span class='op'>=</span> <span class='fl'>50.8</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Nicotine replacement medications\nbecome widely available over the counter"</span>,</span>
<span>    color <span class='op'>=</span> <span class='va'>viridis_color</span><span class='op'>[</span><span class='fl'>4</span><span class='op'>]</span>, size <span class='op'>=</span> <span class='fl'>5</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, lineheight <span class='op'>=</span> <span class='fl'>0.75</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_tile.html'>geom_rect</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>xmin <span class='op'>=</span> <span class='fl'>5.9</span>, xmax <span class='op'>=</span> <span class='fl'>7.3</span>, ymin <span class='op'>=</span> <span class='fl'>44.75</span>, ymax <span class='op'>=</span> <span class='fl'>47.25</span><span class='op'>)</span>,</span>
<span>    fill <span class='op'>=</span> <span class='st'>"transparent"</span>, color <span class='op'>=</span> <span class='va'>viridis_color</span><span class='op'>[</span><span class='fl'>4</span><span class='op'>]</span>, size <span class='op'>=</span> <span class='fl'>0.5</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>5.95</span>, y <span class='op'>=</span> <span class='fl'>46</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"California bans smoking\nin restaurants"</span>,</span>
<span>    color <span class='op'>=</span> <span class='va'>viridis_color</span><span class='op'>[</span><span class='fl'>4</span><span class='op'>]</span>, size <span class='op'>=</span> <span class='fl'>5</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, lineheight <span class='op'>=</span> <span class='fl'>0.75</span>,</span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_tile.html'>geom_rect</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>xmin <span class='op'>=</span> <span class='fl'>3.65</span>, xmax <span class='op'>=</span> <span class='fl'>5.35</span>, ymin <span class='op'>=</span> <span class='fl'>33.7</span>, ymax <span class='op'>=</span> <span class='fl'>36.2</span><span class='op'>)</span>,</span>
<span>    fill <span class='op'>=</span> <span class='st'>"transparent"</span>, color <span class='op'>=</span> <span class='va'>viridis_color</span><span class='op'>[</span><span class='fl'>5</span><span class='op'>]</span>, size <span class='op'>=</span> <span class='fl'>0.5</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>3.7</span>, y <span class='op'>=</span> <span class='fl'>34.95</span>,</span>
<span>    label <span class='op'>=</span> <span class='st'>"Federal tax increased again\nfrom $0.39 to $1.01 per pack"</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#DAA520"</span>, size <span class='op'>=</span> <span class='fl'>5</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, lineheight <span class='op'>=</span> <span class='fl'>0.75</span>, </span>
<span>    family <span class='op'>=</span> <span class='st'>"font_y_axis"</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
<p><img src="100407614_files/figure-html5/unnamed-chunk-13-1.png" width="864" /></p>
</div>
<p>Furthermore, it is easier to observe in this graph that there is a strong positive correlation between daily cigarette sales and deaths attributed to lung cancer in the United States. The arrows start moving upward to the right and then downward to the left, indicating a positive correlation. In addition, the alignment and clear direction of the arrows suggest a strong correlation.</p>
<p>To sum up, it is evident that both the death rate and daily cigarette sales have decreased significantly from the second half of the 20th century to the present. For instance, we transitioned from approximately 9.1 daily cigarettes sold with a 53.61% lung cancer death rate in men in 1983 to 3.7 daily cigarettes sold with a 36.85% lung cancer death rate in men in 2009.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
