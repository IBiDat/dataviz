---
title: "Trust in government by race and ethnicity"
description: |
  Among Asian, Hispanic and Black adults, 23%, 23% and 21% respectively say they trust the federal government “most of the time” or “just about always” – higher levels of trust than among White adults (13%). During the last Democratic administration, Black and Hispanic adults similarly expressed more trust in government than White adults. Throughout most recent Republican administrations, White Americans were substantially more likely than Black Americans to express trust in the federal government to do the right thing.
categories: "2023"
author: Carlos San Juan Baeza
date: "`r Sys.Date()`"
output:
  distill::distill_article:
    self_contained: false
    toc: true
    
---

Distill is a publication format for scientific and technical writing, native to the web.

Learn more about using Distill at <https://rstudio.github.io/distill>.

 

```{r setup, include=FALSE}
knitr::opts_chunk$set(out.width="100%", fig.align="center")
```



##LIBRARIES

```{r}

library(ggplot2)
library(tidyverse)
library(readr)
library(gridExtra)
```

##ORIGINAL PLOT##

 1º WE LOAD THE DATABASE
 
```{r}
ideologi <- read_csv("database.csv")
#View(ideologi)
data.df <- data.frame(ideologi[1:150,1:6])
data.df$Date <- as.Date(data.df$Date, format = "%m/%d/%Y")
```

 2ª WE CONVERT DATA WITH TIDYVERSE TO OMIT NA's

```{r}
data.df <- data.df |>
  tidyr::pivot_longer(c(Hispanic, White, Asian, Black)) |> 
  na.omit()
data.df

```

 3º CREAMOS VECTORES QUE SERÁN UTILIZADO MÁS ADELANTE
 
```{r}
years_to_highlight <- c(
  "1958-12-01",  # Dwight D. Eisenhower
  "1961-01-20",  # John F. Kennedy
  "1963-11-22",  # Asesinato de John F. Kennedy
  "1963-11-22",  # Lyndon B. Johnson asume la presidencia
  "1969-01-20",  # Richard Nixon
  "1974-08-09",  # Renuncia de Richard Nixon
  "1974-08-09",  # Gerald Ford asume la presidencia
  "1977-01-20",  # Jimmy Carter
  "1981-01-20",  # Ronald Reagan
  "1989-01-20",  # George H.W. Bush
  "1993-01-20",  # Bill Clinton
  "2001-01-20",  # George W. Bush
  "2009-01-20",  # Barack Obama
  "2017-01-20",  # Donald Trump
  "2021-01-20"   # Joe Biden
)

fechas_deseadas <- as.Date(c(
  "1960-01-01", "1970-01-01", "1980-01-01", "1990-01-01",
  "2000-01-01", "2010-01-01", "2020-01-01"
))
fechas_deseadas_df <- data.frame(Date = as.Date(fechas_deseadas))
```

4º COMENZAMOS CON EL GRÁFICO
 
```{r}
j <- ggplot(data.df)+
  aes(Date, value, color=name)+
  geom_rect(
    aes(xmin = as.Date("1958-12-01"), xmax = as.Date("1961-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1961-01-20"), xmax = as.Date("1963-11-22")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1963-11-22"), xmax = as.Date("1969-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1969-01-20"), xmax = as.Date("1974-08-09")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1974-08-09"), xmax = as.Date("1977-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1977-01-20"), xmax = as.Date("1981-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1981-01-20"), xmax = as.Date("1989-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1989-01-20"), xmax = as.Date("1993-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1993-01-20"), xmax = as.Date("2001-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) + 
  geom_rect(
    aes(xmin = as.Date("2001-01-20"), xmax = as.Date("2009-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("2009-01-20"), xmax = as.Date("2017-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("2017-01-20"), xmax = as.Date("2021-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("2021-01-20"), xmax = as.Date("2024-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) + geom_line(linetype="solid", size=1.75, alpha = 1, lineend= "round") +
  scale_color_manual(
    values = c( "Asian" = "#DE996A","White" = "#F2DBCD","Black" = "#E7BA9A","Hispanic" = "#A55A26"),
    name = ""
  )

```
 
5º AÑADIR AESTHETHICS AND FINAL RESULT

```{r}
j +
  labs(
    x = NULL,
    y =NULL,
    title = expression(paste(bold("Trust in government by race and ethnicity"))),
    subtitle = "% who say they trust the government to do what is right just about always/most of time",
    color = "Ethnicity:",
    caption = "Source: PEW RESEARCH CENTER") +
  scale_x_date(
    breaks = fechas_deseadas,
    labels = format(fechas_deseadas, "%Y"),
    expand = c(0.00, 0.00)  # Ajustar el espacio entre el eje y los extremos del gráfico
  ) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 20),
    expand = c(0, 0)  # Ajustar el espacio entre el eje y los extremos del gráfico
  ) + 
  theme_minimal() +
  theme(
    plot.subtitle = element_text(size = 10, color = "grey", face = "italic"),
    plot.caption = element_text(hjust = 0, vjust = 0, color = "black", size = 10),
    legend.position = "bottom",
    legend.title = element_text(face = "bold"),
    legend.text = element_text(size = 10),
    legend.margin = margin(t = 0, b = -0.2, unit = "cm"),  # Ajuste de la posición vertical
    axis.line = element_line(size = 0.5, color = "black"),
    axis.text = element_text(size = 10, color = "black"),
    axis.title = element_text(size = 12, color = "black", face = "bold"),
    panel.grid.minor = element_blank(),
    panel.grid.major.x = element_blank(),
    axis.ticks.x = element_line(size = 0.5),
    axis.text.x = element_text(angle = 0, hjust = 0.5),  # Fondo del gráfico
    axis.ticks.y = element_line(size = 0.5),
    axis.text.y = element_text(angle = 0, hjust = 0.5),
    plot.background = element_rect(fill = "white"),
    plot.margin = margin(1, 1, 1, 1, "cm"),  # Añade márgenes alrededor del gráfico
    legend.key.width = unit(1, "cm"),  # Ajusta el ancho de la clave de la leyenda
    legend.key.height = unit(1, "cm"),  # Ajusta la altura de la clave de la leyenda
    legend.spacing = unit(0.5, "cm"),  # Ajusta el espacio entre las entradas de la leyenda
    legend.box.margin = margin(0, 0, 0, 0, "cm")   # Fondo del gráfico
  ) +
  guides(
    color = guide_legend(
      keywidth = 1, keyheight = 0.5,   # Ajustes de ancho y alto de las muestras de color
      label.position = "right",  # Coloca las etiquetas de la leyenda en la parte inferior
      ncol = 4  # Número de columnas en la leyenda
    )
  ) +
  geom_text(aes(x = as.Date("1958-12-01"), y = 90), label = "Eisenhower", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("1961-01-20"), y = 90), label = "Kennedy", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983") +
  geom_text(aes(x = as.Date("1963-11-22"), y = 90), label = "Johnson", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983") +
  geom_text(aes(x = as.Date("1969-01-20"), y = 90), label = "Nixon", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("1974-08-09"), y = 90), label = "Ford", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("1977-01-20"), y = 90), label = "Carter", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983") +
  geom_text(aes(x = as.Date("1981-01-20"), y = 90), label = "Reagan", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("1989-01-20"), y = 90), label = "H.W. Bush", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("1993-01-20"), y = 90), label = "Clinton", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983") +
  geom_text(aes(x = as.Date("2001-01-20"), y = 90), label = "W. Bush", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("2009-01-200"), y = 90), label = "Obama", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983") +
  geom_text(aes(x = as.Date("2017-01-20"), y = 90), label = "Trump", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("2021-01-20"), y = 90), label = "Biden", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983") 

```


##MEJORARMOS EL GRÁFICO

 1º AÑADIMOS UNA NUEVA VARIABLE A LA BASE DE DATOS

```{r}
#NECESIAMOS 1RO CARGAR LA BASE DE DATOS ORIGINAL SIN ESTAR MODIFICADA POR TIDYVERSE
ideologi <- read_csv("database.csv")
data.df <- data.frame(ideologi[1:150,1:6])
data.df$Date <- as.Date(data.df$Date, format = "%m/%d/%Y")

#CARGAMOS LA NUEVA BASE DE DATOS, LA CUAL TIENE LA MISMA ESTRUCUTURA
trust <- read_csv("./chart-export-cda90f7d-1ac9-45fd-99e1-ec61f808868b.csv")
trust.df <- data.frame(trust[1:150,1:4])

#AÑADIMOS LAS VARIABLES
data.df$Trust.Average <-trust.df$Trust.average
data.df$Date <- as.Date(data.df$Date, format = "%m/%d/%Y")

#VOLVEMOS A MODIFICARLA CON TIDYVERSE PARA OMITIR NA
data.df <- data.df |>
  tidyr::pivot_longer(c(Hispanic, White, Asian, Black, Trust.Average)) |> 
  na.omit()
data.df
```

2º HACEMOS EL GRÁFICO

```{r}
j <- ggplot(data.df)+
  aes(Date, value, color=name)+
  geom_rect(
    aes(xmin = as.Date("1958-12-01"), xmax = as.Date("1961-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1961-01-20"), xmax = as.Date("1963-11-22")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1963-11-22"), xmax = as.Date("1969-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1969-01-20"), xmax = as.Date("1974-08-09")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1974-08-09"), xmax = as.Date("1977-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1977-01-20"), xmax = as.Date("1981-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1981-01-20"), xmax = as.Date("1989-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1989-01-20"), xmax = as.Date("1993-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1993-01-20"), xmax = as.Date("2001-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) + 
  geom_rect(
    aes(xmin = as.Date("2001-01-20"), xmax = as.Date("2009-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("2009-01-20"), xmax = as.Date("2017-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("2017-01-20"), xmax = as.Date("2021-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("2021-01-20"), xmax = as.Date("2024-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) + 
  geom_line(linetype="solid", size=1.75, alpha = 1) +
  scale_color_manual(
    values = c( "Asian" = "#cdb4db","White" = "#bde0fe","Black" = "#ffafcc","Hispanic" = "#a7c957", "Trust.Average"= "#ffd166"),
    name = "Ethnicity : "
  )

```

3º HACEMOS MÁS ASTHETIC

```{r}
j +
  labs(
    x = NULL,
    y =NULL,
    title = expression(paste(bold("Trust in government by race and ethnicity"))),
    subtitle = "% who say they trust the government to do what is right just about always/most of time",
    color = "Ethnicity:",
    caption = "Source: PEW RESEARCH CENTER") +
  scale_x_date(
    breaks = c(fechas_deseadas, as.Date("2001-09-11"), as.Date ("2021-01-20"), as.Date("2008-09-15"), as.Date("2013-01-01"), as.Date("1995-01-01"), as.Date("1975-04-30"), as.Date("1968-04-20"), as.Date("1985-08-20")),
    labels = c(format(fechas_deseadas, "%Y"), "11 S", "COVID-19", " Inicio de Crisis del 2008", "Revelaciones de Snowden", "Atentado de Oklahoma", "Fin Guerra de Vietnam", "Asesinato de MLK.Jr", "Irangate"),
    expand = c(0.00, 0.00), 
  )+ 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 20),
    expand = c(0, 0) 
  )+
  theme_minimal() +
theme(
  plot.subtitle = element_text(size = 10, color = "grey", face = "italic"),
  plot.caption = element_text(hjust = 0, vjust = 0, color = "black", size = 10),
  legend.position = "bottom",
  legend.title = element_text(face = "bold"),
  legend.text = element_text(size = 10),
  legend.margin = margin(t = 0, b = -0.2, unit = "cm"),  
  axis.line = element_line(size = 0.5, color = "black"),
  axis.text = element_text(size = 10, color = "black"),
  axis.title = element_text(size = 12, color = "black", face = "bold"),
  panel.grid.minor = element_blank(),
  panel.grid.major.x = element_blank(),
  axis.ticks.x = element_line(size = 0.5),
  axis.text.x = element_text(angle = 45, hjust = 1),  
  axis.ticks.y = element_line(size = 0.5),
  axis.text.y = element_text(angle = 0, hjust = 0.5),
  plot.background = element_rect(fill = "white"),
  plot.margin = margin(0.5, 1, 0.5, 1, "cm"),  # Añade márgenes alrededor del gráfico
  legend.key.width = unit(1, "cm"),  # Ajusta el ancho de la clave de la leyenda
  legend.key.height = unit(1, "cm"),  # Ajusta la altura de la clave de la leyenda
  legend.spacing = unit(0.5, "cm"),  # Ajusta el espacio entre las entradas de la leyenda
  legend.box.margin = margin(0, 0, 0, 0, "cm") # Fondo del gráfico
)+
  guides(
    color = guide_legend(
      keywidth = 2, keyheight = 0.2,  # Ajustes de ancho y alto de las muestras de color
      title.position = "top",  # Coloca el título de la leyenda en la parte superior
      label.position = "bottom",  # Coloca las etiquetas de la leyenda en la parte inferior
      ncol = 5  # Número de columnas en la leyenda
    )
  ) +
  geom_text(aes(x = as.Date("1958-12-01"), y = 90), label = "Eisenhower", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("1961-01-20"), y = 90), label = "Kennedy", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983") +
  geom_text(aes(x = as.Date("1963-11-22"), y = 90), label = "Johnson", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983") +
  geom_text(aes(x = as.Date("1969-01-20"), y = 90), label = "Nixon", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("1974-08-09"), y = 90), label = "Ford", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("1977-01-20"), y = 90), label = "Carter", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983") +
  geom_text(aes(x = as.Date("1981-01-20"), y = 90), label = "Reagan", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("1989-01-20"), y = 90), label = "H.W. Bush", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("1993-01-20"), y = 90), label = "Clinton", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983") +
  geom_text(aes(x = as.Date("2001-01-20"), y = 90), label = "W. Bush", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("2009-01-20"), y = 90), label = "Obama", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983") +
  geom_text(aes(x = as.Date("2017-01-20"), y = 90), label = "Trump", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("2021-01-20"), y = 90), label = "Biden", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983")
  

```

##MEJORA FINAL

CREAMOS UN GRAFICO PARA CADA VARIABLE MANTENIENDO COMO CONTANTE TRUST.AVERAGE

1º WHITE
```{r}
White <-  ggplot(data.df[data.df$name %in% c("White", "Trust.Average"),])+
  aes(Date, value, color=name)+
  geom_rect(
    aes(xmin = as.Date("1958-12-01"), xmax = as.Date("1961-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1961-01-20"), xmax = as.Date("1963-11-22")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1963-11-22"), xmax = as.Date("1969-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1969-01-20"), xmax = as.Date("1974-08-09")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1974-08-09"), xmax = as.Date("1977-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1977-01-20"), xmax = as.Date("1981-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1981-01-20"), xmax = as.Date("1989-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1989-01-20"), xmax = as.Date("1993-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1993-01-20"), xmax = as.Date("2001-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) + 
  geom_rect(
    aes(xmin = as.Date("2001-01-20"), xmax = as.Date("2009-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("2009-01-20"), xmax = as.Date("2017-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("2017-01-20"), xmax = as.Date("2021-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("2021-01-20"), xmax = as.Date("2024-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) + 
  geom_line(linetype="solid", size=1.75, alpha = 1) +
  scale_color_manual(
    values = c("White" = "#bde0fe", "Trust.Average"= "#ffd166"),
    name = "Ethnicity : "
  )  +
  labs(
    x = NULL,
    y =NULL,
    title = expression(paste(bold("Trust in government by White"))),
    subtitle = "% who say they trust the government to do what is right just about always/most of time",
    color = "Ethnicity:")+
  scale_x_date(
    breaks = c(fechas_deseadas, as.Date("2001-09-11"), as.Date ("2021-12-20"), as.Date("2008-01-01"), as.Date("2013-02-02"), as.Date("1995-01-01"), as.Date("1975-04-30"), as.Date("1967-04-20"), as.Date("1985-08-20")),
    labels = c(format(fechas_deseadas, "%Y"), "11 S", "COVID-19", " Inicio de Crisis del 2008", "Revelaciones de Snowden", "Atentado de Oklahoma", "Fin Guerra de Vietnam", "Asesinato de MLK.Jr", "Irangate"),
    expand = c(0.00, 0.00), 
  )+ 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 20),
    expand = c(0, 0)  # Ajustar el espacio entre el eje y los extremos del gráfico
  )+
  theme_minimal() +
  theme(
    plot.subtitle = element_text(size = 10, color = "grey", face = "italic"),
    plot.caption = element_text(hjust = 0, vjust = 0, color = "black", size = 10),
    legend.position = "right",
    legend.title = element_text(face = "bold", size = 10),
    legend.text = element_text(size = 10),
    legend.margin = margin(t = 0, r=-0.2, b = 0, unit = "cm"),  # Ajuste de la posición vertical
    axis.line = element_line(size = 0.5, color = "black"),
    axis.text = element_text(size = 10, color = "black"),
    axis.title = element_text(size = 12, color = "black", face = "bold"),
    panel.grid.minor = element_blank(),
    panel.grid.major.x = element_blank(),
    axis.ticks.x = element_line(size = 0.5),
    axis.ticks.y = element_line(size = 0.5),
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.text.y = element_text(angle = 0, hjust = 0.5),
    plot.background = element_rect(fill = "white"),
    plot.margin = margin(t=0.45, r= 0.5, b=0, l= 0.5, "cm"),  # Añade márgenes alrededor del gráfico
    legend.key.width = unit(1, "cm"),  # Ajusta el ancho de la clave de la leyenda
    legend.key.height = unit(1, "cm"),  # Ajusta la altura de la clave de la leyenda
    legend.spacing = unit(0.5, "cm"),  # Ajusta el espacio entre las entradas de la leyenda
    legend.box.margin = margin(0, 0, 0, 0, "cm"),
  )+
  guides(
    color = guide_legend(
      keywidth = 2, keyheight = 0.2,  # Ajustes de ancho y alto de las muestras de color
      title.position = "top",  # Coloca el título de la leyenda en la parte superior
      label.position = "top",  # Coloca las etiquetas de la leyenda en la parte inferior
      ncol = 1 # Número de columnas en la leyenda
    )
  ) +
  geom_text(aes(x = as.Date("1958-12-01"), y = 90), label = "Eisenhower", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("1961-01-20"), y = 90), label = "Kennedy", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983") +
  geom_text(aes(x = as.Date("1963-11-22"), y = 90), label = "Johnson", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983") +
  geom_text(aes(x = as.Date("1969-01-20"), y = 90), label = "Nixon", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("1974-08-09"), y = 90), label = "Ford", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("1977-01-20"), y = 90), label = "Carter", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983") +
  geom_text(aes(x = as.Date("1981-01-20"), y = 90), label = "Reagan", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("1989-01-20"), y = 90), label = "H.W. Bush", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("1993-01-20"), y = 90), label = "Clinton", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983") +
  geom_text(aes(x = as.Date("2001-01-20"), y = 90), label = "W. Bush", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("2009-01-20"), y = 90), label = "Obama", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983") +
  geom_text(aes(x = as.Date("2017-01-20"), y = 90), label = "Trump", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("2021-01-20"), y = 90), label = "Biden", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983")
White
```

2º BLACK

```{r}
Black <-  ggplot(data.df[data.df$name %in% c("Black", "Trust.Average"),])+
  aes(Date, value, color=name)+
  geom_rect(
    aes(xmin = as.Date("1958-12-01"), xmax = as.Date("1961-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1961-01-20"), xmax = as.Date("1963-11-22")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1963-11-22"), xmax = as.Date("1969-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1969-01-20"), xmax = as.Date("1974-08-09")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1974-08-09"), xmax = as.Date("1977-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1977-01-20"), xmax = as.Date("1981-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1981-01-20"), xmax = as.Date("1989-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1989-01-20"), xmax = as.Date("1993-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1993-01-20"), xmax = as.Date("2001-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) + 
  geom_rect(
    aes(xmin = as.Date("2001-01-20"), xmax = as.Date("2009-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("2009-01-20"), xmax = as.Date("2017-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("2017-01-20"), xmax = as.Date("2021-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("2021-01-20"), xmax = as.Date("2024-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) + 
  geom_line(linetype="solid", size=1.75, alpha = 1) +
  scale_color_manual(
    values = c("Black" = "#ffafcc", "Trust.Average"= "#ffd166"),
    name = "Ethnicity : "
  ) +
  labs(
    x = NULL,
    y =NULL,
    title = expression(paste(bold("Trust in government by Black"))),
    subtitle = "% who say they trust the government to do what is right just about always/most of time",
    color = "Ethnicity:")+
  scale_x_date(
    breaks = c(fechas_deseadas, as.Date("2001-09-11"), as.Date ("2021-12-20"), as.Date("2008-01-01"), as.Date("2013-02-02"), as.Date("1995-01-01"), as.Date("1975-04-30"), as.Date("1967-04-20"), as.Date("1985-08-20")),
    labels = c(format(fechas_deseadas, "%Y"), "11 S", "COVID-19", " Inicio de Crisis del 2008", "Revelaciones de Snowden", "Atentado de Oklahoma", "Fin Guerra de Vietnam", "Asesinato de MLK.Jr", "Irangate"),
    expand = c(0.00, 0.00), 
  )+ 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 20),
    expand = c(0, 0)  # Ajustar el espacio entre el eje y los extremos del gráfico
  )+
  theme_minimal() +
  theme(
    plot.subtitle = element_text(size = 10, color = "grey", face = "italic"),
    plot.caption = element_text(hjust = 0, vjust = 0, color = "black", size = 10),
    legend.position = "right",
    legend.title = element_text(face = "bold", size = 10),
    legend.text = element_text(size = 10),
    legend.margin = margin(t = 0, r=-0.2, b = 0, unit = "cm"),  # Ajuste de la posición vertical
    axis.line = element_line(size = 0.5, color = "black"),
    axis.text = element_text(size = 10, color = "black"),
    axis.title = element_text(size = 12, color = "black", face = "bold"),
    panel.grid.minor = element_blank(),
    panel.grid.major.x = element_blank(),
    axis.ticks.x = element_line(size = 0.5),
    axis.ticks.y = element_line(size = 0.5),
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.text.y = element_text(angle = 0, hjust = 0.5),
    plot.background = element_rect(fill = "white"),
    plot.margin = margin(t=0.45, r= 0.5, b=0, l= 0.5, "cm"),  # Añade márgenes alrededor del gráfico
    legend.key.width = unit(1, "cm"),  # Ajusta el ancho de la clave de la leyenda
    legend.key.height = unit(1, "cm"),  # Ajusta la altura de la clave de la leyenda
    legend.spacing = unit(0.5, "cm"),  # Ajusta el espacio entre las entradas de la leyenda
    legend.box.margin = margin(0, 0, 0, 0, "cm"),
  )+
  guides(
    color = guide_legend(
      keywidth = 2, keyheight = 0.2,  # Ajustes de ancho y alto de las muestras de color
      title.position = "top",  # Coloca el título de la leyenda en la parte superior
      label.position = "top",  # Coloca las etiquetas de la leyenda en la parte inferior
      ncol = 1 # Número de columnas en la leyenda
    )
  ) +
  geom_text(aes(x = as.Date("1958-12-01"), y = 90), label = "Eisenhower", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("1961-01-20"), y = 90), label = "Kennedy", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983") +
  geom_text(aes(x = as.Date("1963-11-22"), y = 90), label = "Johnson", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983") +
  geom_text(aes(x = as.Date("1969-01-20"), y = 90), label = "Nixon", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("1974-08-09"), y = 90), label = "Ford", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("1977-01-20"), y = 90), label = "Carter", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983") +
  geom_text(aes(x = as.Date("1981-01-20"), y = 90), label = "Reagan", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("1989-01-20"), y = 90), label = "H.W. Bush", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("1993-01-20"), y = 90), label = "Clinton", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983") +
  geom_text(aes(x = as.Date("2001-01-20"), y = 90), label = "W. Bush", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("2009-01-20"), y = 90), label = "Obama", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983") +
  geom_text(aes(x = as.Date("2017-01-20"), y = 90), label = "Trump", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("2021-01-20"), y = 90), label = "Biden", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983")
Black
```

3º ASIAN

```{r}
Asian <-  ggplot(data.df[data.df$name %in% c("Asian", "Trust.Average"),])+
  aes(Date, value, color=name)+
  geom_rect(
    aes(xmin = as.Date("1958-12-01"), xmax = as.Date("1961-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1961-01-20"), xmax = as.Date("1963-11-22")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1963-11-22"), xmax = as.Date("1969-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1969-01-20"), xmax = as.Date("1974-08-09")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1974-08-09"), xmax = as.Date("1977-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1977-01-20"), xmax = as.Date("1981-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1981-01-20"), xmax = as.Date("1989-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1989-01-20"), xmax = as.Date("1993-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1993-01-20"), xmax = as.Date("2001-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) + 
  geom_rect(
    aes(xmin = as.Date("2001-01-20"), xmax = as.Date("2009-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("2009-01-20"), xmax = as.Date("2017-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("2017-01-20"), xmax = as.Date("2021-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("2021-01-20"), xmax = as.Date("2024-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) + 
  geom_line(linetype="solid", size=1.75, alpha = 1) +
  scale_color_manual(
    values = c("Asian" = "#cdb4db", "Trust.Average"= "#ffd166"),
    name = "Ethnicity : "
  )  +
  labs(
    x = NULL,
    y =NULL,
    title = expression(paste(bold("Trust in government by Asian"))),
    subtitle = "% who say they trust the government to do what is right just about always/most of time",
    color = "Ethnicity:")+
  scale_x_date(
    breaks = c(fechas_deseadas, as.Date("2001-09-11"), as.Date ("2021-12-20"), as.Date("2008-01-01"), as.Date("2013-02-02"), as.Date("1995-01-01"), as.Date("1975-04-30"), as.Date("1967-04-20"), as.Date("1985-08-20")),
    labels = c(format(fechas_deseadas, "%Y"), "11 S", "COVID-19", " Inicio de Crisis del 2008", "Revelaciones de Snowden", "Atentado de Oklahoma", "Fin Guerra de Vietnam", "Asesinato de MLK.Jr", "Irangate"),
    expand = c(0.00, 0.00), 
  )+ 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 20),
    expand = c(0, 0)  # Ajustar el espacio entre el eje y los extremos del gráfico
  )+
  theme_minimal() +
  theme(
    plot.subtitle = element_text(size = 10, color = "grey", face = "italic"),
    plot.caption = element_text(hjust = 0, vjust = 0, color = "black", size = 10),
    legend.position = "right",
    legend.title = element_text(face = "bold", size = 10),
    legend.text = element_text(size = 10),
    legend.margin = margin(t = 0, r=-0.2, b = 0, unit = "cm"),  # Ajuste de la posición vertical
    axis.line = element_line(size = 0.5, color = "black"),
    axis.text = element_text(size = 10, color = "black"),
    axis.title = element_text(size = 12, color = "black", face = "bold"),
    panel.grid.minor = element_blank(),
    panel.grid.major.x = element_blank(),
    axis.ticks.x = element_line(size = 0.5),
    axis.ticks.y = element_line(size = 0.5),
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.text.y = element_text(angle = 0, hjust = 0.5),
    plot.background = element_rect(fill = "white"),
    plot.margin = margin(t=0.45, r= 0.5, b=0, l= 0.5, "cm"),  # Añade márgenes alrededor del gráfico
    legend.key.width = unit(1, "cm"),  # Ajusta el ancho de la clave de la leyenda
    legend.key.height = unit(1, "cm"),  # Ajusta la altura de la clave de la leyenda
    legend.spacing = unit(0.5, "cm"),  # Ajusta el espacio entre las entradas de la leyenda
    legend.box.margin = margin(0, 0, 0, 0, "cm"),
  )+
  guides(
    color = guide_legend(
      keywidth = 2, keyheight = 0.2,  # Ajustes de ancho y alto de las muestras de color
      title.position = "top",  # Coloca el título de la leyenda en la parte superior
      label.position = "top",  # Coloca las etiquetas de la leyenda en la parte inferior
      ncol = 1 # Número de columnas en la leyenda
    )
  ) +
  geom_text(aes(x = as.Date("1958-12-01"), y = 90), label = "Eisenhower", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("1961-01-20"), y = 90), label = "Kennedy", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983") +
  geom_text(aes(x = as.Date("1963-11-22"), y = 90), label = "Johnson", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983") +
  geom_text(aes(x = as.Date("1969-01-20"), y = 90), label = "Nixon", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("1974-08-09"), y = 90), label = "Ford", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("1977-01-20"), y = 90), label = "Carter", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983") +
  geom_text(aes(x = as.Date("1981-01-20"), y = 90), label = "Reagan", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("1989-01-20"), y = 90), label = "H.W. Bush", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("1993-01-20"), y = 90), label = "Clinton", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983") +
  geom_text(aes(x = as.Date("2001-01-20"), y = 90), label = "W. Bush", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("2009-01-20"), y = 90), label = "Obama", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983") +
  geom_text(aes(x = as.Date("2017-01-20"), y = 90), label = "Trump", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("2021-01-20"), y = 90), label = "Biden", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983")
Asian

```

4º HISPANIC

```{r}
Hispanic <-  ggplot(data.df[data.df$name %in% c("Hispanic", "Trust.Average"),])+
  aes(Date, value, color=name)+
  geom_rect(
    aes(xmin = as.Date("1958-12-01"), xmax = as.Date("1961-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1961-01-20"), xmax = as.Date("1963-11-22")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1963-11-22"), xmax = as.Date("1969-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1969-01-20"), xmax = as.Date("1974-08-09")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1974-08-09"), xmax = as.Date("1977-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1977-01-20"), xmax = as.Date("1981-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1981-01-20"), xmax = as.Date("1989-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1989-01-20"), xmax = as.Date("1993-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("1993-01-20"), xmax = as.Date("2001-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) + 
  geom_rect(
    aes(xmin = as.Date("2001-01-20"), xmax = as.Date("2009-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("2009-01-20"), xmax = as.Date("2017-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("2017-01-20"), xmax = as.Date("2021-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "#F0F0E6", alpha = 0.1,
    inherit.aes = FALSE
  ) +
  geom_rect(
    aes(xmin = as.Date("2021-01-20"), xmax = as.Date("2024-01-20")),
    ymin = -Inf, ymax = Inf,
    fill = "white", alpha = 0.2,
    inherit.aes = FALSE
  ) + 
  geom_line(linetype="solid", size=1.75, alpha = 1) +
  scale_color_manual(
    values = c("Hispanic" = "#a7c957", "Trust.Average"= "#ffd166"),
    name = "Ethnicity : "
  )  +
  labs(
    x = NULL,
    y =NULL,
    title = expression(paste(bold("Trust in government by Hispanic"))),
    subtitle = "% who say they trust the government to do what is right just about always/most of time",
    color = "Ethnicity:")+
  scale_x_date(
    breaks = c(fechas_deseadas, as.Date("2001-09-11"), as.Date ("2021-12-20"), as.Date("2008-01-01"), as.Date("2013-02-02"), as.Date("1995-01-01"), as.Date("1975-04-30"), as.Date("1967-04-20"), as.Date("1985-08-20")),
    labels = c(format(fechas_deseadas, "%Y"), "11 S", "COVID-19", " Inicio de Crisis del 2008", "Revelaciones de Snowden", "Atentado de Oklahoma", "Fin Guerra de Vietnam", "Asesinato de MLK.Jr", "Irangate"),
    expand = c(0.00, 0.00), 
  )+ 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 20),
    expand = c(0, 0)  # Ajustar el espacio entre el eje y los extremos del gráfico
  )+
  theme_minimal() +
  theme(
    plot.subtitle = element_text(size = 10, color = "grey", face = "italic"),
    plot.caption = element_text(hjust = 0, vjust = 0, color = "black", size = 10),
    legend.position = "right",
    legend.title = element_text(face = "bold", size = 10),
    legend.text = element_text(size = 10),
    legend.margin = margin(t = 0, r=-0.2, b = 0, unit = "cm"),  # Ajuste de la posición vertical
    axis.line = element_line(size = 0.5, color = "black"),
    axis.text = element_text(size = 10, color = "black"),
    axis.title = element_text(size = 12, color = "black", face = "bold"),
    panel.grid.minor = element_blank(),
    panel.grid.major.x = element_blank(),
    axis.ticks.x = element_line(size = 0.5),
    axis.ticks.y = element_line(size = 0.5),
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.text.y = element_text(angle = 0, hjust = 0.5),
    plot.background = element_rect(fill = "white"),
    plot.margin = margin(t=0.45, r= 0.5, b=0, l= 0.5, "cm"),  # Añade márgenes alrededor del gráfico
    legend.key.width = unit(1, "cm"),  # Ajusta el ancho de la clave de la leyenda
    legend.key.height = unit(1, "cm"),  # Ajusta la altura de la clave de la leyenda
    legend.spacing = unit(0.5, "cm"),  # Ajusta el espacio entre las entradas de la leyenda
    legend.box.margin = margin(0, 0, 0, 0, "cm"),
  )+
  guides(
    color = guide_legend(
      keywidth = 2, keyheight = 0.2,  # Ajustes de ancho y alto de las muestras de color
      title.position = "top",  # Coloca el título de la leyenda en la parte superior
      label.position = "top",  # Coloca las etiquetas de la leyenda en la parte inferior
      ncol = 1 # Número de columnas en la leyenda
    )
  ) +
  geom_text(aes(x = as.Date("1958-12-01"), y = 90), label = "Eisenhower", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("1961-01-20"), y = 90), label = "Kennedy", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983") +
  geom_text(aes(x = as.Date("1963-11-22"), y = 90), label = "Johnson", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983") +
  geom_text(aes(x = as.Date("1969-01-20"), y = 90), label = "Nixon", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("1974-08-09"), y = 90), label = "Ford", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("1977-01-20"), y = 90), label = "Carter", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983") +
  geom_text(aes(x = as.Date("1981-01-20"), y = 90), label = "Reagan", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("1989-01-20"), y = 90), label = "H.W. Bush", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("1993-01-20"), y = 90), label = "Clinton", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983") +
  geom_text(aes(x = as.Date("2001-01-20"), y = 90), label = "W. Bush", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("2009-01-20"), y = 90), label = "Obama", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983") +
  geom_text(aes(x = as.Date("2017-01-20"), y = 90), label = "Trump", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#bf3927") +
  geom_text(aes(x = as.Date("2021-01-20"), y = 90), label = "Biden", vjust = -1, hjust = 0.2, size = 3, angle = -90, color = "#436983")
Hispanic
```

4ºLOS JUNTAMOS TODOS

```{r titled, layout="l-body-outset", preview=TRUE}
grid.arrange(White, Black, Asian, Hispanic, nrow=2 ,ncol = 2)
```

