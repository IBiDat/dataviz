<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>GDP Forecasts for China's Cities by 'The Economist': Coastal Areas Have the Highest Growth Potential</title>

  <meta property="description" itemprop="description" content="A layer-by-layer construction of a map of Chinese cities containing information on forecasted GDP growth and population."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2022-12-29"/>
  <meta property="article:created" itemprop="dateCreated" content="2022-12-29"/>
  <meta name="article:author" content="Elena Yustres"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="GDP Forecasts for China&#39;s Cities by &#39;The Economist&#39;: Coastal Areas Have the Highest Growth Potential"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="A layer-by-layer construction of a map of Chinese cities containing information on forecasted GDP growth and population."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="GDP Forecasts for China&#39;s Cities by &#39;The Economist&#39;: Coastal Areas Have the Highest Growth Potential"/>
  <meta property="twitter:description" content="A layer-by-layer construction of a map of Chinese cities containing information on forecasted GDP growth and population."/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","categories","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["GDP Forecasts for China's Cities by 'The Economist': Coastal Areas Have the Highest Growth Potential"]},{"type":"character","attributes":{},"value":["A layer-by-layer construction of a map of Chinese cities containing information on forecasted GDP growth and population.\n"]},{"type":"character","attributes":{},"value":["2022"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Elena Yustres"]}]}]},{"type":"character","attributes":{},"value":["2022-12-29"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["100489635_files/anchor-4.2.2/anchor.min.js","100489635_files/bowser-1.9.3/bowser.min.js","100489635_files/distill-2.2.21/template.v2.js","100489635_files/figure-html5/unnamed-chunk-10-1.png","100489635_files/figure-html5/unnamed-chunk-11-1.png","100489635_files/figure-html5/unnamed-chunk-12-1.png","100489635_files/figure-html5/unnamed-chunk-13-1.png","100489635_files/figure-html5/unnamed-chunk-14-1.png","100489635_files/figure-html5/unnamed-chunk-15-1.png","100489635_files/figure-html5/unnamed-chunk-8-1.png","100489635_files/figure-html5/unnamed-chunk-9-1.png","100489635_files/header-attrs-2.16/header-attrs.js","100489635_files/jquery-3.6.0/jquery-3.6.0.js","100489635_files/jquery-3.6.0/jquery-3.6.0.min.js","100489635_files/jquery-3.6.0/jquery-3.6.0.min.map","100489635_files/popper-2.6.0/popper.min.js","100489635_files/tippy-6.2.7/tippy-bundle.umd.min.js","100489635_files/tippy-6.2.7/tippy-light-border.css","100489635_files/tippy-6.2.7/tippy.css","100489635_files/tippy-6.2.7/tippy.umd.min.js","100489635_files/webcomponents-2.0.0/webcomponents.js","economist.png","population.csv","ranking.csv"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="100489635_files/header-attrs-2.16/header-attrs.js"></script>
  <script src="100489635_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="100489635_files/popper-2.6.0/popper.min.js"></script>
  <link href="100489635_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="100489635_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="100489635_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="100489635_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="100489635_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="100489635_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="100489635_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"GDP Forecasts for China's Cities by 'The Economist': Coastal Areas Have the Highest Growth Potential","description":"A layer-by-layer construction of a map of Chinese cities containing information on forecasted GDP growth and population.","authors":[{"author":"Elena Yustres","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2022-12-29T00:00:00.000+01:00","citationText":"Yustres, 2022"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>GDP Forecasts for China’s Cities by ‘The Economist’: Coastal Areas Have the Highest Growth Potential</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt-tag">2022</div>
</div>
<!--/radix_placeholder_categories-->
<p><p>A layer-by-layer construction of a map of Chinese cities containing information on forecasted GDP growth and population.</p></p>
</div>

<div class="d-byline">
  
  Elena Yustres
  
<br/>2022-12-29
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#the-original-chart" id="toc-the-original-chart">The original chart</a>
<ul>
<li><a href="#obtaining-and-processing-the-data" id="toc-obtaining-and-processing-the-data">Obtaining and processing the data</a></li>
<li><a href="#building-the-plot" id="toc-building-the-plot">Building the plot</a></li>
</ul></li>
<li><a href="#evaluation-and-potential-enhancements" id="toc-evaluation-and-potential-enhancements">Evaluation and potential enhancements</a></li>
<li><a href="#alternative-visualization" id="toc-alternative-visualization">Alternative visualization</a></li>
</ul>
</nav>
</div>
<p>As both a cause and a consequence of China’s rapid economic growth, the proportion of the whole population living in cities has soared from 20% in 1980 to 60% in 2020. However, China’s Zero-Covid policy has stilted growth significantly. The <a href="https://viewpoint.eiu.com/analysis/article/1772410560"><em>“China Emerging City Rankings, 2022” Report</em></a>, launched by the Economist Intelligence Unit (EIU), assesses the growth potential of 108 cities predicted to have a population of more than 1 million by 2025. Scores are calculated using historical data and forecasts on variables such as demography, the local economy or the environment.</p>
<figure>
<img src="economist.png" class="external" alt="The Economist’s “March of the cities” map. Figure from economist.com." />
<figcaption aria-hidden="true">The Economist’s “March of the cities” map. Figure from <a href="https://economist.com">economist.com</a>.</figcaption>
</figure>
<p>This post will seek to replicate this map, propose incremental enhancements and suggest an alternative visualization that depicts the relationship between growth potential, population and location or distance to the coast taking cities as our units of analysis.</p>
<h2 id="the-original-chart">The original chart</h2>
<h3 id="obtaining-and-processing-the-data">Obtaining and processing the data</h3>
<p>First, several libraries are required for processing and plotting the data, including the customization of fonts for our plot:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/yixuan/showtext'>showtext</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>maps</span><span class='op'>)</span></span>
<span><span class='fu'>sysfonts</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/sysfonts/man/font_add_google.html'>font_add_google</a></span><span class='op'>(</span><span class='st'>"IBM Plex Sans"</span>, family<span class='op'>=</span><span class='st'>"IBM Plex Sans"</span><span class='op'>)</span></span>
<span><span class='fu'>showtext</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/showtext/man/showtext_auto.html'>showtext_auto</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Diving into data collection, I obtained the data on the <code>ranking</code> and <code>population</code> from the EIU (‘Global Geo-Political Trends and Economics’ section) after contacting their office in Asia by email.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>ranking</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_csv</a></span><span class='op'>(</span><span class='st'>"ranking.csv"</span><span class='op'>)</span></span>
<span><span class='va'>population</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_csv</a></span><span class='op'>(</span><span class='st'>"population.csv"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>As it can be seen below, the ‘ranking’ dataset contains data on scores for 106 cities (ordered from highest, i.e. Ranking = 1, to lowest) while the ‘population’ dataset includes population data for 397 cities in China.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://pillar.r-lib.org/reference/glimpse.html'>glimpse</a></span><span class='op'>(</span><span class='va'>ranking</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Rows: 106
Columns: 2
$ City    &lt;chr&gt; &quot;Hangzhou&quot;, &quot;Shenzhen&quot;, &quot;Shanghai&quot;, &quot;Suzhou&quot;, &quot;Guang…
$ Ranking &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 1…</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://pillar.r-lib.org/reference/glimpse.html'>glimpse</a></span><span class='op'>(</span><span class='va'>population</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Rows: 397
Columns: 2
$ City       &lt;chr&gt; &quot;Shanghai&quot;, &quot;Beijing&quot;, &quot;Shenzhen&quot;, &quot;Guangzhou&quot;, &quot;…
$ Population &lt;dbl&gt; 22315474, 18960744, 17494398, 16096724, 13568357,…</code></pre>
</div>
<p>Therefore, I merged both datasets through the variable they have in common, “City”, through a <code>left_join</code>. This yielded a dataset with both population and ranking data for the 106 cities provided by the EIU. Please note that, while the original graph in the article by ‘The Economist’ includes 108 cities, the EIU only provided me with data on 106.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>output</span> <span class='op'>&lt;-</span> <span class='va'>ranking</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>population</span>, by<span class='op'>=</span><span class='st'>"City"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>In order to obtain data on the ‘longitude’ and ‘latitude’ of each city, I used the <a href="https://search.r-project.org/CRAN/refmans/maps/html/world.cities.html"><code>world.cities</code> database</a>, which includes these and other variables for over 40,000 cities in the world. I then filtered those in China and selected (as well as renamed) the variables of interest to construct my final database.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='va'>world.cities</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>country.etc</span><span class='op'>==</span><span class='st'>"China"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>name</span>, <span class='va'>lat</span>, <span class='va'>long</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span><span class='st'>"City"</span><span class='op'>=</span><span class='st'>"name"</span>, </span>
<span>         <span class='st'>"Latitude"</span><span class='op'>=</span><span class='st'>"lat"</span>, </span>
<span>         <span class='st'>"Longitude"</span><span class='op'>=</span><span class='st'>"long"</span><span class='op'>)</span> </span></code></pre>
</div>
</div>
<p>The data also required cleaning, as there were several cities with the same name in different provinces. Using population data, I cross-checked which cities were the ones for which a ranking score was provided by the EIU and removed the rest. I also removed NAs for cities for which latitude and longitude data were not available.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>fulloutput</span> <span class='op'>&lt;-</span> <span class='va'>output</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>data</span>, by<span class='op'>=</span><span class='st'>"City"</span><span class='op'>)</span></span>
<span><span class='va'>fulloutputclean</span> <span class='op'>&lt;-</span> <span class='va'>fulloutput</span><span class='op'>[</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>23</span>, <span class='fl'>49</span>, <span class='fl'>51</span>, <span class='fl'>70</span>, <span class='fl'>81</span>, <span class='fl'>104</span>, <span class='fl'>113</span><span class='op'>)</span>,<span class='op'>]</span></span>
<span><span class='va'>fulloutputclean</span> <span class='op'>&lt;-</span> <span class='va'>fulloutputclean</span><span class='op'>[</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>fulloutputclean</span><span class='op'>$</span><span class='va'>Latitude</span><span class='op'>)</span> </span>
<span>                                   <span class='op'>&amp;</span> <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>fulloutputclean</span><span class='op'>$</span><span class='va'>Longitude</span><span class='op'>)</span>, <span class='op'>]</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>fulloutputclean</span>, <span class='fl'>5</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 5 × 5
  City      Ranking Population Latitude Longitude
  &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 Hangzhou        1    9236032     30.2      120.
2 Shenzhen        2   17494398     22.5      114.
3 Shanghai        3   22315474     31.2      121.
4 Suzhou          4    6715559     31.3      121.
5 Guangzhou       5   16096724     23.1      113.</code></pre>
</div>
<p>The final step in data processing was obtaining the data to plot the underlying map of China. I used the <a href="https://ggplot2.tidyverse.org/reference/map_data.html"><code>map_data</code> function</a> and again, filtered, selected and renamed variables accordingly.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>China</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/map_data.html'>map_data</a></span><span class='op'>(</span><span class='st'>"world"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>region</span><span class='op'>==</span><span class='st'>"China"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span><span class='st'>"Latitude"</span><span class='op'>=</span><span class='st'>"lat"</span>, </span>
<span>         <span class='st'>"Longitude"</span><span class='op'>=</span><span class='st'>"long"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 id="building-the-plot">Building the plot</h3>
<h4 id="coordinates-of-the-map-and-data-points">Coordinates of the map and data points</h4>
<p>I use <code>geom_polygon</code> to draw the map of China. The <code>aes</code> argument maps the longitude and latitude columns to the x and y coordinates, respectively. This function is also used to specify the fill and the transparency (alpha) level of the map.</p>
<p>Then I add the data points at the specific locations (defined by their latitude and longitude) with <code>geom_point</code>. Hence, on top of the map, we are plotting a scatterplot where each point represents one city. The size of the point (more specifically, its area) represents its population and its color depicts the relative position of a given city vis-à-vis other cities in the EIU ranking. I then set a black line around the point (<code>shape=21</code>).</p>
<p>Also, <code>coord_map</code> sets the coordinate system for the map by projecting the defined portion of the Earth onto a flat 2D plane.</p>
<p>A title and subtitle are added to replicate the original graph using the <code>labs</code> function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_polygon.html'>geom_polygon</a></span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>China</span>, </span>
<span>               <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>Longitude</span>, y<span class='op'>=</span><span class='va'>Latitude</span>, group<span class='op'>=</span><span class='va'>group</span><span class='op'>)</span>, </span>
<span>               fill<span class='op'>=</span><span class='st'>"cornsilk3"</span>, alpha<span class='op'>=</span><span class='fl'>0.3</span><span class='op'>)</span> <span class='op'>+</span>        </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>fulloutputclean</span>, </span>
<span>             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>Longitude</span>, y<span class='op'>=</span><span class='va'>Latitude</span>, size<span class='op'>=</span><span class='va'>Population</span>, fill<span class='op'>=</span><span class='va'>Ranking</span><span class='op'>)</span>, </span>
<span>             shape<span class='op'>=</span><span class='fl'>21</span>,</span>
<span>             color<span class='op'>=</span><span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span>                               </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_map.html'>coord_map</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"March of the cities"</span>,                                                                   </span>
<span>       subtitle <span class='op'>=</span> <span class='st'>"China, emerging city ranking, 2022"</span>,</span>
<span>       caption<span class='op'>=</span><span class='st'>"Source: EIU"</span><span class='op'>)</span></span>
<span><span class='va'>p</span></span></code></pre>
</div>
<p><img src="100489635_files/figure-html5/unnamed-chunk-8-1.png" width="624" /></p>
</div>
<h4 id="scales">Scales</h4>
<p>Next, the <code>scale_fill_stepsn</code> and <code>scale_size</code> functions are used to customize the appearance of the legends for the color and size aesthetics, respectively.</p>
<p>For the color legend (or rather, fill legend, given our points have borders defined by the ‘color’ argument as introduced in the previous section), we first specify its title and position. We then set the details relating to the ticks and separations between the different boxes of the legend. By means of a drawing tool using the hexadecimal system, we set the color palette. We then set the 7 breaks in the variable ‘Ranking’ so as to create six categories. Note that higher-ranked cities are represented with shades of blue and lower-ranked cities are represented with shades of orange or brown, whereby darker shades of both colors represent the ends of the spectrum.</p>
<p>For the size legend, we do the same as with the color legend regarding the title and the breaks (this time we are specifying 3 breaks). However, in this case, we also set the labels for those breaks. This is because, by default, R uses scientific notation for population but the legend title already informs that values are provided in millions. Finally, we set the range of the size of the bubbles from 0.04 to 6 mm.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_steps.html'>scale_fill_stepsn</a></span><span class='op'>(</span></span>
<span>      guide<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guide_coloursteps.html'>guide_colorsteps</a></span><span class='op'>(</span>title<span class='op'>=</span><span class='st'>"Rank"</span>,</span>
<span>                             title.position<span class='op'>=</span><span class='st'>"top"</span>,</span>
<span>                             ticks <span class='op'>=</span> <span class='cn'>TRUE</span>, </span>
<span>                             show.limits<span class='op'>=</span><span class='cn'>TRUE</span>, </span>
<span>                             ticks.colour<span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>                             ticks.linewidth <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>                             draw.llim <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>                             draw.ulim <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,</span>
<span>      colors<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#1c2c74"</span>, <span class='st'>"#5483b3"</span>, <span class='st'>"#99ccff"</span>, <span class='st'>"#fcdb9b"</span>, <span class='st'>"#fcbc04"</span>, <span class='st'>"#ac6404"</span><span class='op'>)</span>,</span>
<span>      breaks<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>20</span>, <span class='fl'>40</span>, <span class='fl'>60</span>, <span class='fl'>80</span>, <span class='fl'>100</span>, <span class='fl'>106</span><span class='op'>)</span>, </span>
<span>      space<span class='op'>=</span><span class='st'>"Lab"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_size.html'>scale_size</a></span><span class='op'>(</span></span>
<span>      guide<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guide_legend.html'>guide_legend</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Population, 2020, m"</span>, </span>
<span>                        title.position <span class='op'>=</span> <span class='st'>"top"</span><span class='op'>)</span>,</span>
<span>      breaks<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1000000</span>, <span class='fl'>10000000</span>, <span class='fl'>20000000</span><span class='op'>)</span>,</span>
<span>      labels<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"1"</span>, <span class='st'>"10"</span>, <span class='st'>"20"</span><span class='op'>)</span>,</span>
<span>      range<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.04</span>, <span class='fl'>6</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>p2</span></span></code></pre>
</div>
<p><img src="100489635_files/figure-html5/unnamed-chunk-9-1.png" width="624" /></p>
</div>
<h4 id="theme">Theme</h4>
<p>Despite there being a special ‘The Economist’ theme, a completely empty theme (without the default background and axis elements) is what we want and hence we use <code>theme_void()</code>. I first specify the font most closely resembling the one used in the original map. Concerning the title and subtitle, we specify their size, as well as their vertical and horizontal justification. Also using the helping function <code>element_text()</code>, we instruct that the title be bold. We then set the position, direction and justification of the legend so that it is horizontal and gets centered to the north of China (approximately where Mongolia would be). We then specify that both legends be left-justified and set the font size for both the title and the text inside the legend. Finally, we set customized margins around the legend area and set the key width to 9mm, the key height to 3mm and the spacing between keys in the size legend to 0.1mm.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p3</span> <span class='op'>&lt;-</span> <span class='va'>p2</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_void</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>text<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>family<span class='op'>=</span><span class='st'>"IBM Plex Sans"</span><span class='op'>)</span>,</span>
<span>        plot.title<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>face<span class='op'>=</span><span class='st'>"bold"</span>, size<span class='op'>=</span><span class='fl'>22</span>, vjust<span class='op'>=</span><span class='op'>-</span><span class='fl'>8</span>, hjust<span class='op'>=</span><span class='fl'>0.05</span><span class='op'>)</span>, </span>
<span>        plot.subtitle<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>18</span>, vjust<span class='op'>=</span><span class='op'>-</span><span class='fl'>10</span>, hjust<span class='op'>=</span><span class='fl'>0.058</span><span class='op'>)</span>,</span>
<span>        plot.caption<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"gray"</span>, size <span class='op'>=</span> <span class='fl'>17</span>, hjust <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span>,</span>
<span>        legend.position<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.73</span>, <span class='fl'>0.96</span><span class='op'>)</span>,</span>
<span>        legend.direction<span class='op'>=</span><span class='st'>"horizontal"</span>,</span>
<span>        legend.justification<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"right"</span>, <span class='st'>"top"</span><span class='op'>)</span>,</span>
<span>        legend.box.just<span class='op'>=</span><span class='st'>"left"</span>,</span>
<span>        legend.title<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>face<span class='op'>=</span><span class='st'>"bold"</span>, size<span class='op'>=</span><span class='fl'>14</span><span class='op'>)</span>,</span>
<span>        legend.text<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>14</span><span class='op'>)</span>,</span>
<span>        legend.margin<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span>        legend.key.width<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>8</span>, <span class='st'>"mm"</span><span class='op'>)</span>,</span>
<span>        legend.key.height<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>2.5</span>, <span class='st'>"mm"</span><span class='op'>)</span>,</span>
<span>        legend.spacing.x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='st'>'mm'</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>p3</span></span></code></pre>
</div>
<p><img src="100489635_files/figure-html5/unnamed-chunk-10-1.png" width="624" /></p>
</div>
<h4 id="annotations">Annotations</h4>
<p>The last step to replicate the original map is the annotations (for which I will use the <code>annotate()</code> function). While it may appear to be a caption, the text “1=best” is actually inside the plot and hence is introduced as an annotation. For this and the rest of annotations, I specify the type (“text”), set the coordinates (x, y), the label, the size and the font (as well as the vertical and horizontal justification for some).</p>
<p>For the textbox in the lower left corner in the original graph, I created separate annotations for the title in order to be able to set it in bold and with a different color. Further, I separated each of the five cities into different annotations because grouping them together under the same one led to there being too large of a vertical space between them.</p>
<p>For the individual annotations of the eight highest ranked cities on their locations, I simply used the coordinates for each city and adjusted them to be able to see which point corresponds to each label. I also added separate annotations with the lines for those cities that were clustered together. These lines make identifying which label corresponds to each point easier when cities are clustered together, as in the case of Dongguan, Guangzhou and Shenzhen.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p4</span> <span class='op'>&lt;-</span> <span class='va'>p3</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x<span class='op'>=</span><span class='fl'>67</span>, y<span class='op'>=</span><span class='fl'>51</span>, label<span class='op'>=</span><span class='st'>"1=best"</span>, </span>
<span>           size<span class='op'>=</span><span class='fl'>6</span>, family<span class='op'>=</span><span class='st'>"IBM Plex Sans"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x<span class='op'>=</span><span class='fl'>65</span>, y<span class='op'>=</span><span class='fl'>30</span>, label<span class='op'>=</span><span class='st'>"Highest ranked"</span>, </span>
<span>           size<span class='op'>=</span><span class='fl'>5</span>, family<span class='op'>=</span><span class='st'>"IBM Plex Sans"</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, vjust<span class='op'>=</span><span class='fl'>0</span>, angle<span class='op'>=</span><span class='fl'>0</span>,</span>
<span>           fontface<span class='op'>=</span><span class='st'>"bold"</span>, color<span class='op'>=</span><span class='st'>"blue4"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x<span class='op'>=</span><span class='fl'>65</span>, y<span class='op'>=</span><span class='fl'>28</span>, label<span class='op'>=</span><span class='st'>"1  Hangzhou"</span>,</span>
<span>           size<span class='op'>=</span><span class='fl'>5</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, vjust<span class='op'>=</span><span class='fl'>0</span>, family<span class='op'>=</span><span class='st'>"IBM Plex Sans"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x<span class='op'>=</span><span class='fl'>65</span>, y<span class='op'>=</span><span class='fl'>26</span>, label<span class='op'>=</span><span class='st'>"2  Shenzhen"</span>,</span>
<span>           size<span class='op'>=</span><span class='fl'>5</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, vjust<span class='op'>=</span><span class='fl'>0</span>, family<span class='op'>=</span><span class='st'>"IBM Plex Sans"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x<span class='op'>=</span><span class='fl'>65</span>, y<span class='op'>=</span><span class='fl'>24</span>, label<span class='op'>=</span><span class='st'>"3  Shanghai"</span>,</span>
<span>           size<span class='op'>=</span><span class='fl'>5</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, vjust<span class='op'>=</span><span class='fl'>0</span>, family<span class='op'>=</span><span class='st'>"IBM Plex Sans"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x<span class='op'>=</span><span class='fl'>65</span>, y<span class='op'>=</span><span class='fl'>22</span>, label<span class='op'>=</span><span class='st'>"4  Suzhou"</span>, </span>
<span>           size<span class='op'>=</span><span class='fl'>5</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, vjust<span class='op'>=</span><span class='fl'>0</span>, family<span class='op'>=</span><span class='st'>"IBM Plex Sans"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x<span class='op'>=</span><span class='fl'>65</span>, y<span class='op'>=</span><span class='fl'>20</span>, label<span class='op'>=</span><span class='st'>"5  Guangzhou"</span>,</span>
<span>           size<span class='op'>=</span><span class='fl'>5</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, vjust<span class='op'>=</span><span class='fl'>0</span>, family<span class='op'>=</span><span class='st'>"IBM Plex Sans"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x<span class='op'>=</span><span class='fl'>122</span>, y<span class='op'>=</span><span class='fl'>26</span>, label<span class='op'>=</span><span class='st'>"Hangzhou"</span>,</span>
<span>           size<span class='op'>=</span><span class='fl'>6</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, vjust<span class='op'>=</span><span class='fl'>0</span>, family<span class='op'>=</span><span class='st'>"IBM Plex Sans"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x<span class='op'>=</span><span class='fl'>116</span>, y<span class='op'>=</span><span class='fl'>21</span>, label<span class='op'>=</span><span class='st'>"Shenzhen"</span>,</span>
<span>           size<span class='op'>=</span><span class='fl'>6</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, vjust<span class='op'>=</span><span class='fl'>0</span>, family<span class='op'>=</span><span class='st'>"IBM Plex Sans"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x<span class='op'>=</span><span class='fl'>122</span>, y<span class='op'>=</span><span class='fl'>33</span>, label<span class='op'>=</span><span class='st'>"Shanghai"</span>,</span>
<span>           size<span class='op'>=</span><span class='fl'>6</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, vjust<span class='op'>=</span><span class='fl'>0</span>, family<span class='op'>=</span><span class='st'>"IBM Plex Sans"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x<span class='op'>=</span><span class='fl'>114</span>, y<span class='op'>=</span><span class='fl'>29</span>, label<span class='op'>=</span><span class='st'>"Suzhou"</span>,</span>
<span>           size<span class='op'>=</span><span class='fl'>6</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, vjust<span class='op'>=</span><span class='fl'>0</span>, family<span class='op'>=</span><span class='st'>"IBM Plex Sans"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x<span class='op'>=</span><span class='fl'>102</span>, y<span class='op'>=</span><span class='fl'>23</span>, label<span class='op'>=</span><span class='st'>"Guangzhou"</span>,</span>
<span>           size<span class='op'>=</span><span class='fl'>6</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, vjust<span class='op'>=</span><span class='fl'>0</span>, family<span class='op'>=</span><span class='st'>"IBM Plex Sans"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x<span class='op'>=</span><span class='fl'>116</span>, y<span class='op'>=</span><span class='fl'>41</span>,label<span class='op'>=</span><span class='st'>"Beijing"</span>, </span>
<span>           size<span class='op'>=</span><span class='fl'>6</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, vjust<span class='op'>=</span><span class='fl'>0</span>, family<span class='op'>=</span><span class='st'>"IBM Plex Sans"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x<span class='op'>=</span><span class='fl'>123</span>, y<span class='op'>=</span><span class='fl'>29</span>, label<span class='op'>=</span><span class='st'>"Jiaxing"</span>, </span>
<span>           size<span class='op'>=</span><span class='fl'>6</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, vjust<span class='op'>=</span><span class='fl'>0</span>, family<span class='op'>=</span><span class='st'>"IBM Plex Sans"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x<span class='op'>=</span><span class='fl'>110</span>, y<span class='op'>=</span><span class='fl'>26</span>, label<span class='op'>=</span><span class='st'>"Dongguan"</span>,</span>
<span>           size<span class='op'>=</span><span class='fl'>6</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, vjust<span class='op'>=</span><span class='fl'>0</span>, family<span class='op'>=</span><span class='st'>"IBM Plex Sans"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"segment"</span>, x <span class='op'>=</span> <span class='fl'>113</span>, y <span class='op'>=</span> <span class='fl'>25.5</span>, </span>
<span>           xend <span class='op'>=</span> <span class='fl'>113</span>, yend <span class='op'>=</span> <span class='fl'>24</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"segment"</span>, x <span class='op'>=</span> <span class='fl'>110</span>, y <span class='op'>=</span> <span class='fl'>23</span>, </span>
<span>           xend <span class='op'>=</span> <span class='fl'>112.5</span>, yend <span class='op'>=</span> <span class='fl'>23</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"segment"</span>, x <span class='op'>=</span> <span class='fl'>117</span>, y <span class='op'>=</span> <span class='fl'>30</span>, </span>
<span>           xend <span class='op'>=</span> <span class='fl'>120</span>, yend <span class='op'>=</span> <span class='fl'>31.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"segment"</span>, x <span class='op'>=</span> <span class='fl'>123</span>, y <span class='op'>=</span> <span class='fl'>29</span>, </span>
<span>           xend <span class='op'>=</span> <span class='fl'>121</span>, yend <span class='op'>=</span> <span class='fl'>31</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"segment"</span>, x <span class='op'>=</span> <span class='fl'>122</span>, y <span class='op'>=</span> <span class='fl'>27</span>, </span>
<span>           xend <span class='op'>=</span> <span class='fl'>120</span>, yend <span class='op'>=</span> <span class='fl'>30</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>p4</span></span></code></pre>
</div>
<p><img src="100489635_files/figure-html5/unnamed-chunk-11-1.png" width="624" /></p>
</div>
<h2 id="evaluation-and-potential-enhancements">Evaluation and potential enhancements</h2>
<p>Overall, this map is an effective visualization. The title and subtitle are concise and informative of the purpose and object of the map, i.e. showing how, because of urbanization, cities of varying populations on the coast of China have different levels of growth potential as measured by a comprehensive rank score. The underlying map, which does not encode any information, does not distract from the information being shown as it is given a light color. Moreover, the legends are clear. This is especially important in the case of the size legend, which could be problematic since people perceive areas rather than radii as visual features in circles. In this case, the area of the circle seems to be proportional to population and so it correctly provides a reference point for readers to estimate the population of individual cities. Finally, the annotations help readers focus on a small number of cities (eight for on-the-map annotations and five for the annotation on the bottom left corner), which facilitates the understanding of which cities have highest growth potential as well as of their characteristics (namely population and location).</p>
<p>Therefore, the mapping of data into visual features communicates (and thus helps us understand) the “story” the author wants to tell in a clear, precise, efficient and truthful way.</p>
<p>However, there may be some areas of potential improvement. As suggested by the famous author in the field of visualization Edward Tufte, we should seek to maximize the data-ink ratio when displaying data. To that end, we should ask ourselves whether all elements (“ink”) in the chart are necessary to convey our message. In our example, we could set limits for the coordinates (x, y) through the use of the <code>coord_cartesian</code> function. This way, as seen below, we “zoom in” to show the relevant data and remove the area west of meridian 110°. In this, case we would only lose one observation (i.e. one city) and so it may be worth exploring this alternative. Since we have less “unused” space, we could also set the legend background to “white” in order to establish a clear contrast between the legend and the points on the map.</p>
<p>Moreover, despite being a small detail, the choice of the color palette may not be the most appropriate to depict the ordering of cities according to their EIU ranking. There does not seem to be an obvious reason for why stronger colors are assigned to the extremes in the ranking spectrum (i.e. highest- and lowest-ranked cities). Hence, allocating different levels of saturation or lightness of the same hue could be an alternative way of visually conveying the order of cities according to ranking. In the code above, we simply change the last three colors in the ‘scales’ section.</p>
<p>Furthermore, the fact that eight cities are annotated on the map and only five are included in the bottom-left textbox is not too helpful and both annotations seem to include redundant information. By removing the textbox and adding the rank numbers to the cities annotated on the map, we simplify the visualization without removing essential information.</p>
<p>Finally, in order to emphasize the idea that cities with the highest growth potential are on the coast, we might want to insert a vertical line (I use <code>geom_vline()</code>) at the (arbitrary) level of longitude 112°. This way we can see that among the top 10 cities of highest growth potential, only Chengdu is to the west of this longitude.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>xlim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>100</span>, <span class='fl'>135</span><span class='op'>)</span></span>
<span><span class='va'>ylim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>20</span>, <span class='fl'>50</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_polygon.html'>geom_polygon</a></span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>China</span>, </span>
<span>               <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>Longitude</span>, y<span class='op'>=</span><span class='va'>Latitude</span>, group<span class='op'>=</span><span class='va'>group</span><span class='op'>)</span>,</span>
<span>               fill<span class='op'>=</span><span class='st'>"cornsilk3"</span>,</span>
<span>               alpha<span class='op'>=</span><span class='fl'>0.3</span><span class='op'>)</span> <span class='op'>+</span>        </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>fulloutputclean</span>,</span>
<span>             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>Longitude</span>, y<span class='op'>=</span><span class='va'>Latitude</span>, size<span class='op'>=</span><span class='va'>Population</span>, fill<span class='op'>=</span><span class='va'>Ranking</span><span class='op'>)</span>,</span>
<span>             shape<span class='op'>=</span><span class='fl'>21</span>, color<span class='op'>=</span><span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span>                               </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span>xlim<span class='op'>=</span><span class='va'>xlim</span>, ylim<span class='op'>=</span><span class='va'>ylim</span>, expand<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title<span class='op'>=</span><span class='st'>"March of the cities"</span>,                                                                              subtitle<span class='op'>=</span><span class='st'>"China, emerging city ranking, 2022"</span>,</span>
<span>       caption<span class='op'>=</span><span class='st'>"Source: EIU"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_steps.html'>scale_fill_stepsn</a></span><span class='op'>(</span></span>
<span>     guide<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guide_coloursteps.html'>guide_colorsteps</a></span><span class='op'>(</span>title<span class='op'>=</span><span class='st'>"Rank"</span>,</span>
<span>                            title.position<span class='op'>=</span><span class='st'>"top"</span>,</span>
<span>                            ticks <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>                            show.limits<span class='op'>=</span><span class='cn'>TRUE</span>,</span>
<span>                            ticks.colour<span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>                            ticks.linewidth <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>                            draw.llim <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>                            draw.ulim <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, </span>
<span>       colors<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#00008b"</span>, <span class='st'>"#4169e1"</span>, <span class='st'>"#6495ed"</span>, <span class='st'>"#87cefa"</span>, <span class='st'>"#add8e6"</span>, <span class='st'>"#e0ffff"</span><span class='op'>)</span>,</span>
<span>       breaks<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>20</span>, <span class='fl'>40</span>, <span class='fl'>60</span>, <span class='fl'>80</span>, <span class='fl'>100</span>, <span class='fl'>106</span><span class='op'>)</span>,</span>
<span>     space<span class='op'>=</span><span class='st'>"Lab"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_size.html'>scale_size</a></span><span class='op'>(</span></span>
<span>     guide<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guide_legend.html'>guide_legend</a></span><span class='op'>(</span>title<span class='op'>=</span><span class='st'>"Population, 2020, m"</span>,</span>
<span>                        title.position<span class='op'>=</span><span class='st'>"top"</span><span class='op'>)</span>, </span>
<span>     breaks<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1000000</span>, <span class='fl'>10000000</span>, <span class='fl'>20000000</span><span class='op'>)</span>, </span>
<span>     labels<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"1"</span>, <span class='st'>"10"</span>, <span class='st'>"20"</span><span class='op'>)</span>,</span>
<span>     range<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.04</span>, <span class='fl'>6</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_void</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>text<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>family <span class='op'>=</span><span class='st'>"IBM Plex Sans"</span><span class='op'>)</span>,</span>
<span>        plot.title<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>face<span class='op'>=</span><span class='st'>"bold"</span>, size<span class='op'>=</span><span class='fl'>24</span>, </span>
<span>                                vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>14</span>, hjust<span class='op'>=</span><span class='fl'>0.025</span><span class='op'>)</span>,                                    </span>
<span>        plot.subtitle<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>18</span>, </span>
<span>                                   vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>18</span>, hjust<span class='op'>=</span><span class='fl'>0.03</span><span class='op'>)</span>,</span>
<span>        plot.caption<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"gray"</span>, size <span class='op'>=</span> <span class='fl'>17</span>, </span>
<span>                                  hjust <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span>,</span>
<span>        legend.position<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.97</span>, <span class='fl'>1.01</span><span class='op'>)</span>,</span>
<span>        legend.direction<span class='op'>=</span><span class='st'>"horizontal"</span>,</span>
<span>        legend.justification<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"right"</span>, <span class='st'>"top"</span><span class='op'>)</span>,</span>
<span>        legend.box.just<span class='op'>=</span><span class='st'>"left"</span>,</span>
<span>        legend.box.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"white"</span><span class='op'>)</span>,</span>
<span>        legend.margin<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>15</span>, <span class='fl'>5</span>, <span class='fl'>10</span><span class='op'>)</span>,</span>
<span>        legend.key.width<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>12</span>, <span class='st'>"mm"</span><span class='op'>)</span>,</span>
<span>        legend.key.height<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='st'>"mm"</span><span class='op'>)</span>,</span>
<span>        legend.spacing.x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='st'>'mm'</span><span class='op'>)</span>,</span>
<span>        legend.title<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>face<span class='op'>=</span><span class='st'>"bold"</span>, size<span class='op'>=</span><span class='fl'>16</span><span class='op'>)</span>,</span>
<span>        legend.title.align<span class='op'>=</span><span class='fl'>0</span>,</span>
<span>        legend.text<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>16</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x<span class='op'>=</span><span class='fl'>101.7</span>, y<span class='op'>=</span><span class='fl'>44</span>, label<span class='op'>=</span><span class='st'>"1=best"</span>,</span>
<span>           size<span class='op'>=</span><span class='fl'>5</span>, family<span class='op'>=</span><span class='st'>"IBM Plex Sans"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x<span class='op'>=</span><span class='fl'>121</span>, y<span class='op'>=</span><span class='fl'>29</span>, label<span class='op'>=</span> <span class='st'>"(1) Hangzhou"</span>, </span>
<span>           size<span class='op'>=</span><span class='fl'>6</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, vjust<span class='op'>=</span><span class='fl'>0</span>, family<span class='op'>=</span><span class='st'>"IBM Plex Sans"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x<span class='op'>=</span><span class='fl'>115</span>, y<span class='op'>=</span><span class='fl'>22</span>, label<span class='op'>=</span> <span class='st'>"(2) Shenzhen"</span>, </span>
<span>           size<span class='op'>=</span><span class='fl'>6</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, vjust<span class='op'>=</span><span class='fl'>0</span>, family<span class='op'>=</span><span class='st'>"IBM Plex Sans"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x<span class='op'>=</span><span class='fl'>122</span>, y<span class='op'>=</span><span class='fl'>32</span>, label<span class='op'>=</span> <span class='st'>"(3) Shanghai"</span>,</span>
<span>           size<span class='op'>=</span><span class='fl'>6</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, vjust<span class='op'>=</span><span class='fl'>0</span>, family<span class='op'>=</span><span class='st'>"IBM Plex Sans"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x<span class='op'>=</span><span class='fl'>116</span>, y<span class='op'>=</span><span class='fl'>30</span>, label<span class='op'>=</span> <span class='st'>"(4) Suzhou"</span>, </span>
<span>           size<span class='op'>=</span><span class='fl'>6</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, vjust<span class='op'>=</span><span class='fl'>0</span>, family<span class='op'>=</span><span class='st'>"IBM Plex Sans"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x<span class='op'>=</span><span class='fl'>111</span>, y<span class='op'>=</span><span class='fl'>24</span>, label<span class='op'>=</span> <span class='st'>"(5) Guangzhou"</span>, </span>
<span>           size<span class='op'>=</span><span class='fl'>6</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, vjust<span class='op'>=</span><span class='fl'>0</span>, family<span class='op'>=</span><span class='st'>"IBM Plex Sans"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept<span class='op'>=</span><span class='fl'>112</span>, linetype<span class='op'>=</span><span class='st'>"dashed"</span><span class='op'>)</span> </span>
<span></span>
<span><span class='va'>p</span></span></code></pre>
</div>
<p><img src="100489635_files/figure-html5/unnamed-chunk-12-1.png" width="624" /></p>
</div>
<h2 id="alternative-visualization">Alternative visualization</h2>
<p>The final section of this post proposes an alternative visualization to represent the relationship between the population, location and growth potential of cities in China. One possibility is the scatterplot shown below. We plot the ranking on the x-axis and population on the y-axis (this time, by using the <code>scale_y_continuous()</code> function, we change the default scientific notation so that the axis itself shows ‘M’ to represent ‘million’). We also use the <code>geom_point()</code>function. We maintain the title, subtitle and main element themes from the original map.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>fulloutputclean</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>Ranking</span>, y<span class='op'>=</span><span class='va'>Population</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title<span class='op'>=</span><span class='st'>"March of the cities"</span>,                                                                              subtitle<span class='op'>=</span><span class='st'>"China, emerging city ranking, 2022"</span>,</span>
<span>       caption<span class='op'>=</span><span class='st'>"Coastal cities have highest growth potential"</span>,</span>
<span>       x<span class='op'>=</span><span class='st'>"Rank"</span>,</span>
<span>       y<span class='op'>=</span><span class='st'>"Population"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>labels<span class='op'>=</span><span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/label_number_si.html'>label_number_si</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_light</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>text<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>family<span class='op'>=</span><span class='st'>"IBM Plex Sans"</span><span class='op'>)</span>,</span>
<span>        plot.title<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>face<span class='op'>=</span><span class='st'>"bold"</span>, size<span class='op'>=</span><span class='fl'>26</span><span class='op'>)</span>,                                                            plot.subtitle<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>20</span><span class='op'>)</span>,</span>
<span>        plot.caption<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>20</span>, hjust<span class='op'>=</span><span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> </span>
<span><span class='va'>p</span></span></code></pre>
</div>
<p><img src="100489635_files/figure-html5/unnamed-chunk-13-1.png" width="624" /></p>
</div>
<p>However, we still need to include information about the coordinates of cities. Within the location variable, it seems that longitude is the most important factor: cities closer to the coast (i.e. farther east, or higher values of x) appear to have higher growth potential. Therefore, we could encode longitude through the color of the points by highlighting in blue those points representing cities that are located east of the (again, arbitrarily chosen) 112° meridian. I also add a text label (on top of a white rectangle constructed with <code>geom_rect()</code>) to indicate that blue dots represent cities farther to the east in China.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>annotation</span> <span class='op'>&lt;-</span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>fulloutputclean</span>, <span class='va'>Longitude</span><span class='op'>&gt;</span><span class='fl'>112</span><span class='op'>)</span></span>
<span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span> </span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>annotation</span>, color<span class='op'>=</span><span class='st'>"#6495ED"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_tile.html'>geom_rect</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>xmin<span class='op'>=</span><span class='fl'>79</span>, xmax<span class='op'>=</span><span class='fl'>122</span>, ymin<span class='op'>=</span><span class='fl'>15000000</span>, ymax<span class='op'>=</span><span class='fl'>16600000</span><span class='op'>)</span>,</span>
<span>              fill<span class='op'>=</span><span class='st'>"white"</span>,</span>
<span>              color <span class='op'>=</span> <span class='st'>"#6495ED"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fl'>80</span>, y<span class='op'>=</span><span class='fl'>15800000</span>, </span>
<span>                  label<span class='op'>=</span><span class='st'>"Cities to the east of 112th meridian"</span><span class='op'>)</span>,</span>
<span>              size<span class='op'>=</span><span class='fl'>6</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, vjust<span class='op'>=</span><span class='fl'>0</span>, color <span class='op'>=</span> <span class='st'>"#6495ED"</span><span class='op'>)</span></span>
<span><span class='va'>p</span></span></code></pre>
</div>
<p><img src="100489635_files/figure-html5/unnamed-chunk-14-1.png" width="624" /></p>
</div>
<p>Finally, to highlight the top 5 cities from the original map, I construct another annotation and insert it as an argument in the <code>geom_text()</code> function. We can see that highly-ranked cities (i.e. cities with a low score) are all near the coast (i.e. all highlighted in blue, meaning they are east of the 112° meridian), but have rather different population levels. For instance, both Shanghai and Suzhou have very high growth potential, while the former has more than 3.5 times the population of the latter.</p>
<p>Therefore, as the caption suggests, it seems that location (whose effect is hard to separate from other historical, economic and environmental factors) is more important than current population as a predictor of future economic growth.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>annotation2</span> <span class='op'>&lt;-</span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>fulloutputclean</span>, <span class='va'>Ranking</span><span class='op'>&lt;=</span><span class='fl'>5</span><span class='op'>)</span></span>
<span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span><span class='va'>City</span><span class='op'>)</span>,</span>
<span>            <span class='va'>annotation2</span>,</span>
<span>            hjust<span class='op'>=</span><span class='op'>-</span><span class='fl'>0.2</span>, nudge_x<span class='op'>=</span><span class='fl'>0.1</span>, size<span class='op'>=</span><span class='fl'>6</span>,</span>
<span>            family <span class='op'>=</span> <span class='st'>"IBM Plex Sans"</span>,</span>
<span>            fontface<span class='op'>=</span><span class='st'>"bold"</span><span class='op'>)</span> </span>
<span><span class='va'>p</span></span></code></pre>
</div>
<p><img src="100489635_files/figure-html5/unnamed-chunk-15-1.png" width="624" /></p>
</div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
