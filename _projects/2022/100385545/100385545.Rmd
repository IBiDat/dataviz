---
title: "Searches of common jobs: women tend to appear lower than men"
description: |
  A replication of the graph made by Pew Research Center about the topic and another proposal.
categories: "2022"
author: Mario Yanes
date: "`r Sys.Date()`"
output:
  distill::distill_article:
    self_contained: false
    toc: true
---

# Gender equality on online search of jobs?

[A research conducted by the Pew Research Center on December 2018](https://www.pewresearch.org/social-trends/2018/12/17/gender-and-jobs-in-online-image-searches/) showed that inequalities also exists on online search. They represented the obtained data in several graphs, such as the underrepresentation or overrepresentation of women depending on the profession, with a several gap between the results of the search and the actual proportion of women in each occupation. 

But the graph we are going to replicate on this project is the one that shows the average position obtained by the first male or female depending on the profession. Such graph is the following:

![Original graph from [Pew Research Center](https://www.pewresearch.org/social-trends/2018/12/17/gender-and-jobs-in-online-image-searches/pl_18-12-10_across_countries/)](original-graph-pew-research.png){.external width="100%"}

# Let's start with the replication
```{r}
# install.packages(c("tidyverse", "ggplot2")
library(tidyverse)
library(ggplot2)
```

After importing (and installing, if necessary) the libraries needed for this project, the next step is to import the data of the plot. Besides the Pew Research Center didn't publish the dataset they used to the article alongside it, it's pretty simple to generate ourselves a dataframe, as they are integers numbers (the position on a search results page) and 20 professions.

```{r}
df <- data.frame(Profession = c("CEO", "Professor", "Electrical engineer", "Security guard", "Banker", "Clergy", "Industrial engineer", "Bartender", "Musician", "Chef", "Movie director", "Police", "Athlete", "Medical scientist", "Physician", "Pharmacist", "Nurse", "Clerk", "Customer service rep.", "Housekeeper"),
                 Male = c(2, 2, 3, 2, 3, 2, 2, 2, 2, 2, 2, 2, 3, 3, 2, 3, 4, 4, 4, 6),
                 Female = c(16, 13, 10, 8, 9, 8, 7, 7, 6, 6, 6, 5, 5, 4, 3, 3, 4, 3, 2, 2))
```

As for now, we have the data we want to plot. Let's focus on generating the plot. Following the original graph, the position of the first male/female that appears on a web search of a certain job is plotted as a tile. The tile is orange if it's a male, purple if it's a female. 

```{r}
ggplot(df, aes(y=Profession)) + 
  geom_tile(aes(x=Male), fill="orange", color = "orange", width = 0.35, height = 0.7) + 
  geom_tile(aes(x=Female), fill="purple", color = "purple", width = 0.35, height =0.7)
```
At this time, we have one major issues: the first one is that we only plotted the female/male tiles, but the original graph has another 14 white tiles (or 15, on Pharmacist and Nurse, where both gender have the same value), as they represent all the possible values.

## Adding tiles

The way of adding the blank tiles that represent all the possible values was tricky. First of all, my intention was trying to generate them automatically with a given R function, but I was not capable of. Instead, I added to the dataset 16 new variables, one per column, that would fit on the x-axis and be the "empty" tiles. In order from 1 to 16, I added the positions that left. So the entire dataframe resulted on the following:

```{r}
df <- data.frame(Profession = c("CEO", "Professor", "Electrical engineer", "Security guard", "Banker", "Clergy", "Industrial engineer", "Bartender", "Musician", "Chef", "Movie director", "Police", "Athlete", "Medical scientist", "Physician", "Pharmacist", "Nurse", "Clerk", "Customer service rep.", "Housekeeper"),
                 Male = c(2, 2, 3, 2, 3, 2, 2, 2, 2, 2, 2, 2, 3, 3, 2, 3, 4, 4, 4, 6),
                 Female = c(16, 13, 10, 8, 9, 8, 7, 7, 6, 6, 6, 5, 5, 4, 3, 3, 4, 3, 2, 2),
                 position = c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
                 position2 = c(3, 3, 2, 3, 2, 3, 3, 3, 3, 3, 3, 3, 2, 2, 4, 2, 2, 2, 3, 3),
                 position3 = c(4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 4, 3, 5, 5, 4),
                 position4 = c(5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 5, 5, 6, 6, 5),
                 position5 = c(6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 6, 6, 7, 7, 7),
                 position6 = c(7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 7, 7, 8, 8, 8),
                 position7 = c(8, 8, 8, 9, 8, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 8, 8, 9, 9, 9),
                 position8 = c(9, 9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, 9, 10, 10, 10),
                 position9 = c(10, 10, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 10, 10, 11, 11, 11),
                 position10 = c(11, 11, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 11, 11, 12, 12, 12),
                 position11 = c(12, 12, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 12, 12, 13, 13, 13),
                 position12 = c(13, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 13, 13, 14, 14, 14),
                 position13 = c(14, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 14, 14, 15, 15, 15),
                 position14 = c(15, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 15, 15, 16, 16, 16),
                 position15 = c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 16, 16, NA, NA, NA)
                 )

```

## Plot again

Done that, the plot should have now all the needed tiles, both gender and possible positions. So we add to the first code we plotted the `geom_tile()` for each new variable we added to the dataset, as the following:

```{r}
p <- ggplot(df, aes(y=Profession)) + 
  geom_tile(aes(x=Male), fill="orange", color = "orange", width = 0.35, height = 0.7) + 
  geom_tile(aes(x=Female), fill="purple", color = "purple", width = 0.35, height =0.7) +
  geom_tile(aes(x=position), fill="white", color = "grey", width = 0.35, height = 0.7) +
  geom_tile(aes(x=position2), fill="white", color = "grey", width = 0.35, height = 0.7) +
  geom_tile(aes(x=position3), fill="white", color = "grey", width = 0.35, height = 0.7) +
  geom_tile(aes(x=position4), fill="white", color = "grey", width = 0.35, height = 0.7) +
  geom_tile(aes(x=position5), fill="white", color = "grey", width = 0.35, height = 0.7) +
  geom_tile(aes(x=position6), fill="white", color = "grey", width = 0.35, height = 0.7) +
  geom_tile(aes(x=position7), fill="white", color = "grey", width = 0.35, height = 0.7) +
  geom_tile(aes(x=position8), fill="white", color = "grey", width = 0.35, height = 0.7) +
  geom_tile(aes(x=position9), fill="white", color = "grey", width = 0.35, height = 0.7) +
  geom_tile(aes(x=position10), fill="white", color = "grey", width = 0.35, height = 0.7) +
  geom_tile(aes(x=position11), fill="white", color = "grey", width = 0.35, height = 0.7) +
  geom_tile(aes(x=position12), fill="white", color = "grey", width = 0.35, height = 0.7) +
  geom_tile(aes(x=position13), fill="white", color = "grey", width = 0.35, height = 0.7) +
  geom_tile(aes(x=position14), fill="white", color = "grey", width = 0.35, height = 0.7) +
  geom_tile(aes(x=position15), fill="white", color = "grey", width = 0.35, height = 0.7)

```

; and the second one is that our y-axis (Professions) are arranged alphabetically in ascending order.

## Rearrange y-axis

This graph has the essential parts of the original one. Nonetheless, the order of the y-axis is not the same, besides we created the dataframe following, from top to bottom, the graph of the Pew Research Center. To fix that, we can use the function `scale_y_discrete(limits = rev(df$Profession)`. We can also use the `scale_y_discrete()` function to add some space at the top of the grid, as we will needed it for the title and the subtitle:
```{r}
p + 
  geom_tile(aes(x=Male), fill="orange", color = "orange", width = 0.35, height = 0.7) + 
  geom_tile(aes(x=Female), fill="purple", color = "purple", width = 0.35, height =0.7) +
  geom_tile(aes(x=position), fill="white", color = "grey", width = 0.35, height = 0.7) +
  geom_tile(aes(x=position2), fill="white", color = "grey", width = 0.35, height = 0.7) +
  geom_tile(aes(x=position3), fill="white", color = "grey", width = 0.35, height = 0.7) +
  geom_tile(aes(x=position4), fill="white", color = "grey", width = 0.35, height = 0.7) +
  geom_tile(aes(x=position5), fill="white", color = "grey", width = 0.35, height = 0.7) +
  geom_tile(aes(x=position6), fill="white", color = "grey", width = 0.35, height = 0.7) +
  geom_tile(aes(x=position7), fill="white", color = "grey", width = 0.35, height = 0.7) +
  geom_tile(aes(x=position8), fill="white", color = "grey", width = 0.35, height = 0.7) +
  geom_tile(aes(x=position9), fill="white", color = "grey", width = 0.35, height = 0.7) +
  geom_tile(aes(x=position10), fill="white", color = "grey", width = 0.35, height = 0.7) +
  geom_tile(aes(x=position11), fill="white", color = "grey", width = 0.35, height = 0.7) +
  geom_tile(aes(x=position12), fill="white", color = "grey", width = 0.35, height = 0.7) +
  geom_tile(aes(x=position13), fill="white", color = "grey", width = 0.35, height = 0.7) +
  geom_tile(aes(x=position14), fill="white", color = "grey", width = 0.35, height = 0.7) +
  geom_tile(aes(x=position15), fill="white", color = "grey", width = 0.35, height = 0.7) +
  scale_fill_manual(values=c(position ="white",
                             Male ="orange",
                             Female = "purple")) +
  scale_y_discrete(limits = rev(df$Profession), expand = expansion(mult = c(0, 0.1)))
```

## Aesthetic and themes
Now we have a graph that follows the original one in its factor form, but we have to modify the appearence to achieve the replica.
First of all, they removed the axis title of both y and x-axis. Also, the title and the subtitle of the plot, and one important thing: the legend. The legend is added to the graph in a particularly way: Male and Female are not together in a traditional box or something like that, as they are on top of the corresponding first tile. So, instead of using `labs` or another related function, we insert "Male" and "Female" as an annotation. With the extra space we gave to the top of the grid, the words are not cut by the space of the subtitle.

```{r}
p + labs(
    x = "",
    y = "",
    title = "Women appear lower in image\nsearch results for common jobs\nacross countries",
    subtitle = "Average position of the first man or woman\nin image search results for ... "
  ) +
  annotate("text", x = 2, y = 21, label = "Male", size = 3, color = "orange", fontface = 2, family = "Arial") +
  annotate("text", x = 16, y = 21, label = "Female", size = 3, color = "purple", fontface = 2, family = "Arial")
```

The trickiest thing we tended to solve is the tiles of Pharmacist and Nurse, the only ones where Male and Female have the same value. The closest approach was generating an annotation with a rectangle (instead of a triangle, as it was impossible to achieve):
```{r}
p +
  annotate("rect", xmin = 3.05, xmax = 3.2, ymin = 4.65, ymax = 5.3, alpha = 1, color = "orange", fill = "orange") +
  annotate("rect", xmin = 4.05, xmax = 4.2, ymin = 3.65, ymax = 4.3, alpha = 1, color = "orange", fill = "orange") 
```

Finally, we adjust the things related to the themes. The grid has to be completely white and without borders, the axis ticks and line dissapear and we try to have the same font family as the original one, as well of adjusting on the horizontal axis the title and the subtitle.
```{r}
p + theme_light() +
  theme(
  panel.background = element_blank(),
  panel.grid = element_line(size = 0.25, color = "white"),
  axis.ticks = element_blank(),
  axis.line = element_blank(),
  panel.border = element_blank(),
  axis.text = element_text(family = "Times New Roman"),
  plot.title = element_text(face = "bold", family = "Arial", hjust = 0),
  plot.subtitle = element_text(color = "grey", face = "italic", family = "Times New Roman", hjust = 0, vjust = 4),
  plot.caption = element_text(hjust = 0)
) 

```



```{r}






