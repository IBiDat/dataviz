<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
<title>Data visualization | MSc CSS: Energy Generation by Fuel Type</title>

<meta property="description" itemprop="description" content="Using the Energy Institute’s data to reproduce Bloomberg’s chart and to provide an alternative representation."/>

<link rel="canonical" href="https://csslab.uc3m.es/dataviz/projects/2023/100513254/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2024-01-14"/>
<meta property="article:created" itemprop="dateCreated" content="2024-01-14"/>
<meta name="article:author" content="Giorgio Rivoli"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Data visualization | MSc CSS: Energy Generation by Fuel Type"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Using the Energy Institute’s data to reproduce Bloomberg’s chart and to provide an alternative representation."/>
<meta property="og:url" content="https://csslab.uc3m.es/dataviz/projects/2023/100513254/"/>
<meta property="og:image" content="https://csslab.uc3m.es/dataviz/projects/2023/100513254/100513254_files/figure-html5/unnamed-chunk-15-1.png"/>
<meta property="og:image:width" content="1910"/>
<meta property="og:image:height" content="1881"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Data visualization | MSc CSS"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="Data visualization | MSc CSS: Energy Generation by Fuel Type"/>
<meta property="twitter:description" content="Using the Energy Institute’s data to reproduce Bloomberg’s chart and to provide an alternative representation."/>
<meta property="twitter:url" content="https://csslab.uc3m.es/dataviz/projects/2023/100513254/"/>
<meta property="twitter:image" content="https://csslab.uc3m.es/dataviz/projects/2023/100513254/100513254_files/figure-html5/unnamed-chunk-15-1.png"/>
<meta property="twitter:image:width" content="1910"/>
<meta property="twitter:image:height" content="1881"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="Data visualization | MSc CSS: Energy Generation by Fuel Type"/>
<meta name="citation_fulltext_html_url" content="https://csslab.uc3m.es/dataviz/projects/2023/100513254/"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2024/01/14"/>
<meta name="citation_publication_date" content="2024/01/14"/>
<meta name="citation_author" content="Giorgio Rivoli"/>
<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["creative_commons","title","description","categories","author","date","output","citation_url","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["CC BY"]},{"type":"character","attributes":{},"value":["Energy Generation by Fuel Type"]},{"type":"character","attributes":{},"value":["Using the Energy Institute’s data to reproduce Bloomberg’s chart and to provide an alternative representation."]},{"type":"character","attributes":{},"value":["2023"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Giorgio Rivoli"]}]}]},{"type":"character","attributes":{},"value":["2024-01-14"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["https://csslab.uc3m.es/dataviz/projects/2023/100513254/"]},{"type":"character","attributes":{},"value":["https://csslab.uc3m.es/dataviz/projects/2023/100513254/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["100513254_files/figure-html5/unnamed-chunk-10-1.png","100513254_files/figure-html5/unnamed-chunk-12-1.png","100513254_files/figure-html5/unnamed-chunk-13-1.png","100513254_files/figure-html5/unnamed-chunk-14-1.png","100513254_files/figure-html5/unnamed-chunk-15-1.png","100513254_files/figure-html5/unnamed-chunk-17-1.png","100513254_files/figure-html5/unnamed-chunk-18-1.png","100513254_files/figure-html5/unnamed-chunk-19-1.png","100513254_files/figure-html5/unnamed-chunk-20-1.png","100513254_files/figure-html5/unnamed-chunk-21-1.png","100513254_files/figure-html5/unnamed-chunk-22-1.png","100513254_files/figure-html5/unnamed-chunk-23-1.png","100513254_files/figure-html5/unnamed-chunk-24-1.png","100513254_files/figure-html5/unnamed-chunk-25-1.png","100513254_files/figure-html5/unnamed-chunk-6-1.png","100513254_files/figure-html5/unnamed-chunk-8-1.png","100513254_files/figure-html5/unnamed-chunk-9-1.png","Data.xlsx","flags/China.png","flags/Germany.png","flags/India.png","flags/Indonesia.png","flags/Japan.png","flags/Malaysia.png","flags/Mexico.png","flags/South Korea.png","flags/Taiwan.png","flags/Thailand.png","flags/UK.png","flags/USA.png","flags/Vietnam.png","original.png"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../../site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"/>
<link href="../../../site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

hr.section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  margin: 0px;
}


d-byline {
  border-top: none;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
  border-top: none;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

/* tweak for Pandoc numbered line within distill */
d-article pre.numberSource code > span {
    left: -2em;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // separator
  var separator = '<hr class="section-separator" style="clear: both"/>';
  // prepend separator above appendix
  $('.d-byline').before(separator);
  $('.d-article').before(separator);

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme, except when numbering line
  // in code chunk
  $('pre:not(.numberLines) code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      var author_name = front_matter.authors[i].author
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */

@import url('https://fonts.googleapis.com/css2?family=Questrial');

html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    "Questrial", sans-serif;
  --mono-font:       monospace;
  --body-font:       "Questrial", sans-serif;
  --navbar-font:     "Questrial", sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #000e78;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #000e78;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */

@media screen and (min-width: 768px) {
  d-article aside {
    height: 0;
  }
  aside.slides {
    margin-left: -148px;
    height: auto;
  }
  aside.slides + h2 {
    white-space: nowrap;
  }
}

d-article li {
  margin-bottom: 0.1em;
}

.posts-list .post-preview .thumbnail {
  max-height: 300px;
  overflow: hidden;
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../../site_libs/header-attrs-2.25/header-attrs.js"></script>
  <script src="../../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Energy Generation by Fuel Type","description":"Using the Energy Institute’s data to reproduce Bloomberg’s chart and to provide an alternative representation.","authors":[{"author":"Giorgio Rivoli","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2024-01-14T00:00:00.000+01:00","citationText":"Rivoli, 2024"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<span class="logo">
<img src="../../../assets/acronimo_0.png"/>
</span>
<a href="../../../index.html" class="title">Data visualization | MSc CSS</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../../contents.html">Contents</a>
<a href="../../../tutorials.html">Tutorials</a>
<a href="../../../resources.html">Resources</a>
<a href="../../../projects.html">Projects</a>
<a href="https://github.com/IBiDat/dataviz" aria-label="Link to source">
<i class="fab fa-github" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Energy Generation by Fuel Type</h1>

<!--radix_placeholder_categories-->
<div class="dt-tags">
  <a href="../../../projects.html#category:2023" class="dt-tag">2023</a>
</div>
<!--/radix_placeholder_categories-->
<p><p>Using the Energy Institute’s data to reproduce Bloomberg’s chart and to provide an alternative representation.</p></p>
</div>

<div class="d-byline">
  
  Giorgio Rivoli
  
<br/>2024-01-14
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#libraries-and-data" id="toc-libraries-and-data">Libraries and data</a></li>
<li><a href="#replicating-the-chart" id="toc-replicating-the-chart">Replicating the chart</a>
<ul>
<li><a href="#construction-of-the-circular-chart" id="toc-construction-of-the-circular-chart">Construction of the circular chart</a></li>
<li><a href="#colored-areas" id="toc-colored-areas">Colored areas</a></li>
<li><a href="#annotate" id="toc-annotate">Annotate</a></li>
<li><a href="#flags" id="toc-flags">Flags</a></li>
<li><a href="#comments" id="toc-comments">Comments</a></li>
<li><a href="#title-and-legend" id="toc-title-and-legend">Title and legend</a></li>
<li><a href="#theme" id="toc-theme">Theme</a></li>
</ul></li>
<li><a href="#alternative-version" id="toc-alternative-version">Alternative version</a>
<ul>
<li><a href="#libraries-and-data-1" id="toc-libraries-and-data-1">Libraries and data</a></li>
<li><a href="#coordinates-and-axes" id="toc-coordinates-and-axes">Coordinates and axes</a></li>
</ul></li>
</ul>
</nav>
</div>
<p>In September 2023, Bloomberg published an article titled <a href="https://www.bloomberg.com/graphics/2023-opinion-apple-supply-chain-climate-change/">“Apple’s Supply Chain Is on a Collision Course With Climate Change”</a>. Within this article, the supplier countries of the Cupertino-based company are examined. Specifically, for each of these countries, based on data from the <a href="https://www.energyinst.org/__data/assets/pdf_file/0004/1055542/EI_Stat_Review_PDF_single_3.pdf">Energy Institute</a>, the resources used to produce their energy are highlighted. The results are depicted in the following graph:</p>
<figure>
<img src="original.png" class="external" style="width:100.0%" alt="Energy generation by fuel type. Source: Bloomberg" />
<figcaption aria-hidden="true">Energy generation by fuel type. Source: <a href="https://www.bloomberg.com/graphics/2023-opinion-apple-supply-chain-climate-change/">Bloomberg</a></figcaption>
</figure>
<p>The purpose of this project is to replicate this graph as faithfully as possible and subsequently provide an alternative representation of the data.</p>
<h2 id="libraries-and-data">Libraries and data</h2>
<p>Regarding the libraries used, we aimed to limit the use primarily to “ggplot2”. However, due to specific aspects of the graph, it was necessary to import additional libraries. As for the data, as previously mentioned, we referred to the <a href="https://www.energyinst.org/__data/assets/pdf_file/0004/1055542/EI_Stat_Review_PDF_single_3.pdf">“Statistical Review of World Energy”</a> report by the Energy Institute. Given that this report spans over 60 pages and includes data not only for the countries featured in our graph, we proceeded to transcribe the relevant data into an Excel file. Nonetheless, the imported data serves solely an informative purpose because constructing the graph required manually inputting this data, albeit relying on the aforementioned Excel file.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://www.rforge.net/png/'>png</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>grid</span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://readxl.tidyverse.org'>readxl</a></span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span><span class='st'>"Data.xlsx"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h2 id="replicating-the-chart">Replicating the chart</h2>
<h3 id="construction-of-the-circular-chart">Construction of the circular chart</h3>
<p>First of all, we need to build the base of our chart. This consists of a larger circumference with three concentric circles inside, each progressively smaller. Additionally, there are also 13 equidistant spokes, one for each of the countries of interest. Initially, we assign three different variables to the number of circumferences, the number of points for each circumference, and the number of spokes. Additionally, we create a variable to which we assign a vector containing the names of the countries that will be displayed in our chart.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>num_circles</span> <span class='op'>&lt;-</span> <span class='fl'>4</span></span>
<span><span class='va'>num_points</span> <span class='op'>&lt;-</span> <span class='fl'>100</span></span>
<span><span class='va'>num_rays</span> <span class='op'>&lt;-</span> <span class='fl'>13</span></span>
<span></span>
<span><span class='va'>countries</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Indonesia"</span>, <span class='st'>"India"</span>, <span class='st'>"Mainland China"</span>, </span>
<span>               <span class='st'>"Mexico"</span>, <span class='st'>"South Korea"</span>, <span class='st'>"Japan"</span>, </span>
<span>               <span class='st'>"US"</span>, <span class='st'>"Vietnam"</span>, <span class='st'>"Germany"</span>, </span>
<span>               <span class='st'>"UK"</span>, <span class='st'>"Thailand"</span>, <span class='st'>"Taiwan"</span>, <span class='st'>"Malaysia"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Afterwards, we use a function that allows us to generate our concentric circles.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>generate_concentric_circles</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>num_circles</span>, <span class='va'>num_points</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='va'>circles_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='va'>num_circles</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>i</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>r</span> <span class='op'>&lt;-</span> <span class='va'>i</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>num_circles</span> <span class='op'>+</span> <span class='fl'>1</span><span class='op'>)</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>      x <span class='op'>=</span> <span class='va'>r</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>cos</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>2</span> <span class='op'>*</span> <span class='va'>pi</span>, length.out <span class='op'>=</span> <span class='va'>num_points</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>      y <span class='op'>=</span> <span class='va'>r</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>sin</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>2</span> <span class='op'>*</span> <span class='va'>pi</span>, length.out <span class='op'>=</span> <span class='va'>num_points</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>      radius <span class='op'>=</span> <span class='va'>r</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>}</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/do.call.html'>do.call</a></span><span class='op'>(</span><span class='va'>rbind</span>, <span class='va'>circles_data</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span></code></pre>
</div>
</div>
<p>In the following code, we have a function that displays equidistant spokes originating from the center of the circle. Moreover, each spoke is associated with the name of a country from the ‘countries’ vector.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>generate_rays</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>num_rays</span>, <span class='va'>max_radius</span>, <span class='va'>countries</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='va'>angle</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>2</span> <span class='op'>*</span> <span class='va'>pi</span>, length.out <span class='op'>=</span> <span class='va'>num_rays</span> <span class='op'>+</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>cos</a></span><span class='op'>(</span><span class='va'>angle</span><span class='op'>)</span> <span class='op'>*</span> <span class='va'>max_radius</span>,</span>
<span>    y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>sin</a></span><span class='op'>(</span><span class='va'>angle</span><span class='op'>)</span> <span class='op'>*</span> <span class='va'>max_radius</span>,</span>
<span>    country <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='va'>countries</span><span class='op'>)</span>  <span class='co'># Inverte l'ordine dei paesi</span></span>
<span>  <span class='op'>)</span></span>
<span><span class='op'>}</span></span></code></pre>
</div>
</div>
<p>After that, we store within three different variables the data necessary to construct our circular chart.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>circles_data</span> <span class='op'>&lt;-</span> <span class='fu'>generate_concentric_circles</span><span class='op'>(</span><span class='va'>num_circles</span>, <span class='va'>num_points</span><span class='op'>)</span></span>
<span><span class='va'>max_radius</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>circles_data</span><span class='op'>$</span><span class='va'>radius</span><span class='op'>)</span></span>
<span><span class='va'>rays_data</span> <span class='op'>&lt;-</span> <span class='fu'>generate_rays</span><span class='op'>(</span><span class='va'>num_rays</span>, <span class='va'>max_radius</span>, <span class='va'>countries</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Finally, we proceed with the graphical representation of what has been done so far.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>gg_circle</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_polygon.html'>geom_polygon</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>circles_data</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, group <span class='op'>=</span> <span class='va'>radius</span><span class='op'>)</span>, fill <span class='op'>=</span> <span class='st'>"gray92"</span>, </span>
<span>               color <span class='op'>=</span> <span class='st'>"gray"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_path</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>circles_data</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span>, color <span class='op'>=</span> <span class='st'>"gray"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>rays_data</span>, <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>+</span> <span class='va'>y</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>&lt;=</span> <span class='va'>max_radius</span><span class='op'>)</span>, </span>
<span>               <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>0</span>, y <span class='op'>=</span> <span class='fl'>0</span>, xend <span class='op'>=</span> <span class='va'>x</span>, yend <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span>, color <span class='op'>=</span> <span class='st'>"white"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>gg_circle</span></span></code></pre>
</div>
<p><img src="100513254_files/figure-html5/unnamed-chunk-6-1.png" width="528" style="display: block; margin: auto;" /></p>
</div>
<h3 id="colored-areas">Colored areas</h3>
<p>We now proceed with constructing the chart, adding colored areas that represent the resources used by various countries for energy production. This phase has been the most complex of the project. In fact, we experimented with several approaches, including the ‘geom_area’ option, for creating the colored areas, but none of them yielded satisfactory results. Ultimately, we chose to use “geom_polygon.” However, the main issue with using geom_polygon is that each colored area is composed of numerous small sections. This not only made the code inevitably longer but also resulted in the areas being slightly more square-shaped and less rounded compared to the original.</p>
<p>To create the aforementioned areas, we first created four lists, one for each colored area. Within each list, there are coordinates for each country that represent the individual colored sections. These, when summed together, will constitute the entire area.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>black_areas</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span></span>
<span>  thailand_coal <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.023</span>, <span class='fl'>0.18</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.15</span>, <span class='fl'>0.275</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  taiwan_coal <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.18</span>, <span class='fl'>0.275</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.275</span>, <span class='fl'>0.14</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  malaysia_coal <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.275</span>, <span class='fl'>0.5</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.14</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  indonesia_coal <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.5</span>, <span class='fl'>0.53</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='op'>-</span><span class='fl'>0.277</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  india_coal <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.53</span>, <span class='fl'>0.275</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='op'>-</span><span class='fl'>0.277</span>, <span class='op'>-</span><span class='fl'>0.4</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  china_coal <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.275</span>, <span class='fl'>0.008</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='op'>-</span><span class='fl'>0.4</span>, <span class='op'>-</span><span class='fl'>0.035</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  mexico_coal <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.008</span>, <span class='op'>-</span><span class='fl'>0.082</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='op'>-</span><span class='fl'>0.035</span>, <span class='op'>-</span><span class='fl'>0.225</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  south_korea_coal <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='op'>-</span><span class='fl'>0.082</span>, <span class='op'>-</span><span class='fl'>0.177</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='op'>-</span><span class='fl'>0.225</span>, <span class='op'>-</span><span class='fl'>0.16</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  japan_coal <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='op'>-</span><span class='fl'>0.177</span>, <span class='op'>-</span><span class='fl'>0.152</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='op'>-</span><span class='fl'>0.16</span>, <span class='op'>-</span><span class='fl'>0.04</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  us_coal <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='op'>-</span><span class='fl'>0.152</span>, <span class='op'>-</span><span class='fl'>0.3</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='op'>-</span><span class='fl'>0.04</span>, <span class='fl'>0.075</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  vietnam_coal <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='op'>-</span><span class='fl'>0.3</span>, <span class='op'>-</span><span class='fl'>0.18</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.075</span>, <span class='fl'>0.162</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  germany_coal <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='op'>-</span><span class='fl'>0.18</span>, <span class='op'>-</span><span class='fl'>0.01</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.162</span>, <span class='fl'>0.025</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  uk_coal <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='op'>-</span><span class='fl'>0.01</span>, <span class='fl'>0.023</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.025</span>, <span class='fl'>0.15</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>gray_area</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span></span>
<span>  thailand_gas <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.023</span>, <span class='fl'>0.18</span>, <span class='fl'>0.362</span>, <span class='fl'>0.075</span><span class='op'>)</span>, </span>
<span>                            y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.15</span>, <span class='fl'>0.275</span>, <span class='fl'>0.525</span>, <span class='fl'>0.65</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  taiwan_gas <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.18</span>, <span class='fl'>0.275</span>, <span class='fl'>0.55</span>, <span class='fl'>0.362</span><span class='op'>)</span>, </span>
<span>                          y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.275</span>, <span class='fl'>0.14</span>, <span class='fl'>0.28</span>, <span class='fl'>0.525</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  malaysia_gas <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.275</span>, <span class='fl'>0.5</span>, <span class='fl'>0.625</span>, <span class='fl'>0.55</span><span class='op'>)</span>, </span>
<span>                            y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.14</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0.28</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  indonesia_gas <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>0.53</span>, <span class='fl'>0.53</span>, <span class='fl'>0.625</span><span class='op'>)</span>, </span>
<span>                             y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='op'>-</span><span class='fl'>0.277</span>, <span class='op'>-</span><span class='fl'>0.285</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  india_gas <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.53</span>, <span class='fl'>0.275</span>, <span class='fl'>0.3</span>, <span class='fl'>0.53</span><span class='op'>)</span>, </span>
<span>                         y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.277</span>, <span class='op'>-</span><span class='fl'>0.4</span>, <span class='op'>-</span><span class='fl'>0.4</span>, <span class='op'>-</span><span class='fl'>0.285</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  china_gas <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.275</span>, <span class='fl'>0.008</span>, <span class='fl'>0.06</span>, <span class='fl'>0.3</span><span class='op'>)</span>, </span>
<span>                         y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.4</span>, <span class='op'>-</span><span class='fl'>0.035</span>, <span class='op'>-</span><span class='fl'>0.5</span>, <span class='op'>-</span><span class='fl'>0.4</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  mexico_gas <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.008</span>, <span class='op'>-</span><span class='fl'>0.082</span>, <span class='op'>-</span><span class='fl'>0.175</span>, <span class='fl'>0.06</span><span class='op'>)</span>, </span>
<span>                          y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.035</span>, <span class='op'>-</span><span class='fl'>0.225</span>, <span class='op'>-</span><span class='fl'>0.475</span>, <span class='op'>-</span><span class='fl'>0.5</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  south_korea_gas <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.082</span>, <span class='op'>-</span><span class='fl'>0.177</span>, <span class='op'>-</span><span class='fl'>0.37</span>, <span class='op'>-</span><span class='fl'>0.175</span><span class='op'>)</span>, </span>
<span>                               y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.225</span>, <span class='op'>-</span><span class='fl'>0.16</span>, <span class='op'>-</span><span class='fl'>0.33</span>, <span class='op'>-</span><span class='fl'>0.475</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  japana_gas <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.177</span>, <span class='op'>-</span><span class='fl'>0.152</span>, <span class='op'>-</span><span class='fl'>0.45</span>, <span class='op'>-</span><span class='fl'>0.37</span><span class='op'>)</span>, </span>
<span>                          y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.16</span>, <span class='op'>-</span><span class='fl'>0.04</span>, <span class='op'>-</span><span class='fl'>0.117</span>, <span class='op'>-</span><span class='fl'>0.33</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  us_gas <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.152</span>, <span class='op'>-</span><span class='fl'>0.3</span>, <span class='op'>-</span><span class='fl'>0.38</span>, <span class='op'>-</span><span class='fl'>0.45</span><span class='op'>)</span>, </span>
<span>                      y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.04</span>, <span class='fl'>0.075</span>, <span class='fl'>0.095</span>, <span class='op'>-</span><span class='fl'>0.117</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  vietnam_gas <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.3</span>, <span class='op'>-</span><span class='fl'>0.18</span>, <span class='op'>-</span><span class='fl'>0.28</span>, <span class='op'>-</span><span class='fl'>0.38</span><span class='op'>)</span>, </span>
<span>                           y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.075</span>, <span class='fl'>0.162</span>, <span class='fl'>0.25</span>, <span class='fl'>0.095</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  germany_gas <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.18</span>, <span class='op'>-</span><span class='fl'>0.01</span>, <span class='op'>-</span><span class='fl'>0.14</span>, <span class='op'>-</span><span class='fl'>0.28</span><span class='op'>)</span>, </span>
<span>                           y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.162</span>, <span class='fl'>0.025</span>, <span class='fl'>0.35</span>, <span class='fl'>0.25</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  uk_gas <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.01</span>, <span class='fl'>0.023</span>, <span class='fl'>0.075</span>, <span class='op'>-</span><span class='fl'>0.14</span><span class='op'>)</span>, </span>
<span>                      y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.025</span>, <span class='fl'>0.15</span>, <span class='fl'>0.65</span>, <span class='fl'>0.35</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>blue_area</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span></span>
<span>  thailand_ren <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.075</span>, <span class='fl'>0.362</span>, <span class='fl'>0.4</span>, <span class='fl'>0.097</span><span class='op'>)</span>, </span>
<span>                            y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.65</span>, <span class='fl'>0.525</span>, <span class='fl'>0.575</span>, <span class='fl'>0.78</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  taiwan_ren <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.362</span>, <span class='fl'>0.55</span>, <span class='fl'>0.7</span>, <span class='fl'>0.4</span><span class='op'>)</span>, </span>
<span>                          y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.525</span>, <span class='fl'>0.28</span>, <span class='fl'>0.37</span>, <span class='fl'>0.575</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>  malaysia_ren <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.55</span>, <span class='fl'>0.625</span>, <span class='fl'>0.77</span>, <span class='fl'>0.7</span><span class='op'>)</span>, </span>
<span>                            y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.28</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0.37</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  indonesia_ren <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.625</span>, <span class='fl'>0.525</span>, <span class='fl'>0.675</span>, <span class='fl'>0.77</span><span class='op'>)</span>, </span>
<span>                             y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='op'>-</span><span class='fl'>0.285</span>, <span class='op'>-</span><span class='fl'>0.35</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  india_ren <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.525</span>, <span class='fl'>0.26</span>, <span class='fl'>0.425</span>, <span class='fl'>0.675</span><span class='op'>)</span>, </span>
<span>                         y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.285</span>, <span class='op'>-</span><span class='fl'>0.415</span>, <span class='op'>-</span><span class='fl'>0.62</span>, <span class='op'>-</span><span class='fl'>0.35</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  china_ren <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.26</span>, <span class='fl'>0.06</span>, <span class='fl'>0.076</span>, <span class='fl'>0.425</span><span class='op'>)</span>, </span>
<span>                         y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.415</span>, <span class='op'>-</span><span class='fl'>0.5</span>, <span class='op'>-</span><span class='fl'>0.67</span>, <span class='op'>-</span><span class='fl'>0.62</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  mexico_ren <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.06</span>, <span class='op'>-</span><span class='fl'>0.175</span>, <span class='op'>-</span><span class='fl'>0.242</span>, <span class='fl'>0.076</span><span class='op'>)</span>, </span>
<span>                          y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.5</span>, <span class='op'>-</span><span class='fl'>0.475</span>, <span class='op'>-</span><span class='fl'>0.625</span>, <span class='op'>-</span><span class='fl'>0.67</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  south_korea_ren <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.175</span>, <span class='op'>-</span><span class='fl'>0.40</span>, <span class='op'>-</span><span class='fl'>0.5</span>, <span class='op'>-</span><span class='fl'>0.23</span><span class='op'>)</span>, </span>
<span>                               y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.475</span>, <span class='op'>-</span><span class='fl'>0.30</span>, <span class='op'>-</span><span class='fl'>0.45</span>, <span class='op'>-</span><span class='fl'>0.625</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  japan_ren <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.376</span>, <span class='op'>-</span><span class='fl'>0.45</span>, <span class='op'>-</span><span class='fl'>0.625</span>, <span class='op'>-</span><span class='fl'>0.5</span><span class='op'>)</span>, </span>
<span>                         y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.32</span>, <span class='op'>-</span><span class='fl'>0.117</span>, <span class='op'>-</span><span class='fl'>0.15</span>, <span class='op'>-</span><span class='fl'>0.45</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  us_ren <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.45</span>, <span class='op'>-</span><span class='fl'>0.38</span>, <span class='op'>-</span><span class='fl'>0.775</span>, <span class='op'>-</span><span class='fl'>0.625</span><span class='op'>)</span>, </span>
<span>                      y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.117</span>, <span class='fl'>0.1</span>, <span class='fl'>0.186</span>, <span class='op'>-</span><span class='fl'>0.15</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  vietnam_ren <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.38</span>, <span class='op'>-</span><span class='fl'>0.28</span>, <span class='op'>-</span><span class='fl'>0.55</span>, <span class='op'>-</span><span class='fl'>0.775</span><span class='op'>)</span>, </span>
<span>                           y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.25</span>, <span class='fl'>0.482</span>, <span class='fl'>0.186</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  germany_ren <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.28</span>, <span class='op'>-</span><span class='fl'>0.141</span>, <span class='op'>-</span><span class='fl'>0.242</span>, <span class='op'>-</span><span class='fl'>0.55</span><span class='op'>)</span>, </span>
<span>                           y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.25</span>, <span class='fl'>0.35</span>, <span class='fl'>0.63</span>, <span class='fl'>0.482</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  uk_ren <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.141</span>, <span class='fl'>0.075</span>, <span class='fl'>0.097</span>, <span class='op'>-</span><span class='fl'>0.242</span><span class='op'>)</span>, </span>
<span>                      y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.35</span>, <span class='fl'>0.65</span>, <span class='fl'>0.78</span>, <span class='fl'>0.63</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>yellow_ocra_area</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span></span>
<span>  indonesia_nuc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.77</span>, <span class='fl'>0.675</span>, <span class='fl'>0.707</span>, <span class='fl'>0.77</span><span class='op'>)</span>, </span>
<span>                             y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='op'>-</span><span class='fl'>0.35</span>, <span class='op'>-</span><span class='fl'>0.37</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  india_nuc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.675</span>, <span class='fl'>0.425</span>, <span class='fl'>0.45</span>, <span class='fl'>0.707</span><span class='op'>)</span>, </span>
<span>                         y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.35</span>, <span class='op'>-</span><span class='fl'>0.62</span>, <span class='op'>-</span><span class='fl'>0.65</span>, <span class='op'>-</span><span class='fl'>0.37</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  china_nuc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.425</span>, <span class='fl'>0.076</span>, <span class='fl'>0.081</span>, <span class='fl'>0.45</span><span class='op'>)</span>, </span>
<span>                         y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.62</span>, <span class='op'>-</span><span class='fl'>0.67</span>, <span class='op'>-</span><span class='fl'>0.68</span>, <span class='op'>-</span><span class='fl'>0.65</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  mexico_nuc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.076</span>, <span class='op'>-</span><span class='fl'>0.255</span>, <span class='op'>-</span><span class='fl'>0.275</span>, <span class='fl'>0.081</span><span class='op'>)</span>, </span>
<span>                          y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.67</span>, <span class='op'>-</span><span class='fl'>0.615</span>, <span class='op'>-</span><span class='fl'>0.735</span>, <span class='op'>-</span><span class='fl'>0.68</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  japan_nuc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.24</span>, <span class='op'>-</span><span class='fl'>0.5</span>, <span class='op'>-</span><span class='fl'>0.54</span>, <span class='op'>-</span><span class='fl'>0.275</span><span class='op'>)</span>, </span>
<span>                         y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.615</span>, <span class='op'>-</span><span class='fl'>0.45</span>, <span class='op'>-</span><span class='fl'>0.475</span>, <span class='op'>-</span><span class='fl'>0.725</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  us_nuc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.5</span>, <span class='op'>-</span><span class='fl'>0.625</span>, <span class='op'>-</span><span class='fl'>0.76</span>, <span class='op'>-</span><span class='fl'>0.54</span><span class='op'>)</span>, </span>
<span>                      y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.45</span>, <span class='op'>-</span><span class='fl'>0.15</span>, <span class='op'>-</span><span class='fl'>0.183</span>, <span class='op'>-</span><span class='fl'>0.475</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  vietnam_nuc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.625</span>, <span class='op'>-</span><span class='fl'>0.775</span>, <span class='op'>-</span><span class='fl'>0.775</span>, <span class='op'>-</span><span class='fl'>0.76</span><span class='op'>)</span>, </span>
<span>                           y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.15</span>, <span class='fl'>0.186</span>, <span class='fl'>0.186</span>, <span class='op'>-</span><span class='fl'>0.183</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  germany_nuc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.775</span>, <span class='op'>-</span><span class='fl'>0.55</span>, <span class='op'>-</span><span class='fl'>0.575</span>, <span class='op'>-</span><span class='fl'>0.775</span><span class='op'>)</span>, </span>
<span>                           y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.186</span>, <span class='fl'>0.482</span>, <span class='fl'>0.51</span>, <span class='fl'>0.186</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  uk_nuc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.55</span>, <span class='op'>-</span><span class='fl'>0.242</span>, <span class='op'>-</span><span class='fl'>0.275</span>, <span class='op'>-</span><span class='fl'>0.575</span><span class='op'>)</span>, </span>
<span>                      y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.482</span>, <span class='fl'>0.63</span>, <span class='fl'>0.72</span>, <span class='fl'>0.51</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  thailand_nuc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.242</span>, <span class='fl'>0.097</span>, <span class='fl'>0.097</span>, <span class='op'>-</span><span class='fl'>0.275</span><span class='op'>)</span>, </span>
<span>                            y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.63</span>, <span class='fl'>0.78</span>, <span class='fl'>0.78</span>, <span class='fl'>0.72</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  taiwan_nuc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.097</span>, <span class='fl'>0.4</span>, <span class='fl'>0.44</span>, <span class='fl'>0.097</span><span class='op'>)</span>, </span>
<span>                          y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.78</span>, <span class='fl'>0.575</span>, <span class='fl'>0.645</span>, <span class='fl'>0.78</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  malaysia_nuc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.4</span>, <span class='fl'>0.7</span>, <span class='fl'>0.7</span>, <span class='fl'>0.44</span><span class='op'>)</span>, </span>
<span>                            y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.575</span>, <span class='fl'>0.37</span>, <span class='fl'>0.37</span>, <span class='fl'>0.645</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>After doing this, we can visualize the graphical outcome.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>gg_areas</span> <span class='op'>&lt;-</span> <span class='va'>gg_circle</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>black_areas</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>area</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_polygon.html'>geom_polygon</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>area</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span>, fill <span class='op'>=</span> <span class='st'>"black"</span>, color <span class='op'>=</span> <span class='st'>"black"</span>, alpha <span class='op'>=</span> <span class='fl'>0.9</span><span class='op'>)</span></span>
<span><span class='op'>}</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>gray_area</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>area</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_polygon.html'>geom_polygon</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>area</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span>, fill <span class='op'>=</span> <span class='st'>"dimgray"</span>, color <span class='op'>=</span> <span class='st'>"dimgray"</span>, alpha <span class='op'>=</span> <span class='fl'>0.9</span><span class='op'>)</span>  </span>
<span>  <span class='op'>}</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>blue_area</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>area</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_polygon.html'>geom_polygon</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>area</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span>, fill <span class='op'>=</span> <span class='st'>"blue1"</span>, color <span class='op'>=</span> <span class='st'>"blue1"</span>, alpha <span class='op'>=</span> <span class='fl'>0.9</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>yellow_ocra_area</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>area</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_polygon.html'>geom_polygon</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>area</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span>, fill <span class='op'>=</span> <span class='st'>"gold3"</span>, color <span class='op'>=</span> <span class='st'>"gold3"</span>, alpha <span class='op'>=</span> <span class='fl'>0.9</span><span class='op'>)</span>  </span>
<span>  <span class='op'>}</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>gg_areas</span></span></code></pre>
</div>
<p><img src="100513254_files/figure-html5/unnamed-chunk-8-1.png" width="528" style="display: block; margin: auto;" /></p>
</div>
<h3 id="annotate">Annotate</h3>
<p>Given that we have created the main core of our graph, let’s now proceed by adding all the details. Before doing so, in order to avoid potential display issues with some elements, we will adjust the dimensions of our graph by expanding the axes.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>gg_exp</span> <span class='op'>&lt;-</span> <span class='va'>gg_areas</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_fixed.html'>coord_fixed</a></span><span class='op'>(</span>expand <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>, limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1.2</span>, <span class='fl'>1.2</span><span class='op'>)</span>, </span>
<span>                     breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1.2</span>, <span class='fl'>1.2</span>, by <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>, limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1.2</span>, <span class='fl'>1.2</span><span class='op'>)</span>, </span>
<span>                     breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1.2</span>, <span class='fl'>1.2</span>, by <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>gg_exp</span></span></code></pre>
</div>
<p><img src="100513254_files/figure-html5/unnamed-chunk-9-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<p>Once done, let’s proceed to add various elements using ‘annotate’. Initially, we’ll add country names outside the circumference, near the reference radius. Then, we’ll add points and lines to highlight a particular energy resource. Finally, above each respective circumference, we’ll add the percentages 25%, 50%, 75%, and 100%, enhancing the interpretability of the graph.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>gg_det</span> <span class='op'>&lt;-</span> <span class='va'>gg_exp</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.415</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.795</span>, label <span class='op'>=</span> <span class='st'>"South Korea"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3.7</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.68</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.557</span>, label <span class='op'>=</span> <span class='st'>"Japan"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3.7</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>0.162</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.848</span>, label <span class='op'>=</span> <span class='st'>"Mexico"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3.7</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>0.62</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.7</span>, label <span class='op'>=</span> <span class='st'>"Mainland China"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3.7</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>0.79</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.395</span>, label <span class='op'>=</span> <span class='st'>"India"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3.7</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>0.088</span>, y <span class='op'>=</span> <span class='fl'>0.843</span>, label <span class='op'>=</span> <span class='st'>"Thailand"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3.7</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.325</span>, y <span class='op'>=</span> <span class='fl'>0.794</span>, label <span class='op'>=</span> <span class='st'>"UK"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3.7</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.71</span>, y <span class='op'>=</span> <span class='fl'>0.575</span>, label <span class='op'>=</span> <span class='st'>"Germany"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3.7</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.884</span>, y <span class='op'>=</span> <span class='fl'>0.215</span>, label <span class='op'>=</span> <span class='st'>"Vietnam"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3.7</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.843</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.188</span>, label <span class='op'>=</span> <span class='st'>"US"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3.7</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>0.52</span>, y <span class='op'>=</span> <span class='fl'>0.71</span>, label <span class='op'>=</span> <span class='st'>"Taiwan"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3.7</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>0.818</span>, y <span class='op'>=</span> <span class='fl'>0.407</span>, label <span class='op'>=</span> <span class='st'>"Malaysia"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3.7</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>0.92</span>, y <span class='op'>=</span> <span class='fl'>0.0079</span>, label <span class='op'>=</span> <span class='st'>"Indonesia"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3.7</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"point"</span>, x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.27</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.73</span>, size <span class='op'>=</span> <span class='fl'>2</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"point"</span>, x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.37</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.33</span>, size <span class='op'>=</span> <span class='fl'>2</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"point"</span>, x <span class='op'>=</span> <span class='fl'>0.078</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.67</span>, size <span class='op'>=</span> <span class='fl'>2</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"point"</span>, x <span class='op'>=</span> <span class='fl'>0.275</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.395</span>, size <span class='op'>=</span> <span class='fl'>2</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"point"</span>, x <span class='op'>=</span> <span class='fl'>0.525</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.276</span>, size <span class='op'>=</span> <span class='fl'>2</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"point"</span>, x <span class='op'>=</span> <span class='fl'>0.075</span>, y <span class='op'>=</span> <span class='fl'>0.645</span>, size <span class='op'>=</span> <span class='fl'>2</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"point"</span>, x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.242</span>, y <span class='op'>=</span> <span class='fl'>0.63</span>, size <span class='op'>=</span> <span class='fl'>2</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"point"</span>, x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.55</span>, y <span class='op'>=</span> <span class='fl'>0.482</span>, size <span class='op'>=</span> <span class='fl'>2</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"point"</span>, x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.775</span>, y <span class='op'>=</span> <span class='fl'>0.186</span>, size <span class='op'>=</span> <span class='fl'>2</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"segment"</span>, x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.27</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.73</span>, xend <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.29</span>, </span>
<span>           yend <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.775</span>, color <span class='op'>=</span> <span class='st'>"black"</span>, size <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"segment"</span>, x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.37</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.33</span>, xend <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.61</span>, </span>
<span>           yend <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.54</span>, color <span class='op'>=</span> <span class='st'>"black"</span>, size <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"segment"</span>, x <span class='op'>=</span> <span class='fl'>0.078</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.67</span>, xend <span class='op'>=</span> <span class='fl'>0.1</span>, </span>
<span>           yend <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.815</span>, color <span class='op'>=</span> <span class='st'>"black"</span>, size <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"segment"</span>, x <span class='op'>=</span> <span class='fl'>0.275</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.395</span>, xend <span class='op'>=</span> <span class='fl'>0.47</span>, </span>
<span>           yend <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.67</span>, color <span class='op'>=</span> <span class='st'>"black"</span>, size <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"segment"</span>, x <span class='op'>=</span> <span class='fl'>0.525</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.276</span>, xend <span class='op'>=</span> <span class='fl'>0.732</span>, </span>
<span>           yend <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.38</span>, color <span class='op'>=</span> <span class='st'>"black"</span>, size <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"segment"</span>, x <span class='op'>=</span> <span class='fl'>0.075</span>, y <span class='op'>=</span> <span class='fl'>0.645</span>, xend <span class='op'>=</span> <span class='fl'>0.0935</span>, </span>
<span>           yend <span class='op'>=</span> <span class='fl'>0.81</span>, color <span class='op'>=</span> <span class='st'>"black"</span>, size <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"segment"</span>, x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.242</span>, y <span class='op'>=</span> <span class='fl'>0.63</span>, xend <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.29</span>, </span>
<span>           yend <span class='op'>=</span> <span class='fl'>0.765</span>, color <span class='op'>=</span> <span class='st'>"black"</span>, size <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"segment"</span>, x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.55</span>, y <span class='op'>=</span> <span class='fl'>0.482</span>, xend <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.61</span>, </span>
<span>           yend <span class='op'>=</span> <span class='fl'>0.54</span>, color <span class='op'>=</span> <span class='st'>"black"</span>, size <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"segment"</span>, x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.775</span>, y <span class='op'>=</span> <span class='fl'>0.186</span>, xend <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.798</span>, </span>
<span>           yend <span class='op'>=</span> <span class='fl'>0.192</span>, color <span class='op'>=</span> <span class='st'>"black"</span>, size <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"segment"</span>, x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.76</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.183</span>, xend <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.8</span>, </span>
<span>           yend <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.196</span>, color <span class='op'>=</span> <span class='st'>"black"</span>, size <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"segment"</span>, x <span class='op'>=</span> <span class='fl'>0.44</span>, y <span class='op'>=</span> <span class='fl'>0.645</span>, xend <span class='op'>=</span> <span class='fl'>0.462</span>, </span>
<span>           yend <span class='op'>=</span> <span class='fl'>0.68</span>, color <span class='op'>=</span> <span class='st'>"black"</span>, size <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"segment"</span>, x <span class='op'>=</span> <span class='fl'>0.7</span>, y <span class='op'>=</span> <span class='fl'>0.37</span>, xend <span class='op'>=</span> <span class='fl'>0.722</span>, </span>
<span>           yend <span class='op'>=</span> <span class='fl'>0.383</span>, color <span class='op'>=</span> <span class='st'>"black"</span>, size <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"segment"</span>, x <span class='op'>=</span> <span class='fl'>0.77</span>, y <span class='op'>=</span> <span class='fl'>0</span>, xend <span class='op'>=</span> <span class='fl'>0.816</span>, </span>
<span>           yend <span class='op'>=</span> <span class='fl'>0</span>, color <span class='op'>=</span> <span class='st'>"black"</span>, size <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>gg_det</span></span></code></pre>
</div>
<p><img src="100513254_files/figure-html5/unnamed-chunk-10-1.png" width="921.6" style="display: block; margin: auto;" /></p>
</div>
<h3 id="flags">Flags</h3>
<p>Now that we’ve added the country names, we can also include the flags. In this regard, the following code aims to import and position the flags correctly next to their respective country names. After saving the flag images in PNG format within a folder, we import them using ‘readPNG’. Subsequently, for each flag, we specify the desired coordinates on both the X and Y axes. Finally, we also indicate the dimensions we want to assign to each image.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>uk_flag</span><span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='st'>"flags/UK.png"</span><span class='op'>)</span></span>
<span><span class='va'>uk_flag_x</span> <span class='op'>&lt;-</span> <span class='op'>-</span><span class='fl'>0.403</span></span>
<span><span class='va'>uk_flag_y</span> <span class='op'>&lt;-</span> <span class='fl'>0.803</span></span>
<span><span class='va'>uk_flag_width</span> <span class='op'>&lt;-</span> <span class='fl'>0.08</span></span>
<span></span>
<span><span class='va'>thai_flag</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='st'>"flags/Thailand.png"</span><span class='op'>)</span></span>
<span><span class='va'>thai_flag_x</span> <span class='op'>&lt;-</span> <span class='fl'>0.21</span></span>
<span><span class='va'>thai_flag_y</span> <span class='op'>&lt;-</span> <span class='fl'>0.843</span></span>
<span><span class='va'>thai_flag_width</span> <span class='op'>&lt;-</span> <span class='fl'>0.08</span></span>
<span></span>
<span><span class='va'>taiwan_flag</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='st'>"flags/Taiwan.png"</span><span class='op'>)</span></span>
<span><span class='va'>taiwan_flag_x</span> <span class='op'>&lt;-</span> <span class='fl'>0.635</span></span>
<span><span class='va'>taiwan_flag_y</span> <span class='op'>&lt;-</span> <span class='fl'>0.715</span></span>
<span><span class='va'>taiwan_flag_width</span> <span class='op'>&lt;-</span> <span class='fl'>0.08</span></span>
<span></span>
<span><span class='va'>mal_flag</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='st'>"flags/Malaysia.png"</span><span class='op'>)</span></span>
<span><span class='va'>mal_flag_x</span> <span class='op'>&lt;-</span> <span class='fl'>0.95</span></span>
<span><span class='va'>mal_flag_y</span> <span class='op'>&lt;-</span> <span class='fl'>0.41</span></span>
<span><span class='va'>mal_flag_width</span> <span class='op'>&lt;-</span> <span class='fl'>0.084</span></span>
<span></span>
<span><span class='va'>india_flag</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='st'>"flags/India.png"</span><span class='op'>)</span></span>
<span><span class='va'>india_flag_x</span> <span class='op'>&lt;-</span> <span class='fl'>0.89</span></span>
<span><span class='va'>india_flag_y</span> <span class='op'>&lt;-</span> <span class='op'>-</span><span class='fl'>0.397</span></span>
<span><span class='va'>india_flag_width</span> <span class='op'>&lt;-</span> <span class='fl'>0.08</span></span>
<span></span>
<span><span class='va'>china_flag</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='st'>"flags/China.png"</span><span class='op'>)</span></span>
<span><span class='va'>china_flag_x</span> <span class='op'>&lt;-</span> <span class='fl'>0.814</span></span>
<span><span class='va'>china_flag_y</span> <span class='op'>&lt;-</span> <span class='op'>-</span><span class='fl'>0.7</span></span>
<span><span class='va'>china_flag_width</span> <span class='op'>&lt;-</span> <span class='fl'>0.077</span></span>
<span></span>
<span><span class='va'>mex_flag</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='st'>"flags/Mexico.png"</span><span class='op'>)</span></span>
<span><span class='va'>mex_flag_x</span> <span class='op'>&lt;-</span> <span class='fl'>0.285</span></span>
<span><span class='va'>mex_flag_y</span> <span class='op'>&lt;-</span> <span class='op'>-</span><span class='fl'>0.85</span></span>
<span><span class='va'>mex_flag_width</span> <span class='op'>&lt;-</span> <span class='fl'>0.08</span></span>
<span></span>
<span><span class='va'>sk_flag</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='st'>"flags/South Korea.png"</span><span class='op'>)</span></span>
<span><span class='va'>sk_flag_x</span> <span class='op'>&lt;-</span> <span class='op'>-</span><span class='fl'>0.588</span></span>
<span><span class='va'>sk_flag_y</span> <span class='op'>&lt;-</span> <span class='op'>-</span><span class='fl'>0.796</span></span>
<span><span class='va'>sk_flag_width</span> <span class='op'>&lt;-</span> <span class='fl'>0.094</span></span>
<span></span>
<span><span class='va'>jap_flag</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='st'>"flags/Japan.png"</span><span class='op'>)</span></span>
<span><span class='va'>jap_flag_x</span> <span class='op'>&lt;-</span> <span class='op'>-</span><span class='fl'>0.79</span></span>
<span><span class='va'>jap_flag_y</span> <span class='op'>&lt;-</span> <span class='op'>-</span><span class='fl'>0.557</span></span>
<span><span class='va'>jap_flag_width</span> <span class='op'>&lt;-</span> <span class='fl'>0.085</span></span>
<span></span>
<span><span class='va'>us_flag</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='st'>"flags/USA.png"</span><span class='op'>)</span></span>
<span><span class='va'>us_flag_x</span> <span class='op'>&lt;-</span> <span class='op'>-</span><span class='fl'>0.93</span></span>
<span><span class='va'>us_flag_y</span> <span class='op'>&lt;-</span> <span class='op'>-</span><span class='fl'>0.19</span></span>
<span><span class='va'>us_flag_width</span> <span class='op'>&lt;-</span> <span class='fl'>0.085</span></span>
<span></span>
<span><span class='va'>viet_flag</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='st'>"flags/Vietnam.png"</span><span class='op'>)</span></span>
<span><span class='va'>viet_flag_x</span> <span class='op'>&lt;-</span> <span class='op'>-</span><span class='fl'>1.012</span></span>
<span><span class='va'>viet_flag_y</span> <span class='op'>&lt;-</span> <span class='fl'>0.217</span></span>
<span><span class='va'>viet_flag_width</span> <span class='op'>&lt;-</span> <span class='fl'>0.08</span></span>
<span></span>
<span><span class='va'>ger_flag</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='st'>"flags/Germany.png"</span><span class='op'>)</span></span>
<span><span class='va'>ger_flag_x</span> <span class='op'>&lt;-</span> <span class='op'>-</span><span class='fl'>0.848</span></span>
<span><span class='va'>ger_flag_y</span> <span class='op'>&lt;-</span> <span class='fl'>0.574</span></span>
<span><span class='va'>ger_flag_width</span> <span class='op'>&lt;-</span> <span class='fl'>0.08</span></span>
<span></span>
<span><span class='va'>indonesia_flag</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='st'>"flags/Indonesia.png"</span><span class='op'>)</span></span>
<span><span class='va'>indonesia_flag_x</span> <span class='op'>&lt;-</span> <span class='fl'>1.06</span></span>
<span><span class='va'>indonesia_flag_y</span> <span class='op'>&lt;-</span> <span class='fl'>0.01</span></span>
<span><span class='va'>indonesia_flag_width</span> <span class='op'>&lt;-</span> <span class='fl'>0.08</span></span></code></pre>
</div>
</div>
<p>Once that’s done, with ‘annotate_custom’, we can display the flags within our graph.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>gg_flag</span> <span class='op'>&lt;-</span> <span class='va'>gg_det</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_custom.html'>annotation_custom</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/grid/grid.raster.html'>rasterGrob</a></span><span class='op'>(</span><span class='va'>uk_flag</span>, interpolate <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,</span>
<span>    xmin <span class='op'>=</span> <span class='va'>uk_flag_x</span> <span class='op'>-</span> <span class='va'>uk_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    xmax <span class='op'>=</span> <span class='va'>uk_flag_x</span> <span class='op'>+</span> <span class='va'>uk_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    ymin <span class='op'>=</span> <span class='va'>uk_flag_y</span> <span class='op'>-</span> <span class='va'>uk_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>, </span>
<span>    ymax <span class='op'>=</span> <span class='va'>uk_flag_y</span> <span class='op'>+</span> <span class='va'>uk_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_custom.html'>annotation_custom</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/grid/grid.raster.html'>rasterGrob</a></span><span class='op'>(</span><span class='va'>thai_flag</span>, interpolate <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,</span>
<span>    xmin <span class='op'>=</span> <span class='va'>thai_flag_x</span> <span class='op'>-</span> <span class='va'>thai_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    xmax <span class='op'>=</span> <span class='va'>thai_flag_x</span> <span class='op'>+</span> <span class='va'>thai_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    ymin <span class='op'>=</span> <span class='va'>thai_flag_y</span> <span class='op'>-</span> <span class='va'>thai_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>, </span>
<span>    ymax <span class='op'>=</span> <span class='va'>thai_flag_y</span> <span class='op'>+</span> <span class='va'>thai_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_custom.html'>annotation_custom</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/grid/grid.raster.html'>rasterGrob</a></span><span class='op'>(</span><span class='va'>taiwan_flag</span>, interpolate <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,</span>
<span>    xmin <span class='op'>=</span> <span class='va'>taiwan_flag_x</span> <span class='op'>-</span> <span class='va'>taiwan_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    xmax <span class='op'>=</span> <span class='va'>taiwan_flag_x</span> <span class='op'>+</span> <span class='va'>taiwan_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    ymin <span class='op'>=</span> <span class='va'>taiwan_flag_y</span> <span class='op'>-</span> <span class='va'>taiwan_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>, </span>
<span>    ymax <span class='op'>=</span> <span class='va'>taiwan_flag_y</span> <span class='op'>+</span> <span class='va'>taiwan_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_custom.html'>annotation_custom</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/grid/grid.raster.html'>rasterGrob</a></span><span class='op'>(</span><span class='va'>mal_flag</span>, interpolate <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,</span>
<span>    xmin <span class='op'>=</span> <span class='va'>mal_flag_x</span> <span class='op'>-</span> <span class='va'>mal_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    xmax <span class='op'>=</span> <span class='va'>mal_flag_x</span> <span class='op'>+</span> <span class='va'>mal_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    ymin <span class='op'>=</span> <span class='va'>mal_flag_y</span> <span class='op'>-</span> <span class='va'>mal_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>, </span>
<span>    ymax <span class='op'>=</span> <span class='va'>mal_flag_y</span> <span class='op'>+</span> <span class='va'>mal_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_custom.html'>annotation_custom</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/grid/grid.raster.html'>rasterGrob</a></span><span class='op'>(</span><span class='va'>india_flag</span>, interpolate <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,</span>
<span>    xmin <span class='op'>=</span> <span class='va'>india_flag_x</span> <span class='op'>-</span> <span class='va'>india_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    xmax <span class='op'>=</span> <span class='va'>india_flag_x</span> <span class='op'>+</span> <span class='va'>india_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    ymin <span class='op'>=</span> <span class='va'>india_flag_y</span> <span class='op'>-</span> <span class='va'>india_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>, </span>
<span>    ymax <span class='op'>=</span> <span class='va'>india_flag_y</span> <span class='op'>+</span> <span class='va'>india_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_custom.html'>annotation_custom</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/grid/grid.raster.html'>rasterGrob</a></span><span class='op'>(</span><span class='va'>china_flag</span>, interpolate <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,</span>
<span>    xmin <span class='op'>=</span> <span class='va'>china_flag_x</span> <span class='op'>-</span> <span class='va'>china_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    xmax <span class='op'>=</span> <span class='va'>china_flag_x</span> <span class='op'>+</span> <span class='va'>china_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    ymin <span class='op'>=</span> <span class='va'>china_flag_y</span> <span class='op'>-</span> <span class='va'>china_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>, </span>
<span>    ymax <span class='op'>=</span> <span class='va'>china_flag_y</span> <span class='op'>+</span> <span class='va'>china_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_custom.html'>annotation_custom</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/grid/grid.raster.html'>rasterGrob</a></span><span class='op'>(</span><span class='va'>mex_flag</span>, interpolate <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,</span>
<span>    xmin <span class='op'>=</span> <span class='va'>mex_flag_x</span> <span class='op'>-</span> <span class='va'>mex_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    xmax <span class='op'>=</span> <span class='va'>mex_flag_x</span> <span class='op'>+</span> <span class='va'>mex_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    ymin <span class='op'>=</span> <span class='va'>mex_flag_y</span> <span class='op'>-</span> <span class='va'>mex_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>, </span>
<span>    ymax <span class='op'>=</span> <span class='va'>mex_flag_y</span> <span class='op'>+</span> <span class='va'>mex_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_custom.html'>annotation_custom</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/grid/grid.raster.html'>rasterGrob</a></span><span class='op'>(</span><span class='va'>sk_flag</span>, interpolate <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,</span>
<span>    xmin <span class='op'>=</span> <span class='va'>sk_flag_x</span> <span class='op'>-</span> <span class='va'>sk_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    xmax <span class='op'>=</span> <span class='va'>sk_flag_x</span> <span class='op'>+</span> <span class='va'>sk_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    ymin <span class='op'>=</span> <span class='va'>sk_flag_y</span> <span class='op'>-</span> <span class='va'>sk_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>, </span>
<span>    ymax <span class='op'>=</span> <span class='va'>sk_flag_y</span> <span class='op'>+</span> <span class='va'>sk_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_custom.html'>annotation_custom</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/grid/grid.raster.html'>rasterGrob</a></span><span class='op'>(</span><span class='va'>jap_flag</span>, interpolate <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,</span>
<span>    xmin <span class='op'>=</span> <span class='va'>jap_flag_x</span> <span class='op'>-</span> <span class='va'>jap_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    xmax <span class='op'>=</span> <span class='va'>jap_flag_x</span> <span class='op'>+</span> <span class='va'>jap_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    ymin <span class='op'>=</span> <span class='va'>jap_flag_y</span> <span class='op'>-</span> <span class='va'>jap_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>, </span>
<span>    ymax <span class='op'>=</span> <span class='va'>jap_flag_y</span> <span class='op'>+</span> <span class='va'>jap_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_custom.html'>annotation_custom</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/grid/grid.raster.html'>rasterGrob</a></span><span class='op'>(</span><span class='va'>us_flag</span>, interpolate <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,</span>
<span>    xmin <span class='op'>=</span> <span class='va'>us_flag_x</span> <span class='op'>-</span> <span class='va'>us_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    xmax <span class='op'>=</span> <span class='va'>us_flag_x</span> <span class='op'>+</span> <span class='va'>us_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    ymin <span class='op'>=</span> <span class='va'>us_flag_y</span> <span class='op'>-</span> <span class='va'>us_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>, </span>
<span>    ymax <span class='op'>=</span> <span class='va'>us_flag_y</span> <span class='op'>+</span> <span class='va'>us_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_custom.html'>annotation_custom</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/grid/grid.raster.html'>rasterGrob</a></span><span class='op'>(</span><span class='va'>viet_flag</span>, interpolate <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,</span>
<span>    xmin <span class='op'>=</span> <span class='va'>viet_flag_x</span> <span class='op'>-</span> <span class='va'>viet_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    xmax <span class='op'>=</span> <span class='va'>viet_flag_x</span> <span class='op'>+</span> <span class='va'>viet_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    ymin <span class='op'>=</span> <span class='va'>viet_flag_y</span> <span class='op'>-</span> <span class='va'>viet_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>, </span>
<span>    ymax <span class='op'>=</span> <span class='va'>viet_flag_y</span> <span class='op'>+</span> <span class='va'>viet_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_custom.html'>annotation_custom</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/grid/grid.raster.html'>rasterGrob</a></span><span class='op'>(</span><span class='va'>ger_flag</span>, interpolate <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,</span>
<span>    xmin <span class='op'>=</span> <span class='va'>ger_flag_x</span> <span class='op'>-</span> <span class='va'>ger_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    xmax <span class='op'>=</span> <span class='va'>ger_flag_x</span> <span class='op'>+</span> <span class='va'>ger_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    ymin <span class='op'>=</span> <span class='va'>ger_flag_y</span> <span class='op'>-</span> <span class='va'>ger_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>, </span>
<span>    ymax <span class='op'>=</span> <span class='va'>ger_flag_y</span> <span class='op'>+</span> <span class='va'>ger_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_custom.html'>annotation_custom</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/grid/grid.raster.html'>rasterGrob</a></span><span class='op'>(</span><span class='va'>indonesia_flag</span>, interpolate <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,</span>
<span>    xmin <span class='op'>=</span> <span class='va'>indonesia_flag_x</span> <span class='op'>-</span> <span class='va'>indonesia_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    xmax <span class='op'>=</span> <span class='va'>indonesia_flag_x</span> <span class='op'>+</span> <span class='va'>indonesia_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    ymin <span class='op'>=</span> <span class='va'>indonesia_flag_y</span> <span class='op'>-</span> <span class='va'>indonesia_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span>, </span>
<span>    ymax <span class='op'>=</span> <span class='va'>indonesia_flag_y</span> <span class='op'>+</span> <span class='va'>indonesia_flag_width</span> <span class='op'>/</span> <span class='fl'>2</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='va'>gg_flag</span></span></code></pre>
</div>
<p><img src="100513254_files/figure-html5/unnamed-chunk-12-1.png" width="921.6" style="display: block; margin: auto;" /></p>
</div>
<h3 id="comments">Comments</h3>
<p>After doing that, let’s add comments related to nine out of the thirteen countries present in the graph. To do this, first, we’ll save the textual descriptions in different variables. Then, using ‘annotate’, we’ll position the comments next to their respective countries.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>text_thai</span> <span class='op'>&lt;-</span> <span class='st'>"Thailand generates 84% of its energy     \nfrom fossil fuels, mostly from natural gas"</span></span>
<span></span>
<span><span class='va'>text_indonesia</span> <span class='op'>&lt;-</span> <span class='st'>"Coal comprises 62% of \nIndonesia's energy mix "</span></span>
<span></span>
<span><span class='va'>text_india</span> <span class='op'>&lt;-</span> <span class='st'>"India and China get most of their  \nenergy from coal at 74% and 61%"</span></span>
<span></span>
<span><span class='va'>text_mexico</span> <span class='op'>&lt;-</span> <span class='st'>"Mexico uses very little col and  \ngets is energy from gas at 56%\nand renewables at 24%           "</span></span>
<span></span>
<span><span class='va'>text_sk</span> <span class='op'>&lt;-</span> <span class='st'>"Nuclear makes up 28% \nSouth Korea's energy generation               "</span></span>
<span></span>
<span><span class='va'>text_japan</span> <span class='op'>&lt;-</span> <span class='st'>"Nearly two thirds of Japan's \nenergy is from gas and coal"</span></span>
<span></span>
<span><span class='va'>text_viet</span> <span class='op'>&lt;-</span> <span class='st'>"Half of Vietnam's energy         \nis from renewables"</span></span>
<span></span>
<span><span class='va'>text_germany</span> <span class='op'>&lt;-</span> <span class='st'>"41% of UK's and 44% of Germany's \n           energy are from renewables"</span></span>
<span></span>
<span><span class='va'>gg_com</span> <span class='op'>&lt;-</span> <span class='va'>gg_flag</span> <span class='op'>+</span>   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>0.298</span>, y <span class='op'>=</span> <span class='fl'>0.94</span>, label <span class='op'>=</span> <span class='va'>text_thai</span>, </span>
<span>                     size <span class='op'>=</span> <span class='fl'>2.7</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>0.995</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.085</span>, label <span class='op'>=</span> <span class='va'>text_indonesia</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>2.7</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>0.955</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.525</span>, label <span class='op'>=</span> <span class='va'>text_india</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>2.7</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>0.312</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.95</span>, label <span class='op'>=</span> <span class='va'>text_mexico</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>2.7</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.455</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.897</span>, label <span class='op'>=</span> <span class='va'>text_sk</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>2.7</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.821</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.65</span>, label <span class='op'>=</span> <span class='va'>text_japan</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>2.7</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.952</span>, y <span class='op'>=</span> <span class='fl'>0.111</span>, label <span class='op'>=</span> <span class='va'>text_viet</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>2.7</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.87</span>, y <span class='op'>=</span> <span class='fl'>0.68</span>, label <span class='op'>=</span> <span class='va'>text_germany</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>2.7</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>gg_com</span></span></code></pre>
</div>
<p><img src="100513254_files/figure-html5/unnamed-chunk-13-1.png" width="955.2" style="display: block; margin: auto;" /></p>
</div>
<h3 id="title-and-legend">Title and legend</h3>
<p>To properly position and display the title and legend, let’s first move the graph a bit downwards. Once done, using ‘gg_title,’ we’ll add our title. Then, due to the complex nature of the original graph, we were compelled to manually add the legend using ‘annotate’. In fact, we started by listing the names of the energy sources, and then we placed a square of the corresponding color next to each name. Below is the code and the resulting graph.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>gg_plot1</span> <span class='op'>&lt;-</span> <span class='va'>gg_com</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>50</span>, r <span class='op'>=</span> <span class='fl'>0</span>, b <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>                                    l <span class='op'>=</span> <span class='fl'>0</span>, unit <span class='op'>=</span> <span class='st'>"pt"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Energy Generation by Fuel Type"</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0.5</span>, vjust <span class='op'>=</span> <span class='fl'>2</span>, </span>
<span>                                  size <span class='op'>=</span> <span class='fl'>27</span>, face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.49</span>, y <span class='op'>=</span> <span class='fl'>1.167</span>, label <span class='op'>=</span> <span class='st'>"Coal"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3.5</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.266</span>, y <span class='op'>=</span> <span class='fl'>1.167</span>, label <span class='op'>=</span> <span class='st'>"Natural gas"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3.5</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>0.03</span>, y <span class='op'>=</span> <span class='fl'>1.167</span>, label <span class='op'>=</span> <span class='st'>"Renewables"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3.5</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>0.28</span>, y <span class='op'>=</span> <span class='fl'>1.167</span>, label <span class='op'>=</span> <span class='st'>"Nuclear"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3.5</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>0.465</span>, y <span class='op'>=</span> <span class='fl'>1.167</span>, label <span class='op'>=</span> <span class='st'>"Other"</span>, </span>
<span>           size <span class='op'>=</span> <span class='fl'>3.5</span>, color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, xmin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.55</span>, xmax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.58</span>, </span>
<span>           ymin <span class='op'>=</span> <span class='fl'>1.15</span>, ymax <span class='op'>=</span> <span class='fl'>1.18</span>, fill <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, xmin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.39</span>, xmax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.42</span>, </span>
<span>           ymin <span class='op'>=</span> <span class='fl'>1.15</span>, ymax <span class='op'>=</span> <span class='fl'>1.18</span>, fill <span class='op'>=</span> <span class='st'>"dimgray"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, xmin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>, xmax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.13</span>, </span>
<span>           ymin <span class='op'>=</span> <span class='fl'>1.15</span>, ymax <span class='op'>=</span> <span class='fl'>1.18</span>, fill <span class='op'>=</span> <span class='st'>"blue1"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, xmin <span class='op'>=</span> <span class='fl'>0.16</span>, xmax <span class='op'>=</span> <span class='fl'>0.19</span>, </span>
<span>           ymin <span class='op'>=</span> <span class='fl'>1.15</span>, ymax <span class='op'>=</span> <span class='fl'>1.18</span>, fill <span class='op'>=</span> <span class='st'>"gold3"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, xmin <span class='op'>=</span> <span class='fl'>0.37</span>, xmax <span class='op'>=</span> <span class='fl'>0.4</span>, </span>
<span>           ymin <span class='op'>=</span> <span class='fl'>1.15</span>, ymax <span class='op'>=</span> <span class='fl'>1.18</span>, fill <span class='op'>=</span> <span class='st'>"gray92"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>gg_plot1</span></span></code></pre>
</div>
<p><img src="100513254_files/figure-html5/unnamed-chunk-14-1.png" width="955.2" style="display: block; margin: auto;" /></p>
</div>
<h3 id="theme">Theme</h3>
<p>Finally, all that remains is to remove the axes and gridlines, achieving a cleaner result.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>gg_fin</span> <span class='op'>&lt;-</span> <span class='va'>gg_plot1</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_void</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Energy Generation by Fuel Type"</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0.5</span>, vjust <span class='op'>=</span> <span class='fl'>2</span>, </span>
<span>                                  size <span class='op'>=</span> <span class='fl'>27</span>, face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>gg_fin</span></span></code></pre>
</div>
<p><img src="100513254_files/figure-html5/unnamed-chunk-15-1.png" width="955.2" data-distill-preview=1 style="display: block; margin: auto;" /></p>
</div>
<h2 id="alternative-version">Alternative version</h2>
<p>In this section, we present a different representation of the same data. We deemed it preferable to opt for an entirely different type of visualization rather than making improvements to the original graph. In fact, we don’t see valid reasons to use a circular chart for this data, as it makes interpretation considerably more complex. In our alternative version, we chose to represent the data using a simple stacked bar plot, which undoubtedly allows for a more immediate understanding. Further changes we made will be presented within this section.</p>
<h3 id="libraries-and-data-1">Libraries and data</h3>
<p>Also in this case, we begin by importing the necessary libraries and the Excel file that we will use to access the data, which we will then manually enter. Compared to the previous graph, we have chosen to group the available data differently. In this version, we include coal and natural gas under the broader category of ‘fossil fuels.’ We haven’t made any changes to either the ‘renewable’ sources or ‘nuclear’ energy. Although many consider nuclear energy a clean source, according to the <a href="https://finance.ec.europa.eu/sustainable-finance/tools-and-standards/eu-taxonomy-sustainable-activities_en">European Union</a>, due to the use of uranium, it cannot be classified as renewable energy. Finally, we have also retained the ‘Other’ category as residual energy sources. We have made this reclassification because, in the current era, rather than detailing the various sources, it is more important to distinguish between polluting fossil fuels and renewable ones. This way, it will be easier to immediately understand which countries are more virtuous and which ones still need to take steps towards a greener energy approach.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/hadley/reshape'>reshape2</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://readxl.tidyverse.org'>readxl</a></span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span><span class='st'>"Data.xlsx"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>dati</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  Country <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"China"</span>, <span class='st'>"Germany"</span>, <span class='st'>"India"</span>, <span class='st'>"Indonesia"</span>, <span class='st'>"Japan"</span>, <span class='st'>"Malaysia"</span>, </span>
<span>              <span class='st'>"Mexico"</span>, <span class='st'>"South Korea"</span>, <span class='st'>"Taiwan"</span>, <span class='st'>"Thailand"</span>, <span class='st'>"United Kingdom"</span>, </span>
<span>              <span class='st'>"United States"</span>, <span class='st'>"Vietnam"</span><span class='op'>)</span>,</span>
<span>  Other <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>4</span>, <span class='fl'>0</span>, <span class='fl'>3</span>, <span class='fl'>14</span>, <span class='fl'>1</span>, <span class='fl'>11</span>, <span class='fl'>1</span>, <span class='fl'>4</span>, <span class='fl'>1</span>, <span class='fl'>3</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>  Nuclear <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>3</span>, <span class='fl'>0</span>, <span class='fl'>4</span>, <span class='fl'>0</span>, <span class='fl'>4</span>, <span class='fl'>9</span>, <span class='fl'>8</span>, <span class='fl'>0</span>, <span class='fl'>11</span>, <span class='fl'>19</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>  Renewables <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>30</span>, <span class='fl'>44</span>, <span class='fl'>21</span>, <span class='fl'>19</span>, <span class='fl'>21</span>, <span class='fl'>21</span>, <span class='fl'>24</span>, <span class='fl'>28</span>, <span class='fl'>8</span>, <span class='fl'>15</span>, <span class='fl'>41</span>, <span class='fl'>21</span>, <span class='fl'>50</span><span class='op'>)</span>,</span>
<span>  Fossil_fuels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>64</span>, <span class='fl'>47</span>, <span class='fl'>76</span>, <span class='fl'>78</span>, <span class='fl'>61</span>, <span class='fl'>78</span>, <span class='fl'>61</span>, <span class='fl'>62</span>, <span class='fl'>80</span>, <span class='fl'>84</span>, <span class='fl'>45</span>, <span class='fl'>59</span>, <span class='fl'>50</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 id="coordinates-and-axes">Coordinates and axes</h3>
<p>Now, let’s proceed with creating our graph. We’ll begin by plotting a Cartesian plane, where numerical values will be represented on the X-axis, while we’ll list the thirteen countries on the Y-axis. These countries have been ordered based on the data so that those primarily generating energy from fossil fuel sources are positioned lower, and as we move upwards, we find those utilizing a more substantial percentage of renewable sources and other sources, besides the more polluting ones.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>custom_order</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>  <span class='st'>"Thailand"</span>, <span class='st'>"Taiwan"</span>, <span class='st'>"Indonesia"</span>, <span class='st'>"Malaysia"</span>, <span class='st'>"India"</span>, </span>
<span>  <span class='st'>"China"</span>, <span class='st'>"South Korea"</span>, <span class='st'>"Mexico"</span>, <span class='st'>"Japan"</span>, <span class='st'>"United States"</span>, <span class='st'>"Vietnam"</span>, </span>
<span>  <span class='st'>"Germany"</span>, <span class='st'>"United Kingdom"</span></span>
<span><span class='op'>)</span></span>
<span><span class='va'>dati_long</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/reshape2/man/melt.html'>melt</a></span><span class='op'>(</span><span class='va'>dati</span>, id.vars <span class='op'>=</span> <span class='st'>"Country"</span><span class='op'>)</span></span>
<span><span class='va'>dati_long</span><span class='op'>$</span><span class='va'>Country</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>dati_long</span><span class='op'>$</span><span class='va'>Country</span>, levels <span class='op'>=</span> <span class='va'>custom_order</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dati_long</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>value</span>, y <span class='op'>=</span> <span class='va'>Country</span>, fill <span class='op'>=</span> <span class='va'>variable</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>p</span></span></code></pre>
</div>
<p><img src="100513254_files/figure-html5/unnamed-chunk-17-1.png" width="624" /></p>
</div>
<p>Now let’s continue building the graph by adding the bars with the legend.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></span><span class='op'>(</span>stat <span class='op'>=</span> <span class='st'>"identity"</span>, width <span class='op'>=</span> <span class='fl'>0.95</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="100513254_files/figure-html5/unnamed-chunk-18-1.png" width="1248" style="display: block; margin: auto;" /></p>
</div>
<p>Afterward, we’ll change the colors associated with each energy source. Compared to the original graph, we have chosen different colors that are more visible and distinguishable from each other. Specifically, we relied on the ‘YlGnBu’ palette from the <a href="https://r-graph-gallery.com/38-rcolorbrewers-palettes.html">RColorBrewer</a> package.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></span><span class='op'>(</span>stat <span class='op'>=</span> <span class='st'>"identity"</span>, width <span class='op'>=</span> <span class='fl'>0.83</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>    Other <span class='op'>=</span> <span class='st'>"#474a35"</span>,</span>
<span>    Nuclear <span class='op'>=</span> <span class='st'>"#edf8b1"</span>,</span>
<span>    Renewables <span class='op'>=</span> <span class='st'>"#7fcdbb"</span>,</span>
<span>    Fossil_fuels <span class='op'>=</span> <span class='st'>"#2c7fb8"</span></span>
<span>  <span class='op'>)</span>, labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>    Other <span class='op'>=</span> <span class='st'>"Other"</span>,</span>
<span>    Nuclear <span class='op'>=</span> <span class='st'>"Nuclear"</span>,</span>
<span>    Renewables <span class='op'>=</span> <span class='st'>"Renewables"</span>,</span>
<span>    Fossil_fuels <span class='op'>=</span> <span class='st'>"Fossil fuels"</span></span>
<span>  <span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>p</span></span></code></pre>
</div>
<p><img src="100513254_files/figure-html5/unnamed-chunk-19-1.png" width="1248" style="display: block; margin: auto;" /></p>
</div>
<p>Then, we simplified the graph by removing the axis titles and changing the theme.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>""</span>, x <span class='op'>=</span> <span class='st'>""</span>, y <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='va'>p</span></span></code></pre>
</div>
<p><img src="100513254_files/figure-html5/unnamed-chunk-20-1.png" width="1248" style="display: block; margin: auto;" /></p>
</div>
<p>Later on, we made some minor adjustments to enhance the visual appearance. Initially, we changed the font of the axis labels, making them bold for better visibility, and additionally italicized the country names to give them a more refined look. Then, we highlighted both axes to facilitate data interpretation. Finally, we made some modifications to the legend, moving it to the top center in a horizontal position, and changing the text font.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>0</span>, vjust <span class='op'>=</span> <span class='fl'>0.5</span>, hjust <span class='op'>=</span> <span class='fl'>1</span>, family <span class='op'>=</span> <span class='st'>"Arial"</span>, face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>,</span>
<span>        axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"Arial"</span>, face <span class='op'>=</span> <span class='st'>"bold.italic"</span><span class='op'>)</span>,</span>
<span>        axis.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"Arial"</span>, face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>,</span>
<span>        axis.line <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span>,</span>
<span>        panel.grid <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>        legend.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>face <span class='op'>=</span> <span class='st'>"bold"</span>, family <span class='op'>=</span> <span class='st'>"Arial"</span><span class='op'>)</span>,</span>
<span>        legend.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"Arial"</span><span class='op'>)</span>,</span>
<span>        legend.position <span class='op'>=</span> <span class='st'>"top"</span>,  </span>
<span>        legend.box <span class='op'>=</span> <span class='st'>"horizontal"</span><span class='op'>)</span></span>
<span><span class='va'>p</span></span></code></pre>
</div>
<p><img src="100513254_files/figure-html5/unnamed-chunk-21-1.png" width="1056" style="display: block; margin: auto;" /></p>
</div>
<p>Afterward, we made some changes to the X-axis, displaying the percentages, which undoubtedly makes interpretation easier, and limiting its length.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span></span>
<span>    labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"0%"</span>, <span class='st'>"25%"</span>, <span class='st'>"50%"</span>, <span class='st'>"75%"</span>, <span class='st'>"100%"</span><span class='op'>)</span>,</span>
<span>    breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>25</span>, <span class='fl'>50</span>, <span class='fl'>75</span>, <span class='fl'>100</span><span class='op'>)</span>,</span>
<span>    limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>100</span><span class='op'>)</span>,  </span>
<span>    expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span><span class='va'>p</span></span></code></pre>
</div>
<p><img src="100513254_files/figure-html5/unnamed-chunk-22-1.png" width="1056" style="display: block; margin: auto;" /></p>
</div>
<p>Furthermore, in order to make interpreting the graph even simpler, especially concerning the percentage of energy from sources other than fossil fuels, we added dashed vertical lines corresponding to the 25%, 50%, and 100% percentages.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>, <span class='fl'>50</span>, <span class='fl'>75</span><span class='op'>)</span>, linetype <span class='op'>=</span> <span class='st'>"dashed"</span>, color <span class='op'>=</span> <span class='st'>"black"</span>, alpha <span class='op'>=</span> <span class='fl'>0.4</span><span class='op'>)</span></span>
<span><span class='va'>p</span></span></code></pre>
</div>
<p><img src="100513254_files/figure-html5/unnamed-chunk-23-1.png" width="1056" style="display: block; margin: auto;" /></p>
</div>
<p>Let’s proceed further by refining some details, removing the title from the legend.”</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guide_legend.html'>guide_legend</a></span><span class='op'>(</span>reverse <span class='op'>=</span> <span class='cn'>TRUE</span>, title <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>p</span></span></code></pre>
</div>
<p><img src="100513254_files/figure-html5/unnamed-chunk-24-1.png" width="1056" style="display: block; margin: auto;" /></p>
</div>
<p>Finally, let’s complete the graph by adding the title in the appropriate position.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Energy Generation by Fuel Type"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0.5</span>, vjust <span class='op'>=</span> <span class='fl'>2</span>, size <span class='op'>=</span> <span class='fl'>27</span>, face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="100513254_files/figure-html5/unnamed-chunk-25-1.png" width="1056" style="display: block; margin: auto;" /></p>
</div>
<div class="sourceCode" id="cb1"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Rivoli (2024, Jan. 14). Data visualization | MSc CSS: Energy Generation by Fuel Type. Retrieved from https://csslab.uc3m.es/dataviz/projects/2023/100513254/</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@misc{rivoli2024energy,
  author = {Rivoli, Giorgio},
  title = {Data visualization | MSc CSS: Energy Generation by Fuel Type},
  url = {https://csslab.uc3m.es/dataviz/projects/2023/100513254/},
  year = {2024}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<!--radix_placeholder_navigation_after_body--><html><body>
<div class="distill-site-nav distill-site-footer">
<p><img src="../../../assets/acronimo_nombre1l_0.png" width="400"></p>
</div>
<!--/radix_placeholder_navigation_after_body-->
</body></html>


</body>

</html>
