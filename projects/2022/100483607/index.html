<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
<title>Data visualization | MSc CSS: Distribution of state investment by autonomous communities</title>

<meta property="description" itemprop="description" content="This following page is a guide, of how to reproduce step by step, the plot of &quot;El Mundo Gráficos&quot; done by the student Pablo Arroyo as a final project for the subject."/>

<link rel="canonical" href="https://csslab.uc3m.es/dataviz/projects/2022/100483607/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2023-01-05"/>
<meta property="article:created" itemprop="dateCreated" content="2023-01-05"/>
<meta name="article:author" content="Pablo Arroyo Rodriguez"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Data visualization | MSc CSS: Distribution of state investment by autonomous communities"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="This following page is a guide, of how to reproduce step by step, the plot of &quot;El Mundo Gráficos&quot; done by the student Pablo Arroyo as a final project for the subject."/>
<meta property="og:url" content="https://csslab.uc3m.es/dataviz/projects/2022/100483607/"/>
<meta property="og:image" content="https://csslab.uc3m.es/dataviz/projects/2022/100483607/ccaa470.jpg"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Data visualization | MSc CSS"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="Data visualization | MSc CSS: Distribution of state investment by autonomous communities"/>
<meta property="twitter:description" content="This following page is a guide, of how to reproduce step by step, the plot of &quot;El Mundo Gráficos&quot; done by the student Pablo Arroyo as a final project for the subject."/>
<meta property="twitter:url" content="https://csslab.uc3m.es/dataviz/projects/2022/100483607/"/>
<meta property="twitter:image" content="https://csslab.uc3m.es/dataviz/projects/2022/100483607/ccaa470.jpg"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="Data visualization | MSc CSS: Distribution of state investment by autonomous communities"/>
<meta name="citation_fulltext_html_url" content="https://csslab.uc3m.es/dataviz/projects/2022/100483607/"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2023/01/05"/>
<meta name="citation_publication_date" content="2023/01/05"/>
<meta name="citation_author" content="Pablo Arroyo Rodriguez"/>
<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["creative_commons","title","description","categories","author","date","output","preview","citation_url","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["CC BY"]},{"type":"character","attributes":{},"value":["Distribution of state investment by autonomous communities"]},{"type":"character","attributes":{},"value":["This following page is a guide, of how to reproduce step by step, the plot of \"El Mundo Gráficos\" done by the student Pablo Arroyo as a final project for the subject."]},{"type":"character","attributes":{},"value":["2022"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Pablo Arroyo Rodriguez"]}]}]},{"type":"character","attributes":{},"value":["2023-01-05"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["ccaa470.jpg"]},{"type":"character","attributes":{},"value":["https://csslab.uc3m.es/dataviz/projects/2022/100483607/"]},{"type":"character","attributes":{},"value":["https://csslab.uc3m.es/dataviz/projects/2022/100483607/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["100483607_files/anchor-4.2.2/anchor.min.js","100483607_files/bowser-1.9.3/bowser.min.js","100483607_files/distill-2.2.21/template.v2.js","100483607_files/figure-html5/unnamed-chunk-10-1.png","100483607_files/figure-html5/unnamed-chunk-11-1.png","100483607_files/figure-html5/unnamed-chunk-12-1.png","100483607_files/figure-html5/unnamed-chunk-13-1.png","100483607_files/figure-html5/unnamed-chunk-14-1.png","100483607_files/figure-html5/unnamed-chunk-4-1.png","100483607_files/figure-html5/unnamed-chunk-5-1.png","100483607_files/figure-html5/unnamed-chunk-6-1.png","100483607_files/figure-html5/unnamed-chunk-7-1.png","100483607_files/figure-html5/unnamed-chunk-8-1.png","100483607_files/figure-html5/unnamed-chunk-9-1.png","100483607_files/header-attrs-2.19/header-attrs.js","100483607_files/jquery-3.6.0/jquery-3.6.0.js","100483607_files/jquery-3.6.0/jquery-3.6.0.min.js","100483607_files/jquery-3.6.0/jquery-3.6.0.min.map","100483607_files/popper-2.6.0/popper.min.js","100483607_files/tippy-6.2.7/tippy-bundle.umd.min.js","100483607_files/tippy-6.2.7/tippy-light-border.css","100483607_files/tippy-6.2.7/tippy.css","100483607_files/tippy-6.2.7/tippy.umd.min.js","100483607_files/webcomponents-2.0.0/webcomponents.js","ccaa470.jpg","Clean_Data.csv","Grafico_Definitivo.png"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme
  $('code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */

@import url('https://fonts.googleapis.com/css2?family=Questrial');

html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    "Questrial", sans-serif;
  --mono-font:       monospace;
  --body-font:       "Questrial", sans-serif;
  --navbar-font:     "Questrial", sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #000e78;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #000e78;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */

@media screen and (min-width: 768px) {
  d-article aside {
    height: 0;
  }
  aside.slides {
    margin-left: -148px;
    height: auto;
  }
  aside.slides + h2 {
    white-space: nowrap;
  }
}

d-article li {
  margin-bottom: 0.1em;
}

.posts-list .post-preview .thumbnail {
  max-height: 300px;
  overflow: hidden;
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../../site_libs/header-attrs-2.19/header-attrs.js"></script>
  <script src="../../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Distribution of state investment by autonomous communities","description":"This following page is a guide, of how to reproduce step by step, the plot of \"El Mundo Gráficos\" done by the student Pablo Arroyo as a final project for the subject.","authors":[{"author":"Pablo Arroyo Rodriguez","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2023-01-05T00:00:00.000+01:00","citationText":"Rodriguez, 2023"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<span class="logo">
<img src="../../../assets/acronimo_0.png"/>
</span>
<a href="../../../index.html" class="title">Data visualization | MSc CSS</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../../contents.html">Contents</a>
<a href="../../../tutorials.html">Tutorials</a>
<a href="../../../resources.html">Resources</a>
<a href="../../../projects.html">Projects</a>
<a href="https://github.com/IBiDat/dataviz" aria-label="Link to source">
<i class="fab fa-github" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Distribution of state investment by autonomous communities</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
  <a href="../../../projects.html#category:2022" class="dt-tag">2022</a>
</div>
<!--/radix_placeholder_categories-->
<p><p>This following page is a guide, of how to reproduce step by step, the plot of “El Mundo Gráficos” done by the student Pablo Arroyo as a final project for the subject.</p></p>
</div>

<div class="d-byline">
  
  Pablo Arroyo Rodriguez
  
<br/>2023-01-05
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#getting-the-data">Getting the data</a></li>
<li><a href="#building-the-chart">Building the chart</a>
<ul>
<li><a href="#coordinates-and-axes">Coordinates and axes</a></li>
<li><a href="#theme">Theme</a></li>
<li><a href="#annotations">Annotations</a></li>
<li><a href="#data">Data</a></li>
<li><a href="#labs">Labs</a></li>
<li><a href="#legend">Legend</a></li>
</ul></li>
<li><a href="#improvements">Improvements</a>
<ul>
<li><a href="#code">Code</a></li>
</ul></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
</nav>
</div>
<p>The distribution of state investment by autonomous communities, it is a tricky topic that each year comes to the news. When the State´s budget is published, almost the first thing that each media do is to analyze what are the communities that receive more, and what are the ones that receive less. This could be important, because depending on the needing of support for the governance, more money would go to one community or another.</p>
<p>The point here, is in the differences between Madrid and Catalonia. However, as illustrated here, the budget from Catalonia is closer to Andalusia rather than Madrid. We can see notices of this kind in the national press channel <a href="https://www.rtve.es/noticias/20221006/presupuestos-2023-comunidades/2405230.shtml"><em>“Catalonia and Andalusia lead state investment with almost twice the budget of Madrid and the Valencian Community”</em></a> or the <a href="https://www.elmundo.es/economia/2022/10/06/633f1bf0fdddffba108b459c.html"><em>“El Mundo”</em></a> from which I took the graph.</p>
<figure>
<img src="ccaa470.jpg" class="external" style="width:100.0%" alt="J.Aguirre | EL MUNDO GRÁFICOS. Figure from elmundo.es." /><figcaption aria-hidden="true">J.Aguirre | EL MUNDO GRÁFICOS. Figure from <a href="https://elmundo.es">elmundo.es</a>.</figcaption>
</figure>
<h2 id="getting-the-data">Getting the data</h2>
<p>Apparently, the data could be really easy to obtain from an official source, because if you observe this same data from different papers, figures vary a bit. But, as expected with public institutions, the process is really tedious. So, what I did is to obtain the data from the public institution in charge of this figures in Spain, <a href="https://www.igae.pap.hacienda.gob.es/sitios/igae/es-ES/Contabilidad/ContabilidadPublica/CPE/EjecucionPresupuestaria/Paginas/isdistribucioninversion.aspx"><em>La Intervención General de la Administración del Estado</em></a> with data from 2009 to 2022.</p>
<p>For data about the budget for the next year, 2023, I used another official page which show the information in a visual way, <a href="https://www.epdata.es/datos/inversion-gobierno-comunidades-datos-estadisticas/263"><em>Ministerio de Hacienda, epdata</em></a>.</p>
<p>Once you get the file with the whole datasheet from one specific year, you have to sum the different budget items by communities. It appears spread by different concepts, as a page in an excel book and repeating the process for the four years. Having done that, it is possible to obtain the data in a <code>.cvs</code> file format. So, we will see how our data looks like:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://wilkelab.org/ggtext/'>ggtext</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://nanx.me/ggsci/'>ggsci</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggforce.data-imaginist.com'>ggforce</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/tidyverse/glue'>glue</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/r-lib/systemfonts'>systemfonts</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://wilkelab.org/cowplot/'>cowplot</a></span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'>sysfonts</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/sysfonts/man/font_add_google.html'>font_add_google</a></span><span class='op'>(</span><span class='st'>"Be Vietnam Pro"</span><span class='op'>)</span></span>
<span><span class='fu'>showtext</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/showtext/man/showtext_opts.html'>showtext_opts</a></span><span class='op'>(</span>dpi<span class='op'>=</span><span class='fl'>300</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>data</span><span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_delim</a></span><span class='op'>(</span><span class='st'>"Clean_Data.csv"</span>, delim <span class='op'>=</span> <span class='st'>";"</span>, col_types <span class='op'>=</span> <span class='st'>"cnnnn"</span>  <span class='op'>)</span></span>
<span><span class='fu'><a href='https://pillar.r-lib.org/reference/glimpse.html'>glimpse</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Rows: 19
Columns: 5
$ Comunidad &lt;chr&gt; &quot;Andalucia&quot;, &quot;Cataluña&quot;, &quot;Com. de Madrid&quot;, &quot;C. Val…
$ `2018`    &lt;dbl&gt; 1379.7, 1312.1, 1117.2, 700.0, 894.8, 962.7, 533.9…
$ `2021`    &lt;dbl&gt; 2146.16, 2199.30, 1133.90, 1106.90, 792.60, 799.20…
$ `2022`    &lt;dbl&gt; 2267.07, 2430.74, 1054.90, 1155.60, 1033.50, 935.2…
$ `2023`    &lt;dbl&gt; 2318.8, 2508.9, 1305.4, 1269.5, 1077.9, 955.8, 600…</code></pre>
</div>
<p>It is impossible to observe the whole datasheet. So, with the previous function glimpse(), we can take a quick view of the general structure, in order to observe more or less how it is. But for observing the main measures of central tendency from our data and its evolution through this for years, it would be nice to include the summary () function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>  Comunidad              2018             2021        
 Length:19          Min.   :  23.5   Min.   :  24.48  
 Class :character   1st Qu.: 195.3   1st Qu.: 216.80  
 Mode  :character   Median : 363.9   Median : 384.10  
                    Mean   : 504.7   Mean   : 622.11  
                    3rd Qu.: 797.4   3rd Qu.: 795.90  
                    Max.   :1379.7   Max.   :2199.30  
      2022              2023       
 Min.   :  31.85   Min.   :  28.9  
 1st Qu.: 192.60   1st Qu.: 241.4  
 Median : 439.30   Median : 481.5  
 Mean   : 666.25   Mean   : 718.1  
 3rd Qu.: 984.35   3rd Qu.:1016.9  
 Max.   :2430.74   Max.   :2508.9  </code></pre>
</div>
<p>Once we have our raw data, it is time to start giving format to our variables, in order that they appear specifically how we want them, not as mere values in a table.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>data</span><span class='op'>&lt;-</span><span class='va'>data</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"2018"</span>, <span class='st'>"2021"</span>, <span class='st'>"2022"</span>, <span class='st'>"2023"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    Comunidad<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>Comunidad</span><span class='op'>)</span>,</span>
<span>    name<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>name</span><span class='op'>)</span>,</span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<p>First thing to do is to mutate them as a long format, which is more useful for visualization and statistics approaches. Also, it is important to convert the name of the communities and the name of the year, 2023, 2022, 2021, 2018, as factors. That is the way that we have in R to specify the categories in the representation.</p>
<p>Now, it is possible to say that our data seems to be what it would be expected to start the construction of the graph.</p>
<h2 id="building-the-chart">Building the chart</h2>
<p>The plot was selected because it could seem easy to reproduce, and was the first time dealing with this kind of representation on my own. However, it started to get harder and harder to deal with this grouped bar chart, and the small details were really time consuming. But finally, it was possible to come up with a result as could be seen in the following lines:</p>
<h3 id="coordinates-and-axes">Coordinates and axes</h3>
<p>I will try to reproduce the graph, step by step, before adding the data and obtaining the whole plot.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>Comunidad</span>, y<span class='op'>=</span><span class='va'>value</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>p</span></span></code></pre>
</div>
<p><img src="100483607_files/figure-html5/unnamed-chunk-4-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<p>With this first chunk of code, the baseline of the plot appears. Based on which, we will be adding information and modifying the different characteristic, in order to satisfy the same specification as in the selected one. However, the names of the communities are all together and it is really difficult to understand. It is a pointless point, so it´s worth it to have a vertical disposition instead of a horizontal one, the categories would be more readable.</p>
<p>As it could be seen in the example, the graph has certain limits for the values of our data. One of the first points that we have to do, is to fix those values within the specific categories. In this case from 0 to 3000 in steps of 500. I decided to expand the limits a bit more than this 3000, because otherwise the label for this 3000 extended passed the axis and we could not see it.</p>
<p>There are also coordinates for the negative part of the graph despite not having negative information for the budgets. That is because we have to extend the lines and add the names of the communities in this part as annotations, otherwise it would be impossible.</p>
<p>A good point to highlight here, and which was really hard to find, is how to set the y axis on both sides. Although it is a simple line of code, it took me a while to find this specific chunk of code, so if some of you need this in the future pay attention at this point, because the rest is more or less the same as in all plots.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span></span>
<span>    breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>500</span>, <span class='fl'>1000</span>, <span class='fl'>1500</span>, <span class='fl'>2000</span>, <span class='fl'>2500</span>, <span class='fl'>3000</span><span class='op'>)</span>,</span>
<span>    limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1500</span>, <span class='fl'>3200</span><span class='op'>)</span>,</span>
<span>    sec.axis <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/sec_axis.html'>dup_axis</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    name <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>    expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_discrete.html'>scale_x_discrete</a></span><span class='op'>(</span></span>
<span>    name <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>    limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Ceuta"</span>, <span class='st'>"Melilla"</span>, <span class='st'>"La Rioja"</span>, <span class='st'>"Navarra"</span>, <span class='st'>"Baleares"</span>, </span>
<span>               <span class='st'>"Cantabria"</span>, <span class='st'>"Canarias"</span>, <span class='st'>"Asturias"</span>, <span class='st'>"Extremadura"</span>, </span>
<span>               <span class='st'>"Murcia"</span>, </span>
<span>               <span class='st'>"Aragón"</span>, <span class='st'>"País Vasco"</span>, <span class='st'>"Castilla-La Mancha"</span>, </span>
<span>               <span class='st'>"Castilla y León"</span>, <span class='st'>"Galicia"</span>, <span class='st'>"C. Valenciana"</span>, </span>
<span>               <span class='st'>"Com. de Madrid"</span>, <span class='st'>"Andalucia"</span>, <span class='st'>"Cataluña"</span><span class='op'>)</span>,</span>
<span>    labels <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>    expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='va'>p</span></span></code></pre>
</div>
<p><img src="100483607_files/figure-html5/unnamed-chunk-5-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<p>A last comment about this previous chunk. The names of the axis have been deleted, because we do not want it to appear in our last graph, but also, we set a specific order for the name of the communities, based on the highest budget for the year 2023.</p>
<h3 id="theme">Theme</h3>
<p>The theme for this project is very easy. As it can be seen, the background of the graph is empty, nothing inside, but for, the lines below the name of each community which separate one community from another. A key point here is that we have established the small tick that appears below each break. Maybe, in this position it is hard to identify, but once we apply for coord_flip() it is more easy to observe.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    panel.grid <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    axis.ticks.x.top <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span></span>
<span>      size <span class='op'>=</span> <span class='fl'>.5</span>, colour <span class='op'>=</span> <span class='st'>"#696969"</span><span class='op'>)</span>, </span>
<span>    axis.ticks.x.bottom <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span></span>
<span>      size <span class='op'>=</span> <span class='fl'>.5</span>, colour <span class='op'>=</span> <span class='st'>"#696969"</span><span class='op'>)</span>,</span>
<span>    plot.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>color<span class='op'>=</span><span class='st'>"#ffffff"</span>, fill<span class='op'>=</span><span class='st'>"#ffffff"</span><span class='op'>)</span>,</span>
<span>    plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>5</span>,<span class='fl'>5</span>,<span class='fl'>5</span>,<span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span></span>
<span>    </span>
<span><span class='va'>p</span></span></code></pre>
</div>
<p><img src="100483607_files/figure-html5/unnamed-chunk-6-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<p>We have an empty graph, with nothing inside which is the case that we are trying to replicate. However, we need to add the guides, and coord_flip() to see something similar to the original one. So, we will do it.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_flip.html'>coord_flip</a></span><span class='op'>(</span>clip <span class='op'>=</span> <span class='st'>"off"</span>, ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1500</span>, <span class='fl'>3100</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>1.5</span>, <span class='fl'>18.5</span>, <span class='fl'>1</span><span class='op'>)</span>, ymin <span class='op'>=</span><span class='op'>-</span><span class='fl'>1500</span>, ymax <span class='op'>=</span> <span class='fl'>3100</span><span class='op'>)</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, xend <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>ymin</span>, yend <span class='op'>=</span> <span class='va'>ymax</span><span class='op'>)</span>,</span>
<span>    inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#8e8e8e"</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='va'>p</span></span></code></pre>
</div>
<p><img src="100483607_files/figure-html5/unnamed-chunk-7-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<p>Instead of having a vertical bar chart which is the usual scenario after applying for these changes, we have a horizontal plot, with nothing inside. The graph is starting to seem similar to the original one. However, it is a kind of graph that by its nature, it is much longer than wider, so we have to change the adjustment of our R.Markdown to obtain what we want.</p>
<p>Notice, that we have changed the specification of the graph, the plot is more or less what we want. Now is the time to add the data and the annotations.</p>
<h3 id="annotations">Annotations</h3>
<p>Apparently, this graph does not have any kind of annotation. However, it is a bit misleading and there was no other way to add the name of the communities rather than as an annotation. To do so, what I did is to extend the dimension of the plot past the axis, and once we have that, adding in the negative part the name corresponding to the different communities as annotations.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>19</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, </span>
<span>           label <span class='op'>=</span> <span class='st'>"Cataluña"</span>, size <span class='op'>=</span> <span class='fl'>3</span>, </span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>18</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, </span>
<span>           label <span class='op'>=</span> <span class='st'>"Andalucia"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>17</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>,  </span>
<span>           label <span class='op'>=</span> <span class='st'>"Com. de Madrid"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>16</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, </span>
<span>           label <span class='op'>=</span> <span class='st'>"C. Valenciana"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>15</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>,  </span>
<span>           label <span class='op'>=</span> <span class='st'>"Galicia"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>14</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, </span>
<span>           label <span class='op'>=</span> <span class='st'>"Castilla y León"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>13</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>,  </span>
<span>           label <span class='op'>=</span> <span class='st'>"Castilla-La Mancha"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>12</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>,  </span>
<span>           label <span class='op'>=</span> <span class='st'>"País Vasco"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>11</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, </span>
<span>           label <span class='op'>=</span> <span class='st'>"Aragón"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>10</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>,  </span>
<span>           label <span class='op'>=</span> <span class='st'>"Murcia"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>9</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, </span>
<span>           label <span class='op'>=</span> <span class='st'>"Extremadura"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>8</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>,  </span>
<span>           label <span class='op'>=</span> <span class='st'>"Asturias"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>7</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, </span>
<span>           label <span class='op'>=</span> <span class='st'>"Canarias"</span>, size <span class='op'>=</span> <span class='fl'>3</span>, </span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>6</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, </span>
<span>           label <span class='op'>=</span> <span class='st'>"Cantabria"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>5</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>,  </span>
<span>           label <span class='op'>=</span> <span class='st'>"Baleares"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>4</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>,  </span>
<span>           label <span class='op'>=</span> <span class='st'>"Navarra"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>3</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>,  </span>
<span>           label <span class='op'>=</span> <span class='st'>"La Rioja"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>,  </span>
<span>           label <span class='op'>=</span> <span class='st'>"Melilla"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>1</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>,  </span>
<span>           label <span class='op'>=</span> <span class='st'>"Ceuta"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>p</span></span></code></pre>
</div>
<p><img src="100483607_files/figure-html5/unnamed-chunk-8-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<h3 id="data">Data</h3>
<p>This graph is based on grouped data by an autonomous community. With the name of the different communities and their budget from four different years, that is why in the previous steps it was important to pivot longer the data, and establish the different year and communities as_factor(). So, it is the type of grouped bar chart.</p>
<p>Now, we will add the data to the previous coordinates and axis that we have been preparing, but also we will establish the different colors of the bars.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></span><span class='op'>(</span>position <span class='op'>=</span> <span class='st'>"dodge"</span>, stat <span class='op'>=</span> <span class='st'>"identity"</span>, width <span class='op'>=</span> <span class='fl'>0.63</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='va'>name</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>breaks<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"2023"</span>,<span class='st'>"2022"</span>,<span class='st'>"2021"</span>, <span class='st'>"2018"</span><span class='op'>)</span>, </span>
<span>                    values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#ff1e26"</span>, <span class='st'>"#5f9dc6"</span>,   <span class='st'>"#8ccaf9"</span>, <span class='st'>"#c5daeb"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>p</span></span></code></pre>
</div>
<p><img src="100483607_files/figure-html5/unnamed-chunk-9-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<p>The graph it is closer to our final result. Few things are still left such as a good title, subtitle and caption. But also, we have to establish a good position for the legend which is almost higher than the plot, and this does not make any sense.</p>
<h3 id="labs">Labs</h3>
<p>A key point that it is still missing in this graph are the labs. If we see the graph until this point, we do not know what the graph is about without an appropriate title, it is mandatory to modify it, and also adding the different subtitles and comments.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span></span>
<span>    title <span class='op'>=</span> <span class='st'>"EL REPARTO DE LA INVERSIÓN ESTATAL POR CCAA"</span>,</span>
<span>    subtitle <span class='op'>=</span> <span class='st'>"INVERSIÓN REAL \n\n\n"</span>,</span>
<span>    caption <span class='op'>=</span> <span class='st'>"Se añaden 20,52 millones de euros para Ceuta y Melilla \n"</span>,</span>
<span>    fill <span class='op'>=</span> <span class='st'>"En millones de euros"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>However, when we add all of these things, our plot is completely a mess, because we have added many different things, without the necessary adjustment. So, everything has moved from one place to another and appears to be untidy. Let´s try to solve it! Basically, we will be adjusting almost every position of the element on the plot.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    axis.title.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust<span class='op'>=</span><span class='fl'>.5</span>, color<span class='op'>=</span><span class='st'>"black"</span>, </span>
<span>                                size<span class='op'>=</span><span class='fl'>10</span>, face <span class='op'>=</span> <span class='st'>"bold"</span>, </span>
<span>                                margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>10</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    axis.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color<span class='op'>=</span><span class='st'>"black"</span>, </span>
<span>                             size<span class='op'>=</span><span class='fl'>8</span> <span class='op'>)</span>,</span>
<span>     axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color<span class='op'>=</span><span class='st'>"black"</span>,</span>
<span>                               size<span class='op'>=</span><span class='fl'>10</span><span class='op'>)</span>,</span>
<span>    plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust<span class='op'>=</span><span class='op'>-</span><span class='fl'>0</span>, size<span class='op'>=</span><span class='fl'>11</span>, </span>
<span>                              color<span class='op'>=</span><span class='st'>"black"</span>,lineheight<span class='op'>=</span><span class='fl'>.8</span>, face<span class='op'>=</span><span class='st'>"bold"</span>, </span>
<span>                              margin<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>     plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust<span class='op'>=</span><span class='fl'>0</span>, vjust <span class='op'>=</span> <span class='fl'>1.2</span>, </span>
<span>                                  size<span class='op'>=</span><span class='fl'>9.5</span>, color<span class='op'>=</span> <span class='st'>"black"</span>, </span>
<span>                                  face <span class='op'>=</span> <span class='st'>"bold"</span>, margin<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>10</span>,<span class='fl'>0</span>,<span class='fl'>10</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    plot.caption <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust<span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.05</span>,margin<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>10</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span><span class='op'>)</span>, </span>
<span>                                size<span class='op'>=</span><span class='fl'>8</span>, color<span class='op'>=</span><span class='st'>"black"</span>, face<span class='op'>=</span><span class='st'>"bold"</span><span class='op'>)</span>,</span>
<span>    plot.title.position <span class='op'>=</span> <span class='st'>"plot"</span>,</span>
<span>    plot.caption.position <span class='op'>=</span> <span class='st'>"plot"</span></span>
<span>    <span class='op'>)</span> </span>
<span><span class='va'>p</span></span></code></pre>
</div>
<p><img src="100483607_files/figure-html5/unnamed-chunk-11-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<h3 id="legend">Legend</h3>
<p>However, we still have the legend in a position that modifies the whole graph, and we have to change that to obtain a real reproduction.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p</span><span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    legend.direction <span class='op'>=</span> <span class='st'>"horizontal"</span>,</span>
<span>    legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.285</span>, <span class='fl'>1.05</span><span class='op'>)</span>, </span>
<span>    legend.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span>,</span>
<span>    legend.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"black"</span>, size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span>,</span>
<span>    legend.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"black"</span>, size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span>,</span>
<span>    legend.spacing.x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.09</span>, <span class='st'>'cm'</span><span class='op'>)</span>,</span>
<span>    legend.key.size <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.6</span>, <span class='st'>"cm"</span><span class='op'>)</span>,</span>
<span>    legend.key.height<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.3</span>, <span class='st'>'cm'</span><span class='op'>)</span>,</span>
<span>    legend.key.width <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.65</span>, <span class='st'>"cm"</span><span class='op'>)</span>,</span>
<span>    legend.spacing.y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.1</span>,<span class='st'>'cm'</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>fill<span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guide_legend.html'>guide_legend</a></span><span class='op'>(</span>title.position <span class='op'>=</span> <span class='st'>"top"</span>, title.hjust <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>p</span></span></code></pre>
</div>
<p><img src="100483607_files/figure-html5/unnamed-chunk-12-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<p>Once we have done that, the representation is consistent with what we want, because everything is adjusted and aligned, not as in the previous steps, that when you modify something everything changes and you have to start again. But never give up, you will finish doing it!</p>
<p>It is time to introduce the annotation near to the name of each community. I tried to do it at the same time in just one chunk of code, but only the names from 3 different communities and the other disappeared. I do not know the reason well. So that is why I decided to do it step by step although it is longer. Sure, there is a better option.</p>
<p>And also we have to add a little more. Notice that at the bottom of the graph there is more information than just a simple caption, so we have to add also this information. The way that I found better to add this information is by using the ggdraw(), which will be included at the end of the next chunk.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>p</span><span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"2508.9"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"2318.8"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"1305.4"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>, </span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"1269.5"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"1077.9"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"955.8"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"600.7"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"558.8"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"547.9"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"481.5"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"473.9"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"420.9"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"391.9"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"296.6"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"186.3"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span> <span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"103.8"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"71.3"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"45.3"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"28.9"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://wilkelab.org/cowplot/reference/ggdraw.html'>ggdraw</a></span><span class='op'>(</span><span class='fu'><a href='https://wilkelab.org/cowplot/reference/add_sub.html'>add_sub</a></span><span class='op'>(</span><span class='va'>p</span>, <span class='st'>"Fuente:PGE 2023, 2022, 2021 Y 2018 \nP.Arroyo | MUCSS"</span>, </span>
<span>                    y <span class='op'>=</span> <span class='fl'>0.8</span>, x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.01</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, vjust <span class='op'>=</span> <span class='fl'>0.85</span>, size <span class='op'>=</span> <span class='fl'>7.8</span>, </span>
<span>                    color <span class='op'>=</span> <span class='st'>"black"</span>, lineheight <span class='op'>=</span> <span class='fl'>0.85</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>p</span></span></code></pre>
</div>
<p><img src="100483607_files/figure-html5/unnamed-chunk-13-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<h2 id="improvements">Improvements</h2>
<p>The plot that I decided to reproduce, was quite complete with almost all the elements that should be included for a good representation, such as: a nice axis with its reference, annotations of different values, a clear legend, nice colors and so on.
However, as a reader of newspapers I miss an interesting point that all graphs should have, something that draws our attention and keeps us reading the notice. This could be done by introducing some interesting point, or maybe some controversial that keeps readers awake, that is why I decided to do the following graph:</p>
<figure>
<img src="Grafico_Definitivo.png" class="external" style="width:100.0%" alt="P.Arroyo | MUCSS." /><figcaption aria-hidden="true">P.Arroyo | MUCSS.</figcaption>
</figure>
<p>Mainly, I decided to do two thing:</p>
<ul>
<li><p>Adding the name of the policy party that is in charge of each community.</p></li>
<li><p>Including the evolution of the budget per community with an ascending or descending arrow.</p></li>
</ul>
<p>By doing that, we include some controversial questions that encourage readers to go deeper in the theme. That is because, as said in the introduction, in Spain it is believed by many people that the budget that each community receives depends on sympathy with the central government.</p>
<p>What, surprised me when I was doing this tutorial, is that also the original author of the previous graph, <a href="https://twitter.com/javagured"><em>Javier Aguirre,</em></a> has introduced some modifications in line with the ones that I was doing. The idea was the same, but his ones were more visual so I decided to continue my path in that way because it was just a few lines of code and the appearance was better. <a href="https://www.elmundo.es/economia/2022/10/06/633f1bf0fdddffba108b459c.html"><em>“See news with the final graph”</em></a> This is a good point to remark, that once you get a nice graph, there is always a way to improve it based on the previous one.
I have to point out that I don’t like in his definitive graph the inclusion of the top X axis, because there is so much information in the positive part that you will end up missing.</p>
<h3 id="code">Code</h3>
<p>I want to comment on the key point that I made to modify the whole graph. Also, I know that a good point of improvement is reducing the code to reproduce exactly the same, by for example using sequences that is something that I would like to do in future steps.</p>
<p>Main points to highlight:</p>
<ul>
<li><p>Extending the limits of the axis passed the data, from -1500 to 4500, to introduce the different elements as annotations.</p></li>
<li><p>Selecting just one X axis for reference instead of dup_axis(), in order not to overload the plot.</p></li>
<li><p>Compute the percentage variation and add the different elements as annotations in this new axis.</p></li>
</ul>
<p>Nevertheless, I include the whole chunk of code, knowing as I said before that there is enough space to do it in fewer lines, but the first step is a nice way of starting.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>### Coordinates and axes</span></span>
<span><span class='va'>t</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>Comunidad</span>, y<span class='op'>=</span><span class='va'>value</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>t</span> <span class='op'>&lt;-</span> <span class='va'>t</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span></span>
<span>  breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1000</span>, <span class='fl'>2000</span>, <span class='fl'>3000</span><span class='op'>)</span>,</span>
<span>  <span class='co'>#sec.axis = dup_axis(),</span></span>
<span>  name <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>  expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span><span class='op'>)</span></span>
<span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_discrete.html'>scale_x_discrete</a></span><span class='op'>(</span></span>
<span>    name <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>    limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Ceuta"</span>, <span class='st'>"Melilla"</span>, <span class='st'>"La Rioja"</span>, <span class='st'>"Navarra"</span>, </span>
<span>               <span class='st'>"Baleares"</span>, <span class='st'>"Cantabria"</span>, <span class='st'>"Canarias"</span>, <span class='st'>"Asturias"</span>, </span>
<span>               <span class='st'>"Extremadura"</span>, <span class='st'>"Murcia"</span>, <span class='st'>"Aragón"</span>, <span class='st'>"País Vasco"</span>, </span>
<span>               <span class='st'>"Castilla-La Mancha"</span>, <span class='st'>"Castilla y León"</span>, <span class='st'>"Galicia"</span>, </span>
<span>               <span class='st'>"C. Valenciana"</span>, <span class='st'>"Com. de Madrid"</span>, <span class='st'>"Andalucia"</span>, <span class='st'>"Cataluña"</span><span class='op'>)</span>,</span>
<span>    labels <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>    expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'>### Theme</span></span>
<span><span class='va'>t</span> <span class='op'>&lt;-</span> <span class='va'>t</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    panel.grid <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    axis.ticks.x.top <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span></span>
<span>      size <span class='op'>=</span> <span class='fl'>.5</span>, colour <span class='op'>=</span> <span class='st'>"#696969"</span><span class='op'>)</span>, </span>
<span>    axis.ticks.x.bottom <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span></span>
<span>      size <span class='op'>=</span> <span class='fl'>.5</span>, colour <span class='op'>=</span> <span class='st'>"#696969"</span><span class='op'>)</span>,</span>
<span>    plot.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>color<span class='op'>=</span><span class='st'>"#ffffff"</span>, fill<span class='op'>=</span><span class='st'>"#ffffff"</span><span class='op'>)</span>,</span>
<span>    plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>5</span>,<span class='fl'>5</span>,<span class='fl'>5</span>,<span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>t</span> <span class='op'>&lt;-</span> <span class='va'>t</span> <span class='op'>+</span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_flip.html'>coord_flip</a></span><span class='op'>(</span>clip <span class='op'>=</span> <span class='st'>"off"</span>, ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1500</span>, <span class='fl'>4500</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>1.5</span>, <span class='fl'>18.5</span>, <span class='fl'>1</span><span class='op'>)</span>, ymin <span class='op'>=</span><span class='op'>-</span><span class='fl'>1500</span>, ymax <span class='op'>=</span> <span class='fl'>4500</span><span class='op'>)</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, xend <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>ymin</span>, yend <span class='op'>=</span> <span class='va'>ymax</span><span class='op'>)</span>,</span>
<span>    inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>    color <span class='op'>=</span> <span class='st'>"#8e8e8e"</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'>### Annotations for the left name of the communities</span></span>
<span><span class='va'>t</span> <span class='op'>&lt;-</span> <span class='va'>t</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>19.2</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, </span>
<span>                  label <span class='op'>=</span> <span class='st'>"Cataluña"</span>, size <span class='op'>=</span> <span class='fl'>3</span>, </span>
<span>                  colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>18.2</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, </span>
<span>           label <span class='op'>=</span> <span class='st'>"Andalucia"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>17.2</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>,  </span>
<span>           label <span class='op'>=</span> <span class='st'>"Com. de Madrid"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>16.2</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, </span>
<span>           label <span class='op'>=</span> <span class='st'>"C. Valenciana"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>15.2</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>,  </span>
<span>           label <span class='op'>=</span> <span class='st'>"Galicia"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>14.2</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, </span>
<span>           label <span class='op'>=</span> <span class='st'>"Castilla y León"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>13.2</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>,  </span>
<span>           label <span class='op'>=</span> <span class='st'>"C.-La Mancha"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>12.2</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>,  </span>
<span>           label <span class='op'>=</span> <span class='st'>"País Vasco"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>11.2</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, </span>
<span>           label <span class='op'>=</span> <span class='st'>"Aragón"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>10.2</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>,  </span>
<span>           label <span class='op'>=</span> <span class='st'>"Murcia"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>9.2</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, </span>
<span>           label <span class='op'>=</span> <span class='st'>"Extremadura"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>8.2</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>,  </span>
<span>           label <span class='op'>=</span> <span class='st'>"Asturias"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>7.2</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, </span>
<span>           label <span class='op'>=</span> <span class='st'>"Canarias"</span>, size <span class='op'>=</span> <span class='fl'>3</span>, </span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>6.2</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>, </span>
<span>           label <span class='op'>=</span> <span class='st'>"Cantabria"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>5.2</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>,  </span>
<span>           label <span class='op'>=</span> <span class='st'>"Baleares"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>4.2</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>,  </span>
<span>           label <span class='op'>=</span> <span class='st'>"Navarra"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>3.2</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>,  </span>
<span>           label <span class='op'>=</span> <span class='st'>"La Rioja"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2.2</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>,  </span>
<span>           label <span class='op'>=</span> <span class='st'>"Melilla"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>1.2</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, hjust<span class='op'>=</span><span class='fl'>0</span>,  </span>
<span>           label <span class='op'>=</span> <span class='st'>"Ceuta"</span>, size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>           colour <span class='op'>=</span> <span class='st'>"#262626"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>##Annotations for adding the different boxes based on the party in charge of each community</span></span>
<span><span class='va'>t</span><span class='op'>&lt;-</span> <span class='va'>t</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, xmin <span class='op'>=</span> <span class='fl'>19</span>, xmax <span class='op'>=</span> <span class='fl'>18.75</span>,</span>
<span>                 ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1200</span>, fill <span class='op'>=</span> <span class='st'>"#f3af44"</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span> <span class='co'>#Cataluña</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, xmin <span class='op'>=</span> <span class='fl'>18</span>, xmax <span class='op'>=</span> <span class='fl'>17.75</span>, <span class='co'>#Andalucia</span></span>
<span>           ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1200</span>, fill <span class='op'>=</span> <span class='st'>"#0086c5"</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, xmin <span class='op'>=</span> <span class='fl'>17</span>, xmax <span class='op'>=</span> <span class='fl'>16.75</span>, <span class='co'>#Com.Mad</span></span>
<span>           ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1200</span>, fill <span class='op'>=</span> <span class='st'>"#0086c5"</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, xmin <span class='op'>=</span> <span class='fl'>16</span>, xmax <span class='op'>=</span> <span class='fl'>15.75</span>, <span class='co'>#C.Valenciana</span></span>
<span>           ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1200</span>, fill <span class='op'>=</span> <span class='st'>"#e52b43"</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, xmin <span class='op'>=</span> <span class='fl'>15</span>, xmax <span class='op'>=</span> <span class='fl'>14.75</span>, <span class='co'>#Galicia</span></span>
<span>           ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1200</span>, fill <span class='op'>=</span> <span class='st'>"#0086c5"</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, xmin <span class='op'>=</span> <span class='fl'>14</span>, xmax <span class='op'>=</span> <span class='fl'>13.75</span>, <span class='co'>#CyL</span></span>
<span>           ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1200</span>, fill <span class='op'>=</span> <span class='st'>"#0086c5"</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, xmin <span class='op'>=</span> <span class='fl'>13</span>, xmax <span class='op'>=</span> <span class='fl'>12.75</span>, <span class='co'>#C.Mancha</span></span>
<span>           ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1200</span>, fill <span class='op'>=</span> <span class='st'>"#e52b43"</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, xmin <span class='op'>=</span> <span class='fl'>12</span>, xmax <span class='op'>=</span> <span class='fl'>11.75</span>, <span class='co'>#País Vasco</span></span>
<span>           ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1200</span>, fill <span class='op'>=</span> <span class='st'>"#22823a"</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, xmin <span class='op'>=</span> <span class='fl'>11</span>, xmax <span class='op'>=</span> <span class='fl'>10.75</span>, <span class='co'>#Aragon</span></span>
<span>           ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1200</span>, fill <span class='op'>=</span> <span class='st'>"#e52b43"</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, xmin <span class='op'>=</span> <span class='fl'>10</span>, xmax <span class='op'>=</span> <span class='fl'>9.75</span>, <span class='co'>#Murcia</span></span>
<span>           ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1200</span>, fill <span class='op'>=</span> <span class='st'>"#0086c5"</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, xmin <span class='op'>=</span> <span class='fl'>9</span>, xmax <span class='op'>=</span> <span class='fl'>8.75</span>, <span class='co'>#Extremadura</span></span>
<span>           ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1200</span>, fill <span class='op'>=</span> <span class='st'>"#e52b43"</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, xmin <span class='op'>=</span> <span class='fl'>8</span>, xmax <span class='op'>=</span> <span class='fl'>7.75</span>, <span class='co'>#Asturias</span></span>
<span>           ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1200</span>, fill <span class='op'>=</span> <span class='st'>"#e52b43"</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, xmin <span class='op'>=</span> <span class='fl'>7</span>, xmax <span class='op'>=</span> <span class='fl'>6.75</span>, <span class='co'>#Canarias</span></span>
<span>           ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1200</span>, fill <span class='op'>=</span> <span class='st'>"#e52b43"</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, xmin <span class='op'>=</span> <span class='fl'>6</span>, xmax <span class='op'>=</span> <span class='fl'>5.75</span>, <span class='co'>#Cantabria</span></span>
<span>           ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1200</span>, fill <span class='op'>=</span> <span class='st'>"#81b881"</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, xmin <span class='op'>=</span> <span class='fl'>5</span>, xmax <span class='op'>=</span> <span class='fl'>4.75</span>, <span class='co'>#Baleares</span></span>
<span>           ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1200</span>, fill <span class='op'>=</span> <span class='st'>"#e52b43"</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, xmin <span class='op'>=</span> <span class='fl'>4</span>, xmax <span class='op'>=</span> <span class='fl'>3.75</span>, <span class='co'>#Navarra</span></span>
<span>           ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1200</span>, fill <span class='op'>=</span> <span class='st'>"#e52b43"</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, xmin <span class='op'>=</span> <span class='fl'>3</span>, xmax <span class='op'>=</span> <span class='fl'>2.75</span>, <span class='co'>#Rioja</span></span>
<span>           ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1200</span>, fill <span class='op'>=</span> <span class='st'>"#e52b43"</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, xmin <span class='op'>=</span> <span class='fl'>2</span>, xmax <span class='op'>=</span> <span class='fl'>1.75</span>, <span class='co'>#Melilla</span></span>
<span>           ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1200</span>, fill <span class='op'>=</span> <span class='st'>"#d9d9d9"</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, xmin <span class='op'>=</span> <span class='fl'>1</span>, xmax <span class='op'>=</span> <span class='fl'>0.75</span>, <span class='co'>#Ceuta</span></span>
<span>           ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1400</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1200</span>, fill <span class='op'>=</span> <span class='st'>"#0086c5"</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>###Annotation for the ascendent/descent arrow based on the budget.</span></span>
<span><span class='va'>t</span><span class='op'>&lt;-</span> <span class='va'>t</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>  x <span class='op'>=</span> <span class='fl'>18.85</span>, y <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>  xend <span class='op'>=</span> <span class='fl'>19.1</span>, yend <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>  lineend <span class='op'>=</span> <span class='st'>"round"</span>, </span>
<span>  linejoin <span class='op'>=</span> <span class='st'>"round"</span>,</span>
<span>  size <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>  arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.3</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  colour <span class='op'>=</span> <span class='st'>"#1d1d1b"</span> </span>
<span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='fl'>17.85</span>, y <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fl'>18.1</span>, yend <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    lineend <span class='op'>=</span> <span class='st'>"round"</span>, </span>
<span>    linejoin <span class='op'>=</span> <span class='st'>"round"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.3</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#1d1d1b"</span> </span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='fl'>16.85</span>, y <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fl'>17.1</span>, yend <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    lineend <span class='op'>=</span> <span class='st'>"round"</span>, </span>
<span>    linejoin <span class='op'>=</span> <span class='st'>"round"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.3</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#1d1d1b"</span> </span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='fl'>15.85</span> , y <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fl'>16.1</span>, yend <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    lineend <span class='op'>=</span> <span class='st'>"round"</span>, </span>
<span>    linejoin <span class='op'>=</span> <span class='st'>"round"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.3</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#1d1d1b"</span> </span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='fl'>14.85</span> , y <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fl'>15.1</span>, yend <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    lineend <span class='op'>=</span> <span class='st'>"round"</span>, </span>
<span>    linejoin <span class='op'>=</span> <span class='st'>"round"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.3</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#1d1d1b"</span> </span>
<span>  <span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='fl'>14.1</span> , y <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fl'>13.85</span>, yend <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    lineend <span class='op'>=</span> <span class='st'>"round"</span>, </span>
<span>    linejoin <span class='op'>=</span> <span class='st'>"round"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.3</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#dc3221"</span> </span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='fl'>12.85</span> , y <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fl'>13.1</span>, yend <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    lineend <span class='op'>=</span> <span class='st'>"round"</span>, </span>
<span>    linejoin <span class='op'>=</span> <span class='st'>"round"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.3</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#1d1d1b"</span> </span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='fl'>11.85</span> , y <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fl'>12.1</span>, yend <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    lineend <span class='op'>=</span> <span class='st'>"round"</span>, </span>
<span>    linejoin <span class='op'>=</span> <span class='st'>"round"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.3</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#1d1d1b"</span> </span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='fl'>10.85</span> , y <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fl'>11.1</span>, yend <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    lineend <span class='op'>=</span> <span class='st'>"round"</span>, </span>
<span>    linejoin <span class='op'>=</span> <span class='st'>"round"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.3</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#1d1d1b"</span> </span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='fl'>10.1</span> , y <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fl'>9.85</span>, yend <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    lineend <span class='op'>=</span> <span class='st'>"round"</span>, </span>
<span>    linejoin <span class='op'>=</span> <span class='st'>"round"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.3</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#dc3221"</span> </span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='fl'>8.85</span> , y <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fl'>9.1</span>, yend <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    lineend <span class='op'>=</span> <span class='st'>"round"</span>, </span>
<span>    linejoin <span class='op'>=</span> <span class='st'>"round"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.3</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#1d1d1b"</span> </span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='fl'>7.85</span> , y <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fl'>8.1</span>, yend <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    lineend <span class='op'>=</span> <span class='st'>"round"</span>, </span>
<span>    linejoin <span class='op'>=</span> <span class='st'>"round"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.3</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#1d1d1b"</span> </span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='fl'>6.85</span> , y <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fl'>7.1</span>, yend <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    lineend <span class='op'>=</span> <span class='st'>"round"</span>, </span>
<span>    linejoin <span class='op'>=</span> <span class='st'>"round"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.3</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#1d1d1b"</span> </span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='fl'>5.85</span> , y <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fl'>6.1</span>, yend <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    lineend <span class='op'>=</span> <span class='st'>"round"</span>, </span>
<span>    linejoin <span class='op'>=</span> <span class='st'>"round"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.3</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#1d1d1b"</span> </span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='fl'>4.85</span> , y <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fl'>5.1</span>, yend <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    lineend <span class='op'>=</span> <span class='st'>"round"</span>, </span>
<span>    linejoin <span class='op'>=</span> <span class='st'>"round"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.3</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#1d1d1b"</span> </span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='fl'>3.85</span> , y <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fl'>4.1</span>, yend <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    lineend <span class='op'>=</span> <span class='st'>"round"</span>, </span>
<span>    linejoin <span class='op'>=</span> <span class='st'>"round"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.3</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#1d1d1b"</span> </span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='fl'>2.85</span> , y <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fl'>3.1</span>, yend <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    lineend <span class='op'>=</span> <span class='st'>"round"</span>, </span>
<span>    linejoin <span class='op'>=</span> <span class='st'>"round"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.3</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#1d1d1b"</span> </span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='fl'>2.1</span>, y <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fl'>1.85</span>, yend <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    lineend <span class='op'>=</span> <span class='st'>"round"</span>, </span>
<span>    linejoin <span class='op'>=</span> <span class='st'>"round"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.3</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#dc3221"</span> </span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='fl'>1.1</span> , y <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    xend <span class='op'>=</span> <span class='fl'>0.85</span>, yend <span class='op'>=</span> <span class='fl'>3700</span>,</span>
<span>    lineend <span class='op'>=</span> <span class='st'>"round"</span>, </span>
<span>    linejoin <span class='op'>=</span> <span class='st'>"round"</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.3</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#dc3221"</span> </span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'>### Annotation fot the variations in the GDP.</span></span>
<span></span>
<span><span class='va'>t</span><span class='op'>&lt;-</span> <span class='va'>t</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>18.975</span>, y <span class='op'>=</span> <span class='fl'>3950</span>,</span>
<span>                 label <span class='op'>=</span> <span class='st'>"3.2"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span> <span class='co'>#Cataluña</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>17.975</span>, y <span class='op'>=</span> <span class='fl'>3950</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"2.3"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>16.975</span>, y <span class='op'>=</span> <span class='fl'>3950</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"13.4"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span> <span class='co'>#Madrid</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>15.975</span>, y <span class='op'>=</span> <span class='fl'>3950</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"5"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>14.975</span>, y <span class='op'>=</span> <span class='fl'>3950</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"0.3"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>13.975</span>, y <span class='op'>=</span> <span class='fl'>3950</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"-4.2"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span> <span class='co'>#CyL</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>12.975</span>, y <span class='op'>=</span> <span class='fl'>3950</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"11.9"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>11.975</span>, y <span class='op'>=</span> <span class='fl'>3950</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"14.1"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>10.975</span>, y <span class='op'>=</span> <span class='fl'>3950</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"4.8"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>9.975</span>, y <span class='op'>=</span> <span class='fl'>3950</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"-33.4"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span> <span class='co'>#Murcia</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>8.975</span>, y <span class='op'>=</span> <span class='fl'>3950</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"16.8"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>7.975</span>, y <span class='op'>=</span> <span class='fl'>3950</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"7.1"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>6.975</span>, y <span class='op'>=</span> <span class='fl'>3950</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"8.1"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>5.975</span>, y <span class='op'>=</span> <span class='fl'>3950</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"23.9"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>4.975</span>, y <span class='op'>=</span> <span class='fl'>3950</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"8.1"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>3.975</span>, y <span class='op'>=</span> <span class='fl'>3950</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"34.7"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2.975</span>, y <span class='op'>=</span> <span class='fl'>3950</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"12.8"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>1.975</span>, y <span class='op'>=</span> <span class='fl'>3950</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"-24.4"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>0.975</span>, y <span class='op'>=</span> <span class='fl'>3950</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"-9.3"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> </span>
<span></span>
<span></span>
<span><span class='co'>##Anotation for adding the different text of the party in charge!</span></span>
<span></span>
<span><span class='va'>t</span><span class='op'>&lt;-</span> <span class='va'>t</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>18.875</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1100</span>,</span>
<span>                 label <span class='op'>=</span> <span class='st'>"ERC"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>17.875</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1100</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"PP"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>16.875</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1100</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"PP"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>15.875</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1100</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"PSOE"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>14.875</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1100</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"PP"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>13.875</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1100</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"PP"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>12.875</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1100</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"PSOE"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>11.875</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1100</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"PNV"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>10.875</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1100</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"PSOE"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>9.875</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1100</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"PP"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>8.875</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1100</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"PSOE"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>7.875</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1100</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"PSOE"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>6.875</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1100</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"PSOE"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>5.875</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1100</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"PRC"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span> <span class='co'>##Cantabria</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>4.875</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1100</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"PSOE"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>3.875</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1100</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"PSOE"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>2.875</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1100</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"PSOE"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>1.875</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1100</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"Indep"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>0.875</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1100</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"PP"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> </span>
<span></span>
<span></span>
<span><span class='co'>##Anottation for the tittle of this column</span></span>
<span><span class='va'>t</span><span class='op'>&lt;-</span> <span class='va'>t</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>19.68</span>, y <span class='op'>=</span> <span class='fl'>3200</span>,</span>
<span>                 label <span class='op'>=</span> <span class='st'>"Var. % 2022/23"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>### Adding the data</span></span>
<span><span class='va'>t</span> <span class='op'>&lt;-</span> <span class='va'>t</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></span><span class='op'>(</span>position <span class='op'>=</span> <span class='st'>"dodge"</span>, stat <span class='op'>=</span> <span class='st'>"identity"</span>, width <span class='op'>=</span> <span class='fl'>0.63</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='va'>name</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>breaks<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"2023"</span>,<span class='st'>"2022"</span>,<span class='st'>"2021"</span>, <span class='st'>"2018"</span><span class='op'>)</span>, </span>
<span>                    values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#ff1e26"</span>, <span class='st'>"#5f9dc6"</span>,   <span class='st'>"#8ccaf9"</span>, <span class='st'>"#c5daeb"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>### Labs</span></span>
<span><span class='va'>t</span> <span class='op'>&lt;-</span> <span class='va'>t</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span></span>
<span>    title <span class='op'>=</span> <span class='st'>"EL REPARTO DE LA INVERSIÓN ESTATAL POR CCAA"</span>,</span>
<span>    subtitle <span class='op'>=</span> <span class='st'>"INVERSIÓN REAL \n\n\n"</span>,</span>
<span>    caption <span class='op'>=</span> <span class='st'>"Se añaden 20,52 millones de euros para Ceuta y Melilla \n"</span>,</span>
<span>    fill <span class='op'>=</span> <span class='st'>"En millones de euros"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>t</span> <span class='op'>&lt;-</span> <span class='va'>t</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    axis.title.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust<span class='op'>=</span><span class='fl'>.5</span>, color<span class='op'>=</span><span class='st'>"black"</span>, </span>
<span>                                size<span class='op'>=</span><span class='fl'>10</span>, face <span class='op'>=</span> <span class='st'>"bold"</span>, </span>
<span>                                margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>10</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    axis.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color<span class='op'>=</span><span class='st'>"black"</span>, </span>
<span>                             size<span class='op'>=</span><span class='fl'>8</span> <span class='op'>)</span>,</span>
<span>    axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color<span class='op'>=</span><span class='st'>"black"</span>,</span>
<span>                               size<span class='op'>=</span><span class='fl'>10</span><span class='op'>)</span>,</span>
<span>    plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust<span class='op'>=</span><span class='op'>-</span><span class='fl'>0</span>, size<span class='op'>=</span><span class='fl'>11</span>, </span>
<span>                              color<span class='op'>=</span><span class='st'>"black"</span>,lineheight<span class='op'>=</span><span class='fl'>.8</span>, </span>
<span>                              face<span class='op'>=</span><span class='st'>"bold"</span>, margin<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust<span class='op'>=</span><span class='fl'>0</span>, vjust <span class='op'>=</span> <span class='fl'>1.2</span>, </span>
<span>                                 size<span class='op'>=</span><span class='fl'>9.5</span>, color<span class='op'>=</span> <span class='st'>"black"</span>, </span>
<span>                                 face <span class='op'>=</span> <span class='st'>"bold"</span>, margin<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>10</span>,<span class='fl'>0</span>,<span class='fl'>10</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    plot.caption <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust<span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.05</span>,margin<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>10</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span><span class='op'>)</span>, </span>
<span>                                size<span class='op'>=</span><span class='fl'>8</span>, color<span class='op'>=</span><span class='st'>"black"</span>, face<span class='op'>=</span><span class='st'>"bold"</span><span class='op'>)</span>,</span>
<span>    plot.title.position <span class='op'>=</span> <span class='st'>"plot"</span>,</span>
<span>    plot.caption.position <span class='op'>=</span> <span class='st'>"plot"</span></span>
<span>  <span class='op'>)</span> </span>
<span></span>
<span><span class='co'>###Anotations for the homemade guide about the different policies parties.</span></span>
<span></span>
<span><span class='va'>t</span><span class='op'>&lt;-</span> <span class='va'>t</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>20.5</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1500</span>,</span>
<span>                 label <span class='op'>=</span> <span class='st'>"Presidencias de las CCAA"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, xmin <span class='op'>=</span> <span class='fl'>20.25</span>, xmax <span class='op'>=</span> <span class='fl'>20</span>,</span>
<span>           ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1500</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1300</span>, fill <span class='op'>=</span> <span class='st'>"#e52b43"</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span><span class='co'>#Color PSOE</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, xmin <span class='op'>=</span> <span class='fl'>20.25</span>, xmax <span class='op'>=</span> <span class='fl'>20</span>,</span>
<span>           ymin <span class='op'>=</span> <span class='op'>-</span><span class='fl'>500</span>, ymax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>300</span>, fill <span class='op'>=</span> <span class='st'>"#0086c5"</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span> <span class='co'>#Color PP</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, xmin <span class='op'>=</span> <span class='fl'>20.25</span>, xmax <span class='op'>=</span> <span class='fl'>20</span>,</span>
<span>           ymin <span class='op'>=</span> <span class='fl'>500</span>, ymax <span class='op'>=</span> <span class='fl'>700</span>, fill <span class='op'>=</span> <span class='st'>"#f3af44"</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>+</span> <span class='co'>#Color ERC</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, xmin <span class='op'>=</span> <span class='fl'>20.25</span>, xmax <span class='op'>=</span> <span class='fl'>20</span>,</span>
<span>           ymin <span class='op'>=</span> <span class='fl'>1500</span>, ymax <span class='op'>=</span> <span class='fl'>1700</span>, fill <span class='op'>=</span> <span class='st'>"#22823a"</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>+</span> <span class='co'>#Color PNV</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, xmin <span class='op'>=</span> <span class='fl'>20.25</span>, xmax <span class='op'>=</span> <span class='fl'>20</span>,</span>
<span>           ymin <span class='op'>=</span> <span class='fl'>2500</span>, ymax <span class='op'>=</span> <span class='fl'>2700</span>, fill <span class='op'>=</span> <span class='st'>"#81b881"</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>+</span> <span class='co'>#Color PRC</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"rect"</span>, xmin <span class='op'>=</span> <span class='fl'>20.25</span>, xmax <span class='op'>=</span> <span class='fl'>20</span>,</span>
<span>           ymin <span class='op'>=</span> <span class='fl'>3500</span>, ymax <span class='op'>=</span> <span class='fl'>3700</span>, fill <span class='op'>=</span> <span class='st'>"#d9d9d9"</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>+</span> <span class='co'>#Color Indep.</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>20.125</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1275</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"PSOE"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>20.125</span>, y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>275</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"PP"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>20.125</span>, y <span class='op'>=</span> <span class='fl'>725</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"ERC"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>20.125</span>, y <span class='op'>=</span> <span class='fl'>1725</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"PNV"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>20.125</span>, y <span class='op'>=</span> <span class='fl'>2725</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"PRC"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span>geom <span class='op'>=</span> <span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>20.125</span>, y <span class='op'>=</span> <span class='fl'>3725</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"Indep."</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>### Legend</span></span>
<span><span class='va'>t</span><span class='op'>&lt;-</span> <span class='va'>t</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    legend.direction <span class='op'>=</span> <span class='st'>"horizontal"</span>,</span>
<span>    legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.295</span>, <span class='fl'>1.027</span><span class='op'>)</span>, </span>
<span>    legend.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span>,</span>
<span>    legend.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"black"</span>, size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span>,</span>
<span>    legend.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"black"</span>, size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span>,</span>
<span>    legend.spacing.x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.09</span>, <span class='st'>'cm'</span><span class='op'>)</span>,</span>
<span>    legend.key.size <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.6</span>, <span class='st'>"cm"</span><span class='op'>)</span>,</span>
<span>    legend.key.height<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.3</span>, <span class='st'>'cm'</span><span class='op'>)</span>,</span>
<span>    legend.key.width <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.65</span>, <span class='st'>"cm"</span><span class='op'>)</span>,</span>
<span>    legend.spacing.y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.1</span>,<span class='st'>'cm'</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>fill<span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guide_legend.html'>guide_legend</a></span><span class='op'>(</span>title.position <span class='op'>=</span> <span class='st'>"top"</span>, title.hjust <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>t</span><span class='op'>&lt;-</span> <span class='va'>t</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"2508.9"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"2318.8"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"1305.4"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>, </span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"1269.5"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"1077.9"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"955.8"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"600.7"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"558.8"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"547.9"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"481.5"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"473.9"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span><span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"420.9"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"391.9"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"296.6"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"186.3"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span> <span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"103.8"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"71.3"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"45.3"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>value</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"28.9"</span><span class='op'>)</span>, <span class='va'>value</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>    position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span>,</span>
<span>    vjust <span class='op'>=</span> <span class='fl'>0.75</span>, size <span class='op'>=</span> <span class='fl'>2.8</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"#262626"</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='va'>t</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://wilkelab.org/cowplot/reference/ggdraw.html'>ggdraw</a></span><span class='op'>(</span><span class='fu'><a href='https://wilkelab.org/cowplot/reference/add_sub.html'>add_sub</a></span><span class='op'>(</span><span class='va'>t</span>, <span class='st'>"Fuente:PGE 2023, 2022, 2021 Y 2018 \nP.Arroyo | MUCSS"</span>, </span>
<span>                    y <span class='op'>=</span> <span class='fl'>0.8</span>, x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.01</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, vjust <span class='op'>=</span> <span class='fl'>0.85</span>, size <span class='op'>=</span> <span class='fl'>7.8</span>, </span>
<span>                    color <span class='op'>=</span> <span class='st'>"black"</span>, lineheight <span class='op'>=</span> <span class='fl'>0.85</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>t</span></span></code></pre>
</div>
<p><img src="100483607_files/figure-html5/unnamed-chunk-14-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<h2 id="conclusion">Conclusion</h2>
<p>Once I completed the whole project, I have to say that it is a challenging process. You will be dealing with new tools that we have never seen before although they are really useful.
You will realize that after many hours of work, those things that in the first lesson sound like double Dutch to us, little by little everything starts to make sense. So, enjoy the process because this wonderful world of <strong><em>Data Visualization</em></strong> has many things to discover.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Rodriguez (2023, Jan. 5). Data visualization | MSc CSS: Distribution of state investment by autonomous communities. Retrieved from https://csslab.uc3m.es/dataviz/projects/2022/100483607/</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@misc{rodriguez2023distribution,
  author = {Rodriguez, Pablo Arroyo},
  title = {Data visualization | MSc CSS: Distribution of state investment by autonomous communities},
  url = {https://csslab.uc3m.es/dataviz/projects/2022/100483607/},
  year = {2023}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<!--radix_placeholder_navigation_after_body--><html><body>
<div class="distill-site-nav distill-site-footer">
<p><img src="../../../assets/acronimo_nombre1l_0.png" width="400"></p>
</div>
<!--/radix_placeholder_navigation_after_body-->
</body></html>


</body>

</html>
