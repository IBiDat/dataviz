<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
<title>Data visualization | MSc CSS: Bump chart: How Americans spend their money</title>

<meta property="description" itemprop="description" content="Code to replicate the graph in `ggplot2` and some improvements."/>

<link rel="canonical" href="https://csslab.uc3m.es/dataviz/projects/2022/100481925/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2023-01-05"/>
<meta property="article:created" itemprop="dateCreated" content="2023-01-05"/>
<meta name="article:author" content="Carolina Cornejo Castellano"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Data visualization | MSc CSS: Bump chart: How Americans spend their money"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Code to replicate the graph in `ggplot2` and some improvements."/>
<meta property="og:url" content="https://csslab.uc3m.es/dataviz/projects/2022/100481925/"/>
<meta property="og:image" content="https://csslab.uc3m.es/dataviz/projects/2022/100481925/images/replica.png"/>
<meta property="og:image:width" content="994"/>
<meta property="og:image:height" content="825"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Data visualization | MSc CSS"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="Data visualization | MSc CSS: Bump chart: How Americans spend their money"/>
<meta property="twitter:description" content="Code to replicate the graph in `ggplot2` and some improvements."/>
<meta property="twitter:url" content="https://csslab.uc3m.es/dataviz/projects/2022/100481925/"/>
<meta property="twitter:image" content="https://csslab.uc3m.es/dataviz/projects/2022/100481925/images/replica.png"/>
<meta property="twitter:image:width" content="994"/>
<meta property="twitter:image:height" content="825"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="Data visualization | MSc CSS: Bump chart: How Americans spend their money"/>
<meta name="citation_fulltext_html_url" content="https://csslab.uc3m.es/dataviz/projects/2022/100481925/"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2023/01/05"/>
<meta name="citation_publication_date" content="2023/01/05"/>
<meta name="citation_author" content="Carolina Cornejo Castellano"/>
<!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Useful junk?: the effects of visual embellishment on comprehension and memorability of charts;citation_publisher=ACM Press;citation_doi=10.1145/1753326.1753716;citation_author=Scott Bateman;citation_author=Regan L. Mandryk;citation_author=Carl Gutwin;citation_author=Aaron Genest;citation_author=David McDine;citation_author=Christopher Brooks"/>
  <meta name="citation_reference" content="citation_title=America’s favorite dog breeds for the past two decades, ranked;citation_issn=0190-8286;citation_author=Philip Bump"/>
  <meta name="citation_reference" content="citation_title=The elements of graphing data;citation_publisher=Wadsworth Advanced Books and Software;citation_author=William S. Cleveland"/>
  <meta name="citation_reference" content="citation_title=Data visualization: a practical introduction;citation_publisher=Princeton University Press;citation_author=Kieran Healy"/>
  <meta name="citation_reference" content="citation_title=Crowdsourcing Graphical Perception: Using Mechanical Turk to Assess Visualization Design;citation_author=Jeffrey Heer;citation_author=Michael Bostock"/>
  <meta name="citation_reference" content="citation_title=How Do Americans Spend Their Money, By Generation?;citation_author=Preethi Lodha"/>
  <meta name="citation_reference" content="citation_title=The visual display of quantitative information;citation_publisher=Graphics Press;citation_author=Edward R. Tufte"/>
  <meta name="citation_reference" content="citation_title=The grammar of graphics;citation_publisher=Springer;citation_author=Leland Wilkinson;citation_author=Graham Wills"/>
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["creative_commons","title","description","categories","author","date","output","bibliography","preview","citation_url","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["CC BY"]},{"type":"character","attributes":{},"value":["Bump chart: How Americans spend their money"]},{"type":"character","attributes":{},"value":["Code to replicate the graph in `ggplot2` and some improvements."]},{"type":"character","attributes":{},"value":["2022"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Carolina Cornejo Castellano"]}]}]},{"type":"character","attributes":{},"value":["2023-01-05"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["biblio.yaml"]},{"type":"character","attributes":{},"value":["images/replica.png"]},{"type":"character","attributes":{},"value":["https://csslab.uc3m.es/dataviz/projects/2022/100481925/"]},{"type":"character","attributes":{},"value":["https://csslab.uc3m.es/dataviz/projects/2022/100481925/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["100481925_files/anchor-4.2.2/anchor.min.js","100481925_files/bowser-1.9.3/bowser.min.js","100481925_files/distill-2.2.21/template.v2.js","100481925_files/figure-html5/unnamed-chunk-10-1.png","100481925_files/figure-html5/unnamed-chunk-16-1.png","100481925_files/figure-html5/unnamed-chunk-25-1.png","100481925_files/figure-html5/unnamed-chunk-27-1.png","100481925_files/figure-html5/unnamed-chunk-35-1.png","100481925_files/figure-html5/unnamed-chunk-38-1.png","100481925_files/header-attrs-2.19/header-attrs.js","100481925_files/jquery-3.6.0/jquery-3.6.0.js","100481925_files/jquery-3.6.0/jquery-3.6.0.min.js","100481925_files/jquery-3.6.0/jquery-3.6.0.min.map","100481925_files/popper-2.6.0/popper.min.js","100481925_files/tippy-6.2.7/tippy-bundle.umd.min.js","100481925_files/tippy-6.2.7/tippy-light-border.css","100481925_files/tippy-6.2.7/tippy.css","100481925_files/tippy-6.2.7/tippy.umd.min.js","100481925_files/webcomponents-2.0.0/webcomponents.js","biblio.yaml","data.csv","images/alternative_bar.png","images/alternative_lol.png","images/alternative_tree.png","images/enhancements.png","images/gestalt-inferences.png","images/original.png","images/replica.png","images/sankey.png","images/washington-post-most-popular-breeds.png"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme
  $('code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */

@import url('https://fonts.googleapis.com/css2?family=Questrial');

html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    "Questrial", sans-serif;
  --mono-font:       monospace;
  --body-font:       "Questrial", sans-serif;
  --navbar-font:     "Questrial", sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #000e78;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #000e78;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */

@media screen and (min-width: 768px) {
  d-article aside {
    height: 0;
  }
  aside.slides {
    margin-left: -148px;
    height: auto;
  }
  aside.slides + h2 {
    white-space: nowrap;
  }
}

d-article li {
  margin-bottom: 0.1em;
}

.posts-list .post-preview .thumbnail {
  max-height: 300px;
  overflow: hidden;
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../../site_libs/header-attrs-2.19/header-attrs.js"></script>
  <script src="../../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Bump chart: How Americans spend their money","description":"Code to replicate the graph in `ggplot2` and some improvements.","authors":[{"author":"Carolina Cornejo Castellano","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2023-01-05T00:00:00.000+01:00","citationText":"Castellano, 2023"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<span class="logo">
<img src="../../../assets/acronimo_0.png"/>
</span>
<a href="../../../index.html" class="title">Data visualization | MSc CSS</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../../contents.html">Contents</a>
<a href="../../../tutorials.html">Tutorials</a>
<a href="../../../resources.html">Resources</a>
<a href="../../../projects.html">Projects</a>
<a href="https://github.com/IBiDat/dataviz" aria-label="Link to source">
<i class="fab fa-github" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Bump chart: How Americans spend their money</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
  <a href="../../../projects.html#category:2022" class="dt-tag">2022</a>
</div>
<!--/radix_placeholder_categories-->
<p><p>Code to replicate the graph in <code>ggplot2</code> and some improvements.</p></p>
</div>

<div class="d-byline">
  
  Carolina Cornejo Castellano
  
<br/>2023-01-05
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#background">Background</a></li>
<li><a href="#what-is-it-for-representing-how-americans-distributed-their-spending-in-2021">What is it for? Representing how Americans distributed their spending in 2021</a></li>
<li><a href="#what-can-be-seen-here-encodings-channels-and-strengths">What can be seen here? Encodings, channels and strengths</a>
<ul>
<li><a href="#replication-in-r">Replication in R</a></li>
</ul></li>
<li><a href="#how-can-it-be-improved-enhancements">How can it be improved? Enhancements</a>
<ul>
<li><a href="#designing-the-enhancements-proposal">Designing the enhancements proposal</a></li>
</ul></li>
<li><a href="#alternative-visualizations">Alternative visualization(s)</a>
<ul>
<li><a href="#designing-the-bar-plot">Designing the bar plot</a></li>
<li><a href="#designing-the-lollipop-plot">Designing the lollipop plot</a></li>
<li><a href="#designing-the-treemap">Designing the treemap</a></li>
</ul></li>
</ul>
</nav>
</div>
<h2 id="introduction">Introduction</h2>
<p>On September 25, 2022, the <a href="https://www.visualcapitalist.com/"><em>Visual Capitalist</em></a>, a digital media focused on generating data-centric visual content, published the article <em>How Do Americans Spend Their Money, By Generation?</em> The author of the visualization is Preethi Lodha, and the author of the article is Carmen Ang.</p>
<p>This report aims to discuss Preethi Lodha’s <span class="citation" data-cites="lodhaHowAmericansSpend2022">(<a href="#ref-lodhaHowAmericansSpend2022" role="doc-biblioref">Lodha 2022</a>)</span> graphic in the light of data visualization theory. Thus, some questions that will guide this narrative are: <em>What information does it intend to show? Does it achieve it? How and through what encodings and channels? What are its strengths and points of improvement?</em> Likewise, improvements and alternative visualizations are proposed, which are also not without their own room for improvement.</p>
<h2 id="background">Background</h2>
<p>The article collected data from the 2021 Consumer Expenditure Surveys (CES) from the <a href="https://www.bls.gov/cex/tables/calendar-year/mean-item-share-average-standard-error/reference-person-age-generation-2021.pdf">U.S. Bureau of Labor Statistics</a>. Specifically, the data used for the visualization was that published in PDF format in <em>Table 2602. Generation of reference person: Annual expenditure means, shares, standard errors, and coefficients of variation</em>.</p>
<p>The source of the article and the original graphic can be accessed <a href="https://www.visualcapitalist.com/cp/how-americans-spend-their-money-2022/">here</a>. This report was written in December 2022.</p>
<h2 id="what-is-it-for-representing-how-americans-distributed-their-spending-in-2021">What is it for? Representing how Americans distributed their spending in 2021</h2>
<p>First, the context and intentionality must be understood. The graphics must be understandable by themselves, and also in their context.</p>
<p>As for the article on the <em>Visual Capitalist</em> website, it has as newsworthiness —in Spanish journalist jargon we call it “la pepa”— to show the distribution of Americans’ spending in 2021. Although the title of the article does not specify that the information is from the previous year —it was written and published in 2022—, but the information is from 2021- this type of generalization or omissions are common in the titles and/or in the headlines of journalistic articles: they are licenses that journalists give themselves to attract the reader’s attention. The content of the article clearly specifies the source of information—the PDF—and that it refers to 2021. So it’s not a time series, it’s just a picture of that moment.</p>
<figure>
<img src="images/original.png" class="external" style="width:100.0%" alt="Screenshot of the public Tableau dashboard How Americans spend their money, by Preethi Lodha. Published in: https://www.visualcapitalist.com/cp/how-americans-spend-their-money-2022/" /><figcaption aria-hidden="true">Screenshot of the public Tableau dashboard <em>How Americans spend their money</em>, by Preethi Lodha. Published in: <a href="https://www.visualcapitalist.com/cp/how-americans-spend-their-money-2022/" class="uri">https://www.visualcapitalist.com/cp/how-americans-spend-their-money-2022/</a></figcaption>
</figure>
<p>As for the graphic, the author used Tableau to build a <em>bump chart</em> that includes interactive elements when hovering over the dots; but for the purposes of this report, those elements will not be taken into account: only what is seen in the screenshot above is considered.</p>
<aside>
Note that we use the term <em>bump chart</em> because this type of visualization is commonly found with that name on the Internet. However, in the article of the Visual Capitalist they refer to it as a “graph” and in this report we try to call the other visualizations as “graphic,” as proposed by <span class="citation" data-cites="wilkinsonGrammarGraphics2005"><a href="#ref-wilkinsonGrammarGraphics2005" role="doc-biblioref">Wilkinson and Wills</a> (<a href="#ref-wilkinsonGrammarGraphics2005" role="doc-biblioref">2005</a>)</span>.
</aside>
<p>Bump charts are useful for exploring changes in rank over time across different categories. That is, they usually do not show the actual values of the categories —which in this case would be the money spent by each generation for each spending category—, but the positions in the ranking. In this case, the ranking moves of 14 spending categories are shown, based on the birth year range from the <em>Silent</em> generation (the oldest) to <em>Generation Z</em>.</p>
<p>At first glance, this and, in general, all bump charts shows three variables in an easy-to-understand way: category, time and position. That’s especially true in cases of graphics where <em>the only important thing</em> is the ranking. For example, this image from <a href="https://www.washingtonpost.com/news/wonk/wp/2015/02/27/americas-favorite-dog-breeds-for-the-past-two-decades-ranked/">The Washington Post</a> from 2015 shows the “favorite” dog breeds, according to the American Kennel Club, where the three important variables are breed of dog, year, and position in the ranking <span class="citation" data-cites="bumpAmericaFavoriteDog2021">(<a href="#ref-bumpAmericaFavoriteDog2021" role="doc-biblioref">Bump 2021</a>)</span>.</p>
<figure>
<img src="images/washington-post-most-popular-breeds.png" class="external" style="width:100.0%" alt="Article published by Philip Bump in The Washington Post: https://www.washingtonpost.com/news/wonk/wp/2015/02/27/americas-favorite-dog-breeds-for-the-past-two-decades-ranked/" /><figcaption aria-hidden="true">Article published by Philip Bump in The Washington Post: <a href="https://www.washingtonpost.com/news/wonk/wp/2015/02/27/americas-favorite-dog-breeds-for-the-past-two-decades-ranked/" class="uri">https://www.washingtonpost.com/news/wonk/wp/2015/02/27/americas-favorite-dog-breeds-for-the-past-two-decades-ranked/</a></figcaption>
</figure>
<p>However, there is another important piece of information in Preethi Lodha’s graph, which is the dollar amount spent by each generation for each expenditure category. This is presented within each point and is undoubtedly important if one wants to know how spending is distributed; however, that oscillation is not displayed with any other visual mark and can be misleading. This point will be discussed later.</p>
<h2 id="what-can-be-seen-here-encodings-channels-and-strengths">What can be seen here? Encodings, channels and strengths</h2>
<p>There are 14 spending categories represented on the Y axis and 5 generations or age ranges showed on the X axis, above the graph and below the title and subtitle, from the <em>Silent</em> generation (the oldest) to the <em>Generation Z</em>.</p>
<p>According to <span class="citation" data-cites="clevelandElementsGraphingData1985"><a href="#ref-clevelandElementsGraphingData1985" role="doc-biblioref">Cleveland</a> (<a href="#ref-clevelandElementsGraphingData1985" role="doc-biblioref">1985</a>)</span>, graphs encode data in distinct elements, such as symbols, colors, position, etc. When we study a graphic we perform several mental-visual tasks to extract quantitative information. Some of the basic judgements we perform to decode quantitative information are 1) angle, 2) area, 3) color hue, 4) color saturation, 5) density, 6) length, 7) position along a common scale, 8) position along identical, nonaligned scales, 9) slope, and 10) volume <span class="citation" data-cites="clevelandElementsGraphingData1985">(<a href="#ref-clevelandElementsGraphingData1985" role="doc-biblioref">Cleveland 1985</a>)</span>.</p>
<p>In consideration of this, the information in the bump chart can be extracted by judgements of position along the vertical scale, which represents the spending categories; the color of each line, which represents the categories of expenditure; the position of each point on the X axis, which represents the generation; and the thickness of the lines, which represents the money spent in each category (the thicker the line the more money has been spent). The closeness of the dots stands for the closeness in the ranking positions. The size of the points does not represent anything.</p>
<p>Cleveland also discusses <em>detection</em>, which he qualifies as the most fundamental perception issue, because before executing any graphical perception task, we must be able to detect the graphical element <span class="citation" data-cites="clevelandElementsGraphingData1985">(<a href="#ref-clevelandElementsGraphingData1985" role="doc-biblioref">Cleveland 1985</a>)</span>. Lodha’s bump chart does not show overlaps in the dots, which together with color and position is the most important symbol. The jumps in the ranking are well understood. In broad terms, the graphic is very readable, which is not the same as effective.</p>
<h3 id="replication-in-r">Replication in R</h3>
<p>An almost exact replica was created using <code>ggplot2</code>,</p>
<p>The libraries used were as follows:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Import libraries</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span> <span class='co'># for data manipulation</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span> <span class='co'># for data graphics.</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://wilkelab.org/ggtext/'>ggtext</a></span><span class='op'>)</span> <span class='co'># provides markdown and HTML text rendering</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>grid</span><span class='op'>)</span> <span class='co'># for adding the two white lines at the top and bottom</span></span></code></pre>
</div>
</div>
<p>Then, the data was imported. As mentioned above, the data is only a PDF, so the values had to be transcribed manually. After that, we made some transformations.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_csv</a></span><span class='op'>(</span><span class='st'>"data.csv"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 5 × 15
  generation  housing healthcare  food trans…¹ cash_…² enter…³ insur…⁴
  &lt;chr&gt;         &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 silent        16656       7053  5487    5263    4045    2027    1213
2 boomers       21273       6594  7651    9327    2876    3476    6309
3 gen_X         26385       5550 10388   13956    2747    4694   11656
4 millennials   24052       4026  8463   11052    1163    3457    9249
5 gen_Z         15449       1354  5529    7929     760    1693    3871
# … with 7 more variables: miscellaneous &lt;dbl&gt;, apparel &lt;dbl&gt;,
#   personal_care &lt;dbl&gt;, education &lt;dbl&gt;, alcohol &lt;dbl&gt;,
#   reading &lt;dbl&gt;, smoking &lt;dbl&gt;, and abbreviated variable names
#   ¹​transportation, ²​cash_contributions, ³​entertainment, ⁴​insurance</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Pivot longer, add ranks and order chronologically</span></span>
<span><span class='va'>df</span> <span class='op'>&lt;-</span> <span class='va'>df</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>generation</span>, names_to <span class='op'>=</span> <span class='st'>"variables"</span>, values_to <span class='op'>=</span> <span class='st'>"dollars"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>generation</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>generation</span>, <span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>dollars</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>ranking <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/ranking.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Manually renaming</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>generation</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>generation</span> <span class='op'>==</span> <span class='st'>"silent"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"Silent"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>generation</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>generation</span> <span class='op'>==</span> <span class='st'>"boomers"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"Boomers"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>generation</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>generation</span> <span class='op'>==</span> <span class='st'>"gen_X"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"Generation X"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>generation</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>generation</span> <span class='op'>==</span> <span class='st'>"millennials"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"Millennials"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>generation</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>generation</span> <span class='op'>==</span> <span class='st'>"gen_Z"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"Generation Z"</span></span>
<span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span> <span class='op'>==</span> <span class='st'>"alcohol"</span><span class='op'>]</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='st'>"Alcoholic beverages"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span> <span class='op'>==</span> <span class='st'>"apparel"</span><span class='op'>]</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='st'>"Apparel and services"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span> <span class='op'>==</span> <span class='st'>"cash_contributions"</span><span class='op'>]</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='st'>"Cash contributions"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span> <span class='op'>==</span> <span class='st'>"education"</span><span class='op'>]</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='st'>"Education"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span> <span class='op'>==</span> <span class='st'>"entertainment"</span><span class='op'>]</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='st'>"Entertainment"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span> <span class='op'>==</span> <span class='st'>"food"</span><span class='op'>]</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='st'>"Food"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span> <span class='op'>==</span> <span class='st'>"entertainment"</span><span class='op'>]</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='st'>"Entertainment"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span> <span class='op'>==</span> <span class='st'>"healthcare"</span><span class='op'>]</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='st'>"Healthcare"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span> <span class='op'>==</span> <span class='st'>"housing"</span><span class='op'>]</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='st'>"Housing"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span> <span class='op'>==</span> <span class='st'>"insurance"</span><span class='op'>]</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='st'>"Personal insurance and pensions"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span> <span class='op'>==</span> <span class='st'>"miscellaneous"</span><span class='op'>]</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='st'>"Miscellaneous expenditures"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span> <span class='op'>==</span> <span class='st'>"personal_care"</span><span class='op'>]</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='st'>"Personal care products and services"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span> <span class='op'>==</span> <span class='st'>"reading"</span><span class='op'>]</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='st'>"Reading"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span> <span class='op'>==</span> <span class='st'>"smoking"</span><span class='op'>]</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='st'>"Tobacco products and smoking \n supplies"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span> <span class='op'>==</span> <span class='st'>"transportation"</span><span class='op'>]</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='st'>"Transportation"</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Formatting the dollars' column</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>dollars</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>$</span><span class='va'>dollars</span>, big.mark<span class='op'>=</span><span class='st'>","</span>, trim<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>dollars</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"$"</span>, <span class='va'>df</span><span class='op'>$</span><span class='va'>dollars</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Character vectors were created to 1) sort the generation names chronologically because ggplot2 displayed them in alphabetical order, 2) format them in HTML language that will later be rendered by the <code>ggtext</code> package, and 3) to add as <em>tag</em> the description of the X-axis.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>x_names_ordered</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Silent"</span>, </span>
<span>                     <span class='st'>"Boomers"</span>, </span>
<span>                     <span class='st'>"Generation X"</span>, </span>
<span>                     <span class='st'>"Millennials"</span>, </span>
<span>                     <span class='st'>"Generation Z"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>x_names_full</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"&lt;span style='font-size: 9.55pt'&gt;**Silent**&lt;/span&gt;"</span>,</span>
<span>        <span class='st'>"1945 or earlier"</span>,</span>
<span>        <span class='st'>"**$44,683**"</span>,</span>
<span>        sep <span class='op'>=</span> <span class='st'>"&lt;br&gt;"</span><span class='op'>)</span>,</span>
<span>  </span>
<span>  </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"&lt;span style='font-size: 9.55pt'&gt;**Boomers**&lt;/span&gt;"</span>,</span>
<span>        <span class='st'>"1946 to 1964"</span>,</span>
<span>        <span class='st'>"**$62,203**"</span>,</span>
<span>        sep <span class='op'>=</span> <span class='st'>"&lt;br&gt;"</span><span class='op'>)</span>,</span>
<span></span>
<span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"&lt;span style='font-size: 9.55pt'&gt;**Generation X**&lt;/span&gt;"</span>,</span>
<span>        <span class='st'>"1965 to 1980"</span>,</span>
<span>        <span class='st'>"**$83,357**"</span>,</span>
<span>        sep <span class='op'>=</span> <span class='st'>"&lt;br&gt;"</span><span class='op'>)</span>,</span>
<span>  </span>
<span>  </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"&lt;span style='font-size: 9.55pt'&gt;**Millennials**&lt;/span&gt;"</span>,</span>
<span>    <span class='st'>"1981 to 1996"</span>,</span>
<span>    <span class='st'>"**$69,061**"</span>,</span>
<span>    sep <span class='op'>=</span> <span class='st'>"&lt;br&gt;"</span><span class='op'>)</span>,</span>
<span>  </span>
<span>  </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"&lt;span style='font-size: 9.55pt'&gt;**Generation Z**&lt;/span&gt;"</span>,</span>
<span>    <span class='st'>"1997 or later"</span>,</span>
<span>    <span class='st'>"**$41,636**"</span>,</span>
<span>    sep <span class='op'>=</span> <span class='st'>"&lt;br&gt;"</span><span class='op'>)</span></span>
<span></span>
<span>                <span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>x_lab</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span></span>
<span>  <span class='st'>"&lt;span style='font-size: 10pt'&gt;**Generation**&lt;/span&gt;"</span>,</span>
<span>  <span class='st'>"Birth Year Range"</span>,</span>
<span>  <span class='st'>"**Average Annual Expenditure**"</span>,</span>
<span>  sep <span class='op'>=</span> <span class='st'>"&lt;br&gt;"</span></span>
<span>              <span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Then the theme was built. We call this theme <code>theme_bump</code>. Before that, we saved as objects the codes of the two main colors: the one of the background and the one of the text.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Colors</span></span>
<span><span class='va'>color_background</span> <span class='op'>&lt;-</span> <span class='st'>"#e5d9cf"</span></span>
<span><span class='va'>color_text</span> <span class='op'>&lt;-</span> <span class='st'>"#333333"</span></span></code></pre>
</div>
</div>
<p>The textual elements were changed from <code>element_text</code> to <code>element_markdown</code> of the <code>ggtext</code> package. This allows to use markdown or HTML to design text strings.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>theme_bump</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>{</span></span>
<span></span>
<span>  <span class='co'># Begin construction of the theme</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span>base_size <span class='op'>=</span> <span class='fl'>15</span><span class='op'>)</span> <span class='op'>+</span></span>
<span></span>
<span>    <span class='co'># Format background colors</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span></span>
<span>      fill <span class='op'>=</span> <span class='va'>color_background</span>, </span>
<span>      color <span class='op'>=</span> <span class='va'>color_background</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span></span>
<span>      fill <span class='op'>=</span> <span class='va'>color_background</span>, </span>
<span>      color <span class='op'>=</span> <span class='va'>color_background</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>panel.border <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span></span>
<span>      color <span class='op'>=</span> <span class='va'>color_background</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>strip.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span></span>
<span>      fill <span class='op'>=</span> <span class='va'>color_background</span>, </span>
<span>      color <span class='op'>=</span> <span class='va'>color_background</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span></span>
<span>    <span class='co'># Format the grid</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.ticks <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>panel.grid <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span></span>
<span>      colour <span class='op'>=</span> <span class='va'>color_background</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span></span>
<span>    <span class='co'># Format the legend</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span></span>
<span>    <span class='co'># Format de caption</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.caption <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span></span>
<span>      hjust <span class='op'>=</span> <span class='fl'>0.6</span>, </span>
<span>      vjust<span class='op'>=</span> <span class='fl'>0.1</span>, </span>
<span>      size <span class='op'>=</span> <span class='fl'>5.45</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span></span>
<span>    <span class='co'># Format title and axis labels</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span></span>
<span>      color <span class='op'>=</span> <span class='va'>color_text</span>, </span>
<span>      size <span class='op'>=</span> <span class='fl'>17.5</span>, </span>
<span>      face <span class='op'>=</span> <span class='st'>"bold"</span>, </span>
<span>      hjust <span class='op'>=</span> <span class='fl'>0.5</span>, </span>
<span>      margin<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>10</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span></span>
<span>      color <span class='op'>=</span> <span class='va'>color_text</span>, </span>
<span>      size <span class='op'>=</span> <span class='fl'>11</span>, </span>
<span>      hjust <span class='op'>=</span> <span class='fl'>0.5</span>, </span>
<span>      face <span class='op'>=</span> <span class='st'>"bold"</span>, </span>
<span>      margin<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>22</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.title.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.title.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text.x.top <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span></span>
<span>      color <span class='op'>=</span> <span class='st'>"#3b3b3a"</span>, </span>
<span>      family <span class='op'>=</span> <span class='st'>"Arial Narrow"</span>, </span>
<span>      size<span class='op'>=</span><span class='fl'>7.5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='co'># theme(strip.text = element_text(face = "bold")) +</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.tag <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span></span>
<span>      family <span class='op'>=</span> <span class='st'>"Arial Narrow"</span>, </span>
<span>      lineheight <span class='op'>=</span> <span class='fl'>0.1</span>, </span>
<span>      size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.tag.position <span class='op'>=</span> </span>
<span>            <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.10</span>, <span class='fl'>0.85</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span></span>
<span>    <span class='co'># Plot margins</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.margin <span class='op'>=</span> </span>
<span>            <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>0.4</span>, <span class='fl'>0.5</span>, <span class='fl'>0.65</span><span class='op'>)</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># top, right, bottom, left</span></span>
<span><span class='op'>}</span></span></code></pre>
</div>
</div>
<p>We then proceeded to build the bump chart. Note that the following chunk must start with <code>{r fig.width = 8.29, fig.height = 6.88}</code> to display the replica in the same proportions as the original.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>replica</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span></span>
<span>  data <span class='op'>=</span> <span class='va'>df</span>,</span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>generation</span>, </span>
<span>      y <span class='op'>=</span> <span class='va'>ranking</span>, </span>
<span>      group <span class='op'>=</span> <span class='va'>variables</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Add the custom theme just designed</span></span>
<span>   <span class='fu'>theme_bump</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Add the horizontal lines per generation</span></span>
<span>     <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='va'>variables</span>, </span>
<span>                   alpha <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>                   <span class='co'># Change line thickness accordingly:</span></span>
<span>                   linewidth <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='va'>ranking</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='co'># Add the points. The white ones are for the border  </span></span>
<span>   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>11.85</span>, </span>
<span>                color <span class='op'>=</span> <span class='st'>"white"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>     <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='va'>variables</span><span class='op'>)</span>, </span>
<span>                size <span class='op'>=</span> <span class='fl'>11.3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>     <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_reverse</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Order and </span></span>
<span>     <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_discrete.html'>scale_x_discrete</a></span><span class='op'>(</span></span>
<span>       limits <span class='op'>=</span> <span class='va'>x_names_ordered</span>,</span>
<span>       labels <span class='op'>=</span> <span class='va'>x_names_full</span>,</span>
<span>       position <span class='op'>=</span> <span class='st'>"top"</span>,</span>
<span>       expand <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/expansion.html'>expansion</a></span><span class='op'>(</span>mult <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.356</span>, <span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span></span>
<span>                    <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Titles, subtitle, caption and tag </span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span></span>
<span>    title <span class='op'>=</span> <span class='st'>"HOW AMERICANS SPEND THEIR MONEY"</span>,</span>
<span>    subtitle <span class='op'>=</span> <span class='st'>"By Age Group | 2021"</span>,</span>
<span>    caption <span class='op'>=</span> <span class='st'>"Author: Preethi Lodha"</span>,</span>
<span>    tag <span class='op'>=</span> <span class='va'>x_lab</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Add the two horizontal white lines at the top and the bottom</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span>clip <span class='op'>=</span> <span class='st'>"off"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_custom.html'>annotation_custom</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/grid/grid.lines.html'>linesGrob</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.99</span><span class='op'>)</span>, </span>
<span>                                  y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1.11</span>, <span class='fl'>1.11</span><span class='op'>)</span>, </span>
<span>                                  gp <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/gpar.html'>gpar</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"#f0eae8"</span>, </span>
<span>                                            lwd <span class='op'>=</span> <span class='fl'>2.8</span>, </span>
<span>                                            lineend <span class='op'>=</span> <span class='st'>"square"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_custom.html'>annotation_custom</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/grid/grid.lines.html'>linesGrob</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.99</span><span class='op'>)</span>, </span>
<span>                                  y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.05</span>, <span class='op'>-</span><span class='fl'>0.05</span><span class='op'>)</span>, </span>
<span>                                  gp <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/gpar.html'>gpar</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"#f0eae8"</span>, </span>
<span>                                            lwd <span class='op'>=</span> <span class='fl'>2.8</span>, </span>
<span>                                            lineend <span class='op'>=</span> <span class='st'>"square"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Add the Y axis text     </span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>df</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>                    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>generation</span> <span class='op'>==</span> <span class='st'>"Silent"</span><span class='op'>)</span>, </span>
<span>                  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>variables</span>, </span>
<span>                      x <span class='op'>=</span> <span class='fl'>0.72236</span><span class='op'>)</span>, </span>
<span>                  hjust <span class='op'>=</span> <span class='st'>"outward"</span>, </span>
<span>                  fontface <span class='op'>=</span> <span class='st'>"bold"</span>, </span>
<span>                  color <span class='op'>=</span> <span class='st'>"#272727"</span>, </span>
<span>                  size <span class='op'>=</span> <span class='fl'>2.4</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Add the amount money spent.</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>df</span>, </span>
<span>                <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>dollars</span><span class='op'>)</span>, </span>
<span>                hjust <span class='op'>=</span> <span class='st'>"center"</span>, </span>
<span>                color <span class='op'>=</span> <span class='st'>"white"</span>, </span>
<span>                size <span class='op'>=</span> <span class='fl'>2.25</span>, </span>
<span>                fontface <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>df</span>, </span>
<span>                <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>dollars</span><span class='op'>)</span>, </span>
<span>                hjust <span class='op'>=</span> <span class='st'>"center"</span>, </span>
<span>                color <span class='op'>=</span> <span class='st'>"white"</span>, </span>
<span>                size <span class='op'>=</span> <span class='fl'>2.253</span>, </span>
<span>                fontface <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>df</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>dollars</span><span class='op'>)</span>, </span>
<span>                hjust <span class='op'>=</span> <span class='st'>"center"</span>, </span>
<span>                color <span class='op'>=</span> <span class='st'>"white"</span>, </span>
<span>                size <span class='op'>=</span> <span class='fl'>2.257</span>, </span>
<span>                fontface <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Add line colors</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_color_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>        <span class='st'>"#9c6255"</span>,</span>
<span>        <span class='st'>"#a0d4ee"</span>,</span>
<span>        <span class='st'>"#9d8379"</span>,</span>
<span>        <span class='st'>"#8f93b5"</span>,</span>
<span>        <span class='st'>"#494c4d"</span>,</span>
<span>        <span class='st'>"#2f634a"</span>,</span>
<span>        <span class='st'>"#ed444a"</span>,</span>
<span>        <span class='st'>"#8a8887"</span>,</span>
<span>        <span class='st'>"#a13b5d"</span>,</span>
<span>        <span class='st'>"#87a7a0"</span>,</span>
<span>        <span class='st'>"#af9e2e"</span>,</span>
<span>        <span class='st'>"#6d1f29"</span>,</span>
<span>        <span class='st'>"#466f9d"</span>,</span>
<span>        <span class='st'>"#3896c4"</span></span>
<span>      <span class='op'>)</span><span class='op'>)</span> </span>
<span><span class='va'>replica</span></span></code></pre>
</div>
<p><img src="100481925_files/figure-html5/unnamed-chunk-10-1.png" width="795.84" /></p>
</div>
<p>To save the plot:</p>
<pre id="r"><code>ggsave(&quot;replica.png&quot;, 
plot = last_plot(), 
path = &quot;images&quot;, 
width = 8.29, 
height = 6.88, 
units = &quot;in&quot;, 
dpi = 120)</code></pre>
<p>As can be seen below, only the small icons at the bottom left and the interactive box at the top right were not reproduced. Since these are interactive elements in the original dashboard, we did not consider it necessary.</p>
<figure>
<img src="images/original.png" class="external" style="width:100.0%" alt="Original bump chart created by Preethi Lodha." /><figcaption aria-hidden="true">Original bump chart created by Preethi Lodha.</figcaption>
</figure>
<figure>
<img src="images/replica.png" style="width:100.0%" alt="My replica in ggplot2." /><figcaption aria-hidden="true">My replica in <code>ggplot2</code>.</figcaption>
</figure>
<h2 id="how-can-it-be-improved-enhancements">How can it be improved? Enhancements</h2>
<p>From the start, one might question the need to design a graphic to display these data. <span class="citation" data-cites="tufteVisualDisplayQuantitative2013"><a href="#ref-tufteVisualDisplayQuantitative2013" role="doc-biblioref">Tufte</a> (<a href="#ref-tufteVisualDisplayQuantitative2013" role="doc-biblioref">2013</a>)</span> points out that “[t]ables usually outperform graphics in reporting on small data sets of 20 numbers or less” and that “[t]he special power of graphs comes in the display of large data sets.” This case is not a large data set: in fact, the source is a PDF. This peculiarity has pros and cons: on the one hand, to represent expenditure by generation and expenditure category, it is unnecessary to perform many transformations; but on the other hand, it limits the options for alternative graphics.</p>
<p>In terms of features, notwithstanding its goodness, it is noted that this bump chart —and indeed, all of them— give readers the feeling that the difference between each category is about the same because the channels used —width of the lines and distance between them— are the same. Although in this case the thickness of the lines has been manipulated to represent each amount of money, its effect in counteracting that feeling is limited.</p>
<p>Using labels within the circles to show the money spent per category and per generation could have been a wise move, following the postulates of <span class="citation" data-cites="tufteVisualDisplayQuantitative2013"><a href="#ref-tufteVisualDisplayQuantitative2013" role="doc-biblioref">Tufte</a> (<a href="#ref-tufteVisualDisplayQuantitative2013" role="doc-biblioref">2013</a>)</span>, who points that “[c]lear, detailed and thorough labeling should be used to avoid graphic distortion and ambiguity […].” But, in this case, such labels add an extra layer of information and if the bump chart represents jumps in ranking, these were already encoded in the position of the dots and the jumps in the lines. Moreover, there are examples that even though spending in a certain category decreases from one generation to the next, its position in the ranking goes up and vice versa: just look at the jump from <em>Millennials</em> to <em>Generation Z</em> in the category <em>Personal care products and services</em>; and the jump from <em>Boomers</em> to <em>Generation X</em> in the <em>Food</em> category. Tufte himself would call it “a lying graphic” <span class="citation" data-cites="tufteVisualDisplayQuantitative2013">(<a href="#ref-tufteVisualDisplayQuantitative2013" role="doc-biblioref">Tufte 2013</a>)</span>.</p>
<blockquote cite>
“A second defense of the lying graphic is that, although the design itself lies, the actual numbers are printed on the graphic for those picky folks who want to know the correct size of the effects displayed. […]” <span class="citation" data-cites="tufteVisualDisplayQuantitative2013">(<a href="#ref-tufteVisualDisplayQuantitative2013" role="doc-biblioref">Tufte 2013</a>)</span>
</blockquote>
<p>So, if the purpose is to represent the spending distribution of Americans, showing rankings can be misleading. For this reason, the main point of improvement would be to represent spending rather than ranking. This implies to change the type of graph to one where the data items are the money spent and the data attributes are the generation and the category of spending. <span class="citation" data-cites="tufteVisualDisplayQuantitative2013"><a href="#ref-tufteVisualDisplayQuantitative2013" role="doc-biblioref">Tufte</a> (<a href="#ref-tufteVisualDisplayQuantitative2013" role="doc-biblioref">2013</a>)</span>, in this regard, postulates that “[t]he representation of numbers, as physically measured on the surface of the graph itself, should be directly proportional to the numerical quantities represented” <span class="citation" data-cites="tufteVisualDisplayQuantitative2013">(<a href="#ref-tufteVisualDisplayQuantitative2013" role="doc-biblioref">Tufte 2013</a>)</span>. What visual marks would be the most efficient?</p>
<p>In order to continue using lines and dots to represent the data, the proposed enhancements are in a line plot:</p>
<figure>
<img src="images/enhancements.png" style="width:100.0%" alt="A line plot based on Preethi Lodha’s bump chart. This enhancements proposal also has much room for improvement in concept and implementation. Own elaboration." /><figcaption aria-hidden="true">A line plot based on Preethi Lodha’s bump chart. This enhancements proposal also has much room for improvement in concept and implementation. Own elaboration.</figcaption>
</figure>
<p>This is not exempt from problems, both in terms of conception and execution. First, the category with the highest expenditure by far is <em>Housing</em>, but the other categories are very close, which caused problems with overlapping labels. That was the driving force behind plotting only the first 6 expenditure categories. Even so, overlapping continued to exist and the <code>ggrepel</code> package, which would help to solve it, did not really avoid them; it only helped to eliminate the labels that were too close at the cost of dislocating others. Another problem is that, according to <span class="citation" data-cites="healyDataVisualizationPractical2018"><a href="#ref-healyDataVisualizationPractical2018" role="doc-biblioref">Healy</a> (<a href="#ref-healyDataVisualizationPractical2018" role="doc-biblioref">2018</a>)</span>, lines illustrate “connection and common fate in that the lines joining the shapes tend to be read left-to-right as part of a series” <span class="citation" data-cites="healyDataVisualizationPractical2018">(<a href="#ref-healyDataVisualizationPractical2018" role="doc-biblioref">Healy 2018</a>)</span>. He mentions this when explaining Gestalt rules, which are “the strong inferences we make about relationships between visual elements from relatively sparse visual information.” The author emphasizes that line graphs suggest that the underlying variable is continuous and that is not necessarily advantageous for our data, since the X axis contains the generations, but it is not a continuous variable over time.</p>
<figure>
<img src="images/gestalt-inferences.png" class="external" style="width:100.0%" alt="The Gestalt inferences. Extracted from: Data vizualization: a practical introduction, by Kieran Healy. Published by the author in https://socviz.co/" /><figcaption aria-hidden="true">The Gestalt inferences. Extracted from: <strong>Data vizualization: a practical introduction</strong>, by Kieran Healy. Published by the author in <a href="https://socviz.co/" class="uri">https://socviz.co/</a></figcaption>
</figure>
<p>One option was to make a Sankey diagram. These visualize flows of quantities through a process and, as an opinion, are more eye-catching. With a Sankey diagram, we would have split the amount spent by each generation in 2021 into 14 categories of data —or fewer, if we also decide to show only the top categories or to group several ones into “Others”—, and each generation would be a breakdown. However, this would give the false sense that the flow of money changes over a period of time and, in stricto sensu, it is not: spending does not change over time: all the data represented is from 2021. What does change is another categorical variable: generation.</p>
<p>An example of a Sanky diagram from <a href="https://commons.wikimedia.org/wiki/File:Sankey_Diagram_-_Income_Statement.jpg">Wikimedia Commons</a>:</p>
<figure>
<img src="images/sankey.png" class="external" style="width:100.0%" alt="Wikimedia Commons." /><figcaption aria-hidden="true">Wikimedia Commons.</figcaption>
</figure>
<p>In addition, in data visualization, clarity should be privileged over the pomposity: <span class="citation" data-cites="healyDataVisualizationPractical2018"><a href="#ref-healyDataVisualizationPractical2018" role="doc-biblioref">Healy</a> (<a href="#ref-healyDataVisualizationPractical2018" role="doc-biblioref">2018</a>)</span> quotes Tufte about graphical excellence, commenting that it “consists of complex ideas communicated with clarity, precision, and efficiency.” Thus, the idea of a Sankey, despite being relatively simple to execute with the <code>ggsankey</code> package, was discarded. A cleaner, clearer and closer option to Lodha’s original graph is the line plot.</p>
<h3 id="designing-the-enhancements-proposal">Designing the enhancements proposal</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#Libraries, most of them already used in the replica</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://wilkelab.org/ggtext/'>ggtext</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>grid</span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/slowkow/ggrepel'>ggrepel</a></span><span class='op'>)</span> <span class='co'># To (try to) avoid label overlappings</span></span></code></pre>
</div>
</div>
<p>The following pipes were useful for obtaining a suitable dataframe:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_csv</a></span><span class='op'>(</span><span class='st'>"data.csv"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>generation</span>, </span>
<span>               names_to <span class='op'>=</span> <span class='st'>"variables"</span>, </span>
<span>               values_to <span class='op'>=</span> <span class='st'>"dollars"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='co'>#group_by(generation) %&gt;%</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>dollars</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Then, the data was manipulated. Those code chunks will not be showed here as are the same than in the replica (renaming variables using indexing and generating the same character vectors).</p>
<p>The theme was a bit edited. This new version is called <code>theme_lines()</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Colors</span></span>
<span><span class='va'>color_background</span> <span class='op'>&lt;-</span> <span class='st'>"#e5d9cf"</span></span>
<span><span class='va'>color_text</span> <span class='op'>&lt;-</span> <span class='st'>"#333333"</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>theme_lines</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>{</span></span>
<span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span>base_size <span class='op'>=</span> <span class='fl'>15</span><span class='op'>)</span> <span class='op'>+</span></span>
<span></span>
<span>    <span class='co'># Background colors</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span></span>
<span>      fill <span class='op'>=</span> <span class='va'>color_background</span>, </span>
<span>      color <span class='op'>=</span> <span class='va'>color_background</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span></span>
<span>      fill <span class='op'>=</span> <span class='va'>color_background</span>, </span>
<span>      color <span class='op'>=</span> <span class='va'>color_background</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>panel.border <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>strip.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span></span>
<span>      fill <span class='op'>=</span> <span class='va'>color_background</span>, </span>
<span>      color <span class='op'>=</span> <span class='va'>color_background</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span></span>
<span>    <span class='co'># Grid</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.ticks <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>panel.grid <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span></span>
<span>    <span class='co'># Legend</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"bottom"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.key <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span></span>
<span>      fill <span class='op'>=</span> <span class='va'>color_background</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.text  <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span></span>
<span>      color <span class='op'>=</span> <span class='va'>color_text</span>, </span>
<span>      size <span class='op'>=</span> <span class='fl'>6.5</span>, </span>
<span>      face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.direction <span class='op'>=</span> <span class='st'>"horizontal"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.spacing.x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.3</span>, <span class='st'>'cm'</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>      </span>
<span>    <span class='co'># Caption</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.caption <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span></span>
<span>      hjust <span class='op'>=</span> <span class='fl'>0.6</span>, </span>
<span>      vjust<span class='op'>=</span> <span class='fl'>0.1</span>, </span>
<span>      size <span class='op'>=</span> <span class='fl'>5.45</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span></span>
<span>    <span class='co'># Title and axis labels</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span></span>
<span>      color <span class='op'>=</span> <span class='va'>color_text</span>, </span>
<span>      size <span class='op'>=</span> <span class='fl'>17.5</span>, </span>
<span>      face <span class='op'>=</span> <span class='st'>"bold"</span>, </span>
<span>      hjust <span class='op'>=</span> <span class='fl'>0.5</span>, </span>
<span>      margin<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>10</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span></span>
<span>      color <span class='op'>=</span> <span class='va'>color_text</span>, </span>
<span>      size <span class='op'>=</span> <span class='fl'>11</span>, </span>
<span>      hjust <span class='op'>=</span> <span class='fl'>0.5</span>, </span>
<span>      face <span class='op'>=</span> <span class='st'>"bold"</span>, </span>
<span>      margin<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>22</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.title.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.title.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text.x.top <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span></span>
<span>      color <span class='op'>=</span> <span class='st'>"#3b3b3a"</span>, </span>
<span>      family <span class='op'>=</span> <span class='st'>"Arial Narrow"</span>, </span>
<span>      size<span class='op'>=</span><span class='fl'>7.5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='co'># theme(strip.text = element_text(face = "bold")) +</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.tag <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span></span>
<span>      family <span class='op'>=</span> <span class='st'>"Arial Narrow"</span>, </span>
<span>      lineheight <span class='op'>=</span> <span class='fl'>0.1</span>, size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.tag.position <span class='op'>=</span> </span>
<span>            <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.10</span>, <span class='fl'>0.85</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span></span>
<span>    <span class='co'># Plot margins</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.margin <span class='op'>=</span> </span>
<span>            <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>0.4</span>, <span class='fl'>0.5</span>, <span class='fl'>0.65</span><span class='op'>)</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># top, right, bottom, left</span></span>
<span></span>
<span><span class='op'>}</span></span></code></pre>
</div>
</div>
<p>Here, we started the construction of the line plot. Note that each <code>ggplot2</code> chunk must start with <code>{r fig.width = 8.29, fig.height = 6.88}</code> for it to be displayed with the same proportions of the original bump chart.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Used by the `ggrepel`. Ensures reproducibility of the same labels disposition</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>78</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#Select only the head categories:</span></span>
<span><span class='va'>df</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>variables</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> </span>
<span>           <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> </span>
<span></span>
<span><span class='va'>enhan</span> <span class='op'>&lt;-</span> <span class='va'>df</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>generation</span>, </span>
<span>      y <span class='op'>=</span><span class='va'>dollars</span>, </span>
<span>      group <span class='op'>=</span> <span class='va'>variables</span>, </span>
<span>      color<span class='op'>=</span> <span class='va'>variables</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span> <span class='co'># Add lines</span></span>
<span>   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span></span>
<span>    alpha <span class='op'>=</span> <span class='fl'>0.6</span>, </span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>1.4</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='co'># Add points and their border:</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>4</span>, </span>
<span>           shape <span class='op'>=</span> <span class='fl'>20</span>, </span>
<span>           alpha <span class='op'>=</span> <span class='fl'>0.6</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>3</span>, </span>
<span>             shape <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>             color<span class='op'>=</span><span class='st'>"white"</span>, </span>
<span>             alpha <span class='op'>=</span> <span class='fl'>0.7</span>, </span>
<span>             stroke <span class='op'>=</span> <span class='fl'>0.7</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Order the axis x text</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_discrete.html'>scale_x_discrete</a></span><span class='op'>(</span></span>
<span>     limits <span class='op'>=</span> <span class='va'>x_names_ordered</span>,</span>
<span>     labels <span class='op'>=</span> <span class='va'>x_names_full</span>,</span>
<span>     position <span class='op'>=</span> <span class='st'>"top"</span>,</span>
<span>     expand <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/expansion.html'>expansion</a></span><span class='op'>(</span>mult <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.09</span>, <span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span></span>
<span>                  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_discrete.html'>scale_y_discrete</a></span><span class='op'>(</span></span>
<span>    expand <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/expansion.html'>expansion</a></span><span class='op'>(</span>mult <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.001</span>, <span class='fl'>0.001</span><span class='op'>)</span><span class='op'>)</span></span>
<span>                  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Title, subtitle and caption. No tag this time.</span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span></span>
<span>  title <span class='op'>=</span> <span class='st'>"HOW AMERICANS SPEND THEIR MONEY"</span>,</span>
<span>  subtitle <span class='op'>=</span> <span class='st'>"Top 6 categories by age group | 2021"</span>,</span>
<span>  caption <span class='op'>=</span> <span class='st'>"Author: Preethi Lodha"</span></span>
<span><span class='op'>)</span> <span class='op'>+</span></span>
<span></span>
<span><span class='co'># Format dollars spent labels</span></span>
<span>   <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> </span>
<span>          <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"$"</span>, <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>$</span><span class='va'>dollars</span>, </span>
<span>                              big.mark<span class='op'>=</span><span class='st'>","</span>, </span>
<span>                              trim<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>      segment.square  <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>      segment.inflect <span class='op'>=</span> <span class='cn'>TRUE</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    <span class='co'># Max labels overlappings allowed:</span></span>
<span>    max.overlaps  <span class='op'>=</span> <span class='fl'>2</span>, </span>
<span>    size          <span class='op'>=</span> <span class='fl'>2.5</span>,</span>
<span>    fontface      <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    direction     <span class='op'>=</span> <span class='st'>"y"</span></span>
<span>    <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guide_legend.html'>guide_legend</a></span><span class='op'>(</span>nrow <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_color_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>                                <span class='st'>"#ab3a6b"</span>,</span>
<span>                                <span class='st'>"#494c4d"</span>,</span>
<span>                                <span class='st'>"#3896c4"</span>,</span>
<span>                                <span class='st'>"#2f634a"</span>, </span>
<span>                                <span class='st'>"#af9e2e"</span>,</span>
<span>                                <span class='st'>"#ed444a"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Add the 2 horizontal white lines</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span>clip <span class='op'>=</span> <span class='st'>"off"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_custom.html'>annotation_custom</a></span><span class='op'>(</span></span>
<span>        <span class='fu'><a href='https://rdrr.io/r/grid/grid.lines.html'>linesGrob</a></span><span class='op'>(</span></span>
<span>          x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.99</span><span class='op'>)</span>, </span>
<span>          y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1.13</span>, <span class='fl'>1.13</span><span class='op'>)</span>, </span>
<span>          gp <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/gpar.html'>gpar</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"#f0eae8"</span>, </span>
<span>                    lwd <span class='op'>=</span> <span class='fl'>2.8</span>, </span>
<span>                    lineend <span class='op'>=</span> <span class='st'>"square"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_custom.html'>annotation_custom</a></span><span class='op'>(</span></span>
<span>        <span class='fu'><a href='https://rdrr.io/r/grid/grid.lines.html'>linesGrob</a></span><span class='op'>(</span></span>
<span>          x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.99</span><span class='op'>)</span>, </span>
<span>          y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.05</span>, <span class='op'>-</span><span class='fl'>0.05</span><span class='op'>)</span>, </span>
<span>          gp <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/gpar.html'>gpar</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"#f0eae8"</span>, </span>
<span>                    lwd <span class='op'>=</span> <span class='fl'>2.8</span>, </span>
<span>                    lineend <span class='op'>=</span> <span class='st'>"square"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Add the custom theme </span></span>
<span>  <span class='fu'>theme_lines</span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>enhan</span></span></code></pre>
</div>
<p><img src="100481925_files/figure-html5/unnamed-chunk-16-1.png" width="795.84" /></p>
</div>
<p>There are 9 unlabeled data points, according to the warning message of the <code>ggrepel</code> package. We save the plot with the following code:</p>
<pre id="r"><code># Save the plot
ggsave(&quot;enhancements.png&quot;, 
       plot = last_plot(), 
# Edit the following path to save the plot:
       path = &quot;images&quot;, 
       width = 8.29, 
       height = 6.88,
       units = &quot;in&quot;, 
       dpi = 120) # Resolution</code></pre>
<h2 id="alternative-visualizations">Alternative visualization(s)</h2>
<p>An attempt was made to design an alternative graphic—and an alternative to the alternative. These, although better, still have some flaws.</p>
<p>The design of an alternative graph with the same data involved a nonlinear flow. Cleveland explains that data graphing should be an iterative process: “Iteration and experimentation are important for all of data analysis, including graphical data display. Most times when we make a graph it is immediately [sic] clear that some aspect is inadequate and we regraph the data. In many other cases we make a graph, and all is well, but we get an idea for studying the data in a different way with a different graph; one successful graph often suggests another” <span class="citation" data-cites="clevelandElementsGraphingData1985">(<a href="#ref-clevelandElementsGraphingData1985" role="doc-biblioref">Cleveland 1985</a>)</span>.</p>
<p>The purposes that the new graph should follow were to make the data stand out and eliminate superfluity <span class="citation" data-cites="clevelandElementsGraphingData1985">(<a href="#ref-clevelandElementsGraphingData1985" role="doc-biblioref">Cleveland 1985</a>)</span>. Another important point is ease of understanding. <span class="citation" data-cites="heerCrowdsourcingGraphicalPerception2010"><a href="#ref-heerCrowdsourcingGraphicalPerception2010" role="doc-biblioref">Heer and Bostock</a> (<a href="#ref-heerCrowdsourcingGraphicalPerception2010" role="doc-biblioref">2010</a>)</span> replicated previous studies on graphical perception by evaluating charts that encoded data in different ways. Basically, the best way to represent data is with comparison on a common scale —such as grouped bar charts— and the worst is to show it in areas like treemaps do (these performed even worse than pie charts!) <span class="citation" data-cites="heerCrowdsourcingGraphicalPerception2010">(<a href="#ref-heerCrowdsourcingGraphicalPerception2010" role="doc-biblioref">Heer and Bostock 2010</a>)</span>. Given this, the theory suggests simplicity, cleanliness and clarity rather than fancy design details and pomposity. In this case, we went for simplicity even in contradiction to Cleveland, who argues that “[t]he important criterion for a graph is not simply how fast we can see a result; rather, it is whether through the use of the graph we can see something that would have been harder to see otherwise […]” <span class="citation" data-cites="clevelandElementsGraphingData1985">(<a href="#ref-clevelandElementsGraphingData1985" role="doc-biblioref">1985</a>)</span>. We believe that it is very important that the graphic shows its main idea at first glance, especially in these days when we have so many visual stimuli on the Internet and they all fight for our attention.</p>
<p>Thus, visual cleanliness is a must, but for those intended for publication in websites such as the <em>Visual Capitalist</em> that target a wide and not necessarily expert audience, it is also a challenge. In addition, there are also studies that suggest that visual embellishment has a positive effect on the comprehension and memorability of graphics <span class="citation" data-cites="batemanUsefulJunkEffects2010">(<a href="#ref-batemanUsefulJunkEffects2010" role="doc-biblioref">Bateman et al. 2010</a>)</span>. How to balance aesthetic taste and graphical excellence and integrity? We had to achieve all this without creating a chartjunk, as Tufte would call it, and without losing the purpose of the data, of the original bump chart and its context, and with a data that is only a small table.</p>
<p>For these reasons, the safe bet was to develop a grouped bar chart that shows spending categories, generation and amounts in a clear, simple and uncluttered way, but with a custom theme.</p>
<figure>
<img src="images/alternative_bar.png" style="width:100.0%" alt="A grouped bar chart, colorblind-friendly. This is the proposed alternative visualization. Own elaboration." /><figcaption aria-hidden="true">A grouped bar chart, colorblind-friendly. This is the proposed alternative visualization. Own elaboration.</figcaption>
</figure>
<p>The underlying cause why it is flipped is mainly to avoid label overlappings, which were the major problem in all the visualizations we tried with this data. A colorblind-friendly color palette was made. Also, the grid was eliminated according to Tufte: “one of the most sedate graphical elements, the grid, should usually be muted or completely suppressed so that its presence is only implicit—lest it compete with the data […]. Dark grid lines are chartjunk” <span class="citation" data-cites="tufteVisualDisplayQuantitative2013">(<a href="#ref-tufteVisualDisplayQuantitative2013" role="doc-biblioref">Tufte 2013</a>)</span>. We do not agree that much with him in that regard, but we must accept that, at least in this case, they are not necessary: that information is already provided by the labels, which Tufte endorses. The choice of font was a personal choice.</p>
<p>This graphic has, however, some flaws: we find that the number of bars make it look bloated even though we reduced their number by including several in the “Others” category.</p>
<p>Also, the presence of a legend is not bad per sé, but in this case there are still several categories and the audience would have to constantly go back and forth from the legend to the plot to decipher what represents which bar. However, positioning the name of each spending category instead of the name, birth year range and total spent would make it even more bloated.</p>
<p>As the display of multiple bars seemed a bit cluttered even if, in our opinion, the plot delivers the correct visualization, a similar visualization was made. We considered that a lollipop plot could be an even better option, and is a close relative of bar plots.</p>
<figure>
<img src="images/alternative_lol.png" style="width:100.0%" alt="A grouped lollipop, also colorblind-friendly. Own elaboration." /><figcaption aria-hidden="true">A grouped lollipop, also colorblind-friendly. Own elaboration.</figcaption>
</figure>
<p>Clarity was the guideline for this lollipop graphic, too. However, some drawbacks arose: the overlapping labels made us decide to remove any <code>geom_text</code> or <code>geom_label</code> from our code and, contravening Tufte, plot a grid as an alternative. Only minor grids are shown and we set a number of grids that we felt was not exaggerated. We also it dashed and used a very subtle color so that it does not overload the plot too much. Still, it exists.</p>
<p>Both plots, even if simple, show the expenses per generation more clearly than the bump chart and have visual encodings, according to <span class="citation" data-cites="heerCrowdsourcingGraphicalPerception2010"><a href="#ref-heerCrowdsourcingGraphicalPerception2010" role="doc-biblioref">Heer and Bostock</a> (<a href="#ref-heerCrowdsourcingGraphicalPerception2010" role="doc-biblioref">2010</a>)</span>, capable of being better interpreted than stacked bar charts, bubble charts, pie charts and treemaps, the latter being even less effective than pie charts. This last case caught our attention, as treemaps are quite common in all types of publications and are, in our personal opinion, visually appealing. <a href="https://www.lemonde.fr/economie/article/2022/05/30/le-defi-de-la-sobriete-pour-repondre-a-l-urgence-climatique_6128136_3234.html">See here an example of a treemap published by Le Monde newspaper</a>.</p>
<p>So, we made one, just for comparison (and learning how-to) purposes:</p>
<figure>
<img src="images/alternative_tree.png" style="width:100.0%" alt="A treemap just for clarity comparison. Authors argue that it is not a good option due that areas are hard to compare, even more than angles (like the case of pie charts). Own elaboration." /><figcaption aria-hidden="true">A treemap just for clarity comparison. Authors argue that it is not a good option due that areas are hard to compare, even more than angles (like the case of pie charts). Own elaboration.</figcaption>
</figure>
<p>As can be seen, the bar plot is simpler and easier to understand than the treemap, as it uses a single visual mark, the bar, to represent the data. That specific visual mark is always of the same width, so the viewer decodes only the height of the bar to interpret the quantity it encodes. For that reason, the proposed bar plot is more effective at conveying the patterns of the data and to compare the values of different categories.</p>
<p>What cannot be denied about the treemap is that it is visually more attractive, at least to our personal taste. Unfortunately, with this one it is more complicated to interpret the differences in the money spent by each generation in a single category. For example, if there were no money spent labels added, it would be difficult to compare <em>Generation X</em> and <em>Generation Z</em> spending on <em>Housing</em>. Besides, it was way more difficult to design. We could have designed one treemap with 5 subgroups —and not 5 invidivual treemaps and then paste them— and the result would have been more or less similar, but without the spaces between each subgroup and with problems to add specific colors for each generation. The code is at the end of this report.</p>
<h3 id="designing-the-bar-plot">Designing the bar plot</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Libraries</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://wilkelab.org/ggtext/'>ggtext</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>grid</span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/slowkow/ggrepel'>ggrepel</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://rpkgs.datanovia.com/ggpubr/'>ggpubr</a></span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>We first computed the rankings just for the selecting the first categories.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>df</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_csv</a></span><span class='op'>(</span><span class='st'>"data.csv"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>generation</span>, </span>
<span>               names_to <span class='op'>=</span> <span class='st'>"variables"</span>, </span>
<span>               values_to <span class='op'>=</span> <span class='st'>"dollars"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>generation</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>generation</span>, </span>
<span>          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>dollars</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>ranking <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/ranking.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Rename categories lower in the ranking as "Others"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>ranking</span> <span class='op'>&gt;=</span> <span class='fl'>8</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"Others"</span></span>
<span></span>
<span><span class='co'>#Aggregation in order to have all "Others" in the same row</span></span>
<span><span class='va'>df</span> <span class='op'>&lt;-</span> <span class='va'>df</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>generation</span>, <span class='va'>variables</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>dollars <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>dollars</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Then, the data was manipulated, and variables renamed.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Format the dollar column</span></span>
<span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>dollars2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>$</span><span class='va'>dollars</span>, big.mark<span class='op'>=</span><span class='st'>","</span>, trim<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>dollars2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"$"</span>,<span class='va'>df</span><span class='op'>$</span><span class='va'>dollars2</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>A character vector for ordering the generations:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>gen_order</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>  <span class='st'>"Generation Z"</span>,</span>
<span>  <span class='st'>"Millennials"</span>,</span>
<span>  <span class='st'>"Generation X"</span>,</span>
<span>  <span class='st'>"Boomers"</span>,</span>
<span>  <span class='st'>"Silent"</span></span>
<span>      <span class='op'>)</span></span></code></pre>
</div>
</div>
<p>We used the same colors:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Theme colours</span></span>
<span><span class='va'>color_background</span> <span class='op'>&lt;-</span> <span class='st'>"#e5d9cf"</span></span>
<span><span class='va'>color_text</span> <span class='op'>&lt;-</span> <span class='st'>"#333333"</span></span></code></pre>
</div>
</div>
<p>Later, the custom theme was built. This was called <code>theme_bar()</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>theme_bar</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>{</span></span>
<span></span>
<span>  <span class='co'># Begin construction of chart</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span>base_size <span class='op'>=</span> <span class='fl'>15</span><span class='op'>)</span> <span class='op'>+</span></span>
<span></span>
<span>    <span class='co'># Format background colors</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span></span>
<span>      fill <span class='op'>=</span> <span class='va'>color_background</span>, </span>
<span>      color <span class='op'>=</span> <span class='va'>color_background</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span></span>
<span>      fill <span class='op'>=</span> <span class='va'>color_background</span>, </span>
<span>      color <span class='op'>=</span> <span class='va'>color_background</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>panel.border <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span></span>
<span>      color <span class='op'>=</span> <span class='va'>color_background</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>strip.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span></span>
<span>      fill <span class='op'>=</span> <span class='va'>color_background</span>, </span>
<span>      color <span class='op'>=</span> <span class='va'>color_background</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span></span>
<span>    <span class='co'># Format the grid</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.ticks <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>panel.grid <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span></span>
<span>    <span class='co'># Format the legend</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"top"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>       legend.text <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span></span>
<span>        color <span class='op'>=</span> <span class='va'>color_text</span>,</span>
<span>        family <span class='op'>=</span> <span class='st'>"Consolas"</span>,</span>
<span>        size <span class='op'>=</span> <span class='fl'>7.5</span>,</span>
<span>        face <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>        hjust <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.key <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span></span>
<span>    <span class='co'># Format de caption</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.caption <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span></span>
<span>        hjust <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>        family <span class='op'>=</span> <span class='st'>"Consolas"</span>,</span>
<span>        size <span class='op'>=</span> <span class='fl'>5.5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span></span>
<span>    <span class='co'># Format title and axis labels</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.title <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span></span>
<span>      color <span class='op'>=</span> <span class='va'>color_text</span>,</span>
<span>      family <span class='op'>=</span> <span class='st'>"Consolas"</span>,</span>
<span>      size <span class='op'>=</span> <span class='fl'>17.5</span>, </span>
<span>      face <span class='op'>=</span> <span class='st'>"bold"</span>, </span>
<span>      hjust <span class='op'>=</span> <span class='fl'>0.5</span>,</span>
<span>      margin<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>4</span>,<span class='fl'>0.2</span>,<span class='fl'>4</span>,<span class='fl'>0.2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.title.position <span class='op'>=</span> <span class='st'>"plot"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span></span>
<span>      color <span class='op'>=</span> <span class='va'>color_text</span>,</span>
<span>      family <span class='op'>=</span> <span class='st'>"Consolas"</span>,</span>
<span>      size <span class='op'>=</span> <span class='fl'>9</span>, </span>
<span>      hjust <span class='op'>=</span> <span class='fl'>0.5</span>, </span>
<span>      face <span class='op'>=</span> <span class='st'>"bold"</span>, </span>
<span>      margin<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>4</span>,<span class='fl'>0.2</span>,<span class='fl'>4</span>,<span class='fl'>0.2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.title.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.title.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span></span>
<span>      color <span class='op'>=</span> <span class='st'>"#3b3b3a"</span>, </span>
<span>      family <span class='op'>=</span> <span class='st'>"Consolas"</span>, </span>
<span>      size <span class='op'>=</span> <span class='fl'>8.5</span></span>
<span>    <span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='co'># theme(strip.text = element_text(face = "bold")) +</span></span>
<span>    </span>
<span>    <span class='co'># Plot margins</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.margin <span class='op'>=</span> </span>
<span>              <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.2</span>, <span class='fl'>0.7</span>, <span class='fl'>0.2</span>, <span class='fl'>0.7</span><span class='op'>)</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># top, right, bottom, left</span></span>
<span><span class='op'>}</span></span></code></pre>
</div>
</div>
<p>This is the colorblind friendly palette:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#Colorblind friendly palette</span></span>
<span><span class='va'>colorblind</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>                <span class='st'>"#5d3686"</span>,</span>
<span>                <span class='st'>"#c3a939"</span>,</span>
<span>                <span class='st'>"#6c7ed7"</span>,</span>
<span>                <span class='st'>"#b95336"</span>,</span>
<span>                <span class='st'>"#74a344"</span>,</span>
<span>                <span class='st'>"#a19f9f"</span>,</span>
<span>                <span class='st'>"#ba496b"</span>,</span>
<span>                <span class='st'>"#43c9b0"</span>,</span>
<span>                <span class='st'>"#c26abb"</span>,</span>
<span>                <span class='st'>"#ae853d"</span></span>
<span>                <span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Then the bar plot was designed:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tag_house</span> <span class='op'>&lt;-</span> <span class='st'>"$26,385"</span></span>
<span></span>
<span><span class='va'>bar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>df</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span></span>
<span>                      fill <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/reorder.factor.html'>reorder</a></span><span class='op'>(</span><span class='va'>variables</span>, </span>
<span>                                     <span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>dollars</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>                      y    <span class='op'>=</span> <span class='va'>dollars</span>,</span>
<span>                      x    <span class='op'>=</span> <span class='va'>generation</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></span><span class='op'>(</span>position  <span class='op'>=</span> <span class='st'>"dodge"</span>, <span class='co'># for groups</span></span>
<span>             stat      <span class='op'>=</span> <span class='st'>"identity"</span>,</span>
<span>             linewidth <span class='op'>=</span> <span class='fl'>0.05</span>,</span>
<span>             color     <span class='op'>=</span> <span class='va'>color_background</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Add dollars' labels</span></span>
<span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>dollars2</span><span class='op'>)</span>,</span>
<span>            position      <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.9</span><span class='op'>)</span>,</span>
<span>            color         <span class='op'>=</span> <span class='va'>color_text</span>,</span>
<span>            family        <span class='op'>=</span> <span class='st'>"Consolas"</span>,</span>
<span>            <span class='co'>#vjust         = 0.5,</span></span>
<span>            hjust         <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.3</span>,</span>
<span>            size          <span class='op'>=</span> <span class='fl'>2.5</span></span>
<span>            <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># Order of the x Axis text</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_discrete.html'>scale_x_discrete</a></span><span class='op'>(</span></span>
<span>    limits <span class='op'>=</span> <span class='va'>gen_order</span>,</span>
<span>    labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>       <span class='st'>"**Generation Z**&lt;br&gt;1997 or later&lt;br&gt;**$41,636**"</span>,</span>
<span>       <span class='st'>"**Millennials**&lt;br&gt;1981 to 1996&lt;br&gt;**$69,061**"</span>,</span>
<span>       <span class='st'>"**Generation X**&lt;br&gt;1965 to 1980&lt;br&gt;**$83,357**"</span>,</span>
<span>       <span class='st'>"**Boomers**&lt;br&gt;1946 to 1964&lt;br&gt;$**62,203**"</span>,</span>
<span>      <span class='st'>"**Silent**&lt;br&gt;1945 or earlier&lt;br&gt;**$44,683**"</span></span>
<span>                <span class='op'>)</span></span>
<span>    <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># To manipulate the width of the graphic:</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span></span>
<span>        expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.005</span>,<span class='fl'>0</span><span class='op'>)</span>, <span class='co'>#0.0632</span></span>
<span>                    <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span></span>
<span>    values <span class='op'>=</span> <span class='va'>colorblind</span> <span class='co'>#colorblind-friendly palette</span></span>
<span>                    <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span></span>
<span>    title <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"&lt;span style='color: #3d2309; font-size: 15pt'&gt;"</span>,</span>
<span>            <span class='st'>"_Housing_: more than 30% of Americans' expenditures in 2021"</span>,</span>
<span>            <span class='st'>"&lt;/span&gt;"</span>,</span>
<span>            sep <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span>,</span>
<span>      </span>
<span>    subtitle <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"&lt;span style='color: #4e4b4b; font-size: 10pt'&gt;"</span>,</span>
<span>            <span class='st'>"It was the top spending category across all generations in 2021.&lt;br&gt;"</span>,</span>
<span>            <span class='st'>"Overall, _Gen X_ spent the most ($83,357), followed by _Millennials_ ($69,091)."</span>,</span>
<span>            <span class='st'>"&lt;/span&gt;"</span>,</span>
<span>            sep <span class='op'>=</span> <span class='st'>""</span></span>
<span>            <span class='op'>)</span>,</span>
<span>    </span>
<span>    caption <span class='op'>=</span> <span class='st'>"Carolina Cornejo Castellano | Data: U.S. Bureau of Labor Statistics"</span>,</span>
<span>   <span class='co'># As one of the bars was too large, we added its label manually as a tag</span></span>
<span>    tag <span class='op'>=</span> <span class='va'>tag_house</span> </span>
<span>       <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'>theme_bar</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    legend.box.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0.2</span>,<span class='fl'>2</span>,<span class='fl'>0.2</span>,<span class='fl'>0.1</span>, unit <span class='op'>=</span> <span class='st'>"cm"</span><span class='op'>)</span>,</span>
<span>    legend.spacing.x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.4</span>, <span class='st'>'cm'</span><span class='op'>)</span>,</span>
<span>    plot.title.position <span class='op'>=</span> <span class='st'>"plot"</span>,</span>
<span>    plot.tag <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span></span>
<span>      family <span class='op'>=</span> <span class='st'>"Consolas"</span>,</span>
<span>      lineheight <span class='op'>=</span> <span class='fl'>0.1</span>, </span>
<span>      size <span class='op'>=</span> <span class='fl'>7.5</span>,</span>
<span>      color <span class='op'>=</span> <span class='va'>color_background</span><span class='op'>)</span>,</span>
<span>    plot.tag.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.965</span>, <span class='fl'>0.332</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='co'>#horizontal, vertical</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_flip.html'>coord_flip</a></span><span class='op'>(</span><span class='op'>)</span> </span>
<span>  </span>
<span><span class='va'>bar</span></span></code></pre>
</div>
<p><img src="100481925_files/figure-html5/unnamed-chunk-25-1.png" width="795.84" /></p>
</div>
<p>Code for saving the plot:</p>
<pre id="r"><code>ggsave(&quot;alternative_bar.png&quot;, 
       plot = last_plot(),
# Edit the following path to save the plot:
       path = &quot;images&quot;, 
       width = 8.29, 
       height = 6.88,   
       units = &quot;in&quot;, 
       dpi = 300)</code></pre>
<h3 id="designing-the-lollipop-plot">Designing the lollipop plot</h3>
<p>The same bar plot theme was used.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>gen_order</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>        <span class='st'>"Silent"</span>,</span>
<span>       <span class='st'>"Boomers"</span>,</span>
<span>       <span class='st'>"Generation X"</span>,</span>
<span>       <span class='st'>"Millennials"</span>,</span>
<span>       <span class='st'>"Generation Z"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>lol</span> <span class='op'>&lt;-</span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span><span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_linerange.html'>geom_linerange</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span></span>
<span>      x <span class='op'>=</span> <span class='va'>generation</span>,</span>
<span>      ymin <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>      ymax <span class='op'>=</span> <span class='va'>dollars</span>, </span>
<span>      colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/reorder.factor.html'>reorder</a></span><span class='op'>(</span><span class='va'>variables</span>, <span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>dollars</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>      position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span></span>
<span>        x <span class='op'>=</span> <span class='va'>generation</span>,</span>
<span>        y <span class='op'>=</span> <span class='va'>dollars</span>,</span>
<span>        colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/reorder.factor.html'>reorder</a></span><span class='op'>(</span><span class='va'>variables</span>, <span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>dollars</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>      <span class='op'>)</span>,</span>
<span>      size <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>      position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span><span class='fl'>0.8</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_discrete.html'>scale_x_discrete</a></span><span class='op'>(</span></span>
<span>    limits <span class='op'>=</span> <span class='va'>gen_order</span>,</span>
<span>    labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"**Silent**&lt;br&gt;1945 or earlier&lt;br&gt;**$44,683**"</span>,</span>
<span>               <span class='st'>"**Boomers**&lt;br&gt;1946 to 1964&lt;br&gt;$**62,203**"</span>,</span>
<span>               <span class='st'>"**Generation X**&lt;br&gt;1965 to 1980&lt;br&gt;**$83,357**"</span>,</span>
<span>               <span class='st'>"**Millennials**&lt;br&gt;1981 to 1996&lt;br&gt;**$69,061**"</span>,</span>
<span>               <span class='st'>"**Generation Z**&lt;br&gt;1997 or later&lt;br&gt;**$41,636**"</span><span class='op'>)</span></span>
<span>               <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span></span>
<span>        expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.03</span>,<span class='fl'>0</span><span class='op'>)</span>,</span>
<span>        n.breaks <span class='op'>=</span> <span class='fl'>8</span></span>
<span>        <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_color_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>colorblind</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span></span>
<span>    title <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"&lt;span style='color: #3d2309; font-size: 15pt'&gt;"</span>,</span>
<span>            <span class='st'>"_Housing_: more than 30% of Americans' expenditures in 2021"</span>,</span>
<span>            <span class='st'>"&lt;/span&gt;"</span>,</span>
<span>            sep <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span>,</span>
<span>      </span>
<span>    subtitle <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"&lt;span style='color: #4e4b4b; font-size: 10pt'&gt;"</span>,</span>
<span>            <span class='st'>"It was the top spending category across all generations in 2021.&lt;br&gt;"</span>,</span>
<span>            <span class='st'>"Overall, _Gen X_ spent the most ($83,357), followed by _Millennials_ ($69,091)."</span>,</span>
<span>            <span class='st'>"&lt;/span&gt;"</span>,</span>
<span>            sep <span class='op'>=</span> <span class='st'>""</span></span>
<span>            <span class='op'>)</span>,</span>
<span>    </span>
<span>    caption <span class='op'>=</span> <span class='st'>"Carolina Cornejo Castellano | Data: U.S. Bureau of Labor Statistics"</span></span>
<span>       <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'>theme_bar</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>          legend.box.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0.2</span>,<span class='fl'>1</span>,<span class='fl'>0.2</span>,<span class='fl'>0.2</span>, unit <span class='op'>=</span> <span class='st'>"cm"</span><span class='op'>)</span>,</span>
<span>          legend.spacing.x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.4</span>, <span class='st'>'cm'</span><span class='op'>)</span>,</span>
<span>          axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span></span>
<span>                                        color <span class='op'>=</span> <span class='st'>"#3b3b3a"</span>, </span>
<span>                                        family <span class='op'>=</span> <span class='st'>"Consolas"</span>, </span>
<span>                                        size<span class='op'>=</span><span class='fl'>7.5</span></span>
<span>                                      <span class='op'>)</span>,</span>
<span>          plot.title.position <span class='op'>=</span> <span class='st'>"plot"</span>,</span>
<span>          panel.grid.major.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#b0aeae"</span>,</span>
<span>                                          linewidth <span class='op'>=</span> <span class='fl'>0.25</span>,</span>
<span>                                          linetype <span class='op'>=</span> <span class='st'>"dashed"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>lol</span></span></code></pre>
</div>
<p><img src="100481925_files/figure-html5/unnamed-chunk-27-1.png" width="795.84" /></p>
</div>
<p>The plot was saved with:</p>
<pre id="r"><code>ggsave(&quot;alternative_lol.png&quot;, 
       plot = last_plot(),
# Edit the following path to save the plot:
       path = &quot;images&quot;, 
       width = 8.29, 
       height = 6.88,   
       units = &quot;in&quot;, 
       dpi = 300)</code></pre>
<h3 id="designing-the-treemap">Designing the treemap</h3>
<p>Finally, just for learning and comparison purposes, the treemap code is shown below. As said before, authors do not recommend this kind of visualizations because differences in areas are hard to perceive. Besides, when compared with the bar plot or the lollipop, looks way more bloated and less effective.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Import libraries</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://wilkelab.org/ggtext/'>ggtext</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>grid</span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://wilkox.org/treemapify/'>treemapify</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://patchwork.data-imaginist.com'>patchwork</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://wilkelab.org/cowplot/'>cowplot</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://rpkgs.datanovia.com/ggpubr/'>ggpubr</a></span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Import data</span></span>
<span><span class='va'>df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_csv</a></span><span class='op'>(</span><span class='st'>"data.csv"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Data wrangling</span></span>
<span></span>
<span><span class='va'>df</span> <span class='op'>&lt;-</span> <span class='va'>df</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>generation</span>, </span>
<span>               names_to <span class='op'>=</span> <span class='st'>"variables"</span>, </span>
<span>               values_to <span class='op'>=</span> <span class='st'>"dollars"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>generation</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>generation</span>, </span>
<span>          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>dollars</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>ranking <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/ranking.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>generation</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>generation</span> <span class='op'>==</span> <span class='st'>"silent"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"Silent"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>generation</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>generation</span> <span class='op'>==</span> <span class='st'>"boomers"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"Boomers"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>generation</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>generation</span> <span class='op'>==</span> <span class='st'>"gen_X"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"Generation X"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>generation</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>generation</span> <span class='op'>==</span> <span class='st'>"millennials"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"Millennials"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>generation</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>generation</span> <span class='op'>==</span> <span class='st'>"gen_Z"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"Generation Z"</span></span>
<span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span> <span class='op'>==</span> <span class='st'>"alcohol"</span><span class='op'>]</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='st'>"Alcoholic beverages"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span> <span class='op'>==</span> <span class='st'>"apparel"</span><span class='op'>]</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='st'>"Apparel and services"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span> <span class='op'>==</span> <span class='st'>"cash_contributions"</span><span class='op'>]</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='st'>"Cash contributions"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span> <span class='op'>==</span> <span class='st'>"education"</span><span class='op'>]</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='st'>"Education"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span> <span class='op'>==</span> <span class='st'>"entertainment"</span><span class='op'>]</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='st'>"Entertainment"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span> <span class='op'>==</span> <span class='st'>"food"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"Food"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span> <span class='op'>==</span> <span class='st'>"entertainment"</span><span class='op'>]</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='st'>"Entertainment"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span> <span class='op'>==</span> <span class='st'>"healthcare"</span><span class='op'>]</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='st'>"Healthcare"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span> <span class='op'>==</span> <span class='st'>"housing"</span><span class='op'>]</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='st'>"Housing"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span> <span class='op'>==</span> <span class='st'>"insurance"</span><span class='op'>]</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='st'>"Personal insurance"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span> <span class='op'>==</span> <span class='st'>"miscellaneous"</span><span class='op'>]</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='st'>"Miscellaneous expenditures"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span> <span class='op'>==</span> <span class='st'>"personal_care"</span><span class='op'>]</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='st'>"Personal care products \n and services"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span> <span class='op'>==</span> <span class='st'>"reading"</span><span class='op'>]</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='st'>"Reading"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span> <span class='op'>==</span> <span class='st'>"smoking"</span><span class='op'>]</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='st'>"Tobacco products and smoking \n supplies"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span> <span class='op'>==</span> <span class='st'>"transportation"</span><span class='op'>]</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='st'>"Transportation"</span></span>
<span></span>
<span></span>
<span><span class='co'># Categorize observations with a ranking &lt;= 9 as "Others"</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>variables</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>ranking</span> <span class='op'>&gt;=</span> <span class='fl'>8</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"Others"</span></span>
<span></span>
<span><span class='co'>#Aggregation in order to have all "Others" in the same row</span></span>
<span></span>
<span><span class='va'>df</span> <span class='op'>&lt;-</span> <span class='va'>df</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>generation</span>, <span class='va'>variables</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>dollars <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>dollars</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>ranking</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>theme_tree</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  </span>
<span>  <span class='co'># Begin construction of chart</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span>base_size <span class='op'>=</span> <span class='fl'>15</span><span class='op'>)</span> <span class='op'>+</span></span>
<span></span>
<span>    <span class='co'># Format background colors</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span></span>
<span>      fill <span class='op'>=</span> <span class='va'>color_background</span>, </span>
<span>      color <span class='op'>=</span> <span class='va'>color_background</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span></span>
<span>      fill <span class='op'>=</span> <span class='va'>color_background</span>, </span>
<span>      color <span class='op'>=</span> <span class='va'>color_background</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>panel.border <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span></span>
<span>      color <span class='op'>=</span> <span class='va'>color_background</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>strip.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span></span>
<span>      fill <span class='op'>=</span> <span class='va'>color_background</span>, </span>
<span>      color <span class='op'>=</span> <span class='va'>color_background</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span></span>
<span>    <span class='co'># Format the grid</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.ticks <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>panel.grid <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span></span>
<span>      colour <span class='op'>=</span> <span class='va'>color_background</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span></span>
<span>    <span class='co'># Format the legend</span></span>
<span>    <span class='co'>#theme(legend.position = "none") +</span></span>
<span></span>
<span>    <span class='co'># Format de caption</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.caption <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span></span>
<span>      hjust <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>      family <span class='op'>=</span> <span class='st'>"Consolas"</span>,</span>
<span>      size <span class='op'>=</span> <span class='fl'>5.5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span></span>
<span>    <span class='co'># Format title and axis labels</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.title <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span></span>
<span>      color <span class='op'>=</span> <span class='va'>color_text</span>,</span>
<span>      family <span class='op'>=</span> <span class='st'>"Consolas"</span>,</span>
<span>      size <span class='op'>=</span> <span class='fl'>17.5</span>, </span>
<span>      face <span class='op'>=</span> <span class='st'>"bold"</span>, </span>
<span>      hjust <span class='op'>=</span> <span class='fl'>0.5</span>, </span>
<span>      margin<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>10</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span></span>
<span>      color <span class='op'>=</span> <span class='va'>color_text</span>,</span>
<span>      family <span class='op'>=</span> <span class='st'>"Consolas"</span>,</span>
<span>      size <span class='op'>=</span> <span class='fl'>9</span>, </span>
<span>      hjust <span class='op'>=</span> <span class='fl'>0.5</span>, </span>
<span>      face <span class='op'>=</span> <span class='st'>"bold"</span>, </span>
<span>      margin<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>22</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.title.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.title.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text.x.top <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span></span>
<span>      color <span class='op'>=</span> <span class='st'>"#3b3b3a"</span>, </span>
<span>      family <span class='op'>=</span> <span class='st'>"Consolas"</span>, </span>
<span>      size<span class='op'>=</span><span class='fl'>7.5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='co'># theme(strip.text = element_text(face = "bold")) +</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.tag <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span></span>
<span>      family <span class='op'>=</span> <span class='st'>"Consolas"</span>,</span>
<span>      lineheight <span class='op'>=</span> <span class='fl'>0.1</span>, </span>
<span>      size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.tag.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.10</span>, <span class='fl'>0.85</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span></span>
<span>    <span class='co'># Plot margins</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.margin <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>0.5</span>, <span class='fl'>0.2</span>, <span class='fl'>0.5</span><span class='op'>)</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># top, right, bottom, left</span></span>
<span><span class='op'>}</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Format the dollars column.</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>dollars2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>$</span><span class='va'>dollars</span>, big.mark<span class='op'>=</span><span class='st'>","</span>, trim<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>dollars2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"$"</span>,<span class='va'>df</span><span class='op'>$</span><span class='va'>dollars2</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Designing the 5 treemaps:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>df</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>generation</span><span class='op'>==</span><span class='st'>"Generation X"</span><span class='op'>)</span>,</span>
<span>            <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>area <span class='op'>=</span> <span class='va'>dollars</span>,</span>
<span>                fill <span class='op'>=</span> <span class='va'>variables</span>,</span>
<span>                label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>variables</span>, <span class='va'>dollars2</span>, sep <span class='op'>=</span> <span class='st'>"\n"</span><span class='op'>)</span></span>
<span>                <span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://wilkox.org/treemapify/reference/geom_treemap.html'>geom_treemap</a></span><span class='op'>(</span></span>
<span>                layout <span class='op'>=</span> <span class='st'>"srow"</span>,</span>
<span>                 radius <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='st'>"pt"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://wilkox.org/treemapify/reference/geom_treemap_text.html'>geom_treemap_text</a></span><span class='op'>(</span></span>
<span>                layout <span class='op'>=</span> <span class='st'>"srow"</span>,</span>
<span>                colour <span class='op'>=</span> <span class='st'>"#fbf2dd"</span>,</span>
<span>                size <span class='op'>=</span> <span class='fl'>9</span>,</span>
<span>                fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>                family <span class='op'>=</span> <span class='st'>"Consolas"</span>,</span>
<span>                min.size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>                reflow <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>                padding.x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='st'>"mm"</span><span class='op'>)</span>,</span>
<span>                padding.y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='st'>"mm"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'>theme_tree</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='co'>#theme(aspect.ratio=1) +</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.margin <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.1</span>, <span class='fl'>0.1</span>, <span class='fl'>0.1</span><span class='op'>)</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='co'># top, right, bottom, left</span></span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#717342"</span>,</span>
<span>                              <span class='st'>"#717342"</span>,</span>
<span>                              <span class='st'>"#717342"</span>,</span>
<span>                              <span class='st'>"#717342"</span>,</span>
<span>                              <span class='st'>"#4b4d27"</span>,</span>
<span>                              <span class='st'>"#a4a671"</span>,</span>
<span>                              <span class='st'>"#717342"</span>,</span>
<span>                              <span class='st'>"#717342"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>millennials</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>df</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>generation</span><span class='op'>==</span><span class='st'>"Millennials"</span><span class='op'>)</span>,</span>
<span>            <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>area <span class='op'>=</span> <span class='va'>dollars</span>,</span>
<span>                fill <span class='op'>=</span> <span class='va'>variables</span>,</span>
<span>                label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>variables</span>, <span class='va'>dollars2</span>, sep <span class='op'>=</span> <span class='st'>"\n"</span><span class='op'>)</span></span>
<span>                <span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://wilkox.org/treemapify/reference/geom_treemap.html'>geom_treemap</a></span><span class='op'>(</span></span>
<span>                layout <span class='op'>=</span> <span class='st'>"srow"</span>,</span>
<span>                 radius <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='st'>"pt"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://wilkox.org/treemapify/reference/geom_treemap_text.html'>geom_treemap_text</a></span><span class='op'>(</span></span>
<span>                layout <span class='op'>=</span> <span class='st'>"srow"</span>,</span>
<span>                colour <span class='op'>=</span> <span class='st'>"#fbf2dd"</span>,</span>
<span>                size <span class='op'>=</span> <span class='fl'>9</span>,</span>
<span>                fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>                family <span class='op'>=</span> <span class='st'>"Consolas"</span>,</span>
<span>                min.size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>                reflow <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>                padding.x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='st'>"mm"</span><span class='op'>)</span>,</span>
<span>                padding.y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='st'>"mm"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'>theme_tree</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='co'>#theme(aspect.ratio=1) +</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.margin <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.1</span>, <span class='fl'>0.1</span>, <span class='fl'>0.</span><span class='op'>)</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='co'># top, right, bottom, left</span></span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#c49350"</span>,</span>
<span>                              <span class='st'>"#c49350"</span>,</span>
<span>                              <span class='st'>"#c49350"</span>,</span>
<span>                              <span class='st'>"#c49350"</span>,</span>
<span>                              <span class='st'>"#805b28"</span>,</span>
<span>                              <span class='st'>"#e3af6b"</span>,</span>
<span>                              <span class='st'>"#c49350"</span>,</span>
<span>                              <span class='st'>"#c49350"</span><span class='op'>)</span><span class='op'>)</span></span>
<span>                              </span>
<span></span>
<span><span class='va'>boomers</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>df</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>generation</span><span class='op'>==</span><span class='st'>"Boomers"</span><span class='op'>)</span>,</span>
<span>            <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>area <span class='op'>=</span> <span class='va'>dollars</span>,</span>
<span>                fill <span class='op'>=</span> <span class='va'>variables</span>,</span>
<span>                label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>variables</span>, <span class='va'>dollars2</span>, sep <span class='op'>=</span> <span class='st'>"\n"</span><span class='op'>)</span></span>
<span>                <span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://wilkox.org/treemapify/reference/geom_treemap.html'>geom_treemap</a></span><span class='op'>(</span></span>
<span>                layout <span class='op'>=</span> <span class='st'>"srow"</span>,</span>
<span>                 radius <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='st'>"pt"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://wilkox.org/treemapify/reference/geom_treemap_text.html'>geom_treemap_text</a></span><span class='op'>(</span></span>
<span>                layout <span class='op'>=</span> <span class='st'>"srow"</span>,</span>
<span>                colour <span class='op'>=</span> <span class='st'>"#fbf2dd"</span>,</span>
<span>                size <span class='op'>=</span> <span class='fl'>9</span>,</span>
<span>                fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>                family <span class='op'>=</span> <span class='st'>"Consolas"</span>,</span>
<span>                min.size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>                reflow <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>                padding.x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='st'>"mm"</span><span class='op'>)</span>,</span>
<span>                padding.y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='st'>"mm"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'>theme_tree</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='co'>#theme(aspect.ratio=1) +</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.margin <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.1</span>, <span class='fl'>0.1</span>, <span class='fl'>0.1</span><span class='op'>)</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='co'># top, right, bottom, left        </span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#be7c4d"</span>,</span>
<span>                              <span class='st'>"#be7c4d"</span>,</span>
<span>                              <span class='st'>"#be7c4d"</span>,</span>
<span>                              <span class='st'>"#be7c4d"</span>,</span>
<span>                              <span class='st'>"#96592d"</span>,</span>
<span>                              <span class='st'>"#e39762"</span>,</span>
<span>                              <span class='st'>"#be7c4d"</span>,</span>
<span>                              <span class='st'>"#be7c4d"</span><span class='op'>)</span><span class='op'>)</span></span>
<span>                              </span>
<span></span>
<span><span class='va'>silent</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>df</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>generation</span><span class='op'>==</span><span class='st'>"Silent"</span><span class='op'>)</span>,</span>
<span>            <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>area <span class='op'>=</span> <span class='va'>dollars</span>,</span>
<span>                fill <span class='op'>=</span> <span class='va'>variables</span>,</span>
<span>                label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>variables</span>, <span class='va'>dollars2</span>, sep <span class='op'>=</span> <span class='st'>"\n"</span><span class='op'>)</span></span>
<span>                <span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://wilkox.org/treemapify/reference/geom_treemap.html'>geom_treemap</a></span><span class='op'>(</span></span>
<span>                layout <span class='op'>=</span> <span class='st'>"srow"</span>,</span>
<span>                 radius <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='st'>"pt"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://wilkox.org/treemapify/reference/geom_treemap_text.html'>geom_treemap_text</a></span><span class='op'>(</span></span>
<span>                layout <span class='op'>=</span> <span class='st'>"srow"</span>,</span>
<span>                colour <span class='op'>=</span> <span class='st'>"#fbf2dd"</span>,</span>
<span>                size <span class='op'>=</span> <span class='fl'>9</span>,</span>
<span>                fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>                family <span class='op'>=</span> <span class='st'>"Consolas"</span>,</span>
<span>                min.size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>                reflow <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>                padding.x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='st'>"mm"</span><span class='op'>)</span>,</span>
<span>                padding.y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='st'>"mm"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'>theme_tree</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='co'>#theme(aspect.ratio=1) +</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.margin <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.1</span>, <span class='fl'>0.1</span>, <span class='fl'>0.1</span><span class='op'>)</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='co'># top, right, bottom, left</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#9a7447"</span>,</span>
<span>                              <span class='st'>"#9a7447"</span>,</span>
<span>                              <span class='st'>"#9a7447"</span>,</span>
<span>                              <span class='st'>"#9a7447"</span>,</span>
<span>                              <span class='st'>"#63431d"</span>,</span>
<span>                              <span class='st'>"#ba9a73"</span>,</span>
<span>                              <span class='st'>"#9a7447"</span>,</span>
<span>                              <span class='st'>"#9a7447"</span><span class='op'>)</span><span class='op'>)</span></span>
<span>                              </span>
<span><span class='va'>z</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>df</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>generation</span><span class='op'>==</span><span class='st'>"Generation Z"</span><span class='op'>)</span>,</span>
<span>            <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>area <span class='op'>=</span> <span class='va'>dollars</span>,</span>
<span>                fill <span class='op'>=</span> <span class='va'>variables</span>,</span>
<span>                label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>variables</span>, <span class='va'>dollars2</span>, sep <span class='op'>=</span> <span class='st'>"\n"</span><span class='op'>)</span></span>
<span>                <span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://wilkox.org/treemapify/reference/geom_treemap.html'>geom_treemap</a></span><span class='op'>(</span></span>
<span>                layout <span class='op'>=</span> <span class='st'>"srow"</span>,</span>
<span>                 radius <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='st'>"pt"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://wilkox.org/treemapify/reference/geom_treemap_text.html'>geom_treemap_text</a></span><span class='op'>(</span></span>
<span>                layout <span class='op'>=</span> <span class='st'>"srow"</span>,</span>
<span>                colour <span class='op'>=</span> <span class='st'>"#fbf2dd"</span>,</span>
<span>                size <span class='op'>=</span> <span class='fl'>9</span>,</span>
<span>                fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>                family <span class='op'>=</span> <span class='st'>"Consolas"</span>,</span>
<span>                min.size <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>                reflow <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>                padding.x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='st'>"mm"</span><span class='op'>)</span>,</span>
<span>                padding.y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='st'>"mm"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'>theme_tree</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='co'>#theme(aspect.ratio=1) +</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.margin <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.1</span>, <span class='fl'>0.1</span>, <span class='fl'>0.1</span><span class='op'>)</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='co'># top, right, bottom, left</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#897d65"</span>,</span>
<span>                              <span class='st'>"#897d65"</span>,</span>
<span>                              <span class='st'>"#897d65"</span>,</span>
<span>                              <span class='st'>"#897d65"</span>,</span>
<span>                              <span class='st'>"#61563f"</span>,</span>
<span>                              <span class='st'>"#baac91"</span>,</span>
<span>                              <span class='st'>"#897d65"</span>,</span>
<span>                              <span class='st'>"#897d65"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>The treemap was, in fact, five glued treemaps. For that reason, the legend could not be displayed properly, so we made a very simple bar plot containing a legend, and the <code>get_leyend</code> function extracted it. Then, we converted it into an <code>ggplot2</code> element with the <code>as_ggplot</code> function. This procedure allowed us to use the <code>patchwork</code> package and paste the 5 treemaps plus the legend. The <code>ggpubr</code> and <code>cowplot</code> packages were used for these purposes.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Summarize the spendings per generation</span></span>
<span><span class='va'>df_summ</span> <span class='op'>&lt;-</span> <span class='va'>df</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>generation</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>total_per_generation <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>dollars</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>gen_order</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Silent"</span>, </span>
<span>       <span class='st'>"Boomers"</span>, </span>
<span>       <span class='st'>"Generation X"</span>, </span>
<span>       <span class='st'>"Millennials"</span>, </span>
<span>       <span class='st'>"Generation Z"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Set custom colors</span></span>
<span><span class='va'>bar_colors</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#9a7447"</span>,</span>
<span>                          <span class='st'>"#be7c4d"</span>,</span>
<span>                          <span class='st'>"#717342"</span>,</span>
<span>                          <span class='st'>"#c49350"</span>,</span>
<span>                          <span class='st'>"#897d65"</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>bar2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>df_summ</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='va'>generation</span>,</span>
<span>    fill <span class='op'>=</span> <span class='va'>generation</span>,</span>
<span>    weight <span class='op'>=</span> <span class='va'>total_per_generation</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>breaks<span class='op'>=</span><span class='va'>gen_order</span>, </span>
<span>                    values <span class='op'>=</span> <span class='va'>bar_colors</span>,</span>
<span>                    name <span class='op'>=</span> <span class='st'>""</span>,</span>
<span>                    labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"**Silent**&lt;br&gt;1945 or earlier&lt;br&gt;**$44,683**"</span>, </span>
<span>                               <span class='st'>"**Boomers**&lt;br&gt;1946 to 1964&lt;br&gt;$**62,203**"</span>, </span>
<span>                               <span class='st'>"**Generation X**&lt;br&gt;1965 to 1980&lt;br&gt;**$83,357**"</span>, </span>
<span>                               <span class='st'>"**Millennials**&lt;br&gt;1981 to 1996&lt;br&gt;**$69,061**"</span>, </span>
<span>                               <span class='st'>"**Generation Z**&lt;br&gt;1997 or later&lt;br&gt;**$41,636**"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_discrete.html'>scale_x_discrete</a></span><span class='op'>(</span></span>
<span>    limits <span class='op'>=</span> <span class='va'>gen_order</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.margin <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span><span class='op'>)</span>, <span class='st'>"pt"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.text <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span></span>
<span>      color <span class='op'>=</span> <span class='va'>color_text</span>,</span>
<span>      family <span class='op'>=</span> <span class='st'>"Consolas"</span>,</span>
<span>      size <span class='op'>=</span> <span class='fl'>7</span>, </span>
<span>      hjust <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='co'># top, right, bottom, left</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.title <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span></span>
<span>      color <span class='op'>=</span> <span class='va'>color_text</span>,</span>
<span>      family <span class='op'>=</span> <span class='st'>"Consolas"</span>,</span>
<span>      size <span class='op'>=</span> <span class='fl'>7</span>, </span>
<span>      hjust <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"bottom"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.spacing.x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='st'>'cm'</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>bar2</span></span></code></pre>
</div>
<p><img src="100481925_files/figure-html5/unnamed-chunk-35-1.png" width="795.84" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Extract the legend</span></span>
<span><span class='va'>legend_extract</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://wilkelab.org/cowplot/reference/get_legend.html'>get_legend</a></span><span class='op'>(</span><span class='va'>bar2</span><span class='op'>)</span> </span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Turn the legend into a ggplot2 object</span></span>
<span><span class='va'>legend</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rpkgs.datanovia.com/ggpubr/reference/as_ggplot.html'>as_ggplot</a></span><span class='op'>(</span><span class='va'>legend_extract</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Paste all graphics:</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tree</span> <span class='op'>&lt;-</span> <span class='va'>legend</span> <span class='op'>+</span> <span class='op'>(</span><span class='op'>(</span><span class='va'>silent</span> <span class='op'>/</span> <span class='va'>boomers</span><span class='op'>)</span> <span class='op'>|</span> <span class='op'>(</span><span class='va'>x</span> <span class='op'>/</span> <span class='va'>millennials</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>z</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_layout.html'>plot_layout</a></span><span class='op'>(</span></span>
<span>              nrow <span class='op'>=</span> <span class='fl'>2</span>,</span>
<span>              ncol <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>              heights <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>6</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_annotation.html'>plot_annotation</a></span><span class='op'>(</span></span>
<span>    title <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"&lt;span style='color: #3d2309; font-size: 15pt'&gt;"</span>,</span>
<span>            <span class='st'>"_Housing_: more than 30% of Americans' expenditures in 2021"</span>,</span>
<span>            <span class='st'>"&lt;/span&gt;"</span>,</span>
<span>            sep <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span>,</span>
<span>    </span>
<span>    subtitle <span class='op'>=</span> </span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"&lt;span style='color: #4e4b4b; font-size: 10pt'&gt;"</span>,</span>
<span>            <span class='st'>"It was the top spending category across all generations in 2021.&lt;br&gt;"</span>,</span>
<span>            <span class='st'>"Overall, _Gen X_ spent the most ($83,357), followed by _Millennials_ ($69,091)."</span>,</span>
<span>            <span class='st'>"&lt;/span&gt;"</span>,</span>
<span>            sep <span class='op'>=</span> <span class='st'>""</span></span>
<span>            <span class='op'>)</span>,</span>
<span>    </span>
<span>    caption <span class='op'>=</span> <span class='st'>"Carolina Cornejo Castellano | Data: U.S. Bureau of Labor Statistics"</span>,</span>
<span>    theme <span class='op'>=</span> <span class='fu'>theme_tree</span><span class='op'>(</span><span class='op'>)</span></span>
<span>                  <span class='op'>)</span></span>
<span></span>
<span><span class='va'>tree</span></span></code></pre>
</div>
<p><img src="100481925_files/figure-html5/unnamed-chunk-38-1.png" width="795.84" /></p>
</div>
<p>Save plot:</p>
<pre id="r"><code>ggsave(&quot;alternative_tree.png&quot;, 
       plot = last_plot(), 
       path = &quot;images&quot;, 
       width = 8.29, 
       height = 6.88, 
       units = &quot;in&quot;, 
       dpi = 300)</code></pre>
<p>Needless to say, replicating the graphic and proposing new visualizations were very learning exercises. Being able to design better graphics with cleaner and shorter code is still a longer term task.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-batemanUsefulJunkEffects2010" class="csl-entry" role="doc-biblioentry">
Bateman, Scott, Regan L. Mandryk, Carl Gutwin, Aaron Genest, David McDine, and Christopher Brooks. 2010. <span>“Useful Junk?: The Effects of Visual Embellishment on Comprehension and Memorability of Charts.”</span> In <em>Proceedings of the 28th International Conference on Human Factors in Computing Systems - CHI ’10</em>, 2573. Atlanta, Georgia, USA: ACM Press. <a href="https://doi.org/10.1145/1753326.1753716">https://doi.org/10.1145/1753326.1753716</a>.
</div>
<div id="ref-bumpAmericaFavoriteDog2021" class="csl-entry" role="doc-biblioentry">
Bump, Philip. 2021. <span>“America’s Favorite Dog Breeds for the Past Two Decades, Ranked.”</span> <em>Washington Post</em>, November 25, 2021. <a href="https://www.washingtonpost.com/news/wonk/wp/2015/02/27/americas-favorite-dog-breeds-for-the-past-two-decades-ranked/">https://www.washingtonpost.com/news/wonk/wp/2015/02/27/americas-favorite-dog-breeds-for-the-past-two-decades-ranked/</a>.
</div>
<div id="ref-clevelandElementsGraphingData1985" class="csl-entry" role="doc-biblioentry">
Cleveland, William S. 1985. <em>The Elements of Graphing Data</em>. Monterey, Calif: Wadsworth Advanced Books and Software.
</div>
<div id="ref-healyDataVisualizationPractical2018" class="csl-entry" role="doc-biblioentry">
Healy, Kieran. 2018. <em>Data Visualization: A Practical Introduction</em>. Princeton, NJ: Princeton University Press.
</div>
<div id="ref-heerCrowdsourcingGraphicalPerception2010" class="csl-entry" role="doc-biblioentry">
Heer, Jeffrey, and Michael Bostock. 2010. <span>“Crowdsourcing Graphical Perception: Using Mechanical Turk to Assess Visualization Design.”</span>
</div>
<div id="ref-lodhaHowAmericansSpend2022" class="csl-entry" role="doc-biblioentry">
Lodha, Preethi. 2022. <span>“How Do Americans Spend Their Money, By Generation?”</span> Visual Capitalist. September 25, 2022. <a href="https://www.visualcapitalist.com/cp/how-americans-spend-their-money-2022/">https://www.visualcapitalist.com/cp/how-americans-spend-their-money-2022/</a>.
</div>
<div id="ref-tufteVisualDisplayQuantitative2013" class="csl-entry" role="doc-biblioentry">
Tufte, Edward R. 2013. <em>The visual display of quantitative information</em>. 2nd ed., 8th print. Cheshire, Conn: Graphics Press.
</div>
<div id="ref-wilkinsonGrammarGraphics2005" class="csl-entry" role="doc-biblioentry">
Wilkinson, Leland, and Graham Wills. 2005. <em>The Grammar of Graphics</em>. 2nd ed. Statistics and Computing. New York: Springer.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="references">References</h3>
  <div id="references-listing"></div>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Castellano (2023, Jan. 5). Data visualization | MSc CSS: Bump chart: How Americans spend their money. Retrieved from https://csslab.uc3m.es/dataviz/projects/2022/100481925/</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@misc{castellano2023bump,
  author = {Castellano, Carolina Cornejo},
  title = {Data visualization | MSc CSS: Bump chart: How Americans spend their money},
  url = {https://csslab.uc3m.es/dataviz/projects/2022/100481925/},
  year = {2023}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<!--radix_placeholder_navigation_after_body--><html><body>
<div class="distill-site-nav distill-site-footer">
<p><img src="../../../assets/acronimo_nombre1l_0.png" width="400"></p>
</div>
<!--/radix_placeholder_navigation_after_body-->
</body></html>


</body>

</html>
