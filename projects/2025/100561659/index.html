<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
<title>Data Visualization | MSc CSS: EUROPE ELECTS - Visualising the 2024 European Parliament Elections</title>

<meta property="description" itemprop="description" content="Recreating and improving on visual representation of election data *** this is still very much a working document - i have the code to a stage where it is running to produce an end product but the final document needs a lot of polishing and fitting to the guidelines of the project. ***"/>

<link rel="canonical" href="https://csslab.uc3m.es/dataviz/projects/2025/100561659/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2025-12-15"/>
<meta property="article:created" itemprop="dateCreated" content="2025-12-15"/>
<meta name="article:author" content="Kirsty Pirzkall"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Data Visualization | MSc CSS: EUROPE ELECTS - Visualising the 2024 European Parliament Elections"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Recreating and improving on visual representation of election data *** this is still very much a working document - i have the code to a stage where it is running to produce an end product but the final document needs a lot of polishing and fitting to the guidelines of the project. ***"/>
<meta property="og:url" content="https://csslab.uc3m.es/dataviz/projects/2025/100561659/"/>
<meta property="og:image" content="https://csslab.uc3m.es/dataviz/projects/2025/100561659/100561659_files/figure-html5/unnamed-chunk-13-1.png"/>
<meta property="og:image:width" content="1248"/>
<meta property="og:image:height" content="768"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Data Visualization | MSc CSS"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="Data Visualization | MSc CSS: EUROPE ELECTS - Visualising the 2024 European Parliament Elections"/>
<meta property="twitter:description" content="Recreating and improving on visual representation of election data *** this is still very much a working document - i have the code to a stage where it is running to produce an end product but the final document needs a lot of polishing and fitting to the guidelines of the project. ***"/>
<meta property="twitter:url" content="https://csslab.uc3m.es/dataviz/projects/2025/100561659/"/>
<meta property="twitter:image" content="https://csslab.uc3m.es/dataviz/projects/2025/100561659/100561659_files/figure-html5/unnamed-chunk-13-1.png"/>
<meta property="twitter:image:width" content="1248"/>
<meta property="twitter:image:height" content="768"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="Data Visualization | MSc CSS: EUROPE ELECTS - Visualising the 2024 European Parliament Elections"/>
<meta name="citation_fulltext_html_url" content="https://csslab.uc3m.es/dataviz/projects/2025/100561659/"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2025/12/15"/>
<meta name="citation_publication_date" content="2025/12/15"/>
<meta name="citation_author" content="Kirsty Pirzkall"/>
<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["creative_commons","title","description","categories","author","date","output","citation_url","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["CC BY"]},{"type":"character","attributes":{},"value":["EUROPE ELECTS - Visualising the 2024 European Parliament Elections"]},{"type":"character","attributes":{},"value":["Recreating and improving on visual representation of election data *** this is still very much a working document - i have the code to a stage where it is running to produce an end product but the final document needs a lot of polishing and fitting to the guidelines of the project. ***"]},{"type":"character","attributes":{},"value":["2025"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Kirsty Pirzkall"]}]}]},{"type":"character","attributes":{},"value":["2025-12-15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["https://csslab.uc3m.es/dataviz/projects/2025/100561659/"]},{"type":"character","attributes":{},"value":["https://csslab.uc3m.es/dataviz/projects/2025/100561659/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["100561659_files/anchor-4.2.2/anchor.min.js","100561659_files/bowser-1.9.3/bowser.min.js","100561659_files/Data/at.csv","100561659_files/Data/be.csv","100561659_files/Data/bg.csv","100561659_files/Data/cy.csv","100561659_files/Data/cz.csv","100561659_files/Data/de.csv","100561659_files/Data/dk.csv","100561659_files/Data/ee.csv","100561659_files/Data/el.csv","100561659_files/Data/es.csv","100561659_files/Data/fi.csv","100561659_files/Data/fr.csv","100561659_files/Data/hr.csv","100561659_files/Data/hu.csv","100561659_files/Data/ie.csv","100561659_files/Data/it.csv","100561659_files/Data/lt.csv","100561659_files/Data/lu.csv","100561659_files/Data/lv.csv","100561659_files/Data/mt.csv","100561659_files/Data/nl.csv","100561659_files/Data/pl.csv","100561659_files/Data/pt.csv","100561659_files/Data/ro.csv","100561659_files/Data/se.csv","100561659_files/Data/si.csv","100561659_files/Data/sk.csv","100561659_files/distill-2.2.21/template.v2.js","100561659_files/figure-html5/unnamed-chunk-13-1.png","100561659_files/figure-html5/unnamed-chunk-16-1.png","100561659_files/figure-html5/unnamed-chunk-19-1.png","100561659_files/figure-html5/unnamed-chunk-19-10.png","100561659_files/figure-html5/unnamed-chunk-19-11.png","100561659_files/figure-html5/unnamed-chunk-19-12.png","100561659_files/figure-html5/unnamed-chunk-19-13.png","100561659_files/figure-html5/unnamed-chunk-19-14.png","100561659_files/figure-html5/unnamed-chunk-19-15.png","100561659_files/figure-html5/unnamed-chunk-19-16.png","100561659_files/figure-html5/unnamed-chunk-19-17.png","100561659_files/figure-html5/unnamed-chunk-19-18.png","100561659_files/figure-html5/unnamed-chunk-19-19.png","100561659_files/figure-html5/unnamed-chunk-19-2.png","100561659_files/figure-html5/unnamed-chunk-19-20.png","100561659_files/figure-html5/unnamed-chunk-19-21.png","100561659_files/figure-html5/unnamed-chunk-19-22.png","100561659_files/figure-html5/unnamed-chunk-19-23.png","100561659_files/figure-html5/unnamed-chunk-19-24.png","100561659_files/figure-html5/unnamed-chunk-19-25.png","100561659_files/figure-html5/unnamed-chunk-19-26.png","100561659_files/figure-html5/unnamed-chunk-19-27.png","100561659_files/figure-html5/unnamed-chunk-19-3.png","100561659_files/figure-html5/unnamed-chunk-19-4.png","100561659_files/figure-html5/unnamed-chunk-19-5.png","100561659_files/figure-html5/unnamed-chunk-19-6.png","100561659_files/figure-html5/unnamed-chunk-19-7.png","100561659_files/figure-html5/unnamed-chunk-19-8.png","100561659_files/figure-html5/unnamed-chunk-19-9.png","100561659_files/figure-html5/unnamed-chunk-22-1.png","100561659_files/figure-html5/unnamed-chunk-22-10.png","100561659_files/figure-html5/unnamed-chunk-22-11.png","100561659_files/figure-html5/unnamed-chunk-22-12.png","100561659_files/figure-html5/unnamed-chunk-22-13.png","100561659_files/figure-html5/unnamed-chunk-22-14.png","100561659_files/figure-html5/unnamed-chunk-22-15.png","100561659_files/figure-html5/unnamed-chunk-22-16.png","100561659_files/figure-html5/unnamed-chunk-22-17.png","100561659_files/figure-html5/unnamed-chunk-22-18.png","100561659_files/figure-html5/unnamed-chunk-22-19.png","100561659_files/figure-html5/unnamed-chunk-22-2.png","100561659_files/figure-html5/unnamed-chunk-22-20.png","100561659_files/figure-html5/unnamed-chunk-22-21.png","100561659_files/figure-html5/unnamed-chunk-22-22.png","100561659_files/figure-html5/unnamed-chunk-22-23.png","100561659_files/figure-html5/unnamed-chunk-22-24.png","100561659_files/figure-html5/unnamed-chunk-22-25.png","100561659_files/figure-html5/unnamed-chunk-22-26.png","100561659_files/figure-html5/unnamed-chunk-22-27.png","100561659_files/figure-html5/unnamed-chunk-22-3.png","100561659_files/figure-html5/unnamed-chunk-22-4.png","100561659_files/figure-html5/unnamed-chunk-22-5.png","100561659_files/figure-html5/unnamed-chunk-22-6.png","100561659_files/figure-html5/unnamed-chunk-22-7.png","100561659_files/figure-html5/unnamed-chunk-22-8.png","100561659_files/figure-html5/unnamed-chunk-22-9.png","100561659_files/figure-html5/unnamed-chunk-24-1.png","100561659_files/figure-html5/unnamed-chunk-24-10.png","100561659_files/figure-html5/unnamed-chunk-24-11.png","100561659_files/figure-html5/unnamed-chunk-24-12.png","100561659_files/figure-html5/unnamed-chunk-24-13.png","100561659_files/figure-html5/unnamed-chunk-24-14.png","100561659_files/figure-html5/unnamed-chunk-24-15.png","100561659_files/figure-html5/unnamed-chunk-24-16.png","100561659_files/figure-html5/unnamed-chunk-24-17.png","100561659_files/figure-html5/unnamed-chunk-24-18.png","100561659_files/figure-html5/unnamed-chunk-24-19.png","100561659_files/figure-html5/unnamed-chunk-24-2.png","100561659_files/figure-html5/unnamed-chunk-24-20.png","100561659_files/figure-html5/unnamed-chunk-24-21.png","100561659_files/figure-html5/unnamed-chunk-24-22.png","100561659_files/figure-html5/unnamed-chunk-24-23.png","100561659_files/figure-html5/unnamed-chunk-24-24.png","100561659_files/figure-html5/unnamed-chunk-24-25.png","100561659_files/figure-html5/unnamed-chunk-24-26.png","100561659_files/figure-html5/unnamed-chunk-24-27.png","100561659_files/figure-html5/unnamed-chunk-24-3.png","100561659_files/figure-html5/unnamed-chunk-24-4.png","100561659_files/figure-html5/unnamed-chunk-24-5.png","100561659_files/figure-html5/unnamed-chunk-24-6.png","100561659_files/figure-html5/unnamed-chunk-24-7.png","100561659_files/figure-html5/unnamed-chunk-24-8.png","100561659_files/figure-html5/unnamed-chunk-24-9.png","100561659_files/figure-html5/unnamed-chunk-30-1.png","100561659_files/figure-html5/unnamed-chunk-35-1.png","100561659_files/figure-html5/unnamed-chunk-36-1.png","100561659_files/figure-html5/unnamed-chunk-37-1.png","100561659_files/figure-html5/unnamed-chunk-42-1.png","100561659_files/figure-html5/unnamed-chunk-43-1.png","100561659_files/figure-html5/unnamed-chunk-44-1.png","100561659_files/figure-html5/unnamed-chunk-45-1.png","100561659_files/figure-html5/unnamed-chunk-46-1.png","100561659_files/figure-html5/unnamed-chunk-47-1.png","100561659_files/figure-html5/unnamed-chunk-48-1.png","100561659_files/figure-html5/unnamed-chunk-49-1.png","100561659_files/figure-html5/unnamed-chunk-50-1.png","100561659_files/figure-html5/unnamed-chunk-52-1.png","100561659_files/figure-html5/unnamed-chunk-58-1.png","100561659_files/figure-html5/unnamed-chunk-60-1.png","100561659_files/figure-html5/unnamed-chunk-62-1.png","100561659_files/header-attrs-2.30/header-attrs.js","100561659_files/jquery-3.6.0/jquery-3.6.0.js","100561659_files/jquery-3.6.0/jquery-3.6.0.min.js","100561659_files/jquery-3.6.0/jquery-3.6.0.min.map","100561659_files/popper-2.6.0/popper.min.js","100561659_files/tippy-6.2.7/tippy-bundle.umd.min.js","100561659_files/tippy-6.2.7/tippy-light-border.css","100561659_files/tippy-6.2.7/tippy.css","100561659_files/tippy-6.2.7/tippy.umd.min.js","100561659_files/webcomponents-2.0.0/webcomponents.js","benelux_plots/Belgium.png","benelux_plots/Luxembourg.png","benelux_plots/Netherlands.png","combined_plots/Austria.png","combined_plots/Bulgaria.png","combined_plots/Croatia.png","combined_plots/Czechia.png","combined_plots/Denmark.png","combined_plots/Estonia.png","combined_plots/Finland.png","combined_plots/France.png","combined_plots/Germany.png","combined_plots/Greece.png","combined_plots/Hungary.png","combined_plots/Ireland.png","combined_plots/Italy.png","combined_plots/Latvia.png","combined_plots/Lithuania.png","combined_plots/Poland.png","combined_plots/Portugal.png","combined_plots/Romania.png","combined_plots/Slovakia.png","combined_plots/Slovenia.png","combined_plots/Spain.png","combined_plots/Sweden.png","cyprus_plots/Cyprus.png","donut_key.png","eu_election_faceted_maps_individual_legends.png","eu_election_faceted_region.png","eu_election_old_vs_new.png","eu_election_results_horizontal.png","EU_FINAL.png","EUROMAP_with_legend_key.png","EUROMAP_with_legend.png","final_EUROMAP.png","Images/original_plot.png","legend_check.png","malta_plots/Malta.png","zooms_trimmed.png","zooms.png"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../../site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"/>
<link href="../../../site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

hr.section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  margin: 0px;
}


d-byline {
  border-top: none;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
  border-top: none;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

/* tweak for Pandoc numbered line within distill */
d-article pre.numberSource code > span {
    left: -2em;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // separator
  var separator = '<hr class="section-separator" style="clear: both"/>';
  // prepend separator above appendix
  $('.d-byline').before(separator);
  $('.d-article').before(separator);

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme, except when numbering line
  // in code chunk
  $('pre:not(.numberLines) code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      var author_name = front_matter.authors[i].author
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */

@import url('https://fonts.googleapis.com/css2?family=Questrial');

html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    "Questrial", sans-serif;
  --mono-font:       monospace;
  --body-font:       "Questrial", sans-serif;
  --navbar-font:     "Questrial", sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #000e78;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #000e78;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */

@media screen and (min-width: 768px) {
  d-article aside {
    height: 0;
  }
  aside.slides {
    margin-left: -148px;
    height: auto;
  }
  aside.slides + h2 {
    white-space: nowrap;
  }
}

d-article li {
  margin-bottom: 0.1em;
}

.posts-list .post-preview .thumbnail {
  max-height: 300px;
  overflow: hidden;
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../../site_libs/header-attrs-2.30/header-attrs.js"></script>
  <script src="../../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"EUROPE ELECTS - Visualising the 2024 European Parliament Elections","description":"Recreating and improving on visual representation of election data *** this is still very much a working document - i have the code to a stage where it is running to produce an end product but the final document needs a lot of polishing and fitting to the guidelines of the project. ***","authors":[{"author":"Kirsty Pirzkall","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2025-12-15T00:00:00.000+01:00","citationText":"Pirzkall, 2025"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<span class="logo">
<img src="../../../assets/acronimo_0.png"/>
</span>
<a href="../../../index.html" class="title">Data Visualization | MSc CSS</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../../contents.html">Contents</a>
<a href="../../../tutorials.html">Tutorials</a>
<a href="../../../resources.html">Resources</a>
<a href="../../../projects.html">Projects</a>
<a href="https://github.com/IBiDat/dataviz" aria-label="Link to source">
<i class="fab fa-github" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>EUROPE ELECTS - Visualising the 2024 European Parliament Elections</h1>

<!--radix_placeholder_categories-->
<div class="dt-tags">
  <a href="../../../projects.html#category:2025" class="dt-tag">2025</a>
</div>
<!--/radix_placeholder_categories-->
<p>Recreating and improving on visual representation of election data *** this is still very much a working document - i have the code to a stage where it is running to produce an end product but the final document needs a lot of polishing and fitting to the guidelines of the project. ***</p>
</div>

<div class="d-byline">
  
  Kirsty Pirzkall
  
<br/>2025-12-15
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#introduction" id="toc-introduction">INTRODUCTION</a></li>
<li><a href="#the-original-plot" id="toc-the-original-plot">THE ORIGINAL PLOT</a></li>
<li><a href="#data-sources" id="toc-data-sources">DATA SOURCES</a></li>
<li><a href="#installing-packages" id="toc-installing-packages">INSTALLING PACKAGES</a></li>
<li><a href="#defining-globals" id="toc-defining-globals">DEFINING GLOBALS</a></li>
<li><a href="#making-the-background-map" id="toc-making-the-background-map">MAKING THE BACKGROUND MAP</a></li>
<li><a href="#adding-the-dotted-boxes" id="toc-adding-the-dotted-boxes">ADDING THE DOTTED BOXES</a></li>
<li><a href="#making-the-parliament-plots" id="toc-making-the-parliament-plots">MAKING THE PARLIAMENT PLOTS</a>
<ul>
<li><a href="#debugging" id="toc-debugging">DEBUGGING</a></li>
<li><a href="#defining-the-parliament-plot-function" id="toc-defining-the-parliament-plot-function">DEFINING THE PARLIAMENT PLOT FUNCTION</a></li>
<li><a href="#plotting" id="toc-plotting">PLOTTING</a></li>
</ul></li>
<li><a href="#making-the-donut-plots" id="toc-making-the-donut-plots">MAKING THE DONUT PLOTS</a>
<ul>
<li><a href="#data-recreation" id="toc-data-recreation">DATA RECREATION</a></li>
<li><a href="#defining-the-donut-plot-function" id="toc-defining-the-donut-plot-function">DEFINING THE DONUT PLOT FUNCTION</a></li>
<li><a href="#plotting-1" id="toc-plotting-1">PLOTTING</a></li>
</ul></li>
<li><a href="#combining-the-parliament-and-donut-plots" id="toc-combining-the-parliament-and-donut-plots">COMBINING THE PARLIAMENT AND DONUT PLOTS</a>
<ul>
<li><a href="#defining-the-combination-plot-function" id="toc-defining-the-combination-plot-function">DEFINING THE COMBINATION PLOT FUNCTION</a></li>
<li><a href="#plotting-2" id="toc-plotting-2">PLOTTING</a></li>
</ul></li>
<li><a href="#positioning-the-combo-plots-on-the-map" id="toc-positioning-the-combo-plots-on-the-map">POSITIONING THE COMBO PLOTS ON THE MAP</a>
<ul>
<li><a href="#data-construction" id="toc-data-construction">DATA CONSTRUCTION</a></li>
<li><a href="#scaling" id="toc-scaling">SCALING</a></li>
</ul></li>
<li><a href="#making-the-legend" id="toc-making-the-legend">MAKING THE LEGEND</a></li>
<li><a href="#making-the-circular-legend" id="toc-making-the-circular-legend">MAKING THE CIRCULAR LEGEND</a></li>
<li><a href="#making-the-zoom-in-map-section" id="toc-making-the-zoom-in-map-section">MAKING THE ZOOM IN MAP SECTION</a>
<ul>
<li><a href="#data-creation" id="toc-data-creation">DATA CREATION</a></li>
<li><a href="#benelux-region" id="toc-benelux-region">BENELUX REGION</a></li>
<li><a href="#malta" id="toc-malta">MALTA</a></li>
<li><a href="#cyprus" id="toc-cyprus">CYPRUS</a></li>
</ul></li>
<li><a href="#putting-it-all-together" id="toc-putting-it-all-together">PUTTING IT ALL TOGETHER</a>
<ul>
<li><a href="#combining-the-zooms" id="toc-combining-the-zooms">COMBINING THE ZOOMS</a></li>
</ul></li>
<li><a href="#final-reproduction" id="toc-final-reproduction">FINAL REPRODUCTION</a></li>
<li><a href="#reimagining-the-visualisation" id="toc-reimagining-the-visualisation">REIMAGINING THE VISUALISATION</a>
<ul>
<li><a href="#issues-with-the-original-plot" id="toc-issues-with-the-original-plot">ISSUES WITH THE ORIGINAL PLOT</a></li>
<li><a href="#streching-out-the-donut-data" id="toc-streching-out-the-donut-data">STRECHING OUT THE DONUT DATA</a></li>
</ul></li>
<li><a href="#multiple-maps" id="toc-multiple-maps">MULTIPLE MAPS</a></li>
</ul>
</nav>
</div>
<h2 id="introduction">INTRODUCTION</h2>
<p>The 10th European Parliament elections (and the first since the UKs departure) took place from the 6th to the 9th of June 2024, spanning the 27 EU member states. In this period over 182 million eligible voters chose the next set of 720 Members of the European Parliament (MEPs).</p>
<p>The outcome of the elections marked significant shifts in the European political landscape. Traditional, centrist political groups experienced losses whereas right-wing and far-right parties made notable gains in many countries. The overall results also reflected growing fragmentation and the strengthening of Eurosceptic voices in several member states.</p>
<p>The composition of the European Parliament is complex - it involves over 200 national political parties from 27 countries that organise into 8 European Parliament groups, 720 MEPs that fill the seats of the parliament, and positions from the whole political spectrum represented across diverse national backdrops. The results of the election mirror this complexity - a large amount of data is produced which is then analysed, reported, and published in many languages and formats. Clear and accurate communication of this data is vital as the outcome of the vote has important implications for EU policy-making on key issues such as migration, defense, climate change, and economic governance in the following parliamentary term.</p>
<p><u><strong>Visualizing Democratic Choice</strong></u></p>
<p>Since election results are inherently complex, data visualisation is commonly used to transform the data into accessible insights, allowing citizens to quickly undertand the political landscape and understand what the numbers mean for governance and policy.</p>
<p>When it comes to the European Parliament elections, using visualisation to present the results comes with unique challenges. The amount and complexity of the data means that careful choices have to be made about what to emphasise and how to maintain clarity.</p>
<p>Traditional approaches like semicircular parliament seat diagrams mirror the physical parliamentary chamber, making coalition dynamics and political balance immediately visible. Geographic breakdowns reveal how European political sentiment varies across regions, while comparative visualizations can highlight shifts from previous elections.</p>
<p>The goal of these visualizations is not simply to report numbers, but to illuminate patterns, facilitate comparison, and make democratic outcomes comprehensible. In an era of information overload, clear and honest visual representation of electoral data serves a vital civic function - helping people understand the institutions that govern them and the choices their fellow citizens have made.</p>
<h2 id="the-original-plot">THE ORIGINAL PLOT</h2>
<p>The visualisation chosen as the basis of this project was sourced from the Wikipedia page 2024 European Parliament election (<a href="https://en.wikipedia.org/wiki/2024_European_Parliament_election" class="uri">https://en.wikipedia.org/wiki/2024_European_Parliament_election</a>) and appears to have been originally made using the Inkscape platform.</p>
<p>This plot aims to communicate the results of the elections to a wide audience by providing a unified visual overview at both a national and EU level. It does this by including geographic, seat-based, and vote-proportion representations.<br />
<br />
A choropleth map (a statistical map that uses colours/ shades to represent data values across predefined geographical areas) employing a combination of colour coding and color graduation is used to represent both which European Parliament group won the largest proportion of the vote in each EU27 country, and what percentage range of the total vote this winning proportion represents.</p>
<p>Parliament plots (also called hemicycle diagrams) are used to represent the seat distribution in legislative bodies. Traditionally, dots are arranged in a semicircle or horseshoe shape where each dot represents one seat/ representative and the colour of the dot represents the political party or group that the representative is affiliated with. In this case, the original plot uses 27 distinct, circular parliament plots to visualise the seat breakdown by European Parliament group in each of the EU member states.</p>
<p>Donut plots show the proportions of a whole, and are essentially nothing more than pie charts with the middle cut out. In the case of original plot, 27 individual donut plots are used to convey the percentage of the total vote that each European Parliament group recieved in each country.</p>
<figure>
<img src="Images/original_plot.png" class="external" style="width:100.0%" alt="Original chart. Source: Wikipedia 2024 European Parliamen Election" />
<figcaption aria-hidden="true">Original chart. Source: Wikipedia 2024 European Parliamen Election</figcaption>
</figure>
<p>The decision to explore this graph was largely due to the variety of visualisation techniques that is employs, which combine into an overall striking and very eye-catching plot. Further to the this visual interest created by the merging of techniques, I hoped that trying to recreate a plot that uses many different methods to convey election data would allow me to explore a wider range of data visualisation tools in R.</p>
<h2 id="data-sources">DATA SOURCES</h2>
<p>Obtaining the election data needed for the recreation of this plot posed some challenges and the final data used came from two differet sources.</p>
<p>The data used to recreate the parliament seat plots came directly from 27 individual country-specific election result datasets published online by the European Parliament (<a href="https://results.elections.europa.eu/en/tools/download-datasheets/" class="uri">https://results.elections.europa.eu/en/tools/download-datasheets/</a>). These datasets primarily consisted of the number of seats won by each European Perliament group in their respective countries which is all the information that was required for this part of the plot.</p>
<p>The data that was used to recreate the donut plots, which represents the proportion of the total vote in each country won per European Parliament group, could not be found in a pre-existing dataset and nor were these figures published explicitly online. This lack of accessible and verifiable data meant that considerable effort was required to approximate and reconstruct the data needed to reconstruct this part of the plot accurately. To this end, the percentage of votes won by individual national political parties was sourced and then aggregated in to European Parliament group percentages manually by researching the affiliation of each individual party at the time of the election. This was a timely process that utilised many sources such as wikipedia, the European Parliament website, and the webpages of the individual national parties themselves.<br />
<br />
Finally, the data required to achieve the colouring of the background map had to be recreated manually. This process was less involved than the data recreation of the donut plots as the figures required could be extracted directly from the original plot.<br />
<br />
Once the required data was gathered, the processing and visualisation process in R could begin.</p>
<h2 id="installing-packages">INSTALLING PACKAGES</h2>
<p>This project uses numerous packages in R that are required to facilitate effective data manipulation and visulisation in a variety of forms.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://r-spatial.github.io/sf/'>sf</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://docs.ropensci.org/rnaturalearth/'>rnaturalearth</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://docs.ropensci.org/rnaturalearthdata/'>rnaturalearthdata</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://readr.tidyverse.org'>readr</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/zmeers/ggparliament'>ggparliament</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggforce.data-imaginist.com'>ggforce</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>grid</span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://wilkelab.org/cowplot/'>cowplot</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://scales.r-lib.org'>scales</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/YuLab-SMU/ggimage'>ggimage</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://patchwork.data-imaginist.com'>patchwork</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://www.rforge.net/png/'>png</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://docs.ropensci.org/magick/'>magick</a></span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h2 id="defining-globals">DEFINING GLOBALS</h2>
<p>At the beginning of the replication process, some global specifications were defined in order to streamline the visualisation process and ensure consistency across the multiple components of the plot.</p>
<p>The order in which the European Parliament groups were represented in the original parliament and donut plots was assigned to a vector:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>party_order</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ESN"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"ECR"</span>, <span class='st'>"EPP"</span>,  <span class='st'>"NI"</span>, <span class='st'>"Independent"</span>, <span class='st'>"Renew"</span>, <span class='st'>"GREENSEFA"</span>, <span class='st'>"SD"</span>, <span class='st'>"Theleft"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Another vector was used to define a standard colour palette reflective of the colours used to represent each European Parliament group in the original plot. To do this, the original image was uploaded to the website <a href="https://imagecolorpicker.com/" class="uri">https://imagecolorpicker.com/</a> which allowed the exact hex codes of each colour to be identified and used in this project:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>custom_cols</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>  <span class='st'>"ECR"</span> <span class='op'>=</span> <span class='st'>"#3d29a3"</span>,</span>
<span>  <span class='st'>"EPP"</span> <span class='op'>=</span> <span class='st'>"#3aaff7"</span>,</span>
<span>  <span class='st'>"NI"</span> <span class='op'>=</span> <span class='st'>"#8c8673"</span>,</span>
<span>  <span class='st'>"Patriots"</span> <span class='op'>=</span> <span class='st'>"#3e435b"</span>,</span>
<span>  <span class='st'>"Renew"</span> <span class='op'>=</span> <span class='st'>"#ffd500"</span>,</span>
<span>  <span class='st'>"SD"</span> <span class='op'>=</span> <span class='st'>"#ed1c25"</span>,</span>
<span>  <span class='st'>"ESN"</span> <span class='op'>=</span> <span class='st'>"#997a1f"</span>,</span>
<span>  <span class='st'>"GREENSEFA"</span> <span class='op'>=</span> <span class='st'>"#33cd32"</span>,</span>
<span>  <span class='st'>"Theleft"</span> <span class='op'>=</span> <span class='st'>"#b01b66"</span>,</span>
<span>  <span class='st'>"Independent"</span> <span class='op'>=</span> <span class='st'>"#e0e0e0"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h2 id="making-the-background-map">MAKING THE BACKGROUND MAP</h2>
<p>The first component of the original plot to be recreated was the main background map. A dataset for the data displayed in the map was constructed:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>eu_parl_map</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  country <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Austria"</span>, <span class='st'>"Belgium"</span>, <span class='st'>"Bulgaria"</span>, <span class='st'>"Croatia"</span>, <span class='st'>"Cyprus"</span>, <span class='st'>"Czechia"</span>, <span class='st'>"Denmark"</span>, <span class='st'>"Estonia"</span>, <span class='st'>"Finland"</span>, <span class='st'>"France"</span>, <span class='st'>"Germany"</span>, <span class='st'>"Greece"</span>, <span class='st'>"Hungary"</span>, <span class='st'>"Ireland"</span>, <span class='st'>"Italy"</span>, <span class='st'>"Latvia"</span>, <span class='st'>"Lithuania"</span>, <span class='st'>"Luxembourg"</span>, <span class='st'>"Malta"</span>, <span class='st'>"Netherlands"</span>, <span class='st'>"Poland"</span>, <span class='st'>"Portugal"</span>, <span class='st'>"Romania"</span>, <span class='st'>"Slovakia"</span>, <span class='st'>"Slovenia"</span>, <span class='st'>"Spain"</span>, <span class='st'>"Sweden"</span><span class='op'>)</span>,</span>
<span>  </span>
<span>  country_code <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"AUT"</span>, <span class='st'>"BEL"</span>, <span class='st'>"BGR"</span>, <span class='st'>"HRV"</span>, <span class='st'>"CYP"</span>, <span class='st'>"CZE"</span>, <span class='st'>"DNK"</span>, <span class='st'>"EST"</span>, <span class='st'>"FIN"</span>, <span class='st'>"FRA"</span>, <span class='st'>"DEU"</span>, <span class='st'>"GRC"</span>, <span class='st'>"HUN"</span>, <span class='st'>"IRL"</span>, <span class='st'>"ITA"</span>, <span class='st'>"LVA"</span>,<span class='st'>"LTU"</span>, <span class='st'>"LUX"</span>, <span class='st'>"MLT"</span>, <span class='st'>"NLD"</span>, <span class='st'>"POL"</span>, <span class='st'>"PRT"</span>, <span class='st'>"ROU"</span>, <span class='st'>"SVK"</span>, <span class='st'>"SVN"</span>, <span class='st'>"ESP"</span>, <span class='st'>"SWE"</span><span class='op'>)</span>,</span>
<span>  </span>
<span>  top_party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Patriots"</span>, <span class='st'>"Renew"</span>, <span class='st'>"EPP"</span>, <span class='st'>"EPP"</span>, <span class='st'>"EPP"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"Renew"</span>, <span class='st'>"Renew"</span>, <span class='st'>"EPP"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"EPP"</span>, <span class='st'>"EPP"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"Renew"</span>, <span class='st'>"ECR"</span>, <span class='st'>"ECR"</span>, <span class='st'>"EPP"</span>, <span class='st'>"EPP"</span>, <span class='st'>"SD"</span>, <span class='st'>"Renew"</span>, <span class='st'>"EPP"</span>, <span class='st'>"SD"</span>, <span class='st'>"SD"</span>, <span class='st'>"NI"</span>, <span class='st'>"EPP"</span>, <span class='st'>"EPP"</span>, <span class='st'>"SD"</span><span class='op'>)</span>,</span>
<span>  </span>
<span>  top_seats <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>6</span>, <span class='fl'>5</span>, <span class='fl'>6</span>, <span class='fl'>6</span>, <span class='fl'>2</span>, <span class='fl'>9</span>, <span class='fl'>4</span>, <span class='fl'>2</span>, <span class='fl'>4</span>, <span class='fl'>30</span>, <span class='fl'>31</span>, <span class='fl'>7</span>, <span class='fl'>11</span>, <span class='fl'>6</span>, <span class='fl'>24</span>, <span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>7</span>, <span class='fl'>23</span>, <span class='fl'>8</span>, <span class='fl'>11</span>, <span class='fl'>7</span>, <span class='fl'>5</span>, <span class='fl'>22</span>, <span class='fl'>5</span><span class='op'>)</span>,</span>
<span>  </span>
<span>  total_seats <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>20</span>, <span class='fl'>22</span>, <span class='fl'>17</span>, <span class='fl'>12</span>, <span class='fl'>6</span>, <span class='fl'>21</span>, <span class='fl'>15</span>, <span class='fl'>7</span>, <span class='fl'>15</span>, <span class='fl'>81</span>, <span class='fl'>96</span>, <span class='fl'>21</span>, <span class='fl'>21</span>, <span class='fl'>14</span>, <span class='fl'>76</span>, <span class='fl'>9</span>, <span class='fl'>11</span>, <span class='fl'>6</span>, <span class='fl'>6</span>, <span class='fl'>31</span>, <span class='fl'>53</span>, <span class='fl'>21</span>, <span class='fl'>33</span>, <span class='fl'>15</span>, <span class='fl'>9</span>, <span class='fl'>61</span>, <span class='fl'>21</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># create a variable containing the percentage of seats held by top group</span></span>
<span><span class='va'>eu_parl_map</span> <span class='op'>&lt;-</span></span>
<span>  <span class='va'>eu_parl_map</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>top_percentage <span class='op'>=</span> <span class='op'>(</span><span class='va'>top_seats</span> <span class='op'>/</span> <span class='va'>total_seats</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>100</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Second, we get the map data that we need for the project. In R there are several packages that can be used for making map-based visualisations, these include maps, rnaturalearth, and giscoR. After researching map creation in R I chose to use the rnaturalearth package for this project as it seemed to be an up-to-date, general-purpose mapping package that had a lot of readily-available supporting documentation, online resources, and existing discussion on R programming forums.</p>
<p>Firstly all the geographic boundary data included in the naturalearthpackage was called. It was decided that for this project a medium scale with moderate detail would provide a good balance of reasonable detail without excessive file size or rendering time. Returning the data as a sf (simple features) object provides a tidyverse-friendly data structure and makes the data compatible with visualisation packages such as ggplot2 which will be relied on heavily throughout this project.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>countries</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://docs.ropensci.org/rnaturalearth/reference/ne_countries.html'>ne_countries</a></span><span class='op'>(</span>scale <span class='op'>=</span> <span class='st'>"medium"</span>, returnclass <span class='op'>=</span> <span class='st'>"sf"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Next this full set of countries was reduced to what is needed for the project - the continental european territories of the 27 European union member states. This was done using a combination of centroids and latitudes/longitudes.</p>
<p>The complex, multi-part geometries retrieved from rnaturalearth were decomposed into individual polygons, and the geographic centroid for each of these polygons was then calculated. After this, a filter was used to only keep those polygons with a centroid falling within a boundary box spanning -25 to 40 longitude and 34 to 72 latitude (this longitude and latitude data was estimated manually using google maps as a reference). This approach captured the European continental region required whilst excluding overseas territories of the EU27 countries that are not represented on the original map.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># decomposition of multipolygons into individual polygons</span></span>
<span><span class='va'>countries</span> <span class='op'>&lt;-</span> <span class='va'>countries</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_cast.html'>st_cast</a></span><span class='op'>(</span><span class='st'>"MULTIPOLYGON"</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_cast.html'>st_cast</a></span><span class='op'>(</span><span class='st'>"POLYGON"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># calculating centroids </span></span>
<span><span class='va'>cent</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_coordinates.html'>st_coordinates</a></span><span class='op'>(</span><span class='fu'><a href='https://r-spatial.github.io/sf/reference/geos_unary.html'>st_centroid</a></span><span class='op'>(</span><span class='va'>countries</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># adding centroid longitude and latitude to the data frame to make filtering easier</span></span>
<span><span class='va'>countries</span> <span class='op'>&lt;-</span> <span class='va'>countries</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    lon <span class='op'>=</span> <span class='va'>cent</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span>,</span>
<span>    lat <span class='op'>=</span> <span class='va'>cent</span><span class='op'>[</span>, <span class='fl'>2</span><span class='op'>]</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># filtering for polygons withing longitude and latitude boundaries</span></span>
<span><span class='va'>countries</span> <span class='op'>&lt;-</span> <span class='va'>countries</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span></span>
<span>    <span class='va'>lon</span> <span class='op'>&gt;</span> <span class='op'>-</span><span class='fl'>25</span>, <span class='va'>lon</span> <span class='op'>&lt;</span> <span class='fl'>40</span>,  </span>
<span>    <span class='va'>lat</span> <span class='op'>&gt;</span> <span class='fl'>34</span>,  <span class='va'>lat</span> <span class='op'>&lt;</span> <span class='fl'>72</span>   </span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Now that both the election data represented in the map and the geometries of the map area have been defined, the next job is to join the two together.<br />
To do this, an inner join was used merging the two datasets and only keeping the rows where there is a match in both. Effectively, this means that as the data is joined the map polygons are simultaneously further filtered down to include those only belonging to EU27 countries. The variables adm0_30 and country_code as the keys for this join.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># join map and election datasets</span></span>
<span><span class='va'>final_map</span> <span class='op'>&lt;-</span> <span class='va'>countries</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>inner_join</a></span><span class='op'>(</span><span class='va'>eu_parl_map</span>, </span>
<span>             by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"adm0_a3"</span> <span class='op'>=</span> <span class='st'>"country_code"</span><span class='op'>)</span>, keep <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>            </span></code></pre>
</div>
</div>
<p>After inspecting the resulting, joined dataset it was decided to clean it up by minimising the number of variables. A lot of variables provided by the {rnaturalearth} package were not relevant to this project so were removed to make the final working dataset more easily readable and Rs processing job lighter.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>final_map</span> <span class='op'>&lt;-</span> <span class='va'>final_map</span> <span class='op'>|&gt;</span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://tidyselect.r-lib.org/reference/all_of.html'>all_of</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>eu_parl_map</span><span class='op'>)</span><span class='op'>)</span>,   </span>
<span>    <span class='va'>geometry</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Next, the banding for the colour graduation in the choropleth map was set. The variable top_percentage held the vote percentage data for the colour graduation, and in its original form was a continuous variable. A new, categorical variable pct_band was created. Here, to match the original plot, (left closed) intervals of 5% were created from 25% to 50%, with catch-all groups for vote percentages below 25 and above 50 percent.<br />
<br />
The top_party variable that holds the identity of the winning European Parliament group for each country was also converted to a factor type variable for categorical analysis.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># create categorical vote percentage variable</span></span>
<span><span class='va'>final_map</span> <span class='op'>&lt;-</span> <span class='va'>final_map</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    top_percentage <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>top_percentage</span><span class='op'>)</span>,</span>
<span>    pct_band <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cut.html'>cut</a></span><span class='op'>(</span></span>
<span>      <span class='va'>top_percentage</span>,</span>
<span>      breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='cn'>Inf</span>, <span class='fl'>25</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>30</span>, <span class='fl'>50</span>, <span class='fl'>5</span><span class='op'>)</span>, <span class='cn'>Inf</span><span class='op'>)</span>,</span>
<span>      right <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>      labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>        <span class='st'>"&lt; 25"</span>,</span>
<span>        <span class='st'>"2530"</span>, <span class='st'>"3035"</span>, <span class='st'>"3540"</span>, <span class='st'>"4045"</span>, <span class='st'>"4550"</span>,</span>
<span>        <span class='st'>"50+"</span></span>
<span>      <span class='op'>)</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    top_party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>top_party</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Following this, it was time to approach the actual shades of colours used for the percentage categories of each European Parliament group in the plot - this meant generating gradient shades for each party based on the colours assigned earlier in the plot globals and the new percentage bands. A unique colour was needed for each combination of EP group (top_party) and percentage category (pct_band) that can exist.</p>
<p>This was a somewhat tricky task, and after a lot of research and trial-and-error two custom functions were designed in order to manipulate the map colours programatically.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># defining a function: create a new colour from 2 input colurs and specified proportions</span></span>
<span><span class='va'>mix_colors</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>col1</span>, <span class='va'>col2</span>, <span class='va'>p</span> <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>{</span></span>
<span><span class='co'># col2rgb() breaks the colour into its rgb components and /255 converts the component values to a 0-1 scale for easier manipulation</span></span>
<span>  <span class='va'>c1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/col2rgb.html'>col2rgb</a></span><span class='op'>(</span><span class='va'>col1</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>255</span></span>
<span>  <span class='va'>c2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/col2rgb.html'>col2rgb</a></span><span class='op'>(</span><span class='va'>col2</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>255</span></span>
<span><span class='co'># weighted average formula with p controlling the mix of rgb</span></span>
<span>  <span class='va'>mix</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>p</span><span class='op'>)</span> <span class='op'>*</span> <span class='va'>c1</span> <span class='op'>+</span> <span class='va'>p</span> <span class='op'>*</span> <span class='va'>c2</span></span>
<span><span class='co'># converting back to a useable colour format for plotting</span></span>
<span>  <span class='fu'>grDevices</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grDevices/rgb.html'>rgb</a></span><span class='op'>(</span><span class='va'>mix</span><span class='op'>[</span><span class='fl'>1</span>, <span class='op'>]</span>, <span class='va'>mix</span><span class='op'>[</span><span class='fl'>2</span>, <span class='op'>]</span>, <span class='va'>mix</span><span class='op'>[</span><span class='fl'>3</span>, <span class='op'>]</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span></span>
<span><span class='co'># defining a new function: making a colour darker by a specified amount</span></span>
<span><span class='va'>darken_color</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>col</span>, <span class='va'>p</span> <span class='op'>=</span> <span class='fl'>0.25</span><span class='op'>)</span> <span class='op'>{</span></span>
<span><span class='co'># p represents how much darker (e.g. 0.2 = 20% darker)</span></span>
<span><span class='co'># like above, converts to rgb and normalises to 0-1 scale</span></span>
<span>  <span class='va'>col_rgb</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/col2rgb.html'>col2rgb</a></span><span class='op'>(</span><span class='va'>col</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>255</span></span>
<span><span class='co'># darkening according to value of p</span></span>
<span>  <span class='va'>dark_rgb</span> <span class='op'>&lt;-</span> <span class='va'>col_rgb</span> <span class='op'>*</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>p</span><span class='op'>)</span></span>
<span><span class='co'># converting back to a useable colour format for plotting</span></span>
<span>  <span class='fu'>grDevices</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grDevices/rgb.html'>rgb</a></span><span class='op'>(</span><span class='va'>dark_rgb</span><span class='op'>[</span><span class='fl'>1</span>, <span class='op'>]</span>, <span class='va'>dark_rgb</span><span class='op'>[</span><span class='fl'>2</span>, <span class='op'>]</span>, <span class='va'>dark_rgb</span><span class='op'>[</span><span class='fl'>3</span>, <span class='op'>]</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span></code></pre>
</div>
</div>
<p>Creating a set of gradiated colours for each party - for each EP group that exists in the data, a colour range was generated by blending the partys assigned colour (the base colour defined in the global colour pallette) with white to create lighter tones and using the darken_color() function to make darker tones. The function colorRampPallette() was then used to create gradient pallettes with individual shades assigned to each percentage band. This process also took some trial-and-error to get gradients of colours that were suitable for the map.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># defining all possible percentage bands</span></span>
<span><span class='va'>all_bands</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>  <span class='st'>"&lt; 25"</span>,</span>
<span>  <span class='st'>"2530"</span>, <span class='st'>"3035"</span>, <span class='st'>"3540"</span>, <span class='st'>"4045"</span>, <span class='st'>"4550"</span>,</span>
<span>  <span class='st'>"50+"</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># getting all parties that appear in the data</span></span>
<span><span class='va'>all_parties</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>final_map</span><span class='op'>$</span><span class='va'>top_party</span><span class='op'>[</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>final_map</span><span class='op'>$</span><span class='va'>top_party</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># creating a complete grid of all possible combinations</span></span>
<span><span class='va'>combos</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span><span class='op'>(</span></span>
<span>  top_party <span class='op'>=</span> <span class='va'>all_parties</span>,</span>
<span><span class='co'># making it an ordered factor</span></span>
<span>  pct_band <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>all_bands</span>, levels <span class='op'>=</span> <span class='va'>all_bands</span><span class='op'>)</span>,  </span>
<span>  stringsAsFactors <span class='op'>=</span> <span class='cn'>FALSE</span></span>
<span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>top_party</span>, <span class='va'>pct_band</span><span class='op'>)</span> <span class='op'>|&gt;</span>  </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>top_party</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    idx <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/row_number.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    color <span class='op'>=</span> <span class='op'>{</span></span>
<span>      <span class='va'>base_col</span> <span class='op'>&lt;-</span> <span class='va'>custom_cols</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/nth.html'>first</a></span><span class='op'>(</span><span class='va'>top_party</span><span class='op'>)</span><span class='op'>)</span><span class='op'>]</span></span>
<span>      </span>
<span><span class='co'># creating a light version</span></span>
<span>      <span class='va'>light_col</span> <span class='op'>&lt;-</span> <span class='fu'>mix_colors</span><span class='op'>(</span><span class='st'>"#FFFFFF"</span>, <span class='va'>base_col</span>, p <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span></span>
<span>      </span>
<span><span class='co'># creating a dark version</span></span>
<span>      <span class='va'>dark_col</span> <span class='op'>&lt;-</span> <span class='fu'>darken_color</span><span class='op'>(</span><span class='va'>base_col</span>, p <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span></span>
<span>      </span>
<span><span class='co'># creating a gradient</span></span>
<span>      <span class='va'>pal</span> <span class='op'>&lt;-</span> <span class='fu'>grDevices</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>light_col</span>, <span class='va'>dark_col</span><span class='op'>)</span><span class='op'>)</span></span>
<span>      <span class='fu'>pal</span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>[</span><span class='va'>idx</span><span class='op'>]</span></span>
<span>    <span class='op'>}</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Next, the map data and the generated colours need to be linked together in the dataset. This was done using the interaction() function to combine the top_party and pct_band variables into a single identifier and creating a named colour vector.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># creating combined factors for EP groups and vote percentage bands</span></span>
<span><span class='va'>final_map</span> <span class='op'>&lt;-</span> <span class='va'>final_map</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    party_band <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/interaction.html'>interaction</a></span><span class='op'>(</span><span class='va'>top_party</span>, <span class='va'>pct_band</span>, drop <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># creating a named colour vector</span></span>
<span><span class='va'>tmp</span> <span class='op'>&lt;-</span> <span class='va'>combos</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>party_band <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/interaction.html'>interaction</a></span><span class='op'>(</span><span class='va'>top_party</span>, <span class='va'>pct_band</span>, drop <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/distinct.html'>distinct</a></span><span class='op'>(</span><span class='va'>party_band</span>, <span class='va'>color</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># creates what is essentially a "look up table" for combined factors and their relevant colour</span></span>
<span><span class='va'>fill_values</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/setNames.html'>setNames</a></span><span class='op'>(</span><span class='va'>tmp</span><span class='op'>$</span><span class='va'>color</span>, <span class='va'>tmp</span><span class='op'>$</span><span class='va'>party_band</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Finally, it was time to put it all together and plot the visual map using ggplot.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># create a "bounding box" which is the rectangular coordinates that con</span></span>
<span><span class='co'># remove cyprus from the visualisation to match original plot</span></span>
<span><span class='va'>euparl_sf</span> <span class='op'>&lt;-</span> <span class='va'>final_map</span> <span class='op'>|&gt;</span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>country</span> <span class='op'>!=</span> <span class='st'>"Cyprus"</span><span class='op'>)</span></span>
<span><span class='va'>bb</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_bbox.html'>st_bbox</a></span><span class='op'>(</span><span class='va'>euparl_sf</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># having to add extra space to the tight hand side of the map where one of the annotations will have to go later</span></span>
<span><span class='va'>extra_width</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>bb</span><span class='op'>[</span><span class='st'>"xmax"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>bb</span><span class='op'>[</span><span class='st'>"xmin"</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>0.50</span> <span class='co'>#(50% chosen arbitrarily)</span></span>
<span></span>
<span><span class='co'># creating the final map with ggplot</span></span>
<span><span class='va'>EUROMAP</span> <span class='op'>&lt;-</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>euparl_sf</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsf.html'>geom_sf</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='va'>party_band</span><span class='op'>)</span>, color <span class='op'>=</span> <span class='st'>"white"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>fill_values</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsf.html'>coord_sf</a></span><span class='op'>(</span></span>
<span>    xlim   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>bb</span><span class='op'>[</span><span class='st'>"xmin"</span><span class='op'>]</span>, <span class='va'>bb</span><span class='op'>[</span><span class='st'>"xmax"</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>extra_width</span><span class='op'>)</span>,</span>
<span>    ylim   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>bb</span><span class='op'>[</span><span class='st'>"ymin"</span><span class='op'>]</span>, <span class='va'>bb</span><span class='op'>[</span><span class='st'>"ymax"</span><span class='op'>]</span><span class='op'>)</span>,</span>
<span>    expand <span class='op'>=</span> <span class='cn'>FALSE</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_void</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>EUROMAP</span></span></code></pre>
</div>
<p><img src="100561659_files/figure-html5/unnamed-chunk-13-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<h2 id="adding-the-dotted-boxes">ADDING THE DOTTED BOXES</h2>
<p>Continuing with the main map, two dotted boxes were required around the BENELUX region and Malta to indicate that these areas are represented in a zoom annotation.</p>
<p>The BENELUX dotted box was created by extracting the required countries from the map dataset, calculating their bounding box (i.e.the minimum rectangular coordinates that contain the required countries), defining the padding wanted around the boundaries of these countries for visual effect, and defining the final coordinates of the box.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># extracting required countries</span></span>
<span><span class='va'>benelux</span> <span class='op'>&lt;-</span> <span class='va'>final_map</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>country</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Belgium"</span>, <span class='st'>"Netherlands"</span>, <span class='st'>"Luxembourg"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># defining the bounding box</span></span>
<span><span class='va'>bb</span> <span class='op'>&lt;-</span> <span class='fu'>sf</span><span class='fu'>::</span><span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_bbox.html'>st_bbox</a></span><span class='op'>(</span><span class='va'>benelux</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># defining padding through trial-and-error</span></span>
<span><span class='va'>x_pad</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>bb</span><span class='op'>[</span><span class='st'>"xmax"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>bb</span><span class='op'>[</span><span class='st'>"xmin"</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>0.07</span></span>
<span><span class='va'>y_pad</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>bb</span><span class='op'>[</span><span class='st'>"ymax"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>bb</span><span class='op'>[</span><span class='st'>"ymin"</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>0.04</span></span>
<span></span>
<span><span class='co'># defining the final coordinates of the box and storing as a data frame</span></span>
<span><span class='va'>benelux_box</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  xmin <span class='op'>=</span> <span class='va'>bb</span><span class='op'>[</span><span class='st'>"xmin"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>x_pad</span>,</span>
<span>  xmax <span class='op'>=</span> <span class='va'>bb</span><span class='op'>[</span><span class='st'>"xmax"</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>x_pad</span>,</span>
<span>  ymin <span class='op'>=</span> <span class='va'>bb</span><span class='op'>[</span><span class='st'>"ymin"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>y_pad</span>,</span>
<span>  ymax <span class='op'>=</span> <span class='va'>bb</span><span class='op'>[</span><span class='st'>"ymax"</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>y_pad</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>The same process was used to create the dotted outline for Malta.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># extracting required country</span></span>
<span><span class='va'>malta</span> <span class='op'>&lt;-</span> <span class='va'>final_map</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>country</span> <span class='op'>==</span> <span class='st'>"Malta"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># defining the bounding box</span></span>
<span><span class='va'>mb</span> <span class='op'>&lt;-</span> <span class='fu'>sf</span><span class='fu'>::</span><span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_bbox.html'>st_bbox</a></span><span class='op'>(</span><span class='va'>malta</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># defininf padding through trial and error</span></span>
<span><span class='va'>mx_pad</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>mb</span><span class='op'>[</span><span class='st'>"xmax"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>mb</span><span class='op'>[</span><span class='st'>"xmin"</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>0.6</span></span>
<span><span class='va'>my_pad</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>mb</span><span class='op'>[</span><span class='st'>"ymax"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>mb</span><span class='op'>[</span><span class='st'>"ymin"</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>0.4</span></span>
<span></span>
<span><span class='co'># defining the final coordinates of the box and storing as a data frame</span></span>
<span><span class='va'>malta_box</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  xmin <span class='op'>=</span> <span class='va'>mb</span><span class='op'>[</span><span class='st'>"xmin"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>mx_pad</span>,</span>
<span>  xmax <span class='op'>=</span> <span class='va'>mb</span><span class='op'>[</span><span class='st'>"xmax"</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>mx_pad</span>,</span>
<span>  ymin <span class='op'>=</span> <span class='va'>mb</span><span class='op'>[</span><span class='st'>"ymin"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>my_pad</span>,</span>
<span>  ymax <span class='op'>=</span> <span class='va'>mb</span><span class='op'>[</span><span class='st'>"ymax"</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>my_pad</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Following this, the background map was redrawn with the two dotted boxes applied using the geom_rect() function and defining the aesthetics of the rectangle (e.g.line style, colour, and weight). The aesthetics were adjusted manually until the boxes were visually as similar as possible to those on the original plot.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># redrawing the main map</span></span>
<span><span class='va'>EUROMAP</span> <span class='op'>&lt;-</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>final_map</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsf.html'>geom_sf</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='va'>party_band</span><span class='op'>)</span>, color <span class='op'>=</span> <span class='st'>"white"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>fill_values</span>, na.value <span class='op'>=</span> <span class='st'>"grey90"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_void</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span><span class='co'># adding the BENELUX box and defining aesthstics</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_tile.html'>geom_rect</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>benelux_box</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>xmin <span class='op'>=</span> <span class='va'>xmin</span>, xmax <span class='op'>=</span> <span class='va'>xmax</span>, ymin <span class='op'>=</span> <span class='va'>ymin</span>, ymax <span class='op'>=</span> <span class='va'>ymax</span><span class='op'>)</span>,</span>
<span>    inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    fill <span class='op'>=</span> <span class='cn'>NA</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.4</span>,</span>
<span>    linetype <span class='op'>=</span> <span class='st'>"11"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span><span class='co'># adding the Malta box and defining aesthetics</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_tile.html'>geom_rect</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>malta_box</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>xmin <span class='op'>=</span> <span class='va'>xmin</span>, xmax <span class='op'>=</span> <span class='va'>xmax</span>, ymin <span class='op'>=</span> <span class='va'>ymin</span>, ymax <span class='op'>=</span> <span class='va'>ymax</span><span class='op'>)</span>,</span>
<span>    inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    fill <span class='op'>=</span> <span class='cn'>NA</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.4</span>,</span>
<span>    linetype <span class='op'>=</span> <span class='st'>"11"</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='va'>EUROMAP</span></span></code></pre>
</div>
<p><img src="100561659_files/figure-html5/unnamed-chunk-16-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<h2 id="making-the-parliament-plots">MAKING THE PARLIAMENT PLOTS</h2>
<p>As the next stage of the project I decided to tackle the circular plots that are overlaid on the main map. These circular plots are a combination of two main elements - an inner circular parliament plot and an outer donut plot. These had to be made seperately and combined in a later stage of the project. The first part that was recreated were the parliament plots.<br />
<br />
in order to make parliament plots in R there only really two options, ggpol and ggparliament. ggpol is limited to semicircular parliament plots, whereas ggparliament has specific functionality to create the circular parliament plots needed for this project, therefore the ggparliament package was the obvious choice.</p>
<h3 id="debugging">DEBUGGING</h3>
<p>Before talking about how the parliament plots were made, it is important to discuss an alteration that was made to the package code to debug an issue that was found in the plot recreation process. Whilst making the final parliament plots, it was clear in looking at the ones that contained only a handful of seats that there were points/ seats missing from the plot. After inspecting each outputted plot manually it became clear that this was consistent across all of the plots with the number of missing seats always being the same as the number of rows of seats in the plot.<br />
<br />
After some substantial effort to find the issue, it was clear that the problem did not lie in the data or in the use of the package but rather in the code of the package itself. Inside the calc_coordinates() helper function, the position for the first and last row of seats in the plot were being defined as 0 and 360 degrees in the circle meaning that the first and last points of each row were being overlayed in the plot.</p>
<p>In order to remedy this, a small portion of the calc_coordinates() code was altered to add ghost points to each row that would take up the overlap, allowing the points that contained the actual data of the plot to remain visible. The final debugging code used to modify and overwrite the ggparliament package code was the following. (Please note, at the time of writing, this issue has been flagged to the ggparliament maintenance team but has not yet been remedied centrally so this fix still needs to be used).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>fix_calc_coordinates</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>N</span>, <span class='va'>M</span>, <span class='va'>limits</span>, <span class='va'>segment</span> <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>{</span>  </span>
<span>  <span class='va'>radii</span>  <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='va'>limits</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, <span class='va'>limits</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, length.out <span class='op'>=</span> <span class='va'>M</span><span class='op'>)</span> </span>
<span>  <span class='va'>counts</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span><span class='op'>(</span><span class='va'>M</span><span class='op'>)</span> </span>
<span>  <span class='va'>pts</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/do.call.html'>do.call</a></span><span class='op'>(</span><span class='va'>rbind</span>, <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='va'>M</span><span class='op'>)</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>i</span><span class='op'>)</span> <span class='op'>{</span>   </span>
<span>    <span class='va'>counts</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>N</span> <span class='op'>*</span> <span class='va'>radii</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>/</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>radii</span><span class='op'>[</span><span class='va'>i</span><span class='op'>:</span><span class='va'>M</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># FIX: generate one extra point then drop last when full circle</span></span>
<span>    <span class='va'>thetas</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='va'>segment</span> <span class='op'>*</span> <span class='fl'>2</span> <span class='op'>*</span> <span class='va'>pi</span>, length.out <span class='op'>=</span> <span class='va'>counts</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>segment</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>  </span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='va'>segment</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span> <span class='va'>thetas</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>thetas</span>, <span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span> </span>
<span>    </span>
<span>    <span class='va'>N</span> <span class='op'>&lt;&lt;-</span> <span class='va'>N</span> <span class='op'>-</span> <span class='va'>counts</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span></span>
<span>    </span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>      </span>
<span>      x     <span class='op'>=</span> <span class='va'>radii</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>cos</a></span><span class='op'>(</span><span class='va'>thetas</span><span class='op'>)</span>,</span>
<span>      y     <span class='op'>=</span> <span class='va'>radii</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>sin</a></span><span class='op'>(</span><span class='va'>thetas</span><span class='op'>)</span>,</span>
<span>      row   <span class='op'>=</span> <span class='va'>i</span>,</span>
<span>      theta <span class='op'>=</span> <span class='va'>thetas</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>}</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='va'>pts</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>pts</span><span class='op'>$</span><span class='va'>theta</span>, <span class='op'>-</span><span class='va'>pts</span><span class='op'>$</span><span class='va'>row</span><span class='op'>)</span>, <span class='op'>]</span>   </span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='co'># overwriting the internal function in the namespace:</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/getFromNamespace.html'>assignInNamespace</a></span><span class='op'>(</span><span class='st'>"calc_coordinates"</span>, <span class='va'>fix_calc_coordinates</span>, ns <span class='op'>=</span> <span class='st'>"ggparliament"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 id="defining-the-parliament-plot-function">DEFINING THE PARLIAMENT PLOT FUNCTION</h3>
<p>Now that the package was working as it should, the correctly-formatted parliament plots could be created. The original plot contains 27 different circular plots on top of the main map, however making 27 parliament plots manually would take a long time and require a lot of code. bearing this in mind, a function was defined to make the process quicker, more streamlined, and the output as identical as possible across all parliament plots. The function had to encompass several features including the function parameters, circle layout, boundary circle, seat point specification, order of parties, and colour specification.</p>
<p>The parliament plot making function was defined as follows:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># creating a parliament plot function</span></span>
<span><span class='co'># defining the function parameters</span></span>
<span><span class='va'>make_parl_plot</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>election_data</span>,</span>
<span>                           <span class='va'>parl_rows</span>,</span>
<span>                           <span class='va'>custom_cols</span>,</span>
<span>                           <span class='va'>circle_expand</span> <span class='op'>=</span> <span class='fl'>1.10</span>,   <span class='co'># how far beyond the outer row</span></span>
<span>                           <span class='va'>point_size</span>    <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  </span>
<span><span class='co'># creating the circle layout </span></span>
<span>  <span class='va'>circle_df</span> <span class='op'>&lt;-</span> <span class='fu'>ggparliament</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ggparliament/man/parliament_data.html'>parliament_data</a></span><span class='op'>(</span></span>
<span>    election_data <span class='op'>=</span> <span class='va'>election_data</span>,</span>
<span>    type        <span class='op'>=</span> <span class='st'>"circle"</span>,</span>
<span>    parl_rows   <span class='op'>=</span> <span class='va'>parl_rows</span>,</span>
<span>    party_seats <span class='op'>=</span> <span class='va'>election_data</span><span class='op'>$</span><span class='va'>SEATS_TOTAL</span>,</span>
<span>    plot_order  <span class='op'>=</span> <span class='va'>election_data</span><span class='op'>$</span><span class='va'>plot_order</span></span>
<span>  <span class='op'>)</span></span>
<span>  </span>
<span><span class='co'># calculating the boundary circle size using the distance form centre of the outermost seat position</span></span>
<span>  <span class='va'>r</span>      <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>circle_df</span><span class='op'>$</span><span class='va'>x</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>+</span> <span class='va'>circle_df</span><span class='op'>$</span><span class='va'>y</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='va'>r_out</span>  <span class='op'>&lt;-</span> <span class='va'>r</span> <span class='op'>*</span> <span class='va'>circle_expand</span></span>
<span>  </span>
<span><span class='co'># building the plot and defining the aesthetics</span></span>
<span><span class='co'># defining the circular "seat" points</span></span>
<span>  <span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>circle_df</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>y</span>, y <span class='op'>=</span> <span class='va'>x</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='va'>GROUP_ID</span><span class='op'>)</span>,</span>
<span>      shape  <span class='op'>=</span> <span class='fl'>21</span>,</span>
<span>      size   <span class='op'>=</span> <span class='va'>point_size</span>,</span>
<span>      colour <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>      stroke <span class='op'>=</span> <span class='fl'>0.4</span></span>
<span>    <span class='op'>)</span> <span class='op'>+</span></span>
<span><span class='co'># defining the outer boundary circle</span></span>
<span>    <span class='fu'><a href='https://ggforce.data-imaginist.com/reference/geom_circle.html'>geom_circle</a></span><span class='op'>(</span></span>
<span>      data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x0 <span class='op'>=</span> <span class='fl'>0</span>, y0 <span class='op'>=</span> <span class='fl'>0</span>, r <span class='op'>=</span> <span class='va'>r_out</span><span class='op'>)</span>,</span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x0 <span class='op'>=</span> <span class='va'>x0</span>, y0 <span class='op'>=</span> <span class='va'>y0</span>, r <span class='op'>=</span> <span class='va'>r</span><span class='op'>)</span>,</span>
<span>      inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>      colour <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>      linewidth <span class='op'>=</span> <span class='fl'>0.8</span>,</span>
<span>      fill <span class='op'>=</span> <span class='cn'>NA</span></span>
<span>    <span class='op'>)</span> <span class='op'>+</span></span>
<span><span class='co'># applying the global party colour scheme</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>custom_cols</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/pkg/ggparliament/man/theme_ggparliament.html'>theme_ggparliament</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_fixed.html'>coord_fixed</a></span><span class='op'>(</span></span>
<span>      ratio <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>      xlim  <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>r_out</span>, <span class='va'>r_out</span><span class='op'>)</span>,</span>
<span>      ylim  <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>r_out</span>, <span class='va'>r_out</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='va'>p</span></span>
<span><span class='op'>}</span></span></code></pre>
</div>
</div>
<h3 id="plotting">PLOTTING</h3>
<p>After the function was defined and tested, the 27 different parliament plots could be made relatively easily. The data for the parliament plots was taken directly from the 27 individual .csv filed downloaded from the European Parliament website.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># AUSTRIA</span></span>
<span><span class='co'># IMPORT DATA</span></span>
<span><span class='va'>at</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100561659_files/Data/at.csv"</span>, sep <span class='op'>=</span> <span class='st'>";"</span><span class='op'>)</span></span>
<span><span class='co'># CHANGING THE NAMES IN THE DATASET TO MATCH NAMES USED IN THE PLOT</span></span>
<span><span class='va'>at</span><span class='op'>$</span><span class='va'>GROUP_ID</span><span class='op'>[</span><span class='va'>at</span><span class='op'>$</span><span class='va'>GROUP_ID</span> <span class='op'>==</span> <span class='st'>"PfE"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"Patriots"</span></span>
<span><span class='co'># MAKING FACTORS</span></span>
<span><span class='va'>at</span> <span class='op'>&lt;-</span> <span class='va'>at</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># make sure GROUP_ID is a factor in your desired order</span></span>
<span>    GROUP_ID   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span>, levels <span class='op'>=</span> <span class='va'>party_order</span><span class='op'>)</span>,</span>
<span>    <span class='co'># numeric order for parliament_data()</span></span>
<span>    plot_order <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># PLOTTING THE PARLIAMENT PLOT USING THE FUNCITON</span></span>
<span><span class='va'>ATPARL</span> <span class='op'>&lt;-</span> <span class='fu'>make_parl_plot</span><span class='op'>(</span></span>
<span>  election_data <span class='op'>=</span> <span class='va'>at</span>,</span>
<span>  parl_rows     <span class='op'>=</span> <span class='fl'>2</span>,</span>
<span>  custom_cols <span class='op'>=</span> <span class='va'>custom_cols</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>ATPARL</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-19-1.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># BELGIUM </span></span>
<span><span class='co'># IMPORT DATA</span></span>
<span><span class='va'>be</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100561659_files/Data/be.csv"</span>, sep <span class='op'>=</span> <span class='st'>";"</span><span class='op'>)</span></span>
<span><span class='co'># CHANGING THE NAMES IN THE DATASET TO MATCH NAMES USED IN TH PLOT</span></span>
<span><span class='va'>be</span><span class='op'>$</span><span class='va'>GROUP_ID</span><span class='op'>[</span><span class='va'>be</span><span class='op'>$</span><span class='va'>GROUP_ID</span> <span class='op'>==</span> <span class='st'>"PfE"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"Patriots"</span></span>
<span><span class='co'># MAKING FACTORS</span></span>
<span><span class='va'>be</span> <span class='op'>&lt;-</span> <span class='va'>be</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># make sure GROUP_ID is a factor in your desired order</span></span>
<span>    GROUP_ID   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span>, levels <span class='op'>=</span> <span class='va'>party_order</span><span class='op'>)</span>,</span>
<span>    <span class='co'># numeric order for parliament_data()</span></span>
<span>    plot_order <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># PLOTTING THE PARLIAMENT PLOT USING THE FUNCITON</span></span>
<span><span class='va'>BEPARL</span> <span class='op'>&lt;-</span> <span class='fu'>make_parl_plot</span><span class='op'>(</span></span>
<span>  election_data <span class='op'>=</span> <span class='va'>be</span>,</span>
<span>  parl_rows     <span class='op'>=</span> <span class='fl'>2</span>,</span>
<span>  custom_cols <span class='op'>=</span> <span class='va'>custom_cols</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>BEPARL</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-19-2.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># BULGARIA</span></span>
<span><span class='co'># IMPORT DATA</span></span>
<span><span class='va'>bg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100561659_files/Data/bg.csv"</span>, sep <span class='op'>=</span> <span class='st'>";"</span><span class='op'>)</span></span>
<span><span class='co'># CHANGING THE NAMES IN THE DATASET TO MATCH NAMES USED IN TH PLOT</span></span>
<span><span class='va'>bg</span><span class='op'>$</span><span class='va'>GROUP_ID</span><span class='op'>[</span><span class='va'>bg</span><span class='op'>$</span><span class='va'>GROUP_ID</span> <span class='op'>==</span> <span class='st'>"PfE"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"Patriots"</span></span>
<span><span class='co'># MAKING FACTORS</span></span>
<span><span class='va'>bg</span> <span class='op'>&lt;-</span> <span class='va'>bg</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># make sure GROUP_ID is a factor in your desired order</span></span>
<span>    GROUP_ID   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span>, levels <span class='op'>=</span> <span class='va'>party_order</span><span class='op'>)</span>,</span>
<span>    <span class='co'># numeric order for parliament_data()</span></span>
<span>    plot_order <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># PLOTTING THE PARLIAMENT PLOT USING THE FUNCITON</span></span>
<span><span class='va'>BGPARL</span> <span class='op'>&lt;-</span> <span class='fu'>make_parl_plot</span><span class='op'>(</span></span>
<span>  election_data <span class='op'>=</span> <span class='va'>bg</span>,</span>
<span>  parl_rows     <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>  custom_cols <span class='op'>=</span> <span class='va'>custom_cols</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>BGPARL</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-19-3.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># CROATIA</span></span>
<span><span class='co'># IMPORT DATA</span></span>
<span><span class='va'>hr</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100561659_files/Data/hr.csv"</span>, sep <span class='op'>=</span> <span class='st'>";"</span><span class='op'>)</span></span>
<span><span class='co'># MAKING FACTORS</span></span>
<span><span class='va'>hr</span> <span class='op'>&lt;-</span> <span class='va'>hr</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># make sure GROUP_ID is a factor in your desired order</span></span>
<span>    GROUP_ID   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span>, levels <span class='op'>=</span> <span class='va'>party_order</span><span class='op'>)</span>,</span>
<span>    <span class='co'># numeric order for parliament_data()</span></span>
<span>    plot_order <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># PLOTTING THE PARLIAMENT PLOT USING THE FUNCITON</span></span>
<span><span class='va'>HRPARL</span> <span class='op'>&lt;-</span> <span class='fu'>make_parl_plot</span><span class='op'>(</span></span>
<span>  election_data <span class='op'>=</span> <span class='va'>hr</span>,</span>
<span>  parl_rows     <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>  custom_col <span class='op'>=</span> <span class='va'>custom_cols</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>HRPARL</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-19-4.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># CYPRUS</span></span>
<span><span class='co'># IMPORT DATA</span></span>
<span><span class='va'>cy</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100561659_files/Data/cy.csv"</span>, sep <span class='op'>=</span> <span class='st'>";"</span><span class='op'>)</span></span>
<span><span class='co'># MAKING FACTORS</span></span>
<span><span class='va'>cy</span> <span class='op'>&lt;-</span> <span class='va'>cy</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># make sure GROUP_ID is a factor in your desired order</span></span>
<span>    GROUP_ID   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span>, levels <span class='op'>=</span> <span class='va'>party_order</span><span class='op'>)</span>,</span>
<span>    <span class='co'># numeric order for parliament_data()</span></span>
<span>    plot_order <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># PLOTTING THE PARLIAMENT PLOT USING THE FUNCITON</span></span>
<span><span class='va'>CYPARL</span> <span class='op'>&lt;-</span> <span class='fu'>make_parl_plot</span><span class='op'>(</span></span>
<span>  election_data <span class='op'>=</span> <span class='va'>cy</span>,</span>
<span>  parl_rows     <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>  custom_cols <span class='op'>=</span> <span class='va'>custom_cols</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>CYPARL</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-19-5.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># CZECHIA</span></span>
<span><span class='co'># IMPORT DATA</span></span>
<span><span class='va'>cz</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100561659_files/Data/cz.csv"</span>, sep <span class='op'>=</span> <span class='st'>";"</span><span class='op'>)</span></span>
<span><span class='co'># CHANGING THE NAMES IN THE DATASET TO MATCH NAMES USED IN TH PLOT</span></span>
<span><span class='va'>cz</span><span class='op'>$</span><span class='va'>GROUP_ID</span><span class='op'>[</span><span class='va'>cz</span><span class='op'>$</span><span class='va'>GROUP_ID</span> <span class='op'>==</span> <span class='st'>"PfE"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"Patriots"</span></span>
<span><span class='co'># MAKING FACTORS</span></span>
<span><span class='va'>cz</span> <span class='op'>&lt;-</span> <span class='va'>cz</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># make sure GROUP_ID is a factor in your desired order</span></span>
<span>    GROUP_ID   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span>, levels <span class='op'>=</span> <span class='va'>party_order</span><span class='op'>)</span>,</span>
<span>    <span class='co'># numeric order for parliament_data()</span></span>
<span>    plot_order <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># PLOTTING THE PARLIAMENT PLOT USING THE FUNCITON</span></span>
<span><span class='va'>CZPARL</span> <span class='op'>&lt;-</span> <span class='fu'>make_parl_plot</span><span class='op'>(</span></span>
<span>  election_data <span class='op'>=</span> <span class='va'>cz</span>,</span>
<span>  parl_rows     <span class='op'>=</span> <span class='fl'>2</span>,</span>
<span>  custom_cols <span class='op'>=</span> <span class='va'>custom_cols</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>CZPARL</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-19-6.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># DENMARK</span></span>
<span><span class='co'># IMPORT DATA</span></span>
<span><span class='va'>dk</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100561659_files/Data/dk.csv"</span>, sep <span class='op'>=</span> <span class='st'>";"</span><span class='op'>)</span></span>
<span><span class='co'># CHANGING THE NAMES IN THE DATASET TO MATCH NAMES USED IN TH PLOT</span></span>
<span><span class='va'>dk</span><span class='op'>$</span><span class='va'>GROUP_ID</span><span class='op'>[</span><span class='va'>dk</span><span class='op'>$</span><span class='va'>GROUP_ID</span> <span class='op'>==</span> <span class='st'>"PfE"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"Patriots"</span></span>
<span><span class='co'># MAKING FACTORS</span></span>
<span><span class='va'>dk</span> <span class='op'>&lt;-</span> <span class='va'>dk</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># make sure GROUP_ID is a factor in your desired order</span></span>
<span>    GROUP_ID   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span>, levels <span class='op'>=</span> <span class='va'>party_order</span><span class='op'>)</span>,</span>
<span>    <span class='co'># numeric order for parliament_data()</span></span>
<span>    plot_order <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># PLOTTING THE PARLIAMENT PLOT USING THE FUNCITON</span></span>
<span><span class='va'>DKPARL</span> <span class='op'>&lt;-</span> <span class='fu'>make_parl_plot</span><span class='op'>(</span></span>
<span>  election_data <span class='op'>=</span> <span class='va'>dk</span>,</span>
<span>  parl_rows     <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>  custom_cols <span class='op'>=</span> <span class='va'>custom_cols</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>DKPARL</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-19-7.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># ESTONIA</span></span>
<span><span class='co'># IMPORT DATA</span></span>
<span><span class='va'>ee</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100561659_files/Data/ee.csv"</span>, sep <span class='op'>=</span> <span class='st'>";"</span><span class='op'>)</span></span>
<span><span class='co'># MAKING FACTORS</span></span>
<span><span class='va'>ee</span> <span class='op'>&lt;-</span> <span class='va'>ee</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># make sure GROUP_ID is a factor in your desired order</span></span>
<span>    GROUP_ID   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span>, levels <span class='op'>=</span> <span class='va'>party_order</span><span class='op'>)</span>,</span>
<span>    <span class='co'># numeric order for parliament_data()</span></span>
<span>    plot_order <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># PLOTTING THE PARLIAMENT PLOT USING THE FUNCITON</span></span>
<span><span class='va'>EEPARL</span> <span class='op'>&lt;-</span> <span class='fu'>make_parl_plot</span><span class='op'>(</span></span>
<span>  election_data <span class='op'>=</span> <span class='va'>ee</span>,</span>
<span>  parl_rows     <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>  custom_cols <span class='op'>=</span> <span class='va'>custom_cols</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>EEPARL</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-19-8.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># FINLAND</span></span>
<span><span class='co'># IMPORT DATA</span></span>
<span><span class='va'>fi</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100561659_files/Data/fi.csv"</span>, sep <span class='op'>=</span> <span class='st'>";"</span><span class='op'>)</span></span>
<span><span class='co'># MAKING FACTORS</span></span>
<span><span class='va'>fi</span> <span class='op'>&lt;-</span> <span class='va'>fi</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># make sure GROUP_ID is a factor in your desired order</span></span>
<span>    GROUP_ID   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span>, levels <span class='op'>=</span> <span class='va'>party_order</span><span class='op'>)</span>,</span>
<span>    <span class='co'># numeric order for parliament_data()</span></span>
<span>    plot_order <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># PLOTTING THE PARLIAMENT PLOT USING THE FUNCITON</span></span>
<span><span class='va'>FIPARL</span> <span class='op'>&lt;-</span> <span class='fu'>make_parl_plot</span><span class='op'>(</span></span>
<span>  election_data <span class='op'>=</span> <span class='va'>fi</span>,</span>
<span>  parl_rows     <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>  custom_cols <span class='op'>=</span> <span class='va'>custom_cols</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>FIPARL</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-19-9.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># FRANCE</span></span>
<span><span class='co'># IMPORT DATA</span></span>
<span><span class='va'>fr</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100561659_files/Data/fr.csv"</span>, sep <span class='op'>=</span> <span class='st'>";"</span><span class='op'>)</span></span>
<span><span class='co'># CHANGING THE NAMES IN THE DATASET TO MATCH NAMES USED IN TH PLOT</span></span>
<span><span class='va'>fr</span><span class='op'>$</span><span class='va'>GROUP_ID</span><span class='op'>[</span><span class='va'>fr</span><span class='op'>$</span><span class='va'>GROUP_ID</span> <span class='op'>==</span> <span class='st'>"PfE"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"Patriots"</span></span>
<span><span class='co'># MAKING FACTORS</span></span>
<span><span class='va'>fr</span> <span class='op'>&lt;-</span> <span class='va'>fr</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># make sure GROUP_ID is a factor in your desired order</span></span>
<span>    GROUP_ID   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span>, levels <span class='op'>=</span> <span class='va'>party_order</span><span class='op'>)</span>,</span>
<span>    <span class='co'># numeric order for parliament_data()</span></span>
<span>    plot_order <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># PLOTTING THE PARLIAMENT PLOT USING THE FUNCITON</span></span>
<span><span class='va'>FRPARL</span> <span class='op'>&lt;-</span> <span class='fu'>make_parl_plot</span><span class='op'>(</span></span>
<span>  election_data <span class='op'>=</span> <span class='va'>fr</span>,</span>
<span>  parl_rows     <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>  custom_cols <span class='op'>=</span> <span class='va'>custom_cols</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>FRPARL</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-19-10.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># GERMANY</span></span>
<span><span class='co'># IMPORT DATA</span></span>
<span><span class='va'>de</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100561659_files/Data/de.csv"</span>, sep <span class='op'>=</span> <span class='st'>";"</span><span class='op'>)</span></span>
<span><span class='co'># MAKING FACTORS</span></span>
<span><span class='va'>de</span> <span class='op'>&lt;-</span> <span class='va'>de</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># make sure GROUP_ID is a factor in your desired order</span></span>
<span>    GROUP_ID   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span>, levels <span class='op'>=</span> <span class='va'>party_order</span><span class='op'>)</span>,</span>
<span>    <span class='co'># numeric order for parliament_data()</span></span>
<span>    plot_order <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># PLOTTING THE PARLIAMENT PLOT USING THE FUNCITON</span></span>
<span><span class='va'>DEPARL</span> <span class='op'>&lt;-</span> <span class='fu'>make_parl_plot</span><span class='op'>(</span></span>
<span>  election_data <span class='op'>=</span> <span class='va'>de</span>,</span>
<span>  parl_rows     <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>  custom_cols <span class='op'>=</span> <span class='va'>custom_cols</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>DEPARL</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-19-11.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># GREECE</span></span>
<span><span class='co'># IMPORT DATA</span></span>
<span><span class='va'>el</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100561659_files/Data/el.csv"</span>, sep <span class='op'>=</span> <span class='st'>";"</span><span class='op'>)</span></span>
<span><span class='co'># CHANGING THE NAMES IN THE DATASET TO MATCH NAMES USED IN TH PLOT</span></span>
<span><span class='va'>el</span><span class='op'>$</span><span class='va'>GROUP_ID</span><span class='op'>[</span><span class='va'>el</span><span class='op'>$</span><span class='va'>GROUP_ID</span> <span class='op'>==</span> <span class='st'>"PfE"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"Patriots"</span></span>
<span><span class='co'># MAKING FACTORS</span></span>
<span><span class='va'>el</span> <span class='op'>&lt;-</span> <span class='va'>el</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># make sure GROUP_ID is a factor in your desired order</span></span>
<span>    GROUP_ID   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span>, levels <span class='op'>=</span> <span class='va'>party_order</span><span class='op'>)</span>,</span>
<span>    <span class='co'># numeric order for parliament_data()</span></span>
<span>    plot_order <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># PLOTTING THE PARLIAMENT PLOT USING THE FUNCITON</span></span>
<span><span class='va'>ELPARL</span> <span class='op'>&lt;-</span> <span class='fu'>make_parl_plot</span><span class='op'>(</span></span>
<span>  election_data <span class='op'>=</span> <span class='va'>el</span>,</span>
<span>  parl_rows     <span class='op'>=</span> <span class='fl'>2</span>,</span>
<span>  custom_cols <span class='op'>=</span> <span class='va'>custom_cols</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>ELPARL</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-19-12.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># HUNGARY</span></span>
<span><span class='co'># IMPORT DATA</span></span>
<span><span class='va'>hu</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100561659_files/Data/hu.csv"</span>, sep <span class='op'>=</span> <span class='st'>";"</span><span class='op'>)</span></span>
<span><span class='co'># CHANGING THE NAMES IN THE DATASET TO MATCH NAMES USED IN TH PLOT</span></span>
<span><span class='va'>hu</span><span class='op'>$</span><span class='va'>GROUP_ID</span><span class='op'>[</span><span class='va'>hu</span><span class='op'>$</span><span class='va'>GROUP_ID</span> <span class='op'>==</span> <span class='st'>"PfE"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"Patriots"</span></span>
<span><span class='co'># MAKING FACTORS</span></span>
<span><span class='va'>hu</span> <span class='op'>&lt;-</span> <span class='va'>hu</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># make sure GROUP_ID is a factor in your desired order</span></span>
<span>    GROUP_ID   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span>, levels <span class='op'>=</span> <span class='va'>party_order</span><span class='op'>)</span>,</span>
<span>    <span class='co'># numeric order for parliament_data()</span></span>
<span>    plot_order <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># PLOTTING THE PARLIAMENT PLOT USING THE FUNCITON</span></span>
<span><span class='va'>HUPARL</span> <span class='op'>&lt;-</span> <span class='fu'>make_parl_plot</span><span class='op'>(</span></span>
<span>  election_data <span class='op'>=</span> <span class='va'>hu</span>,</span>
<span>  parl_rows     <span class='op'>=</span> <span class='fl'>2</span>,</span>
<span>  custom_cols <span class='op'>=</span> <span class='va'>custom_cols</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>HUPARL</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-19-13.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># IRELAND</span></span>
<span><span class='co'># IMPORT DATA</span></span>
<span><span class='va'>ie</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100561659_files/Data/ie.csv"</span>, sep <span class='op'>=</span> <span class='st'>";"</span><span class='op'>)</span></span>
<span><span class='co'># MAKING FACTORS</span></span>
<span><span class='va'>ie</span> <span class='op'>&lt;-</span> <span class='va'>ie</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># make sure GROUP_ID is a factor in your desired order</span></span>
<span>    GROUP_ID   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span>, levels <span class='op'>=</span> <span class='va'>party_order</span><span class='op'>)</span>,</span>
<span>    <span class='co'># numeric order for parliament_data()</span></span>
<span>    plot_order <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># PLOTTING THE PARLIAMENT PLOT USING THE FUNCITON</span></span>
<span><span class='va'>IEPARL</span> <span class='op'>&lt;-</span> <span class='fu'>make_parl_plot</span><span class='op'>(</span></span>
<span>  election_data <span class='op'>=</span> <span class='va'>ie</span>,</span>
<span>  parl_rows     <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>  custom_cols <span class='op'>=</span> <span class='va'>custom_cols</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>IEPARL</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-19-14.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># ITALY</span></span>
<span><span class='co'># IMPORT DATA</span></span>
<span><span class='va'>it</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100561659_files/Data/it.csv"</span>, sep <span class='op'>=</span> <span class='st'>";"</span><span class='op'>)</span></span>
<span><span class='co'># CHANGING THE NAMES IN THE DATASET TO MATCH NAMES USED IN TH PLOT</span></span>
<span><span class='va'>it</span><span class='op'>$</span><span class='va'>GROUP_ID</span><span class='op'>[</span><span class='va'>it</span><span class='op'>$</span><span class='va'>GROUP_ID</span> <span class='op'>==</span> <span class='st'>"PfE"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"Patriots"</span></span>
<span><span class='co'># MAKING FACTORS</span></span>
<span><span class='va'>it</span> <span class='op'>&lt;-</span> <span class='va'>it</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># make sure GROUP_ID is a factor in your desired order</span></span>
<span>    GROUP_ID   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span>, levels <span class='op'>=</span> <span class='va'>party_order</span><span class='op'>)</span>,</span>
<span>    <span class='co'># numeric order for parliament_data()</span></span>
<span>    plot_order <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># PLOTTING THE PARLIAMENT PLOT USING THE FUNCITON</span></span>
<span><span class='va'>ITPARL</span> <span class='op'>&lt;-</span> <span class='fu'>make_parl_plot</span><span class='op'>(</span></span>
<span>  election_data <span class='op'>=</span> <span class='va'>it</span>,</span>
<span>  parl_rows     <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>  custom_cols <span class='op'>=</span> <span class='va'>custom_cols</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>ITPARL</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-19-15.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># LATVIA</span></span>
<span><span class='co'># IMPORT DATA</span></span>
<span><span class='va'>lv</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100561659_files/Data/lv.csv"</span>, sep <span class='op'>=</span> <span class='st'>";"</span><span class='op'>)</span></span>
<span><span class='co'># CHANGING THE NAMES IN THE DATASET TO MATCH NAMES USED IN TH PLOT</span></span>
<span><span class='va'>lv</span><span class='op'>$</span><span class='va'>GROUP_ID</span><span class='op'>[</span><span class='va'>lv</span><span class='op'>$</span><span class='va'>GROUP_ID</span> <span class='op'>==</span> <span class='st'>"PfE"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"Patriots"</span></span>
<span><span class='co'># MAKING FACTORS</span></span>
<span><span class='va'>lv</span> <span class='op'>&lt;-</span> <span class='va'>lv</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># make sure GROUP_ID is a factor in your desired order</span></span>
<span>    GROUP_ID   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span>, levels <span class='op'>=</span> <span class='va'>party_order</span><span class='op'>)</span>,</span>
<span>    <span class='co'># numeric order for parliament_data()</span></span>
<span>    plot_order <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># PLOTTING THE PARLIAMENT PLOT USING THE FUNCITON</span></span>
<span><span class='va'>LVPARL</span> <span class='op'>&lt;-</span> <span class='fu'>make_parl_plot</span><span class='op'>(</span></span>
<span>  election_data <span class='op'>=</span> <span class='va'>lv</span>,</span>
<span>  parl_rows     <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>  custom_cols <span class='op'>=</span> <span class='va'>custom_cols</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>LVPARL</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-19-16.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># LITHUANIA</span></span>
<span><span class='co'># IMPORT DATA</span></span>
<span><span class='va'>lt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100561659_files/Data/lt.csv"</span>, sep <span class='op'>=</span> <span class='st'>";"</span><span class='op'>)</span></span>
<span><span class='co'># MAKING FACTORS</span></span>
<span><span class='va'>lt</span> <span class='op'>&lt;-</span> <span class='va'>lt</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># make sure GROUP_ID is a factor in your desired order</span></span>
<span>    GROUP_ID   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span>, levels <span class='op'>=</span> <span class='va'>party_order</span><span class='op'>)</span>,</span>
<span>    <span class='co'># numeric order for parliament_data()</span></span>
<span>    plot_order <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># PLOTTING THE PARLIAMENT PLOT USING THE FUNCITON</span></span>
<span><span class='va'>LTPARL</span> <span class='op'>&lt;-</span> <span class='fu'>make_parl_plot</span><span class='op'>(</span></span>
<span>  election_data <span class='op'>=</span> <span class='va'>lt</span>,</span>
<span>  parl_rows     <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>  custom_cols <span class='op'>=</span> <span class='va'>custom_cols</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>LTPARL</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-19-17.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># LUXEMBOURG</span></span>
<span><span class='co'># IMPORT DATA</span></span>
<span><span class='va'>lu</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100561659_files/Data/lu.csv"</span>, sep <span class='op'>=</span> <span class='st'>";"</span><span class='op'>)</span></span>
<span><span class='co'># MAKING FACTORS</span></span>
<span><span class='va'>lu</span> <span class='op'>&lt;-</span> <span class='va'>lu</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># make sure GROUP_ID is a factor in your desired order</span></span>
<span>    GROUP_ID   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span>, levels <span class='op'>=</span> <span class='va'>party_order</span><span class='op'>)</span>,</span>
<span>    <span class='co'># numeric order for parliament_data()</span></span>
<span>    plot_order <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># PLOTTING THE PARLIAMENT PLOT USING THE FUNCITON</span></span>
<span><span class='va'>LUPARL</span> <span class='op'>&lt;-</span> <span class='fu'>make_parl_plot</span><span class='op'>(</span></span>
<span>  election_data <span class='op'>=</span> <span class='va'>lu</span>,</span>
<span>  parl_rows     <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>  custom_cols <span class='op'>=</span> <span class='va'>custom_cols</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>LUPARL</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-19-18.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># MALTA</span></span>
<span><span class='co'># IMPORT DATA</span></span>
<span><span class='va'>mt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100561659_files/Data/mt.csv"</span>, sep <span class='op'>=</span> <span class='st'>";"</span><span class='op'>)</span></span>
<span><span class='co'># MAKING FACTORS</span></span>
<span><span class='va'>mt</span> <span class='op'>&lt;-</span> <span class='va'>mt</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># make sure GROUP_ID is a factor in your desired order</span></span>
<span>    GROUP_ID   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span>, levels <span class='op'>=</span> <span class='va'>party_order</span><span class='op'>)</span>,</span>
<span>    <span class='co'># numeric order for parliament_data()</span></span>
<span>    plot_order <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># PLOTTING THE PARLIAMENT PLOT USING THE FUNCITON</span></span>
<span><span class='va'>MTPARL</span> <span class='op'>&lt;-</span> <span class='fu'>make_parl_plot</span><span class='op'>(</span></span>
<span>  election_data <span class='op'>=</span> <span class='va'>mt</span>,</span>
<span>  parl_rows     <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>  custom_cols <span class='op'>=</span> <span class='va'>custom_cols</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>MTPARL</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-19-19.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># NETHERLANDS</span></span>
<span><span class='co'># IMPORT DATA</span></span>
<span><span class='va'>nl</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100561659_files/Data/nl.csv"</span>, sep <span class='op'>=</span> <span class='st'>";"</span><span class='op'>)</span></span>
<span><span class='co'># CHANGING THE NAMES IN THE DATASET TO MATCH NAMES USED IN TH PLOT</span></span>
<span><span class='va'>nl</span><span class='op'>$</span><span class='va'>GROUP_ID</span><span class='op'>[</span><span class='va'>nl</span><span class='op'>$</span><span class='va'>GROUP_ID</span> <span class='op'>==</span> <span class='st'>"PfE"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"Patriots"</span></span>
<span><span class='co'># MAKING FACTORS</span></span>
<span><span class='va'>nl</span> <span class='op'>&lt;-</span> <span class='va'>nl</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># make sure GROUP_ID is a factor in your desired order</span></span>
<span>    GROUP_ID   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span>, levels <span class='op'>=</span> <span class='va'>party_order</span><span class='op'>)</span>,</span>
<span>    <span class='co'># numeric order for parliament_data()</span></span>
<span>    plot_order <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># PLOTTING THE PARLIAMENT PLOT USING THE FUNCITON</span></span>
<span><span class='va'>NLPARL</span> <span class='op'>&lt;-</span> <span class='fu'>make_parl_plot</span><span class='op'>(</span></span>
<span>  election_data <span class='op'>=</span> <span class='va'>nl</span>,</span>
<span>  parl_rows     <span class='op'>=</span> <span class='fl'>2</span>,</span>
<span>  custom_cols <span class='op'>=</span> <span class='va'>custom_cols</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>NLPARL</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-19-20.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># POLAND</span></span>
<span><span class='co'># IMPORT DATA</span></span>
<span><span class='va'>pl</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100561659_files/Data/pl.csv"</span>, sep <span class='op'>=</span> <span class='st'>";"</span><span class='op'>)</span></span>
<span><span class='co'># MAKING FACTORS</span></span>
<span><span class='va'>pl</span> <span class='op'>&lt;-</span> <span class='va'>pl</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># make sure GROUP_ID is a factor in your desired order</span></span>
<span>    GROUP_ID   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span>, levels <span class='op'>=</span> <span class='va'>party_order</span><span class='op'>)</span>,</span>
<span>    <span class='co'># numeric order for parliament_data()</span></span>
<span>    plot_order <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># PLOTTING THE PARLIAMENT PLOT USING THE FUNCITON</span></span>
<span><span class='va'>PLPARL</span> <span class='op'>&lt;-</span> <span class='fu'>make_parl_plot</span><span class='op'>(</span></span>
<span>  election_data <span class='op'>=</span> <span class='va'>pl</span>,</span>
<span>  parl_rows     <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>  custom_cols <span class='op'>=</span> <span class='va'>custom_cols</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>PLPARL</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-19-21.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># PORTUGAL</span></span>
<span><span class='co'># IMPORT DATA</span></span>
<span><span class='va'>pt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100561659_files/Data/pt.csv"</span>, sep <span class='op'>=</span> <span class='st'>";"</span><span class='op'>)</span></span>
<span><span class='co'># CHANGING THE NAMES IN THE DATASET TO MATCH NAMES USED IN TH PLOT</span></span>
<span><span class='va'>pt</span><span class='op'>$</span><span class='va'>GROUP_ID</span><span class='op'>[</span><span class='va'>pt</span><span class='op'>$</span><span class='va'>GROUP_ID</span> <span class='op'>==</span> <span class='st'>"PfE"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"Patriots"</span></span>
<span><span class='co'># MAKING FACTORS</span></span>
<span><span class='va'>pt</span> <span class='op'>&lt;-</span> <span class='va'>pt</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># make sure GROUP_ID is a factor in your desired order</span></span>
<span>    GROUP_ID   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span>, levels <span class='op'>=</span> <span class='va'>party_order</span><span class='op'>)</span>,</span>
<span>    <span class='co'># numeric order for parliament_data()</span></span>
<span>    plot_order <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># PLOTTING THE PARLIAMENT PLOT USING THE FUNCITON</span></span>
<span><span class='va'>PTPARL</span> <span class='op'>&lt;-</span> <span class='fu'>make_parl_plot</span><span class='op'>(</span></span>
<span>  election_data <span class='op'>=</span> <span class='va'>pt</span>,</span>
<span>  parl_rows     <span class='op'>=</span> <span class='fl'>2</span>,</span>
<span>  custom_cols <span class='op'>=</span> <span class='va'>custom_cols</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>PTPARL</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-19-22.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># ROMANIA</span></span>
<span><span class='co'># IMPORT DATA</span></span>
<span><span class='va'>ro</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100561659_files/Data/ro.csv"</span>, sep <span class='op'>=</span> <span class='st'>";"</span><span class='op'>)</span></span>
<span><span class='co'># MAKING FACTORS</span></span>
<span><span class='va'>ro</span> <span class='op'>&lt;-</span> <span class='va'>ro</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># make sure GROUP_ID is a factor in your desired order</span></span>
<span>    GROUP_ID   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span>, levels <span class='op'>=</span> <span class='va'>party_order</span><span class='op'>)</span>,</span>
<span>    <span class='co'># numeric order for parliament_data()</span></span>
<span>    plot_order <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># PLOTTING THE PARLIAMENT PLOT USING THE FUNCITON</span></span>
<span><span class='va'>ROPARL</span> <span class='op'>&lt;-</span> <span class='fu'>make_parl_plot</span><span class='op'>(</span></span>
<span>  election_data <span class='op'>=</span> <span class='va'>ro</span>,</span>
<span>  parl_rows     <span class='op'>=</span> <span class='fl'>2</span>,</span>
<span>  custom_cols <span class='op'>=</span> <span class='va'>custom_cols</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>ROPARL</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-19-23.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># SLOVAKIA</span></span>
<span><span class='co'># IMPORT DATA</span></span>
<span><span class='va'>sk</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100561659_files/Data/sk.csv"</span>, sep <span class='op'>=</span> <span class='st'>";"</span><span class='op'>)</span></span>
<span><span class='co'># MAKING FACTORS</span></span>
<span><span class='va'>sk</span> <span class='op'>&lt;-</span> <span class='va'>sk</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># make sure GROUP_ID is a factor in your desired order</span></span>
<span>    GROUP_ID   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span>, levels <span class='op'>=</span> <span class='va'>party_order</span><span class='op'>)</span>,</span>
<span>    <span class='co'># numeric order for parliament_data()</span></span>
<span>    plot_order <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># PLOTTING THE PARLIAMENT PLOT USING THE FUNCITON</span></span>
<span><span class='va'>SKPARL</span> <span class='op'>&lt;-</span> <span class='fu'>make_parl_plot</span><span class='op'>(</span></span>
<span>  election_data <span class='op'>=</span> <span class='va'>sk</span>,</span>
<span>  parl_rows     <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>  custom_cols <span class='op'>=</span> <span class='va'>custom_cols</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>SKPARL</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-19-24.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># SLOVENIA</span></span>
<span><span class='co'># IMPORT DATA</span></span>
<span><span class='va'>si</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100561659_files/Data/si.csv"</span>, sep <span class='op'>=</span> <span class='st'>";"</span><span class='op'>)</span></span>
<span><span class='co'># MAKING FACTORS</span></span>
<span><span class='va'>si</span> <span class='op'>&lt;-</span> <span class='va'>si</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># make sure GROUP_ID is a factor in your desired order</span></span>
<span>    GROUP_ID   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span>, levels <span class='op'>=</span> <span class='va'>party_order</span><span class='op'>)</span>,</span>
<span>    <span class='co'># numeric order for parliament_data()</span></span>
<span>    plot_order <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># PLOTTING THE PARLIAMENT PLOT USING THE FUNCITON</span></span>
<span><span class='va'>SIPARL</span> <span class='op'>&lt;-</span> <span class='fu'>make_parl_plot</span><span class='op'>(</span></span>
<span>  election_data <span class='op'>=</span> <span class='va'>si</span>,</span>
<span>  parl_rows     <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>  custom_cols <span class='op'>=</span> <span class='va'>custom_cols</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>SIPARL</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-19-25.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># SPAIN</span></span>
<span><span class='co'># IMPORT DATA</span></span>
<span><span class='va'>es</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100561659_files/Data/es.csv"</span>, sep <span class='op'>=</span> <span class='st'>";"</span><span class='op'>)</span></span>
<span><span class='co'># CHANGING THE NAMES IN THE DATASET TO MATCH NAMES USED IN TH PLOT</span></span>
<span><span class='va'>es</span><span class='op'>$</span><span class='va'>GROUP_ID</span><span class='op'>[</span><span class='va'>es</span><span class='op'>$</span><span class='va'>GROUP_ID</span> <span class='op'>==</span> <span class='st'>"PfE"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"Patriots"</span></span>
<span><span class='co'># MAKING FACTORS</span></span>
<span><span class='va'>es</span> <span class='op'>&lt;-</span> <span class='va'>es</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># make sure GROUP_ID is a factor in your desired order</span></span>
<span>    GROUP_ID   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span>, levels <span class='op'>=</span> <span class='va'>party_order</span><span class='op'>)</span>,</span>
<span>    <span class='co'># numeric order for parliament_data()</span></span>
<span>    plot_order <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># PLOTTING THE PARLIAMENT PLOT USING THE FUNCITON</span></span>
<span><span class='va'>ESPARL</span> <span class='op'>&lt;-</span> <span class='fu'>make_parl_plot</span><span class='op'>(</span></span>
<span>  election_data <span class='op'>=</span> <span class='va'>es</span>,</span>
<span>  parl_rows     <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>  custom_cols <span class='op'>=</span> <span class='va'>custom_cols</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>ESPARL</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-19-26.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># SWEDEN</span></span>
<span><span class='co'># IMPORT DATA</span></span>
<span><span class='va'>se</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"100561659_files/Data/se.csv"</span>, sep <span class='op'>=</span> <span class='st'>";"</span><span class='op'>)</span></span>
<span><span class='co'># MAKING FACTORS</span></span>
<span><span class='va'>se</span> <span class='op'>&lt;-</span> <span class='va'>se</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    <span class='co'># make sure GROUP_ID is a factor in your desired order</span></span>
<span>    GROUP_ID   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span>, levels <span class='op'>=</span> <span class='va'>party_order</span><span class='op'>)</span>,</span>
<span>    <span class='co'># numeric order for parliament_data()</span></span>
<span>    plot_order <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>GROUP_ID</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># PLOTTING THE PARLIAMENT PLOT USING THE FUNCITON</span></span>
<span><span class='va'>SEPARL</span> <span class='op'>&lt;-</span> <span class='fu'>make_parl_plot</span><span class='op'>(</span></span>
<span>  election_data <span class='op'>=</span> <span class='va'>se</span>,</span>
<span>  parl_rows     <span class='op'>=</span> <span class='fl'>2</span>,</span>
<span>  custom_cols <span class='op'>=</span> <span class='va'>custom_cols</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>SEPARL</span></span></code></pre>
</div>
<p><img src="100561659_files/figure-html5/unnamed-chunk-19-27.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<h2 id="making-the-donut-plots">MAKING THE DONUT PLOTS</h2>
<p>After successfully making the parliament plots for each country, the next stage was to make the donut plots that surround the parliament plots in the original plot. There is no function to explicitly make donut plots in ggplot, however using a single stacked bar chart bent into a circle (as is used to make a pie chart) using polar coordinates appears to be the agreed-upon solution in the R community. There are some specialised packages like donutsk that have been developed to make donut plots, however after experimenting with this package and ggplot it was decided that for the basic, non-annotated donuts required for this project that the bent-bar-plot approach using ggplot was best suited.</p>
<h3 id="data-recreation">DATA RECREATION</h3>
<p>As discussed earlier, the data required to create the donut plots had to be manually calculated and the datasets constructed in R.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># AUSTRIA</span></span>
<span><span class='va'>don_at</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"EPP"</span>, <span class='st'>"SD"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"ECR"</span>, <span class='st'>"Renew"</span>, <span class='st'>"GREENSEFA"</span>, <span class='st'>"Theleft"</span>, <span class='st'>"ESN"</span>, <span class='st'>"NI"</span>, <span class='st'>"Independent"</span><span class='op'>)</span>,</span>
<span>  vote_proportion <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>24.52</span>, <span class='fl'>23.22</span>, <span class='fl'>25.36</span>, <span class='fl'>0.00</span>, <span class='fl'>10.14</span>, <span class='fl'>11.08</span>, <span class='fl'>2.96</span>, <span class='fl'>0.00</span>, <span class='fl'>0.00</span>, <span class='fl'>2.72</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># check that total proportion = 100</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>don_at</span><span class='op'>$</span><span class='va'>vote_proportion</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 100</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># BELGIUM</span></span>
<span><span class='va'>don_be</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"EPP"</span>, <span class='st'>"SD"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"ECR"</span>, <span class='st'>"Renew"</span>, <span class='st'>"GREENSEFA"</span>, <span class='st'>"Theleft"</span>, <span class='st'>"ESN"</span>, <span class='st'>"NI"</span>, <span class='st'>"Independent"</span><span class='op'>)</span>,</span>
<span>  vote_proportion <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>16.04</span>, <span class='fl'>14.99</span>, <span class='fl'>7.65</span>, <span class='fl'>7.36</span>, <span class='fl'>28.3</span>, <span class='fl'>10.39</span>, <span class='fl'>7.8</span>, <span class='fl'>0.00</span>, <span class='fl'>0.00</span>, <span class='fl'>7.47</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># check that total proportion = 100</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>don_be</span><span class='op'>$</span><span class='va'>vote_proportion</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 100</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># BULGARIA</span></span>
<span><span class='va'>don_bg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"EPP"</span>, <span class='st'>"SD"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"ECR"</span>, <span class='st'>"Renew"</span>, <span class='st'>"GREENSEFA"</span>, <span class='st'>"Theleft"</span>, <span class='st'>"ESN"</span>, <span class='st'>"NI"</span>, <span class='st'>"Independent"</span><span class='op'>)</span>,</span>
<span>  vote_proportion <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>24.79</span>, <span class='fl'>7.01</span>, <span class='fl'>0.00</span>, <span class='fl'>8.13</span>, <span class='fl'>29.11</span>, <span class='fl'>1.26</span>, <span class='fl'>1.23</span>, <span class='fl'>13.98</span>, <span class='fl'>0.00</span>, <span class='fl'>14.49</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># check that total proportion = 100</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>don_bg</span><span class='op'>$</span><span class='va'>vote_proportion</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 100</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># CROATIA</span></span>
<span><span class='va'>don_hr</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"EPP"</span>, <span class='st'>"SD"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"ECR"</span>, <span class='st'>"Renew"</span>, <span class='st'>"GREENSEFA"</span>, <span class='st'>"Theleft"</span>, <span class='st'>"ESN"</span>, <span class='st'>"NI"</span>, <span class='st'>"Independent"</span><span class='op'>)</span>,</span>
<span>  vote_proportion <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>35.83</span>, <span class='fl'>25.62</span>, <span class='fl'>0.00</span>, <span class='fl'>12.85</span>, <span class='fl'>5.69</span>, <span class='fl'>6.15</span>, <span class='fl'>0.63</span>, <span class='fl'>0.00</span>, <span class='fl'>2.98</span>, <span class='fl'>10.25</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># check that total proportion = 100</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>don_hr</span><span class='op'>$</span><span class='va'>vote_proportion</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 100</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># CYPRUS</span></span>
<span><span class='va'>don_cy</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"EPP"</span>, <span class='st'>"SD"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"ECR"</span>, <span class='st'>"Renew"</span>, <span class='st'>"GREENSEFA"</span>, <span class='st'>"Theleft"</span>, <span class='st'>"ESN"</span>, <span class='st'>"NI"</span>, <span class='st'>"Independent"</span><span class='op'>)</span>,</span>
<span>  vote_proportion <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>24.78</span>, <span class='fl'>14.79</span>, <span class='fl'>0.00</span>, <span class='fl'>2.17</span>, <span class='fl'>11.19</span>, <span class='fl'>4.21</span>, <span class='fl'>21.49</span>, <span class='fl'>0.00</span>, <span class='fl'>19.36</span>, <span class='fl'>2.01</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># check that total proportion = 100</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>don_cy</span><span class='op'>$</span><span class='va'>vote_proportion</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 100</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># CZECHIA</span></span>
<span><span class='va'>don_cz</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"EPP"</span>, <span class='st'>"SD"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"ECR"</span>, <span class='st'>"Renew"</span>, <span class='st'>"GREENSEFA"</span>, <span class='st'>"Theleft"</span>, <span class='st'>"ESN"</span>, <span class='st'>"NI"</span>, <span class='st'>"Independent"</span><span class='op'>)</span>,</span>
<span>  vote_proportion <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>19.84</span>, <span class='fl'>1.86</span>, <span class='fl'>36.9</span>, <span class='fl'>11.13</span>, <span class='fl'>0.21</span>, <span class='fl'>8.09</span>, <span class='fl'>0.00</span>, <span class='fl'>7.88</span>, <span class='fl'>9.56</span>, <span class='fl'>4.53</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># check that total proportion = 100</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>don_cz</span><span class='op'>$</span><span class='va'>vote_proportion</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 100</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># DENMARK</span></span>
<span><span class='va'>don_dk</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"EPP"</span>, <span class='st'>"SD"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"ECR"</span>, <span class='st'>"Renew"</span>, <span class='st'>"GREENSEFA"</span>, <span class='st'>"Theleft"</span>, <span class='st'>"ESN"</span>, <span class='st'>"NI"</span>, <span class='st'>"Independent"</span><span class='op'>)</span>,</span>
<span>  vote_proportion <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>15.79</span>, <span class='fl'>15.57</span>, <span class='fl'>6.37</span>, <span class='fl'>27.75</span>, <span class='fl'>7.39</span>, <span class='fl'>20.08</span>, <span class='fl'>7.05</span>, <span class='fl'>0.00</span>, <span class='fl'>0.00</span>, <span class='fl'>0.00</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># check that total proportion = 100</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>don_dk</span><span class='op'>$</span><span class='va'>vote_proportion</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 100</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># ESTONIA</span></span>
<span><span class='va'>don_ee</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"EPP"</span>, <span class='st'>"SD"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"ECR"</span>, <span class='st'>"Renew"</span>, <span class='st'>"GREENSEFA"</span>, <span class='st'>"Theleft"</span>, <span class='st'>"ESN"</span>, <span class='st'>"NI"</span>, <span class='st'>"Independent"</span><span class='op'>)</span>,</span>
<span>  vote_proportion <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>21.51</span>, <span class='fl'>19.33</span>, <span class='fl'>14.86</span>, <span class='fl'>6.22</span>, <span class='fl'>24.14</span>, <span class='fl'>0.61</span>, <span class='fl'>0.00</span>, <span class='fl'>0.00</span>, <span class='fl'>0.00</span>, <span class='fl'>13.33</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># check that total proportion = 100</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>don_ee</span><span class='op'>$</span><span class='va'>vote_proportion</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 100</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># FINLAND</span></span>
<span><span class='va'>don_fi</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"EPP"</span>, <span class='st'>"SD"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"ECR"</span>, <span class='st'>"Renew"</span>, <span class='st'>"GREENSEFA"</span>, <span class='st'>"Theleft"</span>, <span class='st'>"ESN"</span>, <span class='st'>"NI"</span>, <span class='st'>"Independent"</span><span class='op'>)</span>,</span>
<span>  vote_proportion <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>28.92</span>, <span class='fl'>14.87</span>, <span class='fl'>0.00</span>, <span class='fl'>17.90</span>, <span class='fl'>7.61</span>, <span class='fl'>11.28</span>, <span class='fl'>17.47</span>, <span class='fl'>0.00</span>, <span class='fl'>0.00</span>, <span class='fl'>1.95</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># check that total proportion = 100</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>don_fi</span><span class='op'>$</span><span class='va'>vote_proportion</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 100</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># FRANCE</span></span>
<span><span class='va'>don_fr</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"EPP"</span>, <span class='st'>"SD"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"ECR"</span>, <span class='st'>"Renew"</span>, <span class='st'>"GREENSEFA"</span>, <span class='st'>"Theleft"</span>, <span class='st'>"ESN"</span>, <span class='st'>"NI"</span>, <span class='st'>"Independent"</span><span class='op'>)</span>,</span>
<span>  vote_proportion <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>7.25</span>, <span class='fl'>13.88</span>, <span class='fl'>31.37</span>, <span class='fl'>0.00</span>, <span class='fl'>15.02</span>, <span class='fl'>5.76</span>, <span class='fl'>14.40</span>, <span class='fl'>5.47</span>, <span class='fl'>0.00</span>, <span class='fl'>6.85</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># check that total proportion = 100</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>don_fr</span><span class='op'>$</span><span class='va'>vote_proportion</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 100</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># GERMANY</span></span>
<span><span class='va'>don_de</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"EPP"</span>, <span class='st'>"SD"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"ECR"</span>, <span class='st'>"Renew"</span>, <span class='st'>"GREENSEFA"</span>, <span class='st'>"Theleft"</span>, <span class='st'>"ESN"</span>, <span class='st'>"NI"</span>, <span class='st'>"Independent"</span><span class='op'>)</span>,</span>
<span>  vote_proportion <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>31.28</span>, <span class='fl'>13.94</span>, <span class='fl'>0.00</span>, <span class='fl'>0.41</span>, <span class='fl'>7.85</span>, <span class='fl'>14.94</span>, <span class='fl'>4.17</span>, <span class='fl'>15.89</span>, <span class='fl'>8.12</span>, <span class='fl'>3.40</span> <span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># check that total proportion = 100</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>don_de</span><span class='op'>$</span><span class='va'>vote_proportion</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 100</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># GREECE</span></span>
<span><span class='va'>don_el</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"EPP"</span>, <span class='st'>"SD"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"ECR"</span>, <span class='st'>"Renew"</span>, <span class='st'>"GREENSEFA"</span>, <span class='st'>"Theleft"</span>, <span class='st'>"ESN"</span>, <span class='st'>"NI"</span>, <span class='st'>"Independent"</span><span class='op'>)</span>,</span>
<span>  vote_proportion <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>28.31</span>, <span class='fl'>12.79</span>, <span class='fl'>3.04</span>, <span class='fl'>9.30</span>, <span class='fl'>1.45</span>, <span class='fl'>1.80</span>, <span class='fl'>17.46</span>, <span class='fl'>0.52</span>, <span class='fl'>17.02</span>, <span class='fl'>8.31</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># check that total proportion = 100</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>don_el</span><span class='op'>$</span><span class='va'>vote_proportion</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 100</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># HUNGARY</span></span>
<span><span class='va'>don_hu</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"EPP"</span>, <span class='st'>"SD"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"ECR"</span>, <span class='st'>"Renew"</span>, <span class='st'>"GREENSEFA"</span>, <span class='st'>"Theleft"</span>, <span class='st'>"ESN"</span>, <span class='st'>"NI"</span>, <span class='st'>"Independent"</span><span class='op'>)</span>,</span>
<span>  vote_proportion <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>30.59</span>, <span class='fl'>8.03</span>, <span class='fl'>44.82</span>, <span class='fl'>0.00</span>, <span class='fl'>4.34</span>, <span class='fl'>4.46</span>, <span class='fl'>0.00</span>, <span class='fl'>6.71</span>, <span class='fl'>0.00</span>, <span class='fl'>1.05</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># check that total proportion = 100</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>don_hu</span><span class='op'>$</span><span class='va'>vote_proportion</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 100</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># IRELAND</span></span>
<span><span class='va'>don_ie</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"EPP"</span>, <span class='st'>"SD"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"ECR"</span>, <span class='st'>"Renew"</span>, <span class='st'>"GREENSEFA"</span>, <span class='st'>"Theleft"</span>, <span class='st'>"ESN"</span>, <span class='st'>"NI"</span>, <span class='st'>"Independent"</span><span class='op'>)</span>,</span>
<span>  vote_proportion <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>20.79</span>, <span class='fl'>6.33</span>, <span class='fl'>0.00</span>, <span class='fl'>0.00</span>, <span class='fl'>26.67</span>, <span class='fl'>5.36</span>, <span class='fl'>19.46</span>, <span class='fl'>0.00</span>, <span class='fl'>0.00</span>, <span class='fl'>21.39</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># check that total proportion = 100</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>don_ie</span><span class='op'>$</span><span class='va'>vote_proportion</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 100</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># ITALY</span></span>
<span><span class='va'>don_it</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"EPP"</span>, <span class='st'>"SD"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"ECR"</span>, <span class='st'>"Renew"</span>, <span class='st'>"GREENSEFA"</span>, <span class='st'>"Theleft"</span>, <span class='st'>"ESN"</span>, <span class='st'>"NI"</span>, <span class='st'>"Independent"</span><span class='op'>)</span>,</span>
<span>  vote_proportion <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10.50</span>, <span class='fl'>24.11</span>, <span class='fl'>8.97</span>, <span class='fl'>28.76</span>, <span class='fl'>7.13</span>, <span class='fl'>6.78</span>, <span class='fl'>10.11</span>, <span class='fl'>0.00</span>, <span class='fl'>0.00</span>, <span class='fl'>3.64</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># check that total proportion = 100</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>don_it</span><span class='op'>$</span><span class='va'>vote_proportion</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 100</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># LATVIA</span></span>
<span><span class='va'>don_lv</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"EPP"</span>, <span class='st'>"SD"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"ECR"</span>, <span class='st'>"Renew"</span>, <span class='st'>"GREENSEFA"</span>, <span class='st'>"Theleft"</span>, <span class='st'>"ESN"</span>, <span class='st'>"NI"</span>, <span class='st'>"Independent"</span><span class='op'>)</span>,</span>
<span>  vote_proportion <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25.37</span>, <span class='fl'>7.21</span>, <span class='fl'>6.23</span>, <span class='fl'>33.24</span>, <span class='fl'>9.46</span>, <span class='fl'>7.53</span>, <span class='fl'>0.00</span>, <span class='fl'>0.00</span>, <span class='fl'>0.00</span>, <span class='fl'>10.96</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># check that total proportion = 100</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>don_lv</span><span class='op'>$</span><span class='va'>vote_proportion</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 100</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># LITHUANIA</span></span>
<span><span class='va'>don_lt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"EPP"</span>, <span class='st'>"SD"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"ECR"</span>, <span class='st'>"Renew"</span>, <span class='st'>"GREENSEFA"</span>, <span class='st'>"Theleft"</span>, <span class='st'>"ESN"</span>, <span class='st'>"NI"</span>, <span class='st'>"Independent"</span><span class='op'>)</span>,</span>
<span>  vote_proportion <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>22.70</span>, <span class='fl'>17.98</span>, <span class='fl'>0.00</span>, <span class='fl'>18.40</span>, <span class='fl'>13.52</span>, <span class='fl'>5.95</span>, <span class='fl'>0.00</span>, <span class='fl'>5.45</span>, <span class='fl'>0.00</span>, <span class='fl'>16.00</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># check that total proportion = 100</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>don_lt</span><span class='op'>$</span><span class='va'>vote_proportion</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 100</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># LUXEMBOURG</span></span>
<span><span class='va'>don_lu</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"EPP"</span>, <span class='st'>"SD"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"ECR"</span>, <span class='st'>"Renew"</span>, <span class='st'>"GREENSEFA"</span>, <span class='st'>"Theleft"</span>, <span class='st'>"ESN"</span>, <span class='st'>"NI"</span>, <span class='st'>"Independent"</span><span class='op'>)</span>,</span>
<span>  vote_proportion <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>22.91</span>, <span class='fl'>21.72</span>, <span class='fl'>0.00</span>, <span class='fl'>11.76</span>, <span class='fl'>18.29</span>, <span class='fl'>17.72</span>, <span class='fl'>3.15</span>, <span class='fl'>0.00</span>, <span class='fl'>0.00</span>, <span class='fl'>4.45</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># check that total proportion = 100</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>don_lu</span><span class='op'>$</span><span class='va'>vote_proportion</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 100</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># MALTA</span></span>
<span><span class='va'>don_mt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"EPP"</span>, <span class='st'>"SD"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"ECR"</span>, <span class='st'>"Renew"</span>, <span class='st'>"GREENSEFA"</span>, <span class='st'>"Theleft"</span>, <span class='st'>"ESN"</span>, <span class='st'>"NI"</span>, <span class='st'>"Independent"</span><span class='op'>)</span>,</span>
<span>  vote_proportion <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>42.22</span>, <span class='fl'>45.26</span>, <span class='fl'>0.00</span>, <span class='fl'>0.00</span>, <span class='fl'>0.00</span>, <span class='fl'>1.3</span>, <span class='fl'>0.00</span>, <span class='fl'>0.00</span>, <span class='fl'>0.00</span>, <span class='fl'>11.22</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># check that total proportion = 100</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>don_mt</span><span class='op'>$</span><span class='va'>vote_proportion</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 100</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># NETHERLANDS</span></span>
<span><span class='va'>don_nl</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"EPP"</span>, <span class='st'>"SD"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"ECR"</span>, <span class='st'>"Renew"</span>, <span class='st'>"GREENSEFA"</span>, <span class='st'>"Theleft"</span>, <span class='st'>"ESN"</span>, <span class='st'>"NI"</span>, <span class='st'>"Independent"</span><span class='op'>)</span>,</span>
<span>  vote_proportion <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>18.61</span>, <span class='fl'>11.00</span>, <span class='fl'>16.97</span>, <span class='fl'>3.84</span>, <span class='fl'>20.87</span>, <span class='fl'>16.39</span>, <span class='fl'>6.72</span>, <span class='fl'>2.49</span>, <span class='fl'>0.00</span>, <span class='fl'>3.11</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># check that total proportion = 100</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>don_nl</span><span class='op'>$</span><span class='va'>vote_proportion</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 100</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># POLAND</span></span>
<span><span class='va'>don_pl</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"EPP"</span>, <span class='st'>"SD"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"ECR"</span>, <span class='st'>"Renew"</span>, <span class='st'>"GREENSEFA"</span>, <span class='st'>"Theleft"</span>, <span class='st'>"ESN"</span>, <span class='st'>"NI"</span>, <span class='st'>"Independent"</span><span class='op'>)</span>,</span>
<span>  vote_proportion <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>40.18</span>, <span class='fl'>3.90</span>, <span class='fl'>2.79</span>, <span class='fl'>36.16</span>, <span class='fl'>2.60</span>, <span class='fl'>0.00</span>, <span class='fl'>0.00</span>, <span class='fl'>3.19</span>, <span class='fl'>3.50</span>, <span class='fl'>7.68</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># check that total proportion = 100</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>don_pl</span><span class='op'>$</span><span class='va'>vote_proportion</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 100</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># PORTUGAL</span></span>
<span><span class='va'>don_pt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"EPP"</span>, <span class='st'>"SD"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"ECR"</span>, <span class='st'>"Renew"</span>, <span class='st'>"GREENSEFA"</span>, <span class='st'>"Theleft"</span>, <span class='st'>"ESN"</span>, <span class='st'>"NI"</span>, <span class='st'>"Independent"</span><span class='op'>)</span>,</span>
<span>  vote_proportion <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>31.12</span>, <span class='fl'>32.11</span>, <span class='fl'>9.79</span>, <span class='fl'>0.00</span>, <span class='fl'>9.08</span>, <span class='fl'>5.18</span>, <span class='fl'>10.56</span>, <span class='fl'>0.00</span>, <span class='fl'>0.00</span>, <span class='fl'>2.16</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># check that total proportion = 100</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>don_pt</span><span class='op'>$</span><span class='va'>vote_proportion</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 100</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># ROMANIA</span></span>
<span><span class='va'>don_ro</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"EPP"</span>, <span class='st'>"SD"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"ECR"</span>, <span class='st'>"Renew"</span>, <span class='st'>"GREENSEFA"</span>, <span class='st'>"Theleft"</span>, <span class='st'>"ESN"</span>, <span class='st'>"NI"</span>, <span class='st'>"Independent"</span><span class='op'>)</span>,</span>
<span>  vote_proportion <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>30.76</span>, <span class='fl'>25.75</span>, <span class='fl'>0.00</span>, <span class='fl'>15.38</span>, <span class='fl'>12.45</span>, <span class='fl'>0.00</span>, <span class='fl'>0.42</span>, <span class='fl'>0.00</span>, <span class='fl'>5.03</span>, <span class='fl'>10.21</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># check that total proportion = 100</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>don_ro</span><span class='op'>$</span><span class='va'>vote_proportion</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 100</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># SLOVAKIA</span></span>
<span><span class='va'>don_sk</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"EPP"</span>, <span class='st'>"SD"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"ECR"</span>, <span class='st'>"Renew"</span>, <span class='st'>"GREENSEFA"</span>, <span class='st'>"Theleft"</span>, <span class='st'>"ESN"</span>, <span class='st'>"NI"</span>, <span class='st'>"Independent"</span><span class='op'>)</span>,</span>
<span>  vote_proportion <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>17.74</span>, <span class='fl'>0.00</span>, <span class='fl'>0.00</span>, <span class='fl'>5.55</span>, <span class='fl'>27.82</span>, <span class='fl'>0.13</span>, <span class='fl'>0.00</span>, <span class='fl'>12.53</span>, <span class='fl'>32.43</span>, <span class='fl'>3.8</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># check that total proportion = 100</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>don_sk</span><span class='op'>$</span><span class='va'>vote_proportion</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 100</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># SLOVENIA</span></span>
<span><span class='va'>don_si</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"EPP"</span>, <span class='st'>"SD"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"ECR"</span>, <span class='st'>"Renew"</span>, <span class='st'>"GREENSEFA"</span>, <span class='st'>"Theleft"</span>, <span class='st'>"ESN"</span>, <span class='st'>"NI"</span>, <span class='st'>"Independent"</span><span class='op'>)</span>,</span>
<span>  vote_proportion <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>45.41</span>, <span class='fl'>7.77</span>, <span class='fl'>0.00</span>, <span class='fl'>0.00</span>, <span class='fl'>24.35</span>, <span class='fl'>12.15</span>, <span class='fl'>4.81</span>, <span class='fl'>0.00</span>, <span class='fl'>0.00</span>, <span class='fl'>5.51</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># check that total proportion = 100</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>don_si</span><span class='op'>$</span><span class='va'>vote_proportion</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 100</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># SPAIN</span></span>
<span><span class='va'>don_es</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"EPP"</span>, <span class='st'>"SD"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"ECR"</span>, <span class='st'>"Renew"</span>, <span class='st'>"GREENSEFA"</span>, <span class='st'>"Theleft"</span>, <span class='st'>"ESN"</span>, <span class='st'>"NI"</span>, <span class='st'>"Independent"</span><span class='op'>)</span>,</span>
<span>  vote_proportion <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>34.21</span>, <span class='fl'>30.19</span>, <span class='fl'>9.63</span>, <span class='fl'>4.58</span>, <span class='fl'>3.1</span>, <span class='fl'>5.86</span>, <span class='fl'>7.28</span>, <span class='fl'>0.00</span>, <span class='fl'>2.61</span>, <span class='fl'>2.54</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># check that total proportion = 100</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>don_es</span><span class='op'>$</span><span class='va'>vote_proportion</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 100</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># SWEDEN</span></span>
<span><span class='va'>don_se</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"EPP"</span>, <span class='st'>"SD"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"ECR"</span>, <span class='st'>"Renew"</span>, <span class='st'>"GREENSEFA"</span>, <span class='st'>"Theleft"</span>, <span class='st'>"ESN"</span>, <span class='st'>"NI"</span>, <span class='st'>"Independent"</span><span class='op'>)</span>,</span>
<span>  vote_proportion <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>23.86</span>, <span class='fl'>24.77</span>, <span class='fl'>0.00</span>, <span class='fl'>13.17</span>, <span class='fl'>11.67</span>, <span class='fl'>14.22</span>, <span class='fl'>11.06</span>, <span class='fl'>0.00</span>, <span class='fl'>0.04</span>, <span class='fl'>1.21</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># check that total proportion = 100</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>don_se</span><span class='op'>$</span><span class='va'>vote_proportion</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 100</code></pre>
</div>
<h3 id="defining-the-donut-plot-function">DEFINING THE DONUT PLOT FUNCTION</h3>
<p>Following the same thinking as with the parliament plots, it was decided that individually coding 27 different donut plots would be unnecessarily time consuming and too large of a chunk of code. Again, a function was defined to streamline and regulate the donut plot making process.</p>
<p>The function had to encompass several features including the function parameters, the construction of the bar chart, the applicatin of polar coordinates, the white background, and the creation of the donut hole in the centre of the polar plot.</p>
<p>The donut plot making function was defined as follows:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># creating a donut plot function</span></span>
<span><span class='co'># defining the function parameters</span></span>
<span><span class='va'>make_donut</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>data</span>,</span>
<span>                       <span class='va'>party_col</span> <span class='op'>=</span> <span class='va'>party</span>,</span>
<span>                       <span class='va'>value_col</span> <span class='op'>=</span> <span class='va'>vote_proportion</span>,</span>
<span>                       <span class='va'>width_mm</span> <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span> <span class='op'>{</span></span>
<span><span class='co'># data preparation: converting party to a factor and reversing the levels with fct_rev()to correct visuals</span></span>
<span>  <span class='va'>data_prepped</span> <span class='op'>&lt;-</span> <span class='va'>data</span> <span class='op'>|&gt;</span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>      party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='op'>{</span><span class='op'>{</span> <span class='va'>party_col</span> <span class='op'>}</span><span class='op'>}</span>, levels <span class='op'>=</span> <span class='va'>party_order</span><span class='op'>)</span>,</span>
<span>      party <span class='op'>=</span> <span class='fu'>forcats</span><span class='fu'>::</span><span class='fu'><a href='https://forcats.tidyverse.org/reference/fct_rev.html'>fct_rev</a></span><span class='op'>(</span><span class='va'>party</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>party</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># calculating the outer edge of the donut</span></span>
<span>  <span class='va'>donut_outer</span> <span class='op'>&lt;-</span> <span class='fl'>2</span> <span class='op'>+</span> <span class='va'>width_mm</span><span class='op'>/</span><span class='fl'>2</span></span>
<span></span>
<span><span class='co'># constructing the donut </span></span>
<span>  <span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>data_prepped</span>,</span>
<span>              <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>2</span>, y <span class='op'>=</span> <span class='op'>{</span><span class='op'>{</span> <span class='va'>value_col</span> <span class='op'>}</span><span class='op'>}</span>, fill <span class='op'>=</span> <span class='va'>party</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span><span class='co'># defining the white background</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"rect"</span>, </span>
<span>             xmin <span class='op'>=</span> <span class='fl'>0.5</span>, xmax <span class='op'>=</span> <span class='va'>donut_outer</span>,   </span>
<span>             ymin <span class='op'>=</span> <span class='fl'>0</span>, ymax <span class='op'>=</span> <span class='fl'>100</span>,</span>
<span>             fill <span class='op'>=</span> <span class='st'>"white"</span>, colour <span class='op'>=</span> <span class='cn'>NA</span><span class='op'>)</span> <span class='op'>+</span></span>
<span><span class='co'># defining the thickness of the bar</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_col</a></span><span class='op'>(</span>width <span class='op'>=</span> <span class='va'>width_mm</span><span class='op'>)</span> <span class='op'>+</span></span>
<span><span class='co'># wrapping the bar into a circle</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_radial.html'>coord_polar</a></span><span class='op'>(</span>theta <span class='op'>=</span> <span class='st'>"y"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span><span class='co'># spplying globally specified colours</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>custom_cols</span>, drop <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>+</span></span>
<span><span class='co'># defining the centre hole of the donut</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>xlim</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>2.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span><span class='co'># adjusting the theme</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_void</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span>  </span>
<span>  </span>
<span>  <span class='va'>p</span></span>
<span><span class='op'>}</span></span></code></pre>
</div>
</div>
<h3 id="plotting-1">PLOTTING</h3>
<p>Now that the donut plot making function has been defined (and tested???) the 27 individual donut plots required to recreate the original plot can be created.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># AUSTRIA</span></span>
<span><span class='va'>donut_at</span> <span class='op'>&lt;-</span> <span class='fu'>make_donut</span><span class='op'>(</span><span class='va'>don_at</span><span class='op'>)</span></span>
<span><span class='va'>donut_at</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-22-1.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># BELGIUM</span></span>
<span><span class='va'>donut_be</span> <span class='op'>&lt;-</span> <span class='fu'>make_donut</span><span class='op'>(</span><span class='va'>don_be</span><span class='op'>)</span></span>
<span><span class='va'>donut_be</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-22-2.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># BULGARIA</span></span>
<span><span class='va'>donut_bg</span> <span class='op'>&lt;-</span> <span class='fu'>make_donut</span><span class='op'>(</span><span class='va'>don_bg</span><span class='op'>)</span></span>
<span><span class='va'>donut_bg</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-22-3.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># CROATIA</span></span>
<span><span class='va'>donut_hr</span> <span class='op'>&lt;-</span> <span class='fu'>make_donut</span><span class='op'>(</span><span class='va'>don_hr</span><span class='op'>)</span></span>
<span><span class='va'>donut_hr</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-22-4.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># CYPRUS</span></span>
<span><span class='va'>donut_cy</span> <span class='op'>&lt;-</span> <span class='fu'>make_donut</span><span class='op'>(</span><span class='va'>don_cy</span><span class='op'>)</span></span>
<span><span class='va'>donut_cy</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-22-5.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># CZECHIA</span></span>
<span><span class='va'>donut_cz</span> <span class='op'>&lt;-</span> <span class='fu'>make_donut</span><span class='op'>(</span><span class='va'>don_cz</span><span class='op'>)</span></span>
<span><span class='va'>donut_cz</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-22-6.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># DENMARK</span></span>
<span><span class='va'>donut_dk</span> <span class='op'>&lt;-</span> <span class='fu'>make_donut</span><span class='op'>(</span><span class='va'>don_dk</span><span class='op'>)</span></span>
<span><span class='va'>donut_dk</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-22-7.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># ESTONIA</span></span>
<span><span class='va'>donut_ee</span> <span class='op'>&lt;-</span> <span class='fu'>make_donut</span><span class='op'>(</span><span class='va'>don_ee</span><span class='op'>)</span></span>
<span><span class='va'>donut_ee</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-22-8.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># FINLAND</span></span>
<span><span class='va'>donut_fi</span> <span class='op'>&lt;-</span> <span class='fu'>make_donut</span><span class='op'>(</span><span class='va'>don_fi</span><span class='op'>)</span></span>
<span><span class='va'>donut_fi</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-22-9.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># FRANCE</span></span>
<span><span class='va'>donut_fr</span> <span class='op'>&lt;-</span> <span class='fu'>make_donut</span><span class='op'>(</span><span class='va'>don_fr</span><span class='op'>)</span></span>
<span><span class='va'>donut_fr</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-22-10.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># GERMANY</span></span>
<span><span class='va'>donut_de</span> <span class='op'>&lt;-</span> <span class='fu'>make_donut</span><span class='op'>(</span><span class='va'>don_de</span><span class='op'>)</span></span>
<span><span class='va'>donut_de</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-22-11.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># GREECE</span></span>
<span><span class='va'>donut_el</span> <span class='op'>&lt;-</span> <span class='fu'>make_donut</span><span class='op'>(</span><span class='va'>don_el</span><span class='op'>)</span></span>
<span><span class='va'>donut_el</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-22-12.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># HUNGARY</span></span>
<span><span class='va'>donut_hu</span> <span class='op'>&lt;-</span> <span class='fu'>make_donut</span><span class='op'>(</span><span class='va'>don_hu</span><span class='op'>)</span></span>
<span><span class='va'>donut_hu</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-22-13.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># IRELAND</span></span>
<span><span class='va'>donut_ie</span> <span class='op'>&lt;-</span> <span class='fu'>make_donut</span><span class='op'>(</span><span class='va'>don_ie</span><span class='op'>)</span></span>
<span><span class='va'>donut_ie</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-22-14.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># ITALY</span></span>
<span><span class='va'>donut_it</span> <span class='op'>&lt;-</span> <span class='fu'>make_donut</span><span class='op'>(</span><span class='va'>don_it</span><span class='op'>)</span></span>
<span><span class='va'>donut_it</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-22-15.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># LATVIA</span></span>
<span><span class='va'>donut_lv</span> <span class='op'>&lt;-</span> <span class='fu'>make_donut</span><span class='op'>(</span><span class='va'>don_lv</span><span class='op'>)</span></span>
<span><span class='va'>donut_lv</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-22-16.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># LITHUANIA</span></span>
<span><span class='va'>donut_lt</span> <span class='op'>&lt;-</span> <span class='fu'>make_donut</span><span class='op'>(</span><span class='va'>don_lt</span><span class='op'>)</span></span>
<span><span class='va'>donut_lt</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-22-17.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># LUXEMBOURG</span></span>
<span><span class='va'>donut_lu</span> <span class='op'>&lt;-</span> <span class='fu'>make_donut</span><span class='op'>(</span><span class='va'>don_lu</span><span class='op'>)</span></span>
<span><span class='va'>donut_lu</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-22-18.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># MALTA</span></span>
<span><span class='va'>donut_mt</span> <span class='op'>&lt;-</span> <span class='fu'>make_donut</span><span class='op'>(</span><span class='va'>don_mt</span><span class='op'>)</span></span>
<span><span class='va'>donut_mt</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-22-19.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># NETHERLANDS</span></span>
<span><span class='va'>donut_nl</span> <span class='op'>&lt;-</span> <span class='fu'>make_donut</span><span class='op'>(</span><span class='va'>don_nl</span><span class='op'>)</span></span>
<span><span class='va'>donut_nl</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-22-20.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># POLAND</span></span>
<span><span class='va'>donut_pl</span> <span class='op'>&lt;-</span> <span class='fu'>make_donut</span><span class='op'>(</span><span class='va'>don_pl</span><span class='op'>)</span></span>
<span><span class='va'>donut_pl</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-22-21.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># PORTUGAL</span></span>
<span><span class='va'>donut_pt</span> <span class='op'>&lt;-</span> <span class='fu'>make_donut</span><span class='op'>(</span><span class='va'>don_pt</span><span class='op'>)</span></span>
<span><span class='va'>donut_pt</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-22-22.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># ROMANIA</span></span>
<span><span class='va'>donut_ro</span> <span class='op'>&lt;-</span> <span class='fu'>make_donut</span><span class='op'>(</span><span class='va'>don_ro</span><span class='op'>)</span></span>
<span><span class='va'>donut_ro</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-22-23.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># SLOVAKIA</span></span>
<span><span class='va'>donut_sk</span> <span class='op'>&lt;-</span> <span class='fu'>make_donut</span><span class='op'>(</span><span class='va'>don_sk</span><span class='op'>)</span></span>
<span><span class='va'>donut_sk</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-22-24.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># SLOVENIA</span></span>
<span><span class='va'>donut_si</span> <span class='op'>&lt;-</span> <span class='fu'>make_donut</span><span class='op'>(</span><span class='va'>don_si</span><span class='op'>)</span></span>
<span><span class='va'>donut_si</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-22-25.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># SPAIN</span></span>
<span><span class='va'>donut_es</span> <span class='op'>&lt;-</span> <span class='fu'>make_donut</span><span class='op'>(</span><span class='va'>don_es</span><span class='op'>)</span></span>
<span><span class='va'>donut_es</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-22-26.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># SWEDEN</span></span>
<span><span class='va'>donut_se</span> <span class='op'>&lt;-</span> <span class='fu'>make_donut</span><span class='op'>(</span><span class='va'>don_se</span><span class='op'>)</span></span>
<span><span class='va'>donut_se</span></span></code></pre>
</div>
<p><img src="100561659_files/figure-html5/unnamed-chunk-22-27.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<h2 id="combining-the-parliament-and-donut-plots">COMBINING THE PARLIAMENT AND DONUT PLOTS</h2>
<p>After both the parliament and donut plots were created, the next stage of the replication process was to combine them into a single, layered combination plot for each country.</p>
<p>The function had to encompass several features including *****</p>
<h3 id="defining-the-combination-plot-function">DEFINING THE COMBINATION PLOT FUNCTION</h3>
<p>For a third time, a function was defined to streamline and standardise the creation process for all 27 plots.</p>
<p>The final combination plot function was defined as follows:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># creating a combination plot function</span></span>
<span><span class='co'># defining the function parameters</span></span>
<span><span class='va'>combine_donut_parliament</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span></span>
<span>    <span class='va'>donut_plot</span>,</span>
<span>    <span class='va'>parliament_plot</span>,</span>
<span>    <span class='va'>inner_width</span>   <span class='op'>=</span> <span class='fl'>0.72</span>,</span>
<span>    <span class='va'>donut_scale</span>   <span class='op'>=</span> <span class='fl'>1.20</span>,</span>
<span>    <span class='va'>start_angle</span>   <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>    <span class='va'>ring_divisor</span>  <span class='op'>=</span> <span class='fl'>1.89</span>,</span>
<span>    <span class='va'>ring_color</span>    <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>    <span class='va'>ring_lwd</span>      <span class='op'>=</span> <span class='fl'>3</span></span>
<span><span class='op'>)</span> <span class='op'>{</span></span>
<span><span class='co'># defining the layering strategy using ggdraw </span></span>
<span>  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/ggdraw.html'>ggdraw</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span><span class='co'># positioning the outer donut including scale and rotation</span></span>
<span>  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/draw_plot.html'>draw_plot</a></span><span class='op'>(</span></span>
<span>    <span class='va'>donut_plot</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_radial.html'>coord_polar</a></span><span class='op'>(</span>theta <span class='op'>=</span> <span class='st'>"y"</span>, start <span class='op'>=</span> <span class='va'>start_angle</span><span class='op'>)</span>,</span>
<span>    x      <span class='op'>=</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>donut_scale</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    y      <span class='op'>=</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>donut_scale</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    width  <span class='op'>=</span> <span class='va'>donut_scale</span>,</span>
<span>    height <span class='op'>=</span> <span class='va'>donut_scale</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>    </span>
<span><span class='co'># positioning the inner parliament plot</span></span>
<span>  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/draw_plot.html'>draw_plot</a></span><span class='op'>(</span></span>
<span>    <span class='va'>parliament_plot</span>,</span>
<span>    x      <span class='op'>=</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>inner_width</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    y      <span class='op'>=</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>inner_width</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    width  <span class='op'>=</span> <span class='va'>inner_width</span>,</span>
<span>    height <span class='op'>=</span> <span class='va'>inner_width</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>    </span>
<span><span class='co'># defining the inner black ring</span></span>
<span>  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/draw_grob.html'>draw_grob</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/grid/grid.circle.html'>circleGrob</a></span><span class='op'>(</span></span>
<span>      x <span class='op'>=</span> <span class='fl'>0.5</span>, y <span class='op'>=</span> <span class='fl'>0.5</span>,</span>
<span>      r <span class='op'>=</span> <span class='va'>inner_width</span> <span class='op'>/</span> <span class='va'>ring_divisor</span>,</span>
<span>      gp <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/gpar.html'>gpar</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='cn'>NA</span>, col <span class='op'>=</span> <span class='va'>ring_color</span>, lwd <span class='op'>=</span> <span class='va'>ring_lwd</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span><span class='op'>}</span></span></code></pre>
</div>
</div>
<h3 id="plotting-2">PLOTTING</h3>
<p>The above function was then used to create the 27 combination circular plots to be used in the final product.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># AUSTRIA</span></span>
<span><span class='va'>at_final</span> <span class='op'>&lt;-</span> <span class='fu'>combine_donut_parliament</span><span class='op'>(</span></span>
<span>  donut_plot      <span class='op'>=</span> <span class='va'>donut_at</span>,</span>
<span>  parliament_plot <span class='op'>=</span> <span class='va'>ATPARL</span>,</span>
<span>  inner_width     <span class='op'>=</span> <span class='fl'>0.72</span>,</span>
<span>  donut_scale     <span class='op'>=</span> <span class='fl'>1.20</span>,</span>
<span>  start_angle     <span class='op'>=</span> <span class='fl'>0</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>at_final</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-24-1.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># BELGIUM</span></span>
<span><span class='va'>be_final</span> <span class='op'>&lt;-</span> <span class='fu'>combine_donut_parliament</span><span class='op'>(</span></span>
<span>  donut_plot      <span class='op'>=</span> <span class='va'>donut_be</span>,</span>
<span>  parliament_plot <span class='op'>=</span> <span class='va'>BEPARL</span>,</span>
<span>  inner_width     <span class='op'>=</span> <span class='fl'>0.72</span>,</span>
<span>  donut_scale     <span class='op'>=</span> <span class='fl'>1.20</span>,</span>
<span>  start_angle     <span class='op'>=</span> <span class='fl'>0</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>be_final</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-24-2.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># BULGARIA</span></span>
<span><span class='va'>bg_final</span> <span class='op'>&lt;-</span> <span class='fu'>combine_donut_parliament</span><span class='op'>(</span></span>
<span>  donut_plot      <span class='op'>=</span> <span class='va'>donut_bg</span>,</span>
<span>  parliament_plot <span class='op'>=</span> <span class='va'>BGPARL</span>,</span>
<span>  inner_width     <span class='op'>=</span> <span class='fl'>0.72</span>,</span>
<span>  donut_scale     <span class='op'>=</span> <span class='fl'>1.20</span>,</span>
<span>  start_angle     <span class='op'>=</span> <span class='fl'>0</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>bg_final</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-24-3.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># CROATIA</span></span>
<span><span class='va'>hr_final</span> <span class='op'>&lt;-</span> <span class='fu'>combine_donut_parliament</span><span class='op'>(</span></span>
<span>  donut_plot      <span class='op'>=</span> <span class='va'>donut_hr</span>,</span>
<span>  parliament_plot <span class='op'>=</span> <span class='va'>HRPARL</span>,</span>
<span>  inner_width     <span class='op'>=</span> <span class='fl'>0.72</span>,</span>
<span>  donut_scale     <span class='op'>=</span> <span class='fl'>1.20</span>,</span>
<span>  start_angle     <span class='op'>=</span> <span class='fl'>0</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>hr_final</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-24-4.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># CYPRUS</span></span>
<span><span class='va'>cy_final</span> <span class='op'>&lt;-</span> <span class='fu'>combine_donut_parliament</span><span class='op'>(</span></span>
<span>  donut_plot      <span class='op'>=</span> <span class='va'>donut_cy</span>,</span>
<span>  parliament_plot <span class='op'>=</span> <span class='va'>CYPARL</span>,</span>
<span>  inner_width     <span class='op'>=</span> <span class='fl'>0.72</span>,</span>
<span>  donut_scale     <span class='op'>=</span> <span class='fl'>1.20</span>,</span>
<span>  start_angle     <span class='op'>=</span> <span class='fl'>0</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>cy_final</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-24-5.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># CZECH REPUBLIC</span></span>
<span><span class='va'>cz_final</span> <span class='op'>&lt;-</span> <span class='fu'>combine_donut_parliament</span><span class='op'>(</span></span>
<span>  donut_plot      <span class='op'>=</span> <span class='va'>donut_cz</span>,</span>
<span>  parliament_plot <span class='op'>=</span> <span class='va'>CZPARL</span>,</span>
<span>  inner_width     <span class='op'>=</span> <span class='fl'>0.72</span>,</span>
<span>  donut_scale     <span class='op'>=</span> <span class='fl'>1.20</span>,</span>
<span>  start_angle     <span class='op'>=</span> <span class='fl'>0</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='va'>cz_final</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-24-6.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># DENMARK</span></span>
<span><span class='va'>dk_final</span> <span class='op'>&lt;-</span> <span class='fu'>combine_donut_parliament</span><span class='op'>(</span></span>
<span>  donut_plot      <span class='op'>=</span> <span class='va'>donut_dk</span>,</span>
<span>  parliament_plot <span class='op'>=</span> <span class='va'>DKPARL</span>,</span>
<span>  inner_width     <span class='op'>=</span> <span class='fl'>0.72</span>,</span>
<span>  donut_scale     <span class='op'>=</span> <span class='fl'>1.20</span>,</span>
<span>  start_angle     <span class='op'>=</span> <span class='fl'>0</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>dk_final</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-24-7.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># ESTONIA</span></span>
<span><span class='va'>ee_final</span> <span class='op'>&lt;-</span> <span class='fu'>combine_donut_parliament</span><span class='op'>(</span></span>
<span>  donut_plot      <span class='op'>=</span> <span class='va'>donut_ee</span>,</span>
<span>  parliament_plot <span class='op'>=</span> <span class='va'>EEPARL</span>,</span>
<span>  inner_width     <span class='op'>=</span> <span class='fl'>0.72</span>,</span>
<span>  donut_scale     <span class='op'>=</span> <span class='fl'>1.20</span>,</span>
<span>  start_angle     <span class='op'>=</span> <span class='fl'>0</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>ee_final</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-24-8.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># FINLAND</span></span>
<span><span class='va'>fi_final</span> <span class='op'>&lt;-</span> <span class='fu'>combine_donut_parliament</span><span class='op'>(</span></span>
<span>  donut_plot      <span class='op'>=</span> <span class='va'>donut_fi</span>,</span>
<span>  parliament_plot <span class='op'>=</span> <span class='va'>FIPARL</span>,</span>
<span>  inner_width     <span class='op'>=</span> <span class='fl'>0.72</span>,</span>
<span>  donut_scale     <span class='op'>=</span> <span class='fl'>1.20</span>,</span>
<span>  start_angle     <span class='op'>=</span> <span class='fl'>0</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>fi_final</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-24-9.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># FRANCE</span></span>
<span><span class='va'>fr_final</span> <span class='op'>&lt;-</span> <span class='fu'>combine_donut_parliament</span><span class='op'>(</span></span>
<span>  donut_plot      <span class='op'>=</span> <span class='va'>donut_fr</span>,</span>
<span>  parliament_plot <span class='op'>=</span> <span class='va'>FRPARL</span>,</span>
<span>  inner_width     <span class='op'>=</span> <span class='fl'>0.72</span>,</span>
<span>  donut_scale     <span class='op'>=</span> <span class='fl'>1.20</span>,</span>
<span>  start_angle     <span class='op'>=</span> <span class='fl'>0</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>fr_final</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-24-10.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># GERMANY</span></span>
<span><span class='va'>de_final</span> <span class='op'>&lt;-</span> <span class='fu'>combine_donut_parliament</span><span class='op'>(</span></span>
<span>  donut_plot      <span class='op'>=</span> <span class='va'>donut_de</span>,</span>
<span>  parliament_plot <span class='op'>=</span> <span class='va'>DEPARL</span>,</span>
<span>  inner_width     <span class='op'>=</span> <span class='fl'>0.72</span>,</span>
<span>  donut_scale     <span class='op'>=</span> <span class='fl'>1.20</span>,</span>
<span>  start_angle     <span class='op'>=</span> <span class='fl'>0</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>de_final</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-24-11.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># GREECE</span></span>
<span><span class='va'>el_final</span> <span class='op'>&lt;-</span> <span class='fu'>combine_donut_parliament</span><span class='op'>(</span></span>
<span>  donut_plot      <span class='op'>=</span> <span class='va'>donut_el</span>,</span>
<span>  parliament_plot <span class='op'>=</span> <span class='va'>ELPARL</span>,</span>
<span>  inner_width     <span class='op'>=</span> <span class='fl'>0.72</span>,</span>
<span>  donut_scale     <span class='op'>=</span> <span class='fl'>1.20</span>,</span>
<span>  start_angle     <span class='op'>=</span> <span class='fl'>0</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>el_final</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-24-12.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># HUNGARY</span></span>
<span><span class='va'>hu_final</span> <span class='op'>&lt;-</span> <span class='fu'>combine_donut_parliament</span><span class='op'>(</span></span>
<span>  donut_plot      <span class='op'>=</span> <span class='va'>donut_hu</span>,</span>
<span>  parliament_plot <span class='op'>=</span> <span class='va'>HUPARL</span>,</span>
<span>  inner_width     <span class='op'>=</span> <span class='fl'>0.72</span>,</span>
<span>  donut_scale     <span class='op'>=</span> <span class='fl'>1.20</span>,</span>
<span>  start_angle     <span class='op'>=</span> <span class='fl'>0</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>hu_final</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-24-13.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># IRELAND</span></span>
<span><span class='va'>ie_final</span> <span class='op'>&lt;-</span> <span class='fu'>combine_donut_parliament</span><span class='op'>(</span></span>
<span>  donut_plot      <span class='op'>=</span> <span class='va'>donut_ie</span>,</span>
<span>  parliament_plot <span class='op'>=</span> <span class='va'>IEPARL</span>,</span>
<span>  inner_width     <span class='op'>=</span> <span class='fl'>0.72</span>,</span>
<span>  donut_scale     <span class='op'>=</span> <span class='fl'>1.20</span>,</span>
<span>  start_angle     <span class='op'>=</span> <span class='fl'>0</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>ie_final</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-24-14.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># ITALY</span></span>
<span><span class='va'>it_final</span> <span class='op'>&lt;-</span> <span class='fu'>combine_donut_parliament</span><span class='op'>(</span></span>
<span>  donut_plot      <span class='op'>=</span> <span class='va'>donut_it</span>,</span>
<span>  parliament_plot <span class='op'>=</span> <span class='va'>ITPARL</span>,</span>
<span>  inner_width     <span class='op'>=</span> <span class='fl'>0.72</span>,</span>
<span>  donut_scale     <span class='op'>=</span> <span class='fl'>1.20</span>,</span>
<span>  start_angle     <span class='op'>=</span> <span class='fl'>0</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>it_final</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-24-15.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># LATVIA</span></span>
<span><span class='va'>lv_final</span> <span class='op'>&lt;-</span> <span class='fu'>combine_donut_parliament</span><span class='op'>(</span></span>
<span>  donut_plot      <span class='op'>=</span> <span class='va'>donut_lv</span>,</span>
<span>  parliament_plot <span class='op'>=</span> <span class='va'>LVPARL</span>,</span>
<span>  inner_width     <span class='op'>=</span> <span class='fl'>0.72</span>,</span>
<span>  donut_scale     <span class='op'>=</span> <span class='fl'>1.20</span>,</span>
<span>  start_angle     <span class='op'>=</span> <span class='fl'>0</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>lv_final</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-24-16.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># LITHUANIA</span></span>
<span><span class='va'>lt_final</span> <span class='op'>&lt;-</span> <span class='fu'>combine_donut_parliament</span><span class='op'>(</span></span>
<span>  donut_plot      <span class='op'>=</span> <span class='va'>donut_lt</span>,</span>
<span>  parliament_plot <span class='op'>=</span> <span class='va'>LTPARL</span>,</span>
<span>  inner_width     <span class='op'>=</span> <span class='fl'>0.72</span>,</span>
<span>  donut_scale     <span class='op'>=</span> <span class='fl'>1.20</span>,</span>
<span>  start_angle     <span class='op'>=</span> <span class='fl'>0</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>lt_final</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-24-17.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># LUXEMBOURG</span></span>
<span><span class='va'>lu_final</span> <span class='op'>&lt;-</span> <span class='fu'>combine_donut_parliament</span><span class='op'>(</span></span>
<span>  donut_plot      <span class='op'>=</span> <span class='va'>donut_lu</span>,</span>
<span>  parliament_plot <span class='op'>=</span> <span class='va'>LUPARL</span>,</span>
<span>  inner_width     <span class='op'>=</span> <span class='fl'>0.72</span>,</span>
<span>  donut_scale     <span class='op'>=</span> <span class='fl'>1.20</span>,</span>
<span>  start_angle     <span class='op'>=</span> <span class='fl'>0</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>lu_final</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-24-18.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># MALTA</span></span>
<span><span class='va'>mt_final</span> <span class='op'>&lt;-</span> <span class='fu'>combine_donut_parliament</span><span class='op'>(</span></span>
<span>  donut_plot      <span class='op'>=</span> <span class='va'>donut_mt</span>,</span>
<span>  parliament_plot <span class='op'>=</span> <span class='va'>MTPARL</span>,</span>
<span>  inner_width     <span class='op'>=</span> <span class='fl'>0.72</span>,</span>
<span>  donut_scale     <span class='op'>=</span> <span class='fl'>1.20</span>,</span>
<span>  start_angle     <span class='op'>=</span> <span class='fl'>0</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>mt_final</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-24-19.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># NETHERLANDS</span></span>
<span><span class='va'>nl_final</span> <span class='op'>&lt;-</span> <span class='fu'>combine_donut_parliament</span><span class='op'>(</span></span>
<span>  donut_plot      <span class='op'>=</span> <span class='va'>donut_nl</span>,</span>
<span>  parliament_plot <span class='op'>=</span> <span class='va'>NLPARL</span>,</span>
<span>  inner_width     <span class='op'>=</span> <span class='fl'>0.72</span>,</span>
<span>  donut_scale     <span class='op'>=</span> <span class='fl'>1.20</span>,</span>
<span>  start_angle     <span class='op'>=</span> <span class='fl'>0</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>nl_final</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-24-20.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># POLAND</span></span>
<span><span class='va'>pl_final</span> <span class='op'>&lt;-</span> <span class='fu'>combine_donut_parliament</span><span class='op'>(</span></span>
<span>  donut_plot      <span class='op'>=</span> <span class='va'>donut_pl</span>,</span>
<span>  parliament_plot <span class='op'>=</span> <span class='va'>PLPARL</span>,</span>
<span>  inner_width     <span class='op'>=</span> <span class='fl'>0.72</span>,</span>
<span>  donut_scale     <span class='op'>=</span> <span class='fl'>1.20</span>,</span>
<span>  start_angle     <span class='op'>=</span> <span class='fl'>0</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>pl_final</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-24-21.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># PORTUGAL</span></span>
<span><span class='va'>pt_final</span> <span class='op'>&lt;-</span> <span class='fu'>combine_donut_parliament</span><span class='op'>(</span></span>
<span>  donut_plot      <span class='op'>=</span> <span class='va'>donut_pt</span>,</span>
<span>  parliament_plot <span class='op'>=</span> <span class='va'>PTPARL</span>,</span>
<span>  inner_width     <span class='op'>=</span> <span class='fl'>0.72</span>,</span>
<span>  donut_scale     <span class='op'>=</span> <span class='fl'>1.20</span>,</span>
<span>  start_angle     <span class='op'>=</span> <span class='fl'>0</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>pt_final</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-24-22.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># ROMANIA</span></span>
<span><span class='va'>ro_final</span> <span class='op'>&lt;-</span> <span class='fu'>combine_donut_parliament</span><span class='op'>(</span></span>
<span>  donut_plot      <span class='op'>=</span> <span class='va'>donut_ro</span>,</span>
<span>  parliament_plot <span class='op'>=</span> <span class='va'>ROPARL</span>,</span>
<span>  inner_width     <span class='op'>=</span> <span class='fl'>0.72</span>,</span>
<span>  donut_scale     <span class='op'>=</span> <span class='fl'>1.20</span>,</span>
<span>  start_angle     <span class='op'>=</span> <span class='fl'>0</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>ro_final</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-24-23.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># SLOVAKIA</span></span>
<span><span class='va'>sk_final</span> <span class='op'>&lt;-</span> <span class='fu'>combine_donut_parliament</span><span class='op'>(</span></span>
<span>  donut_plot      <span class='op'>=</span> <span class='va'>donut_sk</span>,</span>
<span>  parliament_plot <span class='op'>=</span> <span class='va'>SKPARL</span>,</span>
<span>  inner_width     <span class='op'>=</span> <span class='fl'>0.72</span>,</span>
<span>  donut_scale     <span class='op'>=</span> <span class='fl'>1.20</span>,</span>
<span>  start_angle     <span class='op'>=</span> <span class='fl'>0</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>sk_final</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-24-24.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># SLOVENIA</span></span>
<span><span class='va'>si_final</span> <span class='op'>&lt;-</span> <span class='fu'>combine_donut_parliament</span><span class='op'>(</span></span>
<span>  donut_plot      <span class='op'>=</span> <span class='va'>donut_si</span>,</span>
<span>  parliament_plot <span class='op'>=</span> <span class='va'>SIPARL</span>,</span>
<span>  inner_width     <span class='op'>=</span> <span class='fl'>0.72</span>,</span>
<span>  donut_scale     <span class='op'>=</span> <span class='fl'>1.20</span>,</span>
<span>  start_angle     <span class='op'>=</span> <span class='fl'>0</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>si_final</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-24-25.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># SPAIN</span></span>
<span><span class='va'>es_final</span> <span class='op'>&lt;-</span> <span class='fu'>combine_donut_parliament</span><span class='op'>(</span></span>
<span>  donut_plot      <span class='op'>=</span> <span class='va'>donut_es</span>,</span>
<span>  parliament_plot <span class='op'>=</span> <span class='va'>ESPARL</span>,</span>
<span>  inner_width     <span class='op'>=</span> <span class='fl'>0.72</span>,</span>
<span>  donut_scale     <span class='op'>=</span> <span class='fl'>1.20</span>,</span>
<span>  start_angle     <span class='op'>=</span> <span class='fl'>0</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>es_final</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-24-26.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># SWEDEN</span></span>
<span><span class='va'>se_final</span> <span class='op'>&lt;-</span> <span class='fu'>combine_donut_parliament</span><span class='op'>(</span></span>
<span>  donut_plot      <span class='op'>=</span> <span class='va'>donut_se</span>,</span>
<span>  parliament_plot <span class='op'>=</span> <span class='va'>SEPARL</span>,</span>
<span>  inner_width     <span class='op'>=</span> <span class='fl'>0.72</span>,</span>
<span>  donut_scale     <span class='op'>=</span> <span class='fl'>1.20</span>,</span>
<span>  start_angle     <span class='op'>=</span> <span class='fl'>0</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>se_final</span></span></code></pre>
</div>
<p><img src="100561659_files/figure-html5/unnamed-chunk-24-27.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<h2 id="positioning-the-combo-plots-on-the-map">POSITIONING THE COMBO PLOTS ON THE MAP</h2>
<p>At this stage of the project, the main background map and the individual combination plots for each country have been created. The next logical step was to place each plot on its relevant position on the map.</p>
<p>Before writing any code, some practical decisions had to be made about sizing. The circular plots on the original visualisation vary in size quite dramatically however there is not indication as to what the sizing of the plots is based off (if it is based off any concrete value at all). Looking at the plot it was obvious that bigger countries in terms of size/ population had bigger plots and smaller countries had smaller ones. This is also true in terms of number of seats, those with a larger number of seats had bigger plots and those with less seats had smaller plots. Using some trial and error to test size as both a function of seat number and population, it was decided that scaling the plots using a log function based on the population for each country gave the closest representation to the original.</p>
<h3 id="data-construction">DATA CONSTRUCTION</h3>
<p>First, a data frame containing the country names, codes, and population was created</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>eu_populations</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  country <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Austria"</span>, <span class='st'>"Bulgaria"</span>, <span class='st'>"Croatia"</span>, <span class='st'>"Czechia"</span>, <span class='st'>"Denmark"</span>, <span class='st'>"Estonia"</span>, <span class='st'>"Finland"</span>, <span class='st'>"France"</span>, <span class='st'>"Germany"</span>, <span class='st'>"Greece"</span>, <span class='st'>"Hungary"</span>, <span class='st'>"Ireland"</span>, <span class='st'>"Italy"</span>, <span class='st'>"Latvia"</span>, <span class='st'>"Lithuania"</span>, <span class='st'>"Poland"</span>, <span class='st'>"Portugal"</span>, <span class='st'>"Romania"</span>, <span class='st'>"Slovakia"</span>, <span class='st'>"Slovenia"</span>, <span class='st'>"Spain"</span>, <span class='st'>"Sweden"</span><span class='op'>)</span>,</span>
<span>  </span>
<span>  country_code <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"at"</span>, <span class='st'>"bg"</span>, <span class='st'>"hr"</span>, <span class='st'>"cz"</span>, <span class='st'>"dk"</span>, <span class='st'>"ee"</span>, <span class='st'>"fi"</span>, <span class='st'>"fr"</span>, <span class='st'>"de"</span>, <span class='st'>"el"</span>, <span class='st'>"hu"</span>, <span class='st'>"ie"</span>, <span class='st'>"it"</span>, <span class='st'>"lv"</span>, <span class='st'>"lt"</span>,<span class='st'>"pl"</span>, <span class='st'>"pt"</span>, <span class='st'>"ro"</span>, <span class='st'>"sk"</span>, <span class='st'>"si"</span>, <span class='st'>"es"</span>, <span class='st'>"se"</span><span class='op'>)</span>,</span>
<span>  </span>
<span>  population <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>9100000</span>, <span class='fl'>6400000</span>, <span class='fl'>3900000</span>, <span class='fl'>10900000</span>, <span class='fl'>5900000</span>, <span class='fl'>1400000</span>, <span class='fl'>5600000</span>, <span class='fl'>68200000</span>, <span class='fl'>84400000</span>, <span class='fl'>10400000</span>, <span class='fl'>9600000</span>, <span class='fl'>5200000</span>, <span class='fl'>59000000</span>, <span class='fl'>1800000</span>, <span class='fl'>2900000</span>, <span class='fl'>36800000</span>, <span class='fl'>10500000</span>, <span class='fl'>19100000</span>, <span class='fl'>5400000</span>, <span class='fl'>2100000</span>, <span class='fl'>48100000</span>, <span class='fl'>10600000</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 id="scaling">SCALING</h3>
<p>Next, a plot size was assigned to each countrys circular plot based on its population, using a logarithmic scale. Trial and error was used to adjust the function to the specification that produced the closest visual representation to the original plot - it was important that the smallest countries were not invisible and that the biggest countries did not overtake the entire plot.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># scaling the circular plots</span></span>
<span><span class='va'>country_sizes</span> <span class='op'>&lt;-</span> <span class='va'>eu_populations</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span><span class='co'># calculating log population</span></span>
<span>    log_pop  <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>population</span><span class='op'>)</span>,</span>
<span><span class='co'># rescale to plot sizes</span></span>
<span>    plot_size <span class='op'>=</span> <span class='fu'><a href='https://scales.r-lib.org/reference/rescale.html'>rescale</a></span><span class='op'>(</span></span>
<span>      <span class='va'>log_pop</span>,</span>
<span>      to   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>7.5</span><span class='op'>)</span>,                  </span>
<span>      from <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='fl'>540000</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='fl'>84400000</span><span class='op'>)</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<p>The position of the circular plots on the main map was determined using the centroids of the country areas included in the main map dataset. First, a dataset including the size of the plots and their final position was needed.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># positioning the circular plots on the map</span></span>
<span><span class='co'># copmbining the country geometries to make one row per country with a merged geometry</span></span>
<span><span class='va'>country_centroids</span> <span class='op'>&lt;-</span> <span class='va'>final_map</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>country</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span></span>
<span>    geometry <span class='op'>=</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/geos_combine.html'>st_union</a></span><span class='op'>(</span><span class='va'>geometry</span><span class='op'>)</span>,</span>
<span>    .groups <span class='op'>=</span> <span class='st'>"drop"</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_as_sf.html'>st_as_sf</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># calculating the centroids</span></span>
<span><span class='va'>centroids</span>       <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/geos_unary.html'>st_centroid</a></span><span class='op'>(</span><span class='va'>country_centroids</span><span class='op'>)</span></span>
<span><span class='co'># extracting the coordinates of the centroids</span></span>
<span><span class='va'>centroid_coords</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_coordinates.html'>st_coordinates</a></span><span class='op'>(</span><span class='va'>centroids</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># adding the centroid coordinates to the dataset</span></span>
<span><span class='va'>country_centroids</span> <span class='op'>&lt;-</span> <span class='va'>country_centroids</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_geometry.html'>st_drop_geometry</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    centroid_x <span class='op'>=</span> <span class='va'>centroid_coords</span><span class='op'>[</span>, <span class='st'>"X"</span><span class='op'>]</span>,</span>
<span>    centroid_y <span class='op'>=</span> <span class='va'>centroid_coords</span><span class='op'>[</span>, <span class='st'>"Y"</span><span class='op'>]</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># combining with the plot sizes</span></span>
<span><span class='va'>country_data</span> <span class='op'>&lt;-</span> <span class='va'>country_centroids</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>inner_join</a></span><span class='op'>(</span><span class='va'>country_sizes</span>, by <span class='op'>=</span> <span class='st'>"country"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Then the existing combination plots were saved as .png images and a dataset including country names, centroid coordinates, plot sizes, and path to each saved image were created</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># saving the combination plots as .png images</span></span>
<span><span class='co'># creating an output directory</span></span>
<span><span class='va'>output_dir</span> <span class='op'>&lt;-</span> <span class='st'>"combined_plots"</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/files2.html'>dir.create</a></span><span class='op'>(</span><span class='va'>output_dir</span>, showWarnings <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>country_data</span><span class='op'>$</span><span class='va'>image_path</span> <span class='op'>&lt;-</span> <span class='cn'>NA_character_</span></span>
<span></span>
<span><span class='co'># processing each country in a loop and extracting country information</span></span>
<span><span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>country_data</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='va'>country_name</span> <span class='op'>&lt;-</span> <span class='va'>country_data</span><span class='op'>$</span><span class='va'>country</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span></span>
<span>  <span class='va'>country_code</span> <span class='op'>&lt;-</span> <span class='va'>country_data</span><span class='op'>$</span><span class='va'>country_code</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span></span>
<span>  <span class='va'>plot_size</span>    <span class='op'>&lt;-</span> <span class='va'>country_data</span><span class='op'>$</span><span class='va'>plot_size</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span></span>
<span><span class='co'># retrieving the plot objects  </span></span>
<span>  <span class='va'>plot_name</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>country_code</span>, <span class='st'>"_final"</span><span class='op'>)</span></span>
<span>  <span class='va'>existing_plot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/get.html'>get</a></span><span class='op'>(</span><span class='va'>plot_name</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># crearing a file path where the images are saved</span></span>
<span>  <span class='va'>img_file</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='va'>output_dir</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>country_name</span>, <span class='st'>".png"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># saving the plot </span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span></span>
<span>    filename <span class='op'>=</span> <span class='va'>img_file</span>,</span>
<span>    plot     <span class='op'>=</span> <span class='va'>existing_plot</span>,</span>
<span>    width    <span class='op'>=</span> <span class='va'>plot_size</span>,</span>
<span>    height   <span class='op'>=</span> <span class='va'>plot_size</span>,</span>
<span>    dpi      <span class='op'>=</span> <span class='fl'>300</span>,</span>
<span>    bg       <span class='op'>=</span> <span class='st'>"transparent"</span></span>
<span>  <span class='op'>)</span></span>
<span>  </span>
<span>  <span class='va'>country_data</span><span class='op'>$</span><span class='va'>image_path</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>img_file</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='co'># printing a confirmation message once all files are saved</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span><span class='op'>(</span><span class='st'>"\nSaved plots to:"</span>, <span class='va'>output_dir</span>, <span class='st'>"\n"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>
Saved plots to: combined_plots </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>cd_plot</span> <span class='op'>&lt;-</span> <span class='va'>country_data</span></span></code></pre>
</div>
</div>
<p>Some plots in areas with many smaller countries were overlapping slightly when overlaid onto the main plot, but reducing the lower size of the plots even more was not possible due to readability and not aligning with the visuals of the original plot. To take care of these overlaps a repulsion algorithm was employed.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># dealing with the overlapping circular plots</span></span>
<span><span class='co'># calculating the image sizes suitable for plotting onto the map</span></span>
<span><span class='va'>cd_plot</span> <span class='op'>&lt;-</span> <span class='va'>cd_plot</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    geom_size <span class='op'>=</span> <span class='va'>plot_size</span> <span class='op'>*</span> <span class='fl'>0.015</span> <span class='co'># adjusted using trial and error</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># converting to map units using the bounding box of the entire map area</span></span>
<span><span class='va'>bbox</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_bbox.html'>st_bbox</a></span><span class='op'>(</span><span class='va'>final_map</span><span class='op'>)</span></span>
<span><span class='va'>y_range</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>bbox</span><span class='op'>[</span><span class='st'>"ymax"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>bbox</span><span class='op'>[</span><span class='st'>"ymin"</span><span class='op'>]</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># approximating the circle radiuses in map units</span></span>
<span><span class='va'>cd_plot</span> <span class='op'>&lt;-</span> <span class='va'>cd_plot</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    img_height_data <span class='op'>=</span> <span class='va'>geom_size</span> <span class='op'>*</span> <span class='va'>y_range</span>,</span>
<span>    radius          <span class='op'>=</span> <span class='va'>img_height_data</span> <span class='op'>/</span> <span class='fl'>2</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># setting up the repulsion algorithm</span></span>
<span><span class='va'>coords</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>cd_plot</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"centroid_x"</span>, <span class='st'>"centroid_y"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span></span>
<span><span class='va'>radii</span>  <span class='op'>&lt;-</span> <span class='va'>cd_plot</span><span class='op'>$</span><span class='va'>radius</span></span>
<span><span class='co'># defining the extra spacing between circles (in data units)</span></span>
<span><span class='va'>circle_padding</span> <span class='op'>&lt;-</span> <span class='fl'>0.01</span> <span class='op'>*</span> <span class='va'>y_range</span></span>
<span><span class='co'># the repulsion algorithm</span></span>
<span><span class='va'>max_iter</span> <span class='op'>&lt;-</span> <span class='fl'>100</span></span>
<span></span>
<span><span class='kw'>for</span> <span class='op'>(</span><span class='va'>iter</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='va'>max_iter</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='va'>moved</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span></span>
<span><span class='co'># checking every pair of countries</span></span>
<span>  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>coords</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'>for</span> <span class='op'>(</span><span class='va'>j</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>coords</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>      <span class='kw'>if</span> <span class='op'>(</span><span class='va'>j</span> <span class='op'>&lt;=</span> <span class='va'>i</span><span class='op'>)</span> <span class='kw'>next</span></span>
<span></span>
<span><span class='co'># calculating the distance between circles     </span></span>
<span>      <span class='va'>dx</span>   <span class='op'>&lt;-</span> <span class='va'>coords</span><span class='op'>[</span><span class='va'>j</span>, <span class='fl'>1</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>coords</span><span class='op'>[</span><span class='va'>i</span>, <span class='fl'>1</span><span class='op'>]</span></span>
<span>      <span class='va'>dy</span>   <span class='op'>&lt;-</span> <span class='va'>coords</span><span class='op'>[</span><span class='va'>j</span>, <span class='fl'>2</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>coords</span><span class='op'>[</span><span class='va'>i</span>, <span class='fl'>2</span><span class='op'>]</span></span>
<span>      <span class='va'>dist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>dx</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>+</span> <span class='va'>dy</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># checking for overlap (using the sum of both radii plus padding)</span></span>
<span>      <span class='va'>min_dist</span> <span class='op'>&lt;-</span> <span class='va'>radii</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>radii</span><span class='op'>[</span><span class='va'>j</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>circle_padding</span></span>
<span>      </span>
<span><span class='co'># pushing apart overlapping circles</span></span>
<span>      <span class='kw'>if</span> <span class='op'>(</span><span class='va'>dist</span> <span class='op'>&lt;</span> <span class='va'>min_dist</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>        <span class='va'>overlap</span> <span class='op'>&lt;-</span> <span class='va'>min_dist</span> <span class='op'>-</span> <span class='va'>dist</span></span>
<span>        </span>
<span>        <span class='va'>shift_x</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>dx</span> <span class='op'>/</span> <span class='va'>dist</span><span class='op'>)</span> <span class='op'>*</span> <span class='op'>(</span><span class='va'>overlap</span> <span class='op'>/</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span>        <span class='va'>shift_y</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>dy</span> <span class='op'>/</span> <span class='va'>dist</span><span class='op'>)</span> <span class='op'>*</span> <span class='op'>(</span><span class='va'>overlap</span> <span class='op'>/</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span>        </span>
<span>        <span class='va'>coords</span><span class='op'>[</span><span class='va'>i</span>, <span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>coords</span><span class='op'>[</span><span class='va'>i</span>, <span class='fl'>1</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>shift_x</span></span>
<span>        <span class='va'>coords</span><span class='op'>[</span><span class='va'>i</span>, <span class='fl'>2</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>coords</span><span class='op'>[</span><span class='va'>i</span>, <span class='fl'>2</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>shift_y</span></span>
<span>        <span class='va'>coords</span><span class='op'>[</span><span class='va'>j</span>, <span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>coords</span><span class='op'>[</span><span class='va'>j</span>, <span class='fl'>1</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>shift_x</span></span>
<span>        <span class='va'>coords</span><span class='op'>[</span><span class='va'>j</span>, <span class='fl'>2</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>coords</span><span class='op'>[</span><span class='va'>j</span>, <span class='fl'>2</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>shift_y</span></span>
<span>        </span>
<span>        <span class='va'>moved</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span></span>
<span>      <span class='op'>}</span></span>
<span>    <span class='op'>}</span></span>
<span>  <span class='op'>}</span></span>
<span><span class='co'># stopping if an entire iteration passes with no movements</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='va'>moved</span><span class='op'>)</span> <span class='kw'>break</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='co'># storing the adjusted positions</span></span>
<span><span class='va'>cd_plot</span> <span class='op'>&lt;-</span> <span class='va'>cd_plot</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    adj_x          <span class='op'>=</span> <span class='va'>coords</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span>,</span>
<span>    adj_y          <span class='op'>=</span> <span class='va'>coords</span><span class='op'>[</span>, <span class='fl'>2</span><span class='op'>]</span>,</span>
<span>    padding_factor <span class='op'>=</span> <span class='fl'>0.002</span>,</span>
<span>    label_padding  <span class='op'>=</span> <span class='va'>padding_factor</span> <span class='op'>*</span> <span class='va'>y_range</span>,</span>
<span>    label_y        <span class='op'>=</span> <span class='va'>adj_y</span> <span class='op'>+</span> <span class='va'>radius</span> <span class='op'>+</span> <span class='va'>label_padding</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Furthermore, the circular plots in the original visualisation each have a heading of the countrys name above the plot. This also had to be included at this stage in order to check that no more fine-tuning of the positioning of the circular plots on the map was needed.<br />
Finally, we draw the map with the combinations in their adjusted positions and their country name labels above.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>final_EUROMAP</span> <span class='op'>&lt;-</span> <span class='va'>EUROMAP</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/ggimage/man/geom_image.html'>geom_image</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>cd_plot</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span></span>
<span>      x     <span class='op'>=</span> <span class='va'>adj_x</span>,</span>
<span>      y     <span class='op'>=</span> <span class='va'>adj_y</span>,</span>
<span>      image <span class='op'>=</span> <span class='va'>image_path</span>,</span>
<span>      size  <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>geom_size</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    asp <span class='op'>=</span> <span class='fl'>1</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>cd_plot</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span></span>
<span>      x     <span class='op'>=</span> <span class='va'>adj_x</span>,</span>
<span>      y     <span class='op'>=</span> <span class='va'>label_y</span>,</span>
<span>      label <span class='op'>=</span> <span class='va'>country</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    size     <span class='op'>=</span> <span class='fl'>1.5</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>final_EUROMAP</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="100561659_files/figure-html5/unnamed-chunk-30-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<p>The final map with all of the correctly-placed circular plots was then saved in .png format.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># saving the final map with circular plots </span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span></span>
<span>  filename <span class='op'>=</span> <span class='st'>"final_EUROMAP.png"</span>,</span>
<span>  plot <span class='op'>=</span> <span class='va'>final_EUROMAP</span>,</span>
<span>  width <span class='op'>=</span> <span class='fl'>22.5</span>,</span>
<span>  height <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  units <span class='op'>=</span> <span class='st'>"cm"</span>,</span>
<span>  dpi <span class='op'>=</span> <span class='fl'>300</span>,</span>
<span>  bg <span class='op'>=</span> <span class='st'>"white"</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>All in all, this was a very involved stage of the replication process that required a lot of research, hours of trial and error, and many failed attempts.</p>
<h2 id="making-the-legend">MAKING THE LEGEND</h2>
<p>Now that the main map is created it was time to start constructing the other elements of the original plot. First, the legend in the upper-left corner of the original visualisation was created.</p>
<p>In order to create the colour scales that are shown in the legend, the colour mixing formulas from the map creation were used again.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># reusing the colour mixing formulas to create the legend's colour scales</span></span>
<span><span class='va'>mix_colors</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>col1</span>, <span class='va'>col2</span>, <span class='va'>p</span> <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='va'>c1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/col2rgb.html'>col2rgb</a></span><span class='op'>(</span><span class='va'>col1</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>255</span></span>
<span>  <span class='va'>c2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/col2rgb.html'>col2rgb</a></span><span class='op'>(</span><span class='va'>col2</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>255</span></span>
<span>  <span class='va'>mix</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>p</span><span class='op'>)</span> <span class='op'>*</span> <span class='va'>c1</span> <span class='op'>+</span> <span class='va'>p</span> <span class='op'>*</span> <span class='va'>c2</span></span>
<span>  <span class='fu'>grDevices</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grDevices/rgb.html'>rgb</a></span><span class='op'>(</span><span class='va'>mix</span><span class='op'>[</span><span class='fl'>1</span>, <span class='op'>]</span>, <span class='va'>mix</span><span class='op'>[</span><span class='fl'>2</span>, <span class='op'>]</span>, <span class='va'>mix</span><span class='op'>[</span><span class='fl'>3</span>, <span class='op'>]</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='va'>darken_color</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>col</span>, <span class='va'>p</span> <span class='op'>=</span> <span class='fl'>0.25</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='va'>col_rgb</span>  <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/col2rgb.html'>col2rgb</a></span><span class='op'>(</span><span class='va'>col</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>255</span></span>
<span>  <span class='va'>dark_rgb</span> <span class='op'>&lt;-</span> <span class='va'>col_rgb</span> <span class='op'>*</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>p</span><span class='op'>)</span></span>
<span>  <span class='fu'>grDevices</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grDevices/rgb.html'>rgb</a></span><span class='op'>(</span><span class='va'>dark_rgb</span><span class='op'>[</span><span class='fl'>1</span>, <span class='op'>]</span>, <span class='va'>dark_rgb</span><span class='op'>[</span><span class='fl'>2</span>, <span class='op'>]</span>, <span class='va'>dark_rgb</span><span class='op'>[</span><span class='fl'>3</span>, <span class='op'>]</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span></code></pre>
</div>
</div>
<p>Next, the data required to make the legend was reconstructed and manipulated:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>parties</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"EPP"</span>, <span class='st'>"S&amp;D"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"Renew"</span>, <span class='st'>"ECR"</span>, <span class='st'>"Greens/EFA"</span>, <span class='st'>"The Left"</span>, <span class='st'>"ESN"</span>, <span class='st'>"NI"</span><span class='op'>)</span>,</span>
<span>  label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Group of the European People's Party (Christian Democrats)"</span>,</span>
<span>            <span class='st'>"Group of the Progressive Alliance of Socialists and Democrats"</span>,</span>
<span>            <span class='st'>"Patriots for Europe Group"</span>,</span>
<span>            <span class='st'>"Renew Europe Group"</span>,</span>
<span>            <span class='st'>"European Conservatives and Reformists Group"</span>,</span>
<span>            <span class='st'>"Group of the Greens/European Free Alliance"</span>,</span>
<span>            <span class='st'>"The Left group in the European Parliament - GUE/NGL"</span>,</span>
<span>            <span class='st'>"Europe of Sovereign Nations Group"</span>,</span>
<span>            <span class='st'>"Non-attached Members"</span><span class='op'>)</span>,</span>
<span>  vote <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>23.5</span>, <span class='fl'>17.4</span>, <span class='fl'>10.5</span>, <span class='fl'>10.1</span>, <span class='fl'>9.9</span>, <span class='fl'>8.1</span>, <span class='fl'>7.8</span>, <span class='fl'>4.5</span>, <span class='fl'>4.3</span><span class='op'>)</span>,</span>
<span>  seats <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>188</span>, <span class='fl'>136</span>, <span class='fl'>84</span>, <span class='fl'>77</span>, <span class='fl'>78</span>, <span class='fl'>53</span>, <span class='fl'>46</span>, <span class='fl'>25</span>, <span class='fl'>33</span><span class='op'>)</span>,</span>
<span>  stringsAsFactors <span class='op'>=</span> <span class='cn'>FALSE</span></span>
<span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span><span class='co'># reversing the order</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    row <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/row_number.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span><span class='co'># creating the colour key</span></span>
<span>    col_key <span class='op'>=</span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/recode.html'>recode</a></span><span class='op'>(</span></span>
<span>      <span class='va'>party</span>,</span>
<span>      <span class='st'>"EPP"</span>        <span class='op'>=</span> <span class='st'>"EPP"</span>,</span>
<span>      <span class='st'>"S&amp;D"</span>        <span class='op'>=</span> <span class='st'>"SD"</span>,</span>
<span>      <span class='st'>"Patriots"</span>   <span class='op'>=</span> <span class='st'>"Patriots"</span>,</span>
<span>      <span class='st'>"Renew"</span>      <span class='op'>=</span> <span class='st'>"Renew"</span>,</span>
<span>      <span class='st'>"ECR"</span>        <span class='op'>=</span> <span class='st'>"ECR"</span>,</span>
<span>      <span class='st'>"Greens/EFA"</span> <span class='op'>=</span> <span class='st'>"GREENSEFA"</span>,</span>
<span>      <span class='st'>"The Left"</span>   <span class='op'>=</span> <span class='st'>"Theleft"</span>,</span>
<span>      <span class='st'>"ESN"</span>        <span class='op'>=</span> <span class='st'>"ESN"</span>,</span>
<span>      <span class='st'>"NI"</span>         <span class='op'>=</span> <span class='st'>"NI"</span></span>
<span>    <span class='op'>)</span>,</span>
<span><span class='co'># assigning the colours from the globally designed colour vector</span></span>
<span>    col <span class='op'>=</span> <span class='va'>custom_cols</span><span class='op'>[</span><span class='va'>col_key</span><span class='op'>]</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># creating percentages categories</span></span>
<span><span class='va'>percentages</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span></span>
<span>  percentages_idx <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>7</span>,</span>
<span>  percentages_lab <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"-25"</span>,<span class='st'>"25"</span>,<span class='st'>"30"</span>,<span class='st'>"35"</span>,<span class='st'>"40"</span>,<span class='st'>"45"</span>,<span class='st'>"50+"</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># combining all parties with percentages</span></span>
<span><span class='va'>percentages_blocks</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tidyr.tidyverse.org/reference/expand_grid.html'>expand_grid</a></span><span class='op'>(</span><span class='va'>parties</span>, <span class='va'>percentages</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># identifiying the parties that get a scale bar</span></span>
<span><span class='va'>parties_with_scale</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"EPP"</span>,<span class='st'>"S&amp;D"</span>,<span class='st'>"Patriots"</span>,<span class='st'>"Renew"</span>,<span class='st'>"ECR"</span>,<span class='st'>"NI"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># splitting the parties in to groups of scale bar/  no scale bar</span></span>
<span><span class='va'>parties_scale</span>    <span class='op'>&lt;-</span> <span class='va'>parties</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>party</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>parties_with_scale</span><span class='op'>)</span></span>
<span><span class='va'>parties_noscale</span>  <span class='op'>&lt;-</span> <span class='va'>parties</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='va'>party</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>parties_with_scale</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># creating percentage blocks</span></span>
<span><span class='va'>scale_blocks</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tidyr.tidyverse.org/reference/expand_grid.html'>expand_grid</a></span><span class='op'>(</span><span class='va'>parties_scale</span>, <span class='va'>percentages</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Following this, the colour gradients for the parties with scale bars are applied to the scale bar segments.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># generating colour palettes for each party</span></span>
<span><span class='va'>legend_palettes</span> <span class='op'>&lt;-</span> <span class='va'>parties_scale</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rowwise.html'>rowwise</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span><span class='co'># getting the base colour</span></span>
<span>    base_col  <span class='op'>=</span> <span class='va'>col</span>,</span>
<span><span class='co'># creating thie light shade</span></span>
<span>    light_col <span class='op'>=</span> <span class='fu'>mix_colors</span><span class='op'>(</span><span class='st'>"#FFFFFF"</span>, <span class='va'>base_col</span>, p <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>,</span>
<span><span class='co'># creating the dark shade</span></span>
<span>    dark_col  <span class='op'>=</span> <span class='fu'>darken_color</span><span class='op'>(</span><span class='va'>base_col</span>, p <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>,</span>
<span><span class='co'># creating a 7 colour gradient</span></span>
<span>    pal       <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'>grDevices</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>light_col</span>, <span class='va'>dark_col</span><span class='op'>)</span><span class='op'>)</span><span class='op'>(</span><span class='fl'>7</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span><span class='co'># keeping only the needed columns</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>party</span>, <span class='va'>pal</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span><span class='co'># expanding palettes into individual colours (i.e. multiple rows from one row)</span></span>
<span>  <span class='fu'>tidyr</span><span class='fu'>::</span><span class='fu'><a href='https://tidyr.tidyverse.org/reference/unnest_longer.html'>unnest_longer</a></span><span class='op'>(</span><span class='va'>pal</span>, indices_to <span class='op'>=</span> <span class='st'>"percentages_idx"</span>, values_to <span class='op'>=</span> <span class='st'>"scale_col"</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span><span class='co'># converting to integer type for joining</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    percentages_idx <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='va'>percentages_idx</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># attaching the shaded colours to each scale-bar tile</span></span>
<span><span class='va'>scale_blocks_shaded</span> <span class='op'>&lt;-</span> <span class='va'>scale_blocks</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>legend_palettes</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"party"</span>, <span class='st'>"percentages_idx"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Finally, it is time to create the visual plot of the legend.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># crearing the visual plot of the legend</span></span>
<span><span class='va'>legend_plot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span><span class='co'># creating the main bar for parties with a scale bar </span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_tile.html'>geom_rect</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>parties_scale</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>xmin <span class='op'>=</span> <span class='fl'>0.5</span>, xmax <span class='op'>=</span> <span class='fl'>7.5</span>,</span>
<span>        ymin <span class='op'>=</span> <span class='va'>row</span> <span class='op'>-</span> <span class='fl'>0.45</span>, ymax <span class='op'>=</span> <span class='va'>row</span> <span class='op'>+</span> <span class='fl'>0.25</span>,</span>
<span>        fill <span class='op'>=</span> <span class='va'>col</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span><span class='co'># creating the main bar for parties with no scale bar </span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_tile.html'>geom_rect</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>parties_noscale</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>xmin <span class='op'>=</span> <span class='fl'>0.5</span>, xmax <span class='op'>=</span> <span class='fl'>7.5</span>,</span>
<span>        ymin <span class='op'>=</span> <span class='va'>row</span> <span class='op'>-</span> <span class='fl'>0.45</span>, ymax <span class='op'>=</span> <span class='va'>row</span> <span class='op'>+</span> <span class='fl'>0.25</span>,</span>
<span>        fill <span class='op'>=</span> <span class='va'>col</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span><span class='co'># creating the shaded scale bar</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_tile.html'>geom_rect</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>scale_blocks_shaded</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>xmin <span class='op'>=</span> <span class='va'>percentages_idx</span> <span class='op'>-</span> <span class='fl'>0.5</span>, xmax <span class='op'>=</span> <span class='va'>percentages_idx</span> <span class='op'>+</span> <span class='fl'>0.5</span>,</span>
<span>        ymin <span class='op'>=</span> <span class='va'>row</span> <span class='op'>+</span> <span class='fl'>0.25</span>, ymax <span class='op'>=</span> <span class='va'>row</span> <span class='op'>+</span> <span class='fl'>0.45</span>,</span>
<span>        fill <span class='op'>=</span> <span class='va'>scale_col</span><span class='op'>)</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"white"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.35</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span><span class='co'># creating the grid lines only in the scale bar area</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_tile.html'>geom_rect</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>percentages_blocks</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>party</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>parties_with_scale</span><span class='op'>)</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>xmin <span class='op'>=</span> <span class='va'>percentages_idx</span> <span class='op'>-</span> <span class='fl'>0.5</span>, xmax <span class='op'>=</span> <span class='va'>percentages_idx</span> <span class='op'>+</span> <span class='fl'>0.5</span>,</span>
<span>        ymin <span class='op'>=</span> <span class='va'>row</span> <span class='op'>+</span> <span class='fl'>0.25</span>, ymax <span class='op'>=</span> <span class='va'>row</span> <span class='op'>+</span> <span class='fl'>0.45</span><span class='op'>)</span>,</span>
<span>    fill <span class='op'>=</span> <span class='cn'>NA</span>, colour <span class='op'>=</span> <span class='st'>"white"</span>, linewidth <span class='op'>=</span> <span class='fl'>0.35</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span><span class='co'># adding the group names in the correct colours</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>parties</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>0.7</span>, y <span class='op'>=</span> <span class='va'>row</span> <span class='op'>-</span> <span class='fl'>0.02</span>, label <span class='op'>=</span> <span class='va'>party</span>,</span>
<span>        colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>party</span> <span class='op'>==</span> <span class='st'>"Renew"</span>, <span class='st'>"black"</span>, <span class='st'>"white"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>, hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>5</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span><span class='co'># adding the subtitles in the correct colours</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>parties</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>0.7</span>, y <span class='op'>=</span> <span class='va'>row</span> <span class='op'>-</span> <span class='fl'>0.28</span>, label <span class='op'>=</span> <span class='va'>label</span>,</span>
<span>        colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>party</span> <span class='op'>==</span> <span class='st'>"Renew"</span>, <span class='st'>"black"</span>, <span class='st'>"white"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0</span>, size <span class='op'>=</span> <span class='fl'>2</span>, fontface <span class='op'>=</span> <span class='st'>"italic"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span><span class='co'># adding the percentage headers aligned over scale-bar chunks</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>percentages</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>percentages_idx</span>, y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>parties</span><span class='op'>$</span><span class='va'>row</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>0.6</span>, label <span class='op'>=</span> <span class='va'>percentages_lab</span><span class='op'>)</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>, size <span class='op'>=</span> <span class='fl'>3.3</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span><span class='co'># adding the headers for Vote % and Seats to the right hand side</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>8.8</span>, y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>parties</span><span class='op'>$</span><span class='va'>row</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>0.8</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"Vote %"</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span>, size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotate.html'>annotate</a></span><span class='op'>(</span><span class='st'>"text"</span>, x <span class='op'>=</span> <span class='fl'>11</span>, y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>parties</span><span class='op'>$</span><span class='va'>row</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>0.8</span>,</span>
<span>           label <span class='op'>=</span> <span class='st'>"Seats"</span>, fontface <span class='op'>=</span> <span class='st'>"bold"</span>, size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  </span>
<span><span class='co'># adding the Vote % and Seats data</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>parties</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>8.8</span>, y <span class='op'>=</span> <span class='va'>row</span>,</span>
<span>        label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span><span class='op'>(</span><span class='st'>"%.1f"</span>, <span class='va'>vote</span><span class='op'>)</span>,</span>
<span>        colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>party</span> <span class='op'>==</span> <span class='st'>"Renew"</span>, <span class='st'>"black"</span>, <span class='va'>col</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>, size <span class='op'>=</span> <span class='fl'>5</span>, hjust <span class='op'>=</span> <span class='fl'>0.5</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>parties</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>11</span>, y <span class='op'>=</span> <span class='va'>row</span>,</span>
<span>        label <span class='op'>=</span> <span class='va'>seats</span>,</span>
<span>        colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>party</span> <span class='op'>==</span> <span class='st'>"Renew"</span>, <span class='st'>"black"</span>, <span class='va'>col</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>, size <span class='op'>=</span> <span class='fl'>5</span>, hjust <span class='op'>=</span> <span class='fl'>0.5</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span><span class='co'># applying the styling and coordinate settings to finalise the visualisation</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_identity.html'>scale_fill_identity</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_identity.html'>scale_colour_identity</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span></span>
<span>    xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>11</span><span class='op'>)</span>,</span>
<span>    ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>parties</span><span class='op'>$</span><span class='va'>row</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>1.6</span><span class='op'>)</span>,</span>
<span>    clip <span class='op'>=</span> <span class='st'>"off"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_void</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>40</span>, <span class='fl'>5</span>, <span class='fl'>5</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='va'>legend_plot</span></span></code></pre>
</div>
<p><img src="100561659_files/figure-html5/unnamed-chunk-35-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># saving the legend with the correct proportions to a .png file</span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span></span>
<span>  <span class='st'>"legend_check.png"</span>,</span>
<span>  <span class='va'>legend_plot</span>,</span>
<span>  width  <span class='op'>=</span> <span class='fl'>12</span>,</span>
<span>  height <span class='op'>=</span> <span class='fl'>15</span>,</span>
<span>  units  <span class='op'>=</span> <span class='st'>"cm"</span>,</span>
<span>  dpi    <span class='op'>=</span> <span class='fl'>500</span>,</span>
<span>  bg     <span class='op'>=</span> <span class='st'>"white"</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>legend_plot</span></span></code></pre>
</div>
<p><img src="100561659_files/figure-html5/unnamed-chunk-36-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<p>Overall making this legend was much more time consuming and difficult than originally anticipated.</p>
<h2 id="making-the-circular-legend">MAKING THE CIRCULAR LEGEND</h2>
<p>Next, the donut legend was created. This tells the viewer that the donuts of the combined plots depict the percentage of the total vote recieved by each European Parliament Group, and that the parliament plot refers to the absolute number of seats won by each of these groups. This small piece of the project was perhaps one of the most unexpectedly dufficult to recreate - mainly owing to the fact that it required placing curved arrows on top of a plot with a polar coordinate system.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  party <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>custom_cols</span><span class='op'>)</span>,</span>
<span>  value <span class='op'>=</span> <span class='fl'>1</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='va'>party_order</span> <span class='op'>&lt;-</span> <span class='va'>party_order</span><span class='op'>[</span><span class='va'>party_order</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>df</span><span class='op'>$</span><span class='va'>party</span><span class='op'>]</span></span>
<span><span class='va'>df</span><span class='op'>$</span><span class='va'>party</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>$</span><span class='va'>party</span>, levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='va'>party_order</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>circle_path</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>radius</span>, <span class='va'>total</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='va'>radius</span>,</span>
<span>    y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='va'>total</span>, length.out <span class='op'>=</span> <span class='fl'>400</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='va'>total_angle</span>  <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>$</span><span class='va'>value</span><span class='op'>)</span></span>
<span><span class='va'>outer_radius</span> <span class='op'>&lt;-</span> <span class='fl'>2.5</span></span>
<span><span class='va'>inner_radius</span> <span class='op'>&lt;-</span> <span class='fl'>1.2</span></span>
<span></span>
<span><span class='va'>outer_circle</span> <span class='op'>&lt;-</span> <span class='fu'>circle_path</span><span class='op'>(</span><span class='va'>outer_radius</span>, <span class='va'>total_angle</span><span class='op'>)</span></span>
<span><span class='va'>inner_circle</span> <span class='op'>&lt;-</span> <span class='fu'>circle_path</span><span class='op'>(</span><span class='va'>inner_radius</span>, <span class='va'>total_angle</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># defining the central disk radius</span></span>
<span><span class='va'>center_radius</span> <span class='op'>&lt;-</span> <span class='fl'>0.5</span></span>
<span><span class='va'>x_center</span>      <span class='op'>&lt;-</span> <span class='va'>center_radius</span> <span class='op'>/</span> <span class='fl'>2</span></span>
<span><span class='va'>width_center</span>  <span class='op'>&lt;-</span> <span class='va'>center_radius</span></span>
<span></span>
<span><span class='co'># defining the inner-circle outline (for the central disk)</span></span>
<span><span class='va'>inner_circle_outline</span> <span class='op'>&lt;-</span> <span class='fu'>circle_path</span><span class='op'>(</span><span class='va'>center_radius</span>, <span class='va'>total_angle</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># making a quadratic Bezier helper function: allows us to make a curved path in top of the polar coordinates</span></span>
<span><span class='va'>make_curve</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x0</span>, <span class='va'>y0</span>, <span class='va'>x1</span>, <span class='va'>y1</span>, <span class='va'>xc</span>, <span class='va'>yc</span>, <span class='va'>n</span> <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='va'>t</span>  <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, length.out <span class='op'>=</span> <span class='va'>n</span><span class='op'>)</span></span>
<span>  <span class='va'>x</span>  <span class='op'>&lt;-</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>t</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>*</span> <span class='va'>x0</span> <span class='op'>+</span> <span class='fl'>2</span> <span class='op'>*</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>t</span><span class='op'>)</span> <span class='op'>*</span> <span class='va'>t</span> <span class='op'>*</span> <span class='va'>xc</span> <span class='op'>+</span> <span class='va'>t</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>*</span> <span class='va'>x1</span></span>
<span>  <span class='va'>y</span>  <span class='op'>&lt;-</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>t</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>*</span> <span class='va'>y0</span> <span class='op'>+</span> <span class='fl'>2</span> <span class='op'>*</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>t</span><span class='op'>)</span> <span class='op'>*</span> <span class='va'>t</span> <span class='op'>*</span> <span class='va'>yc</span> <span class='op'>+</span> <span class='va'>t</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>*</span> <span class='va'>y1</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='va'>arrow_tail_radius</span> <span class='op'>&lt;-</span> <span class='fl'>4.5</span>  <span class='co'># outside donut (outer_radius = 2.5)</span></span>
<span><span class='co'>#arrow_tail_radius_2 &lt;- 3 # for seats arroe</span></span>
<span></span>
<span><span class='co'># making the first curved arrow (bottom of donut) ---------------------------------</span></span>
<span><span class='va'>arrow_df</span> <span class='op'>&lt;-</span> <span class='fu'>make_curve</span><span class='op'>(</span></span>
<span>  x0 <span class='op'>=</span> <span class='va'>arrow_tail_radius</span>,           <span class='co'># start radius (outside donut)</span></span>
<span>  y0 <span class='op'>=</span> <span class='va'>total_angle</span> <span class='op'>*</span> <span class='fl'>0.40</span>,          <span class='co'># start angle</span></span>
<span>  x1 <span class='op'>=</span> <span class='va'>x_center</span> <span class='op'>+</span> <span class='fl'>0.01</span>,             <span class='co'># end radius (just at the centre disk)</span></span>
<span>  y1 <span class='op'>=</span> <span class='va'>total_angle</span> <span class='op'>*</span> <span class='fl'>0.35</span>,          <span class='co'># end angle</span></span>
<span>  xc <span class='op'>=</span> <span class='fl'>2.5</span>,                         <span class='co'># control radius (controls bend)</span></span>
<span>  yc <span class='op'>=</span> <span class='va'>total_angle</span> <span class='op'>*</span> <span class='fl'>0.38</span>           <span class='co'># control angle</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># making the second curved arrow (pointing to top of donut) </span></span>
<span><span class='va'>arrow_df_top</span> <span class='op'>&lt;-</span> <span class='fu'>make_curve</span><span class='op'>(</span></span>
<span>  x0 <span class='op'>=</span> <span class='va'>arrow_tail_radius</span>,           <span class='co'># tail outside donut</span></span>
<span>  y0 <span class='op'>=</span> <span class='va'>total_angle</span> <span class='op'>*</span> <span class='fl'>0.07</span>,          <span class='co'># start angle near top</span></span>
<span>  x1 <span class='op'>=</span> <span class='va'>outer_radius</span> <span class='op'>+</span> <span class='op'>-</span><span class='fl'>0.5</span>,         <span class='co'># end just at outer edge of donut</span></span>
<span>  y1 <span class='op'>=</span> <span class='va'>total_angle</span> <span class='op'>*</span> <span class='fl'>0</span>,          <span class='co'># angle around top; tweak if needed</span></span>
<span>  xc <span class='op'>=</span> <span class='fl'>2.2</span>,                         <span class='co'># control radius (further out for a nice bend)</span></span>
<span>  yc <span class='op'>=</span> <span class='va'>total_angle</span> <span class='op'>*</span> <span class='fl'>0.07</span>      <span class='co'># control angle slightly "above" to arc over</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># putting points at the arrow heads (i.e. at the last row of each path)</span></span>
<span><span class='va'>tail1</span> <span class='op'>&lt;-</span> <span class='va'>arrow_df</span><span class='op'>[</span><span class='fl'>1</span>, <span class='op'>]</span></span>
<span><span class='va'>tail2</span> <span class='op'>&lt;-</span> <span class='va'>arrow_df_top</span><span class='op'>[</span><span class='fl'>1</span>, <span class='op'>]</span></span>
<span></span>
<span><span class='va'>donut_key</span> <span class='op'>&lt;-</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>df</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>2</span>, y <span class='op'>=</span> <span class='va'>value</span>, fill <span class='op'>=</span> <span class='va'>party</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_col</a></span><span class='op'>(</span>width <span class='op'>=</span> <span class='fl'>1</span>, colour <span class='op'>=</span> <span class='cn'>NA</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_col</a></span><span class='op'>(</span></span>
<span>    data  <span class='op'>=</span> <span class='va'>df</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x_center</span>, y <span class='op'>=</span> <span class='va'>value</span><span class='op'>)</span>,</span>
<span>    inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>    width  <span class='op'>=</span> <span class='va'>width_center</span>,</span>
<span>    fill   <span class='op'>=</span> <span class='st'>"#b3e5e5"</span>,</span>
<span>    colour <span class='op'>=</span> <span class='cn'>NA</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_path</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>outer_circle</span>,</span>
<span>            <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span>,</span>
<span>            inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>            colour <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>            linewidth <span class='op'>=</span> <span class='fl'>1.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_path</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>inner_circle</span>,</span>
<span>            <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span>,</span>
<span>            inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>            colour <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>            linewidth <span class='op'>=</span> <span class='fl'>1.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_path</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>inner_circle_outline</span>,</span>
<span>            <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span>,</span>
<span>            inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>            colour <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>            linewidth <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_path</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>arrow_df</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span>,</span>
<span>    inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='st'>"mm"</span><span class='op'>)</span>, type <span class='op'>=</span> <span class='st'>"closed"</span><span class='op'>)</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>1</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_path</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>arrow_df_top</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span>,</span>
<span>    inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>    arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='st'>"mm"</span><span class='op'>)</span>, type <span class='op'>=</span> <span class='st'>"closed"</span><span class='op'>)</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>1</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span><span class='co'># putting the labels on the arrows</span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>  data <span class='op'>=</span> <span class='va'>tail1</span>,</span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span> <span class='op'>+</span> <span class='fl'>0.25</span>, y <span class='op'>=</span> <span class='va'>y</span> <span class='op'>+</span> <span class='fl'>0.35</span>, label <span class='op'>=</span> <span class='st'>"Seats"</span><span class='op'>)</span>,</span>
<span>  inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>  size <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>  hjust <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>  fontface <span class='op'>=</span> <span class='st'>"italic"</span></span>
<span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>tail2</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span> <span class='op'>+</span> <span class='fl'>0.4</span>, y <span class='op'>=</span> <span class='va'>y</span> <span class='op'>+</span> <span class='op'>-</span><span class='fl'>0.38</span>, label <span class='op'>=</span> <span class='st'>"Vote %"</span><span class='op'>)</span>,</span>
<span>    inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>    hjust <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"italic"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_radial.html'>coord_polar</a></span><span class='op'>(</span>theta <span class='op'>=</span> <span class='st'>"y"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>custom_cols</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>xlim</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='va'>arrow_tail_radius</span> <span class='op'>+</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_void</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>donut_key</span></span></code></pre>
</div>
<p><img src="100561659_files/figure-html5/unnamed-chunk-37-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># saving the donut key as a .png file</span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span></span>
<span>  <span class='st'>"donut_key.png"</span>,</span>
<span>  <span class='va'>donut_key</span>,</span>
<span>  width  <span class='op'>=</span> <span class='fl'>12</span>,</span>
<span>  height <span class='op'>=</span> <span class='fl'>12</span> ,</span>
<span>  units  <span class='op'>=</span> <span class='st'>"cm"</span>,</span>
<span>  dpi    <span class='op'>=</span> <span class='fl'>500</span>,</span>
<span>  bg     <span class='op'>=</span> <span class='st'>"transparent"</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h2 id="making-the-zoom-in-map-section">MAKING THE ZOOM IN MAP SECTION</h2>
<p>Last but not least, the zoomed in map sections present in the upper-right corner of the original plot had to be recreated. Initially, the map portion of the three geographical areas represented in the zoom areas were individually created, then they were recreated with the appropriate circle plots overlaid on top.</p>
<p>Step by step, for each final zoomed in area the process included:<br />
- sizing the circular plots based on population<br />
- finding where to place them (country centroids)<br />
- saving the circles as .png files<br />
- creating a zoomed map of the relevant region<br />
- overlaying the circular plots at each countrys location<br />
- adding country name labels above each circle</p>
<h3 id="data-creation">DATA CREATION</h3>
<p>Before the zoom maps were made, the population data for these regions had to be added to the environment.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>benelux_populations</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  country <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Belgium"</span>, <span class='st'>"Netherlands"</span>, <span class='st'>"Luxembourg"</span><span class='op'>)</span>,</span>
<span>  </span>
<span>  country_code <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"be"</span>, <span class='st'>"nl"</span>, <span class='st'>"lu"</span><span class='op'>)</span>,</span>
<span>  </span>
<span>  population <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>11800000</span>, <span class='fl'>18000000</span>, <span class='fl'>700000</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>malta_populations</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  country <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Malta"</span><span class='op'>)</span>,</span>
<span>  </span>
<span>  country_code <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"mt"</span><span class='op'>)</span>,</span>
<span>  </span>
<span>  population <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>600000</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>cyprus_populations</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  country <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Cyprus"</span><span class='op'>)</span>,</span>
<span>  </span>
<span>  country_code <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"cy"</span><span class='op'>)</span>,</span>
<span>  </span>
<span>  population <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1400000</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 id="benelux-region">BENELUX REGION</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># making the map of the Benelux zoom box</span></span>
<span><span class='co'># filtering only the relevant countries</span></span>
<span><span class='va'>benelux</span> <span class='op'>&lt;-</span> <span class='va'>final_map</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>country</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Belgium"</span>, <span class='st'>"Netherlands"</span>, <span class='st'>"Luxembourg"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># getting the bounding box (minimum square coordinates) of the countries</span></span>
<span><span class='va'>bb_ben</span> <span class='op'>&lt;-</span> <span class='fu'>sf</span><span class='fu'>::</span><span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_bbox.html'>st_bbox</a></span><span class='op'>(</span><span class='va'>benelux</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># adding padding for aesthetics</span></span>
<span><span class='va'>xpad_ben</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>bb_ben</span><span class='op'>[</span><span class='st'>"xmax"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>bb_ben</span><span class='op'>[</span><span class='st'>"xmin"</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>0.15</span></span>
<span><span class='va'>ypad_ben</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>bb_ben</span><span class='op'>[</span><span class='st'>"ymax"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>bb_ben</span><span class='op'>[</span><span class='st'>"ymin"</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>0.15</span></span>
<span></span>
<span><span class='co'># creating the zoomed map</span></span>
<span><span class='va'>zoom_benelux</span> <span class='op'>&lt;-</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsf.html'>geom_sf</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>final_map</span>,              </span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='va'>party_band</span><span class='op'>)</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"white"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>fill_values</span>, na.value <span class='op'>=</span> <span class='st'>"grey90"</span>, guide <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span><span class='co'># cropping the view to just the Benelux area</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsf.html'>coord_sf</a></span><span class='op'>(</span></span>
<span>    xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>bb_ben</span><span class='op'>[</span><span class='st'>"xmin"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>xpad_ben</span>, <span class='va'>bb_ben</span><span class='op'>[</span><span class='st'>"xmax"</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>xpad_ben</span><span class='op'>)</span>,</span>
<span>    ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>bb_ben</span><span class='op'>[</span><span class='st'>"ymin"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>ypad_ben</span>, <span class='va'>bb_ben</span><span class='op'>[</span><span class='st'>"ymax"</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>ypad_ben</span><span class='op'>)</span>,</span>
<span>    expand <span class='op'>=</span> <span class='cn'>FALSE</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_void</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>zoom_benelux</span></span></code></pre>
</div>
<p><img src="100561659_files/figure-html5/unnamed-chunk-42-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<p>Once this was created correctly, the map section was created again, this time with the relevant circular plots overlaid.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># creating the final map of the Benelux zoom box</span></span>
<span><span class='co'># calculating the plot sizes based on populaitons</span></span>
<span><span class='va'>benelux_sizes</span> <span class='op'>&lt;-</span> <span class='va'>benelux_populations</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    log_pop <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>population</span><span class='op'>)</span>,</span>
<span>    plot_size <span class='op'>=</span> <span class='fu'><a href='https://scales.r-lib.org/reference/rescale.html'>rescale</a></span><span class='op'>(</span></span>
<span>      <span class='va'>log_pop</span>,</span>
<span>      to   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>6</span><span class='op'>)</span>,</span>
<span>      from <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>population</span><span class='op'>)</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>population</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># calculating the centroids for the Benelux countries (same process as before)</span></span>
<span><span class='va'>benelux_sf</span> <span class='op'>&lt;-</span> <span class='va'>final_map</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>country</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>benelux_populations</span><span class='op'>$</span><span class='va'>country</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>country</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span></span>
<span>    geometry <span class='op'>=</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/geos_combine.html'>st_union</a></span><span class='op'>(</span><span class='va'>geometry</span><span class='op'>)</span>,</span>
<span>    .groups <span class='op'>=</span> <span class='st'>"drop"</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_as_sf.html'>st_as_sf</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>centroids</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/geos_unary.html'>st_centroid</a></span><span class='op'>(</span><span class='va'>benelux_sf</span><span class='op'>)</span></span>
<span><span class='va'>coords</span>    <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_coordinates.html'>st_coordinates</a></span><span class='op'>(</span><span class='va'>centroids</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>benelux_centroids</span> <span class='op'>&lt;-</span> <span class='va'>benelux_sf</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_geometry.html'>st_drop_geometry</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    centroid_x <span class='op'>=</span> <span class='va'>coords</span><span class='op'>[</span>, <span class='st'>"X"</span><span class='op'>]</span>,</span>
<span>    centroid_y <span class='op'>=</span> <span class='va'>coords</span><span class='op'>[</span>, <span class='st'>"Y"</span><span class='op'>]</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># combining the centroid positions with plot sizes</span></span>
<span><span class='va'>benelux_data</span> <span class='op'>&lt;-</span> <span class='va'>benelux_centroids</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>benelux_sizes</span>, by <span class='op'>=</span> <span class='st'>"country"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># saving the country plots as .png images (also like befoere)</span></span>
<span><span class='va'>output_dir</span> <span class='op'>&lt;-</span> <span class='st'>"benelux_plots"</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/files2.html'>dir.create</a></span><span class='op'>(</span><span class='va'>output_dir</span>, showWarnings <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>benelux_data</span><span class='op'>$</span><span class='va'>image_path</span> <span class='op'>&lt;-</span> <span class='cn'>NA_character_</span></span>
<span></span>
<span><span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>benelux_data</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='va'>country_name</span> <span class='op'>&lt;-</span> <span class='va'>benelux_data</span><span class='op'>$</span><span class='va'>country</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span></span>
<span>  <span class='va'>country_code</span> <span class='op'>&lt;-</span> <span class='va'>benelux_data</span><span class='op'>$</span><span class='va'>country_code</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span></span>
<span>  <span class='va'>plot_size</span>    <span class='op'>&lt;-</span> <span class='va'>benelux_data</span><span class='op'>$</span><span class='va'>plot_size</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span></span>
<span>  </span>
<span><span class='co'># expecting be_final, nl_final, lu_final</span></span>
<span>  <span class='va'>plot_name</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>country_code</span>, <span class='st'>"_final"</span><span class='op'>)</span></span>
<span>  </span>
<span>  </span>
<span>  </span>
<span>  <span class='va'>existing_plot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/get.html'>get</a></span><span class='op'>(</span><span class='va'>plot_name</span><span class='op'>)</span></span>
<span>  <span class='va'>img_file</span>      <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='va'>output_dir</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>country_name</span>, <span class='st'>".png"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># saving the sized plots </span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span></span>
<span>    filename <span class='op'>=</span> <span class='va'>img_file</span>,</span>
<span>    plot     <span class='op'>=</span> <span class='va'>existing_plot</span>,</span>
<span>    width    <span class='op'>=</span> <span class='va'>plot_size</span>,</span>
<span>    height   <span class='op'>=</span> <span class='va'>plot_size</span>,</span>
<span>    dpi      <span class='op'>=</span> <span class='fl'>300</span>,</span>
<span>    bg       <span class='op'>=</span> <span class='st'>"transparent"</span></span>
<span>  <span class='op'>)</span></span>
<span>  </span>
<span>  <span class='va'>benelux_data</span><span class='op'>$</span><span class='va'>image_path</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>img_file</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span></span>
<span><span class='co'># using overall map height to convert relative sizes</span></span>
<span><span class='va'>bbox</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_bbox.html'>st_bbox</a></span><span class='op'>(</span><span class='va'>final_map</span><span class='op'>)</span></span>
<span><span class='va'>y_range</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>bbox</span><span class='op'>[</span><span class='st'>"ymax"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>bbox</span><span class='op'>[</span><span class='st'>"ymin"</span><span class='op'>]</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>benelux_data</span> <span class='op'>&lt;-</span> <span class='va'>benelux_data</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    geom_size <span class='op'>=</span> <span class='va'>plot_size</span> <span class='op'>*</span> <span class='fl'>0.05</span>,</span>
<span>    img_height_data <span class='op'>=</span> <span class='va'>geom_size</span> <span class='op'>*</span> <span class='va'>y_range</span>,</span>
<span>    radius <span class='op'>=</span> <span class='va'>img_height_data</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    </span>
<span>    adj_x <span class='op'>=</span> <span class='va'>centroid_x</span>,</span>
<span>    adj_y <span class='op'>=</span> <span class='va'>centroid_y</span>,</span>
<span>    </span>
<span><span class='co'># positioning the name labels just above the circles</span></span>
<span>    label_y <span class='op'>=</span> <span class='va'>adj_y</span> <span class='op'>+</span> <span class='fl'>0.14</span> <span class='op'>*</span> <span class='va'>radius</span>  </span>
<span>  <span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='co'># recreating the Benelux zoom base map</span></span>
<span><span class='va'>benelux_poly</span> <span class='op'>&lt;-</span> <span class='va'>final_map</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>country</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Belgium"</span>, <span class='st'>"Netherlands"</span>, <span class='st'>"Luxembourg"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>bb_ben</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_bbox.html'>st_bbox</a></span><span class='op'>(</span><span class='va'>benelux</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>xpad_ben</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>bb_ben</span><span class='op'>[</span><span class='st'>"xmax"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>bb_ben</span><span class='op'>[</span><span class='st'>"xmin"</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>0.15</span></span>
<span><span class='va'>ypad_ben</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>bb_ben</span><span class='op'>[</span><span class='st'>"ymax"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>bb_ben</span><span class='op'>[</span><span class='st'>"ymin"</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>0.15</span></span>
<span></span>
<span><span class='va'>zoom_benelux</span> <span class='op'>&lt;-</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsf.html'>geom_sf</a></span><span class='op'>(</span></span>
<span>    data   <span class='op'>=</span> <span class='va'>final_map</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='va'>party_band</span><span class='op'>)</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"white"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>fill_values</span>, na.value <span class='op'>=</span> <span class='st'>"grey90"</span>, guide <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsf.html'>coord_sf</a></span><span class='op'>(</span></span>
<span>    xlim   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>bb_ben</span><span class='op'>[</span><span class='st'>"xmin"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>xpad_ben</span>, <span class='va'>bb_ben</span><span class='op'>[</span><span class='st'>"xmax"</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>xpad_ben</span><span class='op'>)</span>,</span>
<span>    ylim   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>bb_ben</span><span class='op'>[</span><span class='st'>"ymin"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>ypad_ben</span>, <span class='va'>bb_ben</span><span class='op'>[</span><span class='st'>"ymax"</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>ypad_ben</span><span class='op'>)</span>,</span>
<span>    expand <span class='op'>=</span> <span class='cn'>FALSE</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_void</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># adding the  circular plots on top of the map</span></span>
<span><span class='va'>zoom_benelux_with_circles</span> <span class='op'>&lt;-</span></span>
<span>  <span class='va'>zoom_benelux</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/ggimage/man/geom_image.html'>geom_image</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>benelux_data</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span></span>
<span>      x     <span class='op'>=</span> <span class='va'>adj_x</span>,</span>
<span>      y     <span class='op'>=</span> <span class='va'>adj_y</span>,</span>
<span>      image <span class='op'>=</span> <span class='va'>image_path</span>,</span>
<span>      size  <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>geom_size</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    asp <span class='op'>=</span> <span class='fl'>1</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>benelux_data</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span></span>
<span>      x     <span class='op'>=</span> <span class='va'>adj_x</span>,</span>
<span>      y     <span class='op'>=</span> <span class='va'>label_y</span>,</span>
<span>      label <span class='op'>=</span> <span class='va'>country</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    size     <span class='op'>=</span> <span class='fl'>1.5</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='va'>zoom_benelux_with_circles</span></span></code></pre>
</div>
<p><img src="100561659_files/figure-html5/unnamed-chunk-43-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<p>The same process was then recreated for the creation of the Malta and Cyprus zoomed map sections.</p>
<h3 id="malta">MALTA</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>malta_data</span> <span class='op'>&lt;-</span> <span class='va'>final_map</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>country</span> <span class='op'>==</span> <span class='st'>"Malta"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>bb_mt</span> <span class='op'>&lt;-</span> <span class='fu'>sf</span><span class='fu'>::</span><span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_bbox.html'>st_bbox</a></span><span class='op'>(</span><span class='va'>malta_data</span><span class='op'>)</span></span>
<span><span class='va'>xpad_mt</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>bb_mt</span><span class='op'>[</span><span class='st'>"xmax"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>bb_mt</span><span class='op'>[</span><span class='st'>"xmin"</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>1.2</span>   </span>
<span><span class='va'>ypad_mt</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>bb_mt</span><span class='op'>[</span><span class='st'>"ymax"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>bb_mt</span><span class='op'>[</span><span class='st'>"ymin"</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>1.2</span></span>
<span></span>
<span><span class='va'>zoom_malta</span> <span class='op'>&lt;-</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsf.html'>geom_sf</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>malta_data</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='va'>party_band</span><span class='op'>)</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"white"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>fill_values</span>, na.value <span class='op'>=</span> <span class='st'>"grey90"</span>, guide <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsf.html'>coord_sf</a></span><span class='op'>(</span></span>
<span>    xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>bb_mt</span><span class='op'>[</span><span class='st'>"xmin"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>xpad_mt</span>, <span class='va'>bb_mt</span><span class='op'>[</span><span class='st'>"xmax"</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>xpad_mt</span><span class='op'>)</span>,</span>
<span>    ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>bb_mt</span><span class='op'>[</span><span class='st'>"ymin"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>ypad_mt</span>, <span class='va'>bb_mt</span><span class='op'>[</span><span class='st'>"ymax"</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>ypad_mt</span><span class='op'>)</span>,</span>
<span>    expand <span class='op'>=</span> <span class='cn'>FALSE</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_void</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>zoom_malta</span></span></code></pre>
</div>
<p><img src="100561659_files/figure-html5/unnamed-chunk-44-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<p>with combo plots</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>malta_sizes</span> <span class='op'>&lt;-</span> <span class='va'>malta_populations</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    log_pop <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>population</span><span class='op'>)</span>,</span>
<span>    plot_size <span class='op'>=</span> <span class='fu'><a href='https://scales.r-lib.org/reference/rescale.html'>rescale</a></span><span class='op'>(</span></span>
<span>      <span class='va'>log_pop</span>,</span>
<span>      to   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span>,</span>
<span>      from <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>population</span><span class='op'>)</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>population</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># centroids</span></span>
<span><span class='va'>malta_sf</span> <span class='op'>&lt;-</span> <span class='va'>final_map</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>country</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>malta_populations</span><span class='op'>$</span><span class='va'>country</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>country</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span></span>
<span>    geometry <span class='op'>=</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/geos_combine.html'>st_union</a></span><span class='op'>(</span><span class='va'>geometry</span><span class='op'>)</span>,</span>
<span>    .groups <span class='op'>=</span> <span class='st'>"drop"</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_as_sf.html'>st_as_sf</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>centroids</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/geos_unary.html'>st_centroid</a></span><span class='op'>(</span><span class='va'>malta_sf</span><span class='op'>)</span></span>
<span><span class='va'>coords</span>    <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_coordinates.html'>st_coordinates</a></span><span class='op'>(</span><span class='va'>centroids</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>malta_centroids</span> <span class='op'>&lt;-</span> <span class='va'>malta_sf</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_geometry.html'>st_drop_geometry</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    centroid_x <span class='op'>=</span> <span class='va'>coords</span><span class='op'>[</span>, <span class='st'>"X"</span><span class='op'>]</span>,</span>
<span>    centroid_y <span class='op'>=</span> <span class='va'>coords</span><span class='op'>[</span>, <span class='st'>"Y"</span><span class='op'>]</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># joining population and size info</span></span>
<span><span class='va'>malta_data</span> <span class='op'>&lt;-</span> <span class='va'>malta_centroids</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>malta_sizes</span>, by <span class='op'>=</span> <span class='st'>"country"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># saving circles as .png</span></span>
<span><span class='va'>output_dir</span> <span class='op'>&lt;-</span> <span class='st'>"malta_plots"</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/files2.html'>dir.create</a></span><span class='op'>(</span><span class='va'>output_dir</span>, showWarnings <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>malta_data</span><span class='op'>$</span><span class='va'>image_path</span> <span class='op'>&lt;-</span> <span class='cn'>NA_character_</span></span>
<span></span>
<span><span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>malta_data</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='va'>country_name</span> <span class='op'>&lt;-</span> <span class='va'>malta_data</span><span class='op'>$</span><span class='va'>country</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span></span>
<span>  <span class='va'>country_code</span> <span class='op'>&lt;-</span> <span class='va'>malta_data</span><span class='op'>$</span><span class='va'>country_code</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span></span>
<span>  <span class='va'>plot_size</span>    <span class='op'>&lt;-</span> <span class='va'>malta_data</span><span class='op'>$</span><span class='va'>plot_size</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span></span>
<span>  </span>
<span><span class='co'># expecting be_final, nl_final, lu_final</span></span>
<span>  <span class='va'>plot_name</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>country_code</span>, <span class='st'>"_final"</span><span class='op'>)</span></span>
<span></span>
<span>  </span>
<span>  <span class='va'>existing_plot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/get.html'>get</a></span><span class='op'>(</span><span class='va'>plot_name</span><span class='op'>)</span></span>
<span>  <span class='va'>img_file</span>      <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='va'>output_dir</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>country_name</span>, <span class='st'>".png"</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span></span>
<span>    filename <span class='op'>=</span> <span class='va'>img_file</span>,</span>
<span>    plot     <span class='op'>=</span> <span class='va'>existing_plot</span>,</span>
<span>    width    <span class='op'>=</span> <span class='va'>plot_size</span>,</span>
<span>    height   <span class='op'>=</span> <span class='va'>plot_size</span>,</span>
<span>    dpi      <span class='op'>=</span> <span class='fl'>300</span>,</span>
<span>    bg       <span class='op'>=</span> <span class='st'>"transparent"</span></span>
<span>  <span class='op'>)</span></span>
<span>  </span>
<span>  <span class='va'>malta_data</span><span class='op'>$</span><span class='va'>image_path</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>img_file</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span></span>
<span><span class='co'># converting to relative sizes</span></span>
<span><span class='va'>bbox</span>    <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_bbox.html'>st_bbox</a></span><span class='op'>(</span><span class='va'>final_map</span><span class='op'>)</span></span>
<span><span class='va'>y_range</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>bbox</span><span class='op'>[</span><span class='st'>"ymax"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>bbox</span><span class='op'>[</span><span class='st'>"ymin"</span><span class='op'>]</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>malta_data</span> <span class='op'>&lt;-</span> <span class='va'>malta_data</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    geom_size       <span class='op'>=</span> <span class='va'>plot_size</span> <span class='op'>*</span> <span class='fl'>0.05</span>,</span>
<span>    img_height_data <span class='op'>=</span> <span class='va'>geom_size</span> <span class='op'>*</span> <span class='va'>y_range</span>,</span>
<span>    radius          <span class='op'>=</span> <span class='va'>img_height_data</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    </span>
<span>    adj_x <span class='op'>=</span> <span class='va'>centroid_x</span>,</span>
<span>    adj_y <span class='op'>=</span> <span class='va'>centroid_y</span>,</span>
<span>    </span>
<span><span class='co'># positioning the label</span></span>
<span>    label_y <span class='op'>=</span> <span class='va'>adj_y</span> <span class='op'>+</span> <span class='fl'>0.008</span> <span class='op'>*</span> <span class='va'>radius</span>   </span>
<span>  <span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='co'># recreating the malta base map</span></span>
<span><span class='va'>malta_poly</span> <span class='op'>&lt;-</span> <span class='va'>final_map</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>country</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Malta"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>bb_mt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_bbox.html'>st_bbox</a></span><span class='op'>(</span><span class='va'>malta_poly</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>xpad_mt</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>bb_mt</span><span class='op'>[</span><span class='st'>"xmax"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>bb_mt</span><span class='op'>[</span><span class='st'>"xmin"</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>0.15</span></span>
<span><span class='va'>ypad_mt</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>bb_mt</span><span class='op'>[</span><span class='st'>"ymax"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>bb_mt</span><span class='op'>[</span><span class='st'>"ymin"</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>0.15</span></span>
<span></span>
<span><span class='va'>zoom_malta</span> <span class='op'>&lt;-</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsf.html'>geom_sf</a></span><span class='op'>(</span></span>
<span>    data   <span class='op'>=</span> <span class='va'>final_map</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='va'>party_band</span><span class='op'>)</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"white"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>fill_values</span>, na.value <span class='op'>=</span> <span class='st'>"grey90"</span>, guide <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsf.html'>coord_sf</a></span><span class='op'>(</span></span>
<span>    xlim   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>bb_mt</span><span class='op'>[</span><span class='st'>"xmin"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>xpad_mt</span>, <span class='va'>bb_mt</span><span class='op'>[</span><span class='st'>"xmax"</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>xpad_mt</span><span class='op'>)</span>,</span>
<span>    ylim   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>bb_mt</span><span class='op'>[</span><span class='st'>"ymin"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>ypad_mt</span>, <span class='va'>bb_mt</span><span class='op'>[</span><span class='st'>"ymax"</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>ypad_mt</span><span class='op'>)</span>,</span>
<span>    expand <span class='op'>=</span> <span class='cn'>FALSE</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_void</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># adding the circular plots on top</span></span>
<span><span class='va'>zoom_malta_with_circles</span> <span class='op'>&lt;-</span></span>
<span>  <span class='va'>zoom_malta</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/ggimage/man/geom_image.html'>geom_image</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>malta_data</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span></span>
<span>      x     <span class='op'>=</span> <span class='va'>adj_x</span>,</span>
<span>      y     <span class='op'>=</span> <span class='va'>adj_y</span>,</span>
<span>      image <span class='op'>=</span> <span class='va'>image_path</span>,</span>
<span>      size  <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>geom_size</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    asp <span class='op'>=</span> <span class='fl'>1</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>malta_data</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span></span>
<span>      x     <span class='op'>=</span> <span class='va'>adj_x</span>,</span>
<span>      y     <span class='op'>=</span> <span class='va'>label_y</span>,</span>
<span>      label <span class='op'>=</span> <span class='va'>country</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    size     <span class='op'>=</span> <span class='fl'>1.5</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='va'>zoom_malta_with_circles</span></span></code></pre>
</div>
<p><img src="100561659_files/figure-html5/unnamed-chunk-45-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<h3 id="cyprus">CYPRUS</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>cyprus_data</span> <span class='op'>&lt;-</span> <span class='va'>final_map</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>country</span> <span class='op'>==</span> <span class='st'>"Cyprus"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>bb_cy</span> <span class='op'>&lt;-</span> <span class='fu'>sf</span><span class='fu'>::</span><span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_bbox.html'>st_bbox</a></span><span class='op'>(</span><span class='va'>cyprus_data</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>xpad_cy</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>bb_cy</span><span class='op'>[</span><span class='st'>"xmax"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>bb_cy</span><span class='op'>[</span><span class='st'>"xmin"</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>0.6</span></span>
<span><span class='va'>ypad_cy</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>bb_cy</span><span class='op'>[</span><span class='st'>"ymax"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>bb_cy</span><span class='op'>[</span><span class='st'>"ymin"</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>0.6</span></span>
<span></span>
<span><span class='va'>zoom_cyprus</span> <span class='op'>&lt;-</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsf.html'>geom_sf</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>cyprus_data</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='va'>party_band</span><span class='op'>)</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"white"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>fill_values</span>, na.value <span class='op'>=</span> <span class='st'>"grey90"</span>, guide <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsf.html'>coord_sf</a></span><span class='op'>(</span></span>
<span>    xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>bb_cy</span><span class='op'>[</span><span class='st'>"xmin"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>xpad_cy</span>, <span class='va'>bb_cy</span><span class='op'>[</span><span class='st'>"xmax"</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>xpad_cy</span><span class='op'>)</span>,</span>
<span>    ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>bb_cy</span><span class='op'>[</span><span class='st'>"ymin"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>ypad_cy</span>, <span class='va'>bb_cy</span><span class='op'>[</span><span class='st'>"ymax"</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>ypad_cy</span><span class='op'>)</span>,</span>
<span>    expand <span class='op'>=</span> <span class='cn'>FALSE</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_void</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>zoom_cyprus</span></span></code></pre>
</div>
<p><img src="100561659_files/figure-html5/unnamed-chunk-46-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<p>with combo plots</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>cyprus_sizes</span> <span class='op'>&lt;-</span> <span class='va'>cyprus_populations</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    log_pop <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='va'>population</span><span class='op'>)</span>,</span>
<span>    plot_size <span class='op'>=</span> <span class='fu'><a href='https://scales.r-lib.org/reference/rescale.html'>rescale</a></span><span class='op'>(</span></span>
<span>      <span class='va'>log_pop</span>,</span>
<span>      to   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>13</span><span class='op'>)</span>,</span>
<span>      from <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>population</span><span class='op'>)</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log10</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>population</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># centroids for cyprus</span></span>
<span><span class='va'>cyprus_sf</span> <span class='op'>&lt;-</span> <span class='va'>final_map</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>country</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>cyprus_populations</span><span class='op'>$</span><span class='va'>country</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>country</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span></span>
<span>    geometry <span class='op'>=</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/geos_combine.html'>st_union</a></span><span class='op'>(</span><span class='va'>geometry</span><span class='op'>)</span>,</span>
<span>    .groups <span class='op'>=</span> <span class='st'>"drop"</span></span>
<span>  <span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_as_sf.html'>st_as_sf</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>centroids</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/geos_unary.html'>st_centroid</a></span><span class='op'>(</span><span class='va'>cyprus_sf</span><span class='op'>)</span></span>
<span><span class='va'>coords</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_coordinates.html'>st_coordinates</a></span><span class='op'>(</span><span class='va'>centroids</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>cyprus_centroids</span> <span class='op'>&lt;-</span> <span class='va'>cyprus_sf</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_geometry.html'>st_drop_geometry</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    centroid_x <span class='op'>=</span> <span class='va'>coords</span><span class='op'>[</span>, <span class='st'>"X"</span><span class='op'>]</span>,</span>
<span>    centroid_y <span class='op'>=</span> <span class='va'>coords</span><span class='op'>[</span>, <span class='st'>"Y"</span><span class='op'>]</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># joining population and size info</span></span>
<span><span class='va'>cyprus_data</span> <span class='op'>&lt;-</span> <span class='va'>cyprus_centroids</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>cyprus_sizes</span>, by <span class='op'>=</span> <span class='st'>"country"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># saving circular plots in .png format </span></span>
<span><span class='va'>output_dir</span> <span class='op'>&lt;-</span> <span class='st'>"cyprus_plots"</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/files2.html'>dir.create</a></span><span class='op'>(</span><span class='va'>output_dir</span>, showWarnings <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>cyprus_data</span><span class='op'>$</span><span class='va'>image_path</span> <span class='op'>&lt;-</span> <span class='cn'>NA_character_</span></span>
<span></span>
<span><span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>cyprus_data</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='va'>country_name</span> <span class='op'>&lt;-</span> <span class='va'>cyprus_data</span><span class='op'>$</span><span class='va'>country</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span></span>
<span>  <span class='va'>country_code</span> <span class='op'>&lt;-</span> <span class='va'>cyprus_data</span><span class='op'>$</span><span class='va'>country_code</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span></span>
<span>  <span class='va'>plot_size</span>    <span class='op'>&lt;-</span> <span class='va'>cyprus_data</span><span class='op'>$</span><span class='va'>plot_size</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span></span>
<span>  </span>
<span>  <span class='co'># expects: be_final, nl_final, lu_final</span></span>
<span>  <span class='va'>plot_name</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>country_code</span>, <span class='st'>"_final"</span><span class='op'>)</span></span>
<span>  </span>
<span></span>
<span>  </span>
<span>  <span class='va'>existing_plot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/get.html'>get</a></span><span class='op'>(</span><span class='va'>plot_name</span><span class='op'>)</span></span>
<span>  <span class='va'>img_file</span>      <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='va'>output_dir</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>country_name</span>, <span class='st'>".png"</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span></span>
<span>    filename <span class='op'>=</span> <span class='va'>img_file</span>,</span>
<span>    plot     <span class='op'>=</span> <span class='va'>existing_plot</span>,</span>
<span>    width    <span class='op'>=</span> <span class='va'>plot_size</span>,</span>
<span>    height   <span class='op'>=</span> <span class='va'>plot_size</span>,</span>
<span>    dpi      <span class='op'>=</span> <span class='fl'>300</span>,</span>
<span>    bg       <span class='op'>=</span> <span class='st'>"transparent"</span></span>
<span>  <span class='op'>)</span></span>
<span>  </span>
<span>  <span class='va'>cyprus_data</span><span class='op'>$</span><span class='va'>image_path</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>img_file</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span></span>
<span></span>
<span><span class='co'># We use overall map height to convert relative sizes</span></span>
<span><span class='va'>bbox</span>    <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_bbox.html'>st_bbox</a></span><span class='op'>(</span><span class='va'>final_map</span><span class='op'>)</span></span>
<span><span class='va'>y_range</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>bbox</span><span class='op'>[</span><span class='st'>"ymax"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>bbox</span><span class='op'>[</span><span class='st'>"ymin"</span><span class='op'>]</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>cyprus_data</span> <span class='op'>&lt;-</span> <span class='va'>cyprus_data</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    geom_size       <span class='op'>=</span> <span class='va'>plot_size</span> <span class='op'>*</span> <span class='fl'>0.05</span>,</span>
<span>    img_height_data <span class='op'>=</span> <span class='va'>geom_size</span> <span class='op'>*</span> <span class='va'>y_range</span>,</span>
<span>    radius          <span class='op'>=</span> <span class='va'>img_height_data</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>    </span>
<span>    adj_x <span class='op'>=</span> <span class='va'>centroid_x</span>,</span>
<span>    adj_y <span class='op'>=</span> <span class='va'>centroid_y</span>,</span>
<span>    </span>
<span><span class='co'># positioning the label</span></span>
<span>    label_y <span class='op'>=</span> <span class='va'>adj_y</span> <span class='op'>+</span> <span class='fl'>0.023</span> <span class='op'>*</span> <span class='va'>radius</span>   </span>
<span>  <span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='co'># recreating cyprus zoom base map</span></span>
<span><span class='va'>cyprus_poly</span> <span class='op'>&lt;-</span> <span class='va'>final_map</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>country</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Cyprus"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>bb_cy</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_bbox.html'>st_bbox</a></span><span class='op'>(</span><span class='va'>cyprus_poly</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>xpad_cy</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>bb_cy</span><span class='op'>[</span><span class='st'>"xmax"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>bb_cy</span><span class='op'>[</span><span class='st'>"xmin"</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>0.15</span></span>
<span><span class='va'>ypad_cy</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>bb_cy</span><span class='op'>[</span><span class='st'>"ymax"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>bb_cy</span><span class='op'>[</span><span class='st'>"ymin"</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>0.15</span></span>
<span></span>
<span><span class='va'>zoom_cyprus</span> <span class='op'>&lt;-</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsf.html'>geom_sf</a></span><span class='op'>(</span></span>
<span>    data   <span class='op'>=</span> <span class='va'>final_map</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='va'>party_band</span><span class='op'>)</span>,</span>
<span>    colour <span class='op'>=</span> <span class='st'>"white"</span>,</span>
<span>    linewidth <span class='op'>=</span> <span class='fl'>0.2</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>fill_values</span>, na.value <span class='op'>=</span> <span class='st'>"grey90"</span>, guide <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsf.html'>coord_sf</a></span><span class='op'>(</span></span>
<span>    xlim   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>bb_cy</span><span class='op'>[</span><span class='st'>"xmin"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>xpad_cy</span>, <span class='va'>bb_cy</span><span class='op'>[</span><span class='st'>"xmax"</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>xpad_cy</span><span class='op'>)</span>,</span>
<span>    ylim   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>bb_cy</span><span class='op'>[</span><span class='st'>"ymin"</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>ypad_cy</span>, <span class='va'>bb_cy</span><span class='op'>[</span><span class='st'>"ymax"</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>ypad_cy</span><span class='op'>)</span>,</span>
<span>    expand <span class='op'>=</span> <span class='cn'>FALSE</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_void</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># adding the circular plots on top of the map</span></span>
<span><span class='va'>zoom_cyprus_with_circles</span> <span class='op'>&lt;-</span></span>
<span>  <span class='va'>zoom_cyprus</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/ggimage/man/geom_image.html'>geom_image</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>cyprus_data</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span></span>
<span>      x     <span class='op'>=</span> <span class='va'>adj_x</span>,</span>
<span>      y     <span class='op'>=</span> <span class='va'>adj_y</span>,</span>
<span>      image <span class='op'>=</span> <span class='va'>image_path</span>,</span>
<span>      size  <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>geom_size</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    asp <span class='op'>=</span> <span class='fl'>1</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='va'>cyprus_data</span>,</span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span></span>
<span>      x     <span class='op'>=</span> <span class='va'>adj_x</span>,</span>
<span>      y     <span class='op'>=</span> <span class='va'>label_y</span>,</span>
<span>      label <span class='op'>=</span> <span class='va'>country</span></span>
<span>    <span class='op'>)</span>,</span>
<span>    fontface <span class='op'>=</span> <span class='st'>"bold"</span>,</span>
<span>    size     <span class='op'>=</span> <span class='fl'>1.5</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='va'>zoom_cyprus_with_circles</span></span></code></pre>
</div>
<p><img src="100561659_files/figure-html5/unnamed-chunk-47-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<h2 id="putting-it-all-together">PUTTING IT ALL TOGETHER</h2>
<p>At this stage all of the component parts of the original visualisation had been made so it was time to put them all together to create the final image. To combine multiple ggplot2 plots into a figure there are multiple different strategies - the two packages that were most seriously considered in this project were cowplot and patchwork. Cowplot appeared to be more function based, whereas patchwork seemed to take a simpler approach to plot layouts. After some experimentation, it was decided that using the patchwork package gave the easiest to follow path from component parts to final plot, specifically utilising its inset_element() function to overlay the insets on the main background map.</p>
<p>The first inset to be positioned on the main map was the legend</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># reading the saved legend image</span></span>
<span><span class='va'>leg_img</span>  <span class='op'>&lt;-</span> <span class='fu'>png</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='st'>"legend_check.png"</span><span class='op'>)</span></span>
<span><span class='co'># concerting the image to a grob</span></span>
<span><span class='va'>leg_grob</span> <span class='op'>&lt;-</span> <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/grid.raster.html'>rasterGrob</a></span><span class='op'>(</span><span class='va'>leg_img</span>, interpolate <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># wrapping the png in a ggplot so patchwork can inset it</span></span>
<span><span class='va'>legend_png_plot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_custom.html'>annotation_custom</a></span><span class='op'>(</span><span class='va'>leg_grob</span>, xmin <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>, xmax <span class='op'>=</span> <span class='cn'>Inf</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>, ymax <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span>expand <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_void</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>    plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>    panel.spacing <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='st'>"pt"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># defining the inset position (01, relative to the full canvas)</span></span>
<span><span class='va'>left</span>   <span class='op'>&lt;-</span> <span class='fl'>0.0</span></span>
<span><span class='va'>right</span>  <span class='op'>&lt;-</span> <span class='fl'>0.34</span></span>
<span><span class='va'>top</span>    <span class='op'>&lt;-</span> <span class='fl'>0.98</span></span>
<span><span class='va'>bottom</span> <span class='op'>&lt;-</span> <span class='fl'>0.66</span></span>
<span></span>
<span><span class='co'># adding the legend to the main map (full canvas, not just plot area)</span></span>
<span><span class='va'>final_plot</span> <span class='op'>&lt;-</span> <span class='va'>final_EUROMAP</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/inset_element.html'>inset_element</a></span><span class='op'>(</span></span>
<span>    <span class='va'>legend_png_plot</span>,</span>
<span>    left   <span class='op'>=</span> <span class='va'>left</span>,</span>
<span>    bottom <span class='op'>=</span> <span class='va'>bottom</span>,</span>
<span>    right  <span class='op'>=</span> <span class='va'>right</span>,</span>
<span>    top    <span class='op'>=</span> <span class='va'>top</span>,</span>
<span>    align_to <span class='op'>=</span> <span class='st'>"full"</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='va'>final_plot</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-48-1.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># saving thhe progress</span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span></span>
<span>  <span class='st'>"EUROMAP_with_legend.png"</span>,</span>
<span>  <span class='va'>final_plot</span>,</span>
<span>  width  <span class='op'>=</span> <span class='fl'>22.5</span>,</span>
<span>  height <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  units  <span class='op'>=</span> <span class='st'>"cm"</span>,</span>
<span>  dpi    <span class='op'>=</span> <span class='fl'>300</span>,</span>
<span>  bg     <span class='op'>=</span> <span class='st'>"white"</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Following this, the donut key was added to the main plot by slotting it into the above chunk of code. This was done by defining its position relative to the legend key that has already been positioned.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># reading the saved legend image</span></span>
<span><span class='va'>leg_img</span>  <span class='op'>&lt;-</span> <span class='fu'>png</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='st'>"legend_check.png"</span><span class='op'>)</span></span>
<span><span class='co'># converting it to a grob</span></span>
<span><span class='va'>leg_grob</span> <span class='op'>&lt;-</span> <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/grid.raster.html'>rasterGrob</a></span><span class='op'>(</span><span class='va'>leg_img</span>, interpolate <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># wrapping the png in a ggplot so patchwork can inset it</span></span>
<span><span class='va'>legend_png_plot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_custom.html'>annotation_custom</a></span><span class='op'>(</span><span class='va'>leg_grob</span>, xmin <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>, xmax <span class='op'>=</span> <span class='cn'>Inf</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>, ymax <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span>expand <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_void</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># reading the saved donut key image</span></span>
<span><span class='va'>don_img</span>  <span class='op'>&lt;-</span> <span class='fu'>png</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='st'>"donut_key.png"</span><span class='op'>)</span></span>
<span><span class='co'># converting it to a grob</span></span>
<span><span class='va'>don_grob</span> <span class='op'>&lt;-</span> <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/grid.raster.html'>rasterGrob</a></span><span class='op'>(</span><span class='va'>don_img</span>, interpolate <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># wrapping the png in a ggplot so patchwork can inset it</span></span>
<span><span class='va'>donut_png_plot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/annotation_custom.html'>annotation_custom</a></span><span class='op'>(</span><span class='va'>don_grob</span>, xmin <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>, xmax <span class='op'>=</span> <span class='cn'>Inf</span>, ymin <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>, ymax <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span>expand <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_void</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># legend inset positioning again</span></span>
<span><span class='va'>leg_left</span>   <span class='op'>&lt;-</span> <span class='fl'>0.00</span></span>
<span><span class='va'>leg_right</span>  <span class='op'>&lt;-</span> <span class='fl'>0.34</span></span>
<span><span class='va'>leg_top</span>    <span class='op'>&lt;-</span> <span class='fl'>0.98</span></span>
<span><span class='va'>leg_bottom</span> <span class='op'>&lt;-</span> <span class='fl'>0.66</span></span>
<span></span>
<span><span class='co'># placing the donut key to the right of the legend by defining a horisontal gap between the two</span></span>
<span><span class='va'>gap</span> <span class='op'>&lt;-</span> <span class='op'>-</span><span class='fl'>0.05</span>            </span>
<span><span class='va'>don_size</span> <span class='op'>&lt;-</span> <span class='fl'>0.2</span>      </span>
<span></span>
<span><span class='va'>don_left</span>   <span class='op'>&lt;-</span> <span class='va'>leg_right</span> <span class='op'>+</span> <span class='va'>gap</span></span>
<span><span class='va'>don_right</span>  <span class='op'>&lt;-</span> <span class='va'>don_left</span> <span class='op'>+</span> <span class='va'>don_size</span></span>
<span><span class='va'>don_top</span>    <span class='op'>&lt;-</span> <span class='va'>leg_top</span> <span class='op'>-</span> <span class='fl'>0.06</span>     </span>
<span><span class='va'>don_bottom</span> <span class='op'>&lt;-</span> <span class='va'>don_top</span> <span class='op'>-</span> <span class='va'>don_size</span>     <span class='co'>#</span></span>
<span></span>
<span><span class='co'># adding the legend and the key to the main map (full canvas, not just plot area)</span></span>
<span><span class='va'>final_plot</span> <span class='op'>&lt;-</span> <span class='va'>final_EUROMAP</span> <span class='op'>+</span></span>
<span><span class='co'># adding the legend</span></span>
<span>  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/inset_element.html'>inset_element</a></span><span class='op'>(</span></span>
<span>    <span class='va'>legend_png_plot</span>,</span>
<span>    left   <span class='op'>=</span> <span class='va'>leg_left</span>,</span>
<span>    right  <span class='op'>=</span> <span class='va'>leg_right</span>,</span>
<span>    top    <span class='op'>=</span> <span class='va'>leg_top</span>,</span>
<span>    bottom <span class='op'>=</span> <span class='va'>leg_bottom</span>,</span>
<span>    align_to <span class='op'>=</span> <span class='st'>"full"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span><span class='co'># adding the donut key</span></span>
<span>  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/inset_element.html'>inset_element</a></span><span class='op'>(</span></span>
<span>    <span class='va'>donut_png_plot</span>,</span>
<span>    left   <span class='op'>=</span> <span class='va'>don_left</span>,</span>
<span>    right  <span class='op'>=</span> <span class='va'>don_right</span>,</span>
<span>    top    <span class='op'>=</span> <span class='va'>don_top</span>,</span>
<span>    bottom <span class='op'>=</span> <span class='va'>don_bottom</span>,</span>
<span>    align_to <span class='op'>=</span> <span class='st'>"full"</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='va'>final_plot</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-49-1.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># saving the progress</span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span></span>
<span>  <span class='st'>"EUROMAP_with_legend_key.png"</span>,</span>
<span>  <span class='va'>final_plot</span>,</span>
<span>  width  <span class='op'>=</span> <span class='fl'>22.5</span>,</span>
<span>  height <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  units  <span class='op'>=</span> <span class='st'>"cm"</span>,</span>
<span>  dpi    <span class='op'>=</span> <span class='fl'>300</span>,</span>
<span>  bg     <span class='op'>=</span> <span class='st'>"white"</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 id="combining-the-zooms">COMBINING THE ZOOMS</h3>
<p>To inset the three zoomed in map sections, they were first joined together so that only one inset on the main map had to be done. Patchwork was again used to do this, and custom styling was applied.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># removing the spacinf between panels, the borderm and the margin around the plot</span></span>
<span><span class='va'>panel_strip</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>  panel.spacing <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='st'>"pt"</span><span class='op'>)</span>,</span>
<span>  panel.border <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>  plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># adding the black border</span></span>
<span><span class='va'>panel_border</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>  panel.border <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"black"</span>, fill <span class='op'>=</span> <span class='cn'>NA</span>, linewidth <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span>,</span>
<span>  plot.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>  plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># combining the zoomed map sections using patchwork operators</span></span>
<span><span class='va'>combo_zooms</span> <span class='op'>&lt;-</span></span>
<span>  <span class='op'>(</span><span class='va'>zoom_benelux_with_circles</span> <span class='op'>+</span> <span class='va'>panel_strip</span> <span class='op'>+</span> <span class='va'>panel_border</span><span class='op'>)</span> <span class='op'>/</span></span>
<span>  <span class='op'>(</span><span class='op'>(</span><span class='va'>zoom_malta_with_circles</span> <span class='op'>+</span> <span class='va'>panel_strip</span> <span class='op'>+</span> <span class='va'>panel_border</span><span class='op'>)</span> <span class='op'>|</span></span>
<span>   <span class='op'>(</span><span class='va'>zoom_cyprus_with_circles</span> <span class='op'>+</span> <span class='va'>panel_strip</span> <span class='op'>+</span> <span class='va'>panel_border</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_layout.html'>plot_layout</a></span><span class='op'>(</span>heights <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5.1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>combo_zooms</span></span></code></pre>
</div>
<p><img src="100561659_files/figure-html5/unnamed-chunk-50-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<p>now the combination plot is saved as a .png file and trimmed tightly to the boundaries of the plot</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># saving the combination zoom plot in .png format</span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span></span>
<span>  <span class='st'>"zooms.png"</span>,</span>
<span>  <span class='va'>combo_zooms</span>,</span>
<span>  width  <span class='op'>=</span> <span class='fl'>10</span>,</span>
<span>  height <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  units  <span class='op'>=</span> <span class='st'>"cm"</span>,</span>
<span>  dpi    <span class='op'>=</span> <span class='fl'>300</span>,</span>
<span>  bg     <span class='op'>=</span> <span class='st'>"white"</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># using the "magick" package to trim the excess white space around the saved plot (load, trim, save trimmed)</span></span>
<span><span class='va'>img</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://docs.ropensci.org/magick/reference/editing.html'>image_read</a></span><span class='op'>(</span><span class='st'>"zooms.png"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>img_trim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://docs.ropensci.org/magick/reference/transform.html'>image_trim</a></span><span class='op'>(</span><span class='va'>img</span>, fuzz <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://docs.ropensci.org/magick/reference/editing.html'>image_write</a></span><span class='op'>(</span><span class='va'>img_trim</span>, <span class='st'>"zooms_trimmed.png"</span>, format <span class='op'>=</span> <span class='st'>"png"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>At last, the trimmed zoom plots image is overlaid on the top-right-hand corner of the main map</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># loading the image file and converting it to a grob</span></span>
<span><span class='va'>zooms_grob</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grid/grid.raster.html'>rasterGrob</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/png/man/readPNG.html'>readPNG</a></span><span class='op'>(</span><span class='st'>"zooms_trimmed.png"</span><span class='op'>)</span>, interpolate <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># wrapping the image so it can be used by patchwork</span></span>
<span><span class='va'>zooms_panel</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/wrap_elements.html'>wrap_elements</a></span><span class='op'>(</span>full <span class='op'>=</span> <span class='va'>zooms_grob</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_void</a></span><span class='op'>(</span><span class='op'>)</span>  <span class='co'># keeps it as just the image</span></span>
<span></span>
<span><span class='co'># positioning the zooms plot on the main map</span></span>
<span><span class='va'>final_fig</span> <span class='op'>&lt;-</span></span>
<span>  <span class='va'>final_plot</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/inset_element.html'>inset_element</a></span><span class='op'>(</span></span>
<span>    <span class='va'>zooms_panel</span>,</span>
<span>    left   <span class='op'>=</span> <span class='fl'>0.78</span>,</span>
<span>    bottom <span class='op'>=</span> <span class='fl'>0.62</span>,</span>
<span>    right  <span class='op'>=</span> <span class='fl'>1.30</span>,</span>
<span>    top    <span class='op'>=</span> <span class='fl'>0.98</span>,</span>
<span>    align_to <span class='op'>=</span> <span class='st'>"plot"</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='va'>final_fig</span></span></code></pre>
</div>
<p><img src="100561659_files/figure-html5/unnamed-chunk-52-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># saving the final image</span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span></span>
<span>  <span class='st'>"EU_FINAL.png"</span>,</span>
<span>  <span class='va'>final_fig</span>,</span>
<span>  width  <span class='op'>=</span> <span class='fl'>40</span>,</span>
<span>  height <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  units  <span class='op'>=</span> <span class='st'>"cm"</span>,</span>
<span>  dpi    <span class='op'>=</span> <span class='fl'>300</span>,</span>
<span>  bg     <span class='op'>=</span> <span class='st'>"white"</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h2 id="final-reproduction">FINAL REPRODUCTION</h2>
<p>Here the final reproduction is presented at the correct scale</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/include_graphics.html'>include_graphics</a></span><span class='op'>(</span><span class='st'>"EU_FINAL.png"</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="EU_FINAL.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<h2 id="reimagining-the-visualisation">REIMAGINING THE VISUALISATION</h2>
<p>In this stage of the project, the goal is to reimagine and improve on the original plot.</p>
<h3 id="issues-with-the-original-plot">ISSUES WITH THE ORIGINAL PLOT</h3>
<p>The original plot is undeniably eye catching, however it has some issues mainly relating do readability. Firstly, the donut plots include small segments of vote that are entirely invisible at the scale the plots are drawn at. Secondly, the colours used in the plot in the way that they are used make the plot sometimes very difficult to interpret. For example, a dark blue and a dark grey seat point next to each other on a smaller-sized circular plot are very hard to distinguish from one another quickly. Thirdly, the plot lacks any sort of heading or contextualisation and this, combined with the sheer number of different types of election data and plot formats that are combined in the final image, makes it very difficult to understand and interpret the plot quickly or quicker than the viewer could learn the same information from a textual source. This ease and speed of conveying information is one of teh main reason that visualisations are used however any advantages to the graphic approach are lost in the overcomplexity of the original graph. All in all, these problems can be summed up as - the original plot is trying to do too many things at once.</p>
<p>In order to remedy this, it was decided to split the information being conveyed in the original plot into three(???) individual plots, each using a technique specific to the type of information being conveyed.</p>
<h3 id="streching-out-the-donut-data">STRECHING OUT THE DONUT DATA</h3>
<p>The data in the donuts of the original plot represents the percentage of the overall vote won by each European Parliament Group in the 2024 election. In other less specific words, this data represents parts of a whole, therefore it was chosen to use stacked bar charts in order to re-imagine this part of the visualisation.</p>
<p>The data in the original donut plots came from 27 individually defined data sets, one for each country in the plot. In order to be able to handle the data better for making a series of stacked bar plots, these datasets were all combined in to one larger dataframe.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>all_countries</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind_rows.html'>bind_rows</a></span><span class='op'>(</span></span>
<span>  <span class='va'>don_at</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>country <span class='op'>=</span> <span class='st'>"Austria"</span><span class='op'>)</span>,</span>
<span>  <span class='va'>don_be</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>country <span class='op'>=</span> <span class='st'>"Belgium"</span><span class='op'>)</span>,</span>
<span>  <span class='va'>don_bg</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>country <span class='op'>=</span> <span class='st'>"Bulgaria"</span><span class='op'>)</span>,</span>
<span>  <span class='va'>don_hr</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>country <span class='op'>=</span> <span class='st'>"Croatia"</span><span class='op'>)</span>,</span>
<span>  <span class='va'>don_cy</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>country <span class='op'>=</span> <span class='st'>"Cyprus"</span><span class='op'>)</span>,</span>
<span>  <span class='va'>don_cz</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>country <span class='op'>=</span> <span class='st'>"Czechia"</span><span class='op'>)</span>,</span>
<span>  <span class='va'>don_dk</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>country <span class='op'>=</span> <span class='st'>"Denmark"</span><span class='op'>)</span>,</span>
<span>  <span class='va'>don_ee</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>country <span class='op'>=</span> <span class='st'>"Estonia"</span><span class='op'>)</span>,</span>
<span>  <span class='va'>don_fi</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>country <span class='op'>=</span> <span class='st'>"Finland"</span><span class='op'>)</span>,</span>
<span>  <span class='va'>don_fr</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>country <span class='op'>=</span> <span class='st'>"France"</span><span class='op'>)</span>,</span>
<span>  <span class='va'>don_de</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>country <span class='op'>=</span> <span class='st'>"Germany"</span><span class='op'>)</span>,</span>
<span>  <span class='va'>don_el</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>country <span class='op'>=</span> <span class='st'>"Greece"</span><span class='op'>)</span>,</span>
<span>  <span class='va'>don_hu</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>country <span class='op'>=</span> <span class='st'>"Hungary"</span><span class='op'>)</span>,</span>
<span>  <span class='va'>don_ie</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>country <span class='op'>=</span> <span class='st'>"Ireland"</span><span class='op'>)</span>,</span>
<span>  <span class='va'>don_it</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>country <span class='op'>=</span> <span class='st'>"Italy"</span><span class='op'>)</span>,</span>
<span>  <span class='va'>don_lv</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>country <span class='op'>=</span> <span class='st'>"Latvia"</span><span class='op'>)</span>,</span>
<span>  <span class='va'>don_lt</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>country <span class='op'>=</span> <span class='st'>"Lithuania"</span><span class='op'>)</span>,</span>
<span>  <span class='va'>don_lu</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>country <span class='op'>=</span> <span class='st'>"Luxembourg"</span><span class='op'>)</span>,</span>
<span>  <span class='va'>don_mt</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>country <span class='op'>=</span> <span class='st'>"Malta"</span><span class='op'>)</span>,</span>
<span>  <span class='va'>don_nl</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>country <span class='op'>=</span> <span class='st'>"Netherlands"</span><span class='op'>)</span>,</span>
<span>  <span class='va'>don_pl</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>country <span class='op'>=</span> <span class='st'>"Poland"</span><span class='op'>)</span>,</span>
<span>  <span class='va'>don_pt</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>country <span class='op'>=</span> <span class='st'>"Portugal"</span><span class='op'>)</span>,</span>
<span>  <span class='va'>don_ro</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>country <span class='op'>=</span> <span class='st'>"Romania"</span><span class='op'>)</span>,</span>
<span>  <span class='va'>don_sk</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>country <span class='op'>=</span> <span class='st'>"Slovakia"</span><span class='op'>)</span>,</span>
<span>  <span class='va'>don_si</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>country <span class='op'>=</span> <span class='st'>"Slovenia"</span><span class='op'>)</span>,</span>
<span>  <span class='va'>don_es</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>country <span class='op'>=</span> <span class='st'>"Spain"</span><span class='op'>)</span>,</span>
<span>  <span class='va'>don_se</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>country <span class='op'>=</span> <span class='st'>"Sweden"</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Then a new party order was created which places the parliament group with the overall largest proportion of the vote at the bottom, and that with the smallest at the top. This was done for both ease of reading and aesthetic reasons.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>bars_party_order</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Independent"</span>, <span class='st'>"NI"</span>, <span class='st'>"ESN"</span>, <span class='st'>"Theleft"</span>, <span class='st'>"GREENSEFA"</span>, <span class='st'>"Renew"</span>, <span class='st'>"ECR"</span>, <span class='st'>"Patriots"</span>, <span class='st'>"SD"</span>, <span class='st'>"EPP"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Party factor levels were set to match the corrected order</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>all_countries</span><span class='op'>$</span><span class='va'>party</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>all_countries</span><span class='op'>$</span><span class='va'>party</span>, levels <span class='op'>=</span> <span class='va'>bars_party_order</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Then a new plot was created with heavy styling</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>all_countries</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>vote_proportion</span>, y <span class='op'>=</span> <span class='va'>country</span>, fill <span class='op'>=</span> <span class='va'>party</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></span><span class='op'>(</span>stat <span class='op'>=</span> <span class='st'>"identity"</span>, width <span class='op'>=</span> <span class='fl'>0.75</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span></span>
<span>    values <span class='op'>=</span> <span class='va'>custom_cols</span>, </span>
<span>    labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>      <span class='st'>"Independent"</span> <span class='op'>=</span> <span class='st'>"Independent"</span>,</span>
<span>      <span class='st'>"NI"</span> <span class='op'>=</span> <span class='st'>"Non-Inscrits"</span>,</span>
<span>      <span class='st'>"ESN"</span> <span class='op'>=</span> <span class='st'>"Europe of Sovereign Nations"</span>,</span>
<span>      <span class='st'>"Theleft"</span> <span class='op'>=</span> <span class='st'>"The Left"</span>,</span>
<span>      <span class='st'>"GREENSEFA"</span> <span class='op'>=</span> <span class='st'>"Greens/EFA"</span>,</span>
<span>      <span class='st'>"Renew"</span> <span class='op'>=</span> <span class='st'>"Renew Europe"</span>,</span>
<span>      <span class='st'>"ECR"</span> <span class='op'>=</span> <span class='st'>"European Conservatives &amp; Reformists"</span>,</span>
<span>      <span class='st'>"Patriots"</span> <span class='op'>=</span> <span class='st'>"Patriots for Europe"</span>,</span>
<span>      <span class='st'>"SD"</span> <span class='op'>=</span> <span class='st'>"Socialists &amp; Democrats"</span>,</span>
<span>      <span class='st'>"EPP"</span> <span class='op'>=</span> <span class='st'>"European People's Party"</span></span>
<span>    <span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span></span>
<span>    expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>, </span>
<span>    breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>100</span>, <span class='fl'>25</span><span class='op'>)</span>,</span>
<span>    labels <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='st'>"%"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span></span>
<span>    title <span class='op'>=</span> <span class='st'>"2024 European Parliament Election Results by Country"</span>,</span>
<span>    subtitle <span class='op'>=</span> <span class='st'>"Vote share by political group"</span>,</span>
<span>    x <span class='op'>=</span> <span class='st'>"Vote Share"</span>, </span>
<span>    y <span class='op'>=</span> <span class='cn'>NULL</span>, </span>
<span>    fill <span class='op'>=</span> <span class='st'>"Political Group"</span>,</span>
<span>    caption <span class='op'>=</span> <span class='st'>"Source: European Parliament Election Results 2024"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span>base_size <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span><span class='co'># defining the plot background</span></span>
<span>    plot.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"white"</span>, </span>
<span>                                   color <span class='op'>=</span> <span class='cn'>NA</span><span class='op'>)</span>,</span>
<span>    panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"white"</span>, </span>
<span>                                    color <span class='op'>=</span> <span class='cn'>NA</span><span class='op'>)</span>,</span>
<span>    panel.grid.major.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    panel.grid.minor <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    panel.grid.major.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"grey90"</span>, </span>
<span>                                      linewidth <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>,</span>
<span>    </span>
<span><span class='co'># styling the axes</span></span>
<span>    axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>10</span>, </span>
<span>                               color <span class='op'>=</span> <span class='st'>"grey20"</span><span class='op'>)</span>,</span>
<span>    axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>10</span>, </span>
<span>                               color <span class='op'>=</span> <span class='st'>"grey20"</span><span class='op'>)</span>,</span>
<span>    axis.title.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>11</span>, </span>
<span>                                face <span class='op'>=</span> <span class='st'>"bold"</span>, </span>
<span>                                color <span class='op'>=</span> <span class='st'>"grey20"</span>, </span>
<span>                                margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    </span>
<span><span class='co'># styling the title</span></span>
<span>    plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>16</span>, </span>
<span>                              face <span class='op'>=</span> <span class='st'>"bold"</span>, </span>
<span>                              color <span class='op'>=</span> <span class='st'>"grey10"</span>, </span>
<span>                              margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>b <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>12</span>, </span>
<span>                                 color <span class='op'>=</span> <span class='st'>"grey30"</span>, </span>
<span>                                 margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>b <span class='op'>=</span> <span class='fl'>15</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    plot.caption <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>9</span>, </span>
<span>                                color <span class='op'>=</span> <span class='st'>"grey50"</span>, </span>
<span>                                hjust <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>                                margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>15</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    </span>
<span><span class='co'># styling the legend</span></span>
<span>    legend.position <span class='op'>=</span> <span class='st'>"right"</span>,</span>
<span>    legend.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>11</span>, </span>
<span>                                face <span class='op'>=</span> <span class='st'>"bold"</span>, </span>
<span>                                color <span class='op'>=</span> <span class='st'>"grey20"</span><span class='op'>)</span>,</span>
<span>    legend.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>10</span>, </span>
<span>                               color <span class='op'>=</span> <span class='st'>"grey20"</span><span class='op'>)</span>,</span>
<span>    legend.key.size <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.8</span>, <span class='st'>"cm"</span><span class='op'>)</span>,</span>
<span>    legend.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"white"</span>, </span>
<span>                                     color <span class='op'>=</span> <span class='st'>"grey80"</span>, </span>
<span>                                     linewidth <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>,</span>
<span>    legend.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>10</span><span class='op'>)</span>,</span>
<span>    </span>
<span><span class='co'># defining the margins</span></span>
<span>    plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>20</span>, <span class='fl'>20</span>, <span class='fl'>20</span>, <span class='fl'>20</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-58-1.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># saving the plot</span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span><span class='st'>"eu_election_results_horizontal.png"</span>, width <span class='op'>=</span> <span class='fl'>12</span>, </span>
<span>                                             height <span class='op'>=</span> <span class='fl'>10</span>, </span>
<span>                                            dpi <span class='op'>=</span> <span class='fl'>300</span>, </span>
<span>                                            bg <span class='op'>=</span> <span class='st'>"white"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="eu_election_results_horizontal.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<p>This plot gives a representation of the data that was held in the donut plots of the original visualisation in a format that allows even the smallest proportions of the vote to be recognised by the viewer. The standardisation of the bar length means that, compared to the varying sizes of the donuts in the original plot, the vote breakdown across the coutries can be more easily and accurately compared.<br />
<br />
Conveying the raw data is only one facet of using data visualisation techniques in election and parlimentary contexts. Graphical representations can and are often used for storytelling with the data, meaning that they are used to give a representation that adds extra context or meaning to the viewers understanding of the data. With some relatively small tweaks, the vote proportion stacked bar charts can be represented in more illustrative ways.</p>
<p>One way in which this could be done here is through the use of grouping and faceting in order to present the bars according to regional groupings</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># adding regional groupings </span></span>
<span><span class='va'>all_countries</span> <span class='op'>&lt;-</span> <span class='va'>all_countries</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>region <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>    <span class='va'>country</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Denmark"</span>, <span class='st'>"Sweden"</span>, <span class='st'>"Finland"</span>, <span class='st'>"Estonia"</span>, <span class='st'>"Latvia"</span>, <span class='st'>"Lithuania"</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"Nordic &amp; Baltic"</span>,</span>
<span>    <span class='va'>country</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Poland"</span>, <span class='st'>"Czechia"</span>, <span class='st'>"Slovakia"</span>, <span class='st'>"Hungary"</span>, <span class='st'>"Slovenia"</span>, <span class='st'>"Croatia"</span>, <span class='st'>"Romania"</span>, <span class='st'>"Bulgaria"</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"Eastern Europe"</span>,</span>
<span>    <span class='va'>country</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Germany"</span>, <span class='st'>"Austria"</span>, <span class='st'>"Belgium"</span>, <span class='st'>"Netherlands"</span>, <span class='st'>"Luxembourg"</span>, <span class='st'>"Ireland"</span>, <span class='st'>"France"</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"Western Europe"</span>,</span>
<span>    <span class='va'>country</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Spain"</span>, <span class='st'>"Portugal"</span>, <span class='st'>"Italy"</span>, <span class='st'>"Greece"</span>, <span class='st'>"Malta"</span>, <span class='st'>"Cyprus"</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"Southern Europe"</span>,</span>
<span>    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='st'>"Other"</span></span>
<span>  <span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># setting party factor levels</span></span>
<span><span class='va'>all_countries</span><span class='op'>$</span><span class='va'>party</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>all_countries</span><span class='op'>$</span><span class='va'>party</span>, levels <span class='op'>=</span> <span class='va'>party_order</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># creating the faceted plot</span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>all_countries</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>country</span>, </span>
<span>                          y <span class='op'>=</span> <span class='va'>vote_proportion</span>, </span>
<span>                          fill <span class='op'>=</span> <span class='va'>party</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></span><span class='op'>(</span>stat <span class='op'>=</span> <span class='st'>"identity"</span>, </span>
<span>           width <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span></span>
<span>    values <span class='op'>=</span> <span class='va'>custom_cols</span>,</span>
<span>    labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>      <span class='st'>"Independent"</span> <span class='op'>=</span> <span class='st'>"Independent"</span>,</span>
<span>      <span class='st'>"NI"</span> <span class='op'>=</span> <span class='st'>"Non-Inscrits"</span>,</span>
<span>      <span class='st'>"ESN"</span> <span class='op'>=</span> <span class='st'>"Europe of Sovereign Nations"</span>,</span>
<span>      <span class='st'>"Theleft"</span> <span class='op'>=</span> <span class='st'>"The Left"</span>,</span>
<span>      <span class='st'>"GREENSEFA"</span> <span class='op'>=</span> <span class='st'>"Greens/EFA"</span>,</span>
<span>      <span class='st'>"Renew"</span> <span class='op'>=</span> <span class='st'>"Renew Europe"</span>,</span>
<span>      <span class='st'>"ECR"</span> <span class='op'>=</span> <span class='st'>"European Conservatives &amp; Reformists"</span>,</span>
<span>      <span class='st'>"Patriots"</span> <span class='op'>=</span> <span class='st'>"Patriots for Europe"</span>,</span>
<span>      <span class='st'>"SD"</span> <span class='op'>=</span> <span class='st'>"Socialists &amp; Democrats"</span>,</span>
<span>      <span class='st'>"EPP"</span> <span class='op'>=</span> <span class='st'>"European People's Party"</span></span>
<span>    <span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span></span>
<span>    expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>    breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>100</span>, <span class='fl'>25</span><span class='op'>)</span>,</span>
<span>    labels <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='st'>"%"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>facet_wrap</a></span><span class='op'>(</span><span class='op'>~</span> <span class='va'>region</span>, scales <span class='op'>=</span> <span class='st'>"free_x"</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span></span>
<span>    title <span class='op'>=</span> <span class='st'>"2024 European Parliament Election Results by Country"</span>,</span>
<span>    subtitle <span class='op'>=</span> <span class='st'>"Vote share by political group and region"</span>,</span>
<span>    x <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>    y <span class='op'>=</span> <span class='st'>"Vote Share"</span>,</span>
<span>    fill <span class='op'>=</span> <span class='st'>"Political Group"</span>,</span>
<span>    caption <span class='op'>=</span> <span class='st'>"Source: European Parliament Election Results 2024"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span>base_size <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span><span class='co'># defining the plot background</span></span>
<span>    plot.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"white"</span>, </span>
<span>                                   color <span class='op'>=</span> <span class='cn'>NA</span><span class='op'>)</span>,</span>
<span>    panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"white"</span>, </span>
<span>                                    color <span class='op'>=</span> <span class='cn'>NA</span><span class='op'>)</span>,</span>
<span>    panel.grid.major.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    panel.grid.minor <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    panel.grid.major.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"grey90"</span>, </span>
<span>                                      linewidth <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>,</span>
<span>    </span>
<span><span class='co'># styling the axes</span></span>
<span>    axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>45</span>, </span>
<span>                               hjust <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>                               vjust <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>                               size <span class='op'>=</span> <span class='fl'>9</span>, </span>
<span>                               color <span class='op'>=</span> <span class='st'>"grey20"</span><span class='op'>)</span>,</span>
<span>    axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>10</span>, </span>
<span>                               color <span class='op'>=</span> <span class='st'>"grey20"</span><span class='op'>)</span>,</span>
<span>    axis.title.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>11</span>, </span>
<span>                                face <span class='op'>=</span> <span class='st'>"bold"</span>, </span>
<span>                                color <span class='op'>=</span> <span class='st'>"grey20"</span>, </span>
<span>                                margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>r <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    axis.line.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"grey60"</span>, </span>
<span>                               linewidth <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>,</span>
<span>    </span>
<span><span class='co'># styling the title</span></span>
<span>    plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>16</span>, </span>
<span>                              face <span class='op'>=</span> <span class='st'>"bold"</span>, </span>
<span>                              color <span class='op'>=</span> <span class='st'>"grey10"</span>, </span>
<span>                              margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>b <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>12</span>, </span>
<span>                                 color <span class='op'>=</span> <span class='st'>"grey30"</span>, </span>
<span>                                 margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>b <span class='op'>=</span> <span class='fl'>15</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    plot.caption <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>9</span>, </span>
<span>                                color <span class='op'>=</span> <span class='st'>"grey50"</span>, </span>
<span>                                hjust <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>                                margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>15</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    </span>
<span><span class='co'># styling the facet strip</span></span>
<span>    strip.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"grey95"</span>, </span>
<span>                                    color <span class='op'>=</span> <span class='st'>"grey60"</span>, </span>
<span>                                    linewidth <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>,</span>
<span>    strip.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>11</span>, </span>
<span>                              face <span class='op'>=</span> <span class='st'>"bold"</span>, </span>
<span>                              color <span class='op'>=</span> <span class='st'>"grey20"</span>, </span>
<span>                              margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    </span>
<span><span class='co'># styling the legend</span></span>
<span>    legend.position <span class='op'>=</span> <span class='st'>"right"</span>,</span>
<span>    legend.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>11</span>, </span>
<span>                                face <span class='op'>=</span> <span class='st'>"bold"</span>, </span>
<span>                                color <span class='op'>=</span> <span class='st'>"grey20"</span><span class='op'>)</span>,</span>
<span>    legend.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>10</span>, </span>
<span>                               color <span class='op'>=</span> <span class='st'>"grey20"</span><span class='op'>)</span>,</span>
<span>    legend.key.size <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.8</span>, <span class='st'>"cm"</span><span class='op'>)</span>,</span>
<span>    legend.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"white"</span>, </span>
<span>                                     color <span class='op'>=</span> <span class='st'>"grey80"</span>, </span>
<span>                                     linewidth <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>,</span>
<span>    legend.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>10</span><span class='op'>)</span>,</span>
<span>    </span>
<span><span class='co'># defining the margins</span></span>
<span>    plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>20</span>, <span class='fl'>20</span>, <span class='fl'>20</span>, <span class='fl'>20</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-60-1.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># saving the plot</span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span><span class='st'>"eu_election_faceted_region.png"</span>, width <span class='op'>=</span> <span class='fl'>16</span>, </span>
<span>                                        height <span class='op'>=</span> <span class='fl'>10</span>, </span>
<span>                                         dpi <span class='op'>=</span> <span class='fl'>300</span>, </span>
<span>                                          bg <span class='op'>=</span> <span class='st'>"white"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="eu_election_faceted_region.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<p>Alternatively, instead of regional groupings, the bars could be arranged by old vs new EU member states</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># grouping according to EU-15 vs post-2004 members</span></span>
<span><span class='va'>all_countries</span> <span class='op'>&lt;-</span> <span class='va'>all_countries</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>eu_group <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>    <span class='va'>country</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Belgium"</span>, <span class='st'>"France"</span>, <span class='st'>"Germany"</span>, <span class='st'>"Italy"</span>, <span class='st'>"Luxembourg"</span>, <span class='st'>"Netherlands"</span>,</span>
<span>                   <span class='st'>"Denmark"</span>, <span class='st'>"Ireland"</span>, <span class='st'>"Greece"</span>, <span class='st'>"Spain"</span>, <span class='st'>"Portugal"</span>, </span>
<span>                   <span class='st'>"Austria"</span>, <span class='st'>"Finland"</span>, <span class='st'>"Sweden"</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"EU-15 (pre-2004)"</span>,</span>
<span>    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='st'>"Post-2004 Members"</span></span>
<span>  <span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># setting party factor levels</span></span>
<span><span class='va'>all_countries</span><span class='op'>$</span><span class='va'>party</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>all_countries</span><span class='op'>$</span><span class='va'>party</span>, levels <span class='op'>=</span> <span class='va'>party_order</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># creating the faceted plot</span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>all_countries</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>country</span>, y <span class='op'>=</span> <span class='va'>vote_proportion</span>, fill <span class='op'>=</span> <span class='va'>party</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></span><span class='op'>(</span>stat <span class='op'>=</span> <span class='st'>"identity"</span>, width <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span></span>
<span>    values <span class='op'>=</span> <span class='va'>custom_cols</span>,</span>
<span>    labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>      <span class='st'>"Independent"</span> <span class='op'>=</span> <span class='st'>"Independent"</span>,</span>
<span>      <span class='st'>"NI"</span> <span class='op'>=</span> <span class='st'>"Non-Inscrits"</span>,</span>
<span>      <span class='st'>"ESN"</span> <span class='op'>=</span> <span class='st'>"Europe of Sovereign Nations"</span>,</span>
<span>      <span class='st'>"Theleft"</span> <span class='op'>=</span> <span class='st'>"The Left"</span>,</span>
<span>      <span class='st'>"GREENSEFA"</span> <span class='op'>=</span> <span class='st'>"Greens/EFA"</span>,</span>
<span>      <span class='st'>"Renew"</span> <span class='op'>=</span> <span class='st'>"Renew Europe"</span>,</span>
<span>      <span class='st'>"ECR"</span> <span class='op'>=</span> <span class='st'>"European Conservatives &amp; Reformists"</span>,</span>
<span>      <span class='st'>"Patriots"</span> <span class='op'>=</span> <span class='st'>"Patriots for Europe"</span>,</span>
<span>      <span class='st'>"SD"</span> <span class='op'>=</span> <span class='st'>"Socialists &amp; Democrats"</span>,</span>
<span>      <span class='st'>"EPP"</span> <span class='op'>=</span> <span class='st'>"European People's Party"</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span></span>
<span>    expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>    breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>100</span>, <span class='fl'>25</span><span class='op'>)</span>,</span>
<span>    labels <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='st'>"%"</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>facet_wrap</a></span><span class='op'>(</span><span class='op'>~</span> <span class='va'>eu_group</span>, scales <span class='op'>=</span> <span class='st'>"free_x"</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span></span>
<span>    title <span class='op'>=</span> <span class='st'>"2024 European Parliament Election Results by Country"</span>,</span>
<span>    subtitle <span class='op'>=</span> <span class='st'>"Vote share by political group: Comparing old and new EU members"</span>,</span>
<span>    x <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>    y <span class='op'>=</span> <span class='st'>"Vote Share"</span>,</span>
<span>    fill <span class='op'>=</span> <span class='st'>"Political Group"</span>,</span>
<span>    caption <span class='op'>=</span> <span class='st'>"Source: European Parliament Election Results 2024"</span></span>
<span>  <span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span>base_size <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span><span class='co'># plotting the background</span></span>
<span>    plot.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"white"</span>, </span>
<span>                                   color <span class='op'>=</span> <span class='cn'>NA</span><span class='op'>)</span>,</span>
<span>    panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"white"</span>, </span>
<span>                                    color <span class='op'>=</span> <span class='cn'>NA</span><span class='op'>)</span>,</span>
<span>    panel.grid.major.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    panel.grid.minor <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>    panel.grid.major.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"grey90"</span>, </span>
<span>                                      linewidth <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>,</span>
<span>    </span>
<span><span class='co'># styling the axes</span></span>
<span>    axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>45</span>, </span>
<span>                               hjust <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>                               vjust <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>                               size <span class='op'>=</span> <span class='fl'>9</span>, </span>
<span>                               color <span class='op'>=</span> <span class='st'>"grey20"</span><span class='op'>)</span>,</span>
<span>    axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>10</span>, </span>
<span>                               color <span class='op'>=</span> <span class='st'>"grey20"</span><span class='op'>)</span>,</span>
<span>    axis.title.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>11</span>, </span>
<span>                                face <span class='op'>=</span> <span class='st'>"bold"</span>, </span>
<span>                                color <span class='op'>=</span> <span class='st'>"grey20"</span>, </span>
<span>                                margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>r <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    axis.line.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"grey60"</span>, </span>
<span>                               linewidth <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>,</span>
<span>    </span>
<span><span class='co'># styling the title</span></span>
<span>    plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>16</span>, </span>
<span>                              face <span class='op'>=</span> <span class='st'>"bold"</span>, </span>
<span>                              color <span class='op'>=</span> <span class='st'>"grey10"</span>, </span>
<span>                              margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>b <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>12</span>, </span>
<span>                                 color <span class='op'>=</span> <span class='st'>"grey30"</span>, </span>
<span>                                 margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>b <span class='op'>=</span> <span class='fl'>15</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    plot.caption <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>9</span>, </span>
<span>                                color <span class='op'>=</span> <span class='st'>"grey50"</span>, </span>
<span>                                hjust <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>                                margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>15</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    </span>
<span><span class='co'># styling the facet strip</span></span>
<span>    strip.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"grey95"</span>, </span>
<span>                                    color <span class='op'>=</span> <span class='st'>"grey60"</span>, </span>
<span>                                    linewidth <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>,</span>
<span>    strip.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>11</span>, </span>
<span>                              face <span class='op'>=</span> <span class='st'>"bold"</span>, </span>
<span>                              color <span class='op'>=</span> <span class='st'>"grey20"</span>, </span>
<span>                              margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    </span>
<span><span class='co'># styling the legend</span></span>
<span>    legend.position <span class='op'>=</span> <span class='st'>"right"</span>,</span>
<span>    legend.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>11</span>, </span>
<span>                                face <span class='op'>=</span> <span class='st'>"bold"</span>, </span>
<span>                                color <span class='op'>=</span> <span class='st'>"grey20"</span><span class='op'>)</span>,</span>
<span>    legend.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>10</span>, </span>
<span>                               color <span class='op'>=</span> <span class='st'>"grey20"</span><span class='op'>)</span>,</span>
<span>    legend.key.size <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.8</span>, <span class='st'>"cm"</span><span class='op'>)</span>,</span>
<span>    legend.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"white"</span>, </span>
<span>                                     color <span class='op'>=</span> <span class='st'>"grey80"</span>, </span>
<span>                                     linewidth <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>,</span>
<span>    legend.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>10</span>, <span class='fl'>10</span><span class='op'>)</span>,</span>
<span>    </span>
<span><span class='co'># defining the margins</span></span>
<span>    plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>20</span>, <span class='fl'>20</span>, <span class='fl'>20</span>, <span class='fl'>20</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
<img src="100561659_files/figure-html5/unnamed-chunk-62-1.png" width="100%" style="display: block; margin: auto;" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># saving the plot</span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span><span class='st'>"eu_election_old_vs_new.png"</span>, width <span class='op'>=</span> <span class='fl'>16</span>, </span>
<span>                                    height <span class='op'>=</span> <span class='fl'>10</span>, </span>
<span>                                      dpi <span class='op'>=</span> <span class='fl'>300</span>, </span>
<span>                                        bg <span class='op'>=</span> <span class='st'>"white"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="eu_election_old_vs_new.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<h2 id="multiple-maps">MULTIPLE MAPS</h2>
<p>The use of the choropleth map in the original visualisation does a relatively good job at simultaneously displaying both the dominant party in each country (through distinct party colours) and the magnitude of their lead (through colour intensity), creating an effective bivariate visualization. Nonetheless, the individual map on its own is somewhat limited as only the top European Parliament group in each country is represented. It would likely be beneficial to a viewer to understand the percentage of seats each European Parliament group received across the entire EU27 area.</p>
<p>In order to do this, facets were once again employed in order to expand upon the original visualisation.</p>
<p>Here I have used a different method for obtaining the map shape of the EU27 countries than I did in the replication of the original plot. After using ggplot2, rnaturalearth, and other packages throughout the course of this project I have become more comfortable and hopefully more proficient in their use and would now make different choices for things like creating the background map than I did when I originally created it several weeks ago. Unfortunatley, changing the approach to the map in the reproduction to match the (better?) approach used in this re-imagination completely changes the basis upon which pretty much every other element of the reproduction is based. Long story short, this would mean having to go back and recreate everything else to match the new background map therefore is not a logistically possible option at this stage of the project.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># getting the europe map data</span></span>
<span><span class='va'>europe</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://docs.ropensci.org/rnaturalearth/reference/ne_countries.html'>ne_countries</a></span><span class='op'>(</span>scale <span class='op'>=</span> <span class='st'>"medium"</span>, </span>
<span>                       continent <span class='op'>=</span> <span class='st'>"Europe"</span>, </span>
<span>                       returnclass <span class='op'>=</span> <span class='st'>"sf"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># filtering for the EU27 countries</span></span>
<span><span class='va'>eu_countries</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Austria"</span>, <span class='st'>"Belgium"</span>, <span class='st'>"Bulgaria"</span>, <span class='st'>"Croatia"</span>, <span class='st'>"Cyprus"</span>, <span class='st'>"Czechia"</span>, <span class='st'>"Denmark"</span>, <span class='st'>"Estonia"</span>, <span class='st'>"Finland"</span>, <span class='st'>"France"</span>, <span class='st'>"Germany"</span>, <span class='st'>"Greece"</span>, <span class='st'>"Hungary"</span>, <span class='st'>"Ireland"</span>, <span class='st'>"Italy"</span>, <span class='st'>"Latvia"</span>, <span class='st'>"Lithuania"</span>, <span class='st'>"Luxembourg"</span>, <span class='st'>"Malta"</span>, <span class='st'>"Netherlands"</span>, <span class='st'>"Poland"</span>, <span class='st'>"Portugal"</span>, <span class='st'>"Romania"</span>, <span class='st'>"Slovakia"</span>, <span class='st'>"Slovenia"</span>, <span class='st'>"Spain"</span>, <span class='st'>"Sweden"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>europe_eu</span> <span class='op'>&lt;-</span> <span class='va'>europe</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>name</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>eu_countries</span> <span class='op'>|</span> <span class='va'>sovereignt</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>eu_countries</span> <span class='op'>|</span> <span class='va'>admin</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>eu_countries</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># preparing the data</span></span>
<span><span class='va'>all_countries_long</span> <span class='op'>&lt;-</span> <span class='va'>all_countries</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>country</span>, <span class='va'>party</span>, <span class='va'>vote_proportion</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># joining with the map data</span></span>
<span><span class='va'>europe_map_data</span> <span class='op'>&lt;-</span> <span class='va'>europe_eu</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>country <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>    <span class='va'>name</span> <span class='op'>==</span> <span class='st'>"Czech Republic"</span> <span class='op'>~</span> <span class='st'>"Czechia"</span>,</span>
<span>    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='va'>name</span></span>
<span>  <span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>all_countries_long</span>, by <span class='op'>=</span> <span class='st'>"country"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># creating a map for each party</span></span>
<span><span class='va'>create_party_map</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>party_name</span>, <span class='va'>data</span>, <span class='va'>base_map</span>, <span class='va'>party_colors</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  </span>
<span>  <span class='va'>party_data</span> <span class='op'>&lt;-</span> <span class='va'>data</span> <span class='op'>|&gt;</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>party</span> <span class='op'>==</span> <span class='va'>party_name</span><span class='op'>)</span></span>
<span>  <span class='va'>party_color</span> <span class='op'>&lt;-</span> <span class='va'>party_colors</span><span class='op'>[</span><span class='va'>party_name</span><span class='op'>]</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsf.html'>geom_sf</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>base_map</span>, </span>
<span>            fill <span class='op'>=</span> <span class='st'>"grey95"</span>, </span>
<span>            color <span class='op'>=</span> <span class='st'>"white"</span>, </span>
<span>            size <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsf.html'>geom_sf</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>party_data</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='va'>vote_proportion</span><span class='op'>)</span>, </span>
<span>            color <span class='op'>=</span> <span class='st'>"white"</span>, size <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_gradient.html'>scale_fill_gradient</a></span><span class='op'>(</span></span>
<span>      low <span class='op'>=</span> <span class='st'>"white"</span>,</span>
<span>      high <span class='op'>=</span> <span class='va'>party_color</span>,</span>
<span>      name <span class='op'>=</span> <span class='st'>"Vote %"</span>,</span>
<span>      limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>50</span><span class='op'>)</span>,</span>
<span>      breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>50</span>, <span class='fl'>10</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsf.html'>coord_sf</a></span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>10</span>, <span class='fl'>30</span><span class='op'>)</span>, ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>35</span>, <span class='fl'>71</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='va'>party_name</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span>base_size <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>      plot.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"white"</span>, </span>
<span>                                     color <span class='op'>=</span> <span class='cn'>NA</span><span class='op'>)</span>,</span>
<span>      panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"white"</span>, </span>
<span>                                      color <span class='op'>=</span> <span class='cn'>NA</span><span class='op'>)</span>,</span>
<span>      panel.grid <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"grey90"</span>, </span>
<span>                                linewidth <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span>,</span>
<span>      </span>
<span>      plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>11</span>, </span>
<span>                                face <span class='op'>=</span> <span class='st'>"bold"</span>, </span>
<span>                                color <span class='op'>=</span> <span class='st'>"grey20"</span>, </span>
<span>                                hjust <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>,</span>
<span>      </span>
<span>      legend.position <span class='op'>=</span> <span class='st'>"right"</span>,</span>
<span>      legend.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>9</span>, </span>
<span>                                  face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>,</span>
<span>      legend.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span>,</span>
<span>      legend.key.height <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.8</span>, <span class='st'>"cm"</span><span class='op'>)</span>,</span>
<span>      legend.key.width <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.4</span>, <span class='st'>"cm"</span><span class='op'>)</span>,</span>
<span>      </span>
<span>      axis.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>      axis.ticks <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>      </span>
<span>      plot.margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>5</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='co'># using the party order from donut_party_order to ensure correct order and matching</span></span>
<span><span class='va'>party_list</span> <span class='op'>&lt;-</span> <span class='va'>party_order</span></span>
<span></span>
<span><span class='co'># creating individual maps for each party in the correct order</span></span>
<span><span class='va'>map_list</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>party_list</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='fu'>create_party_map</span><span class='op'>(</span><span class='va'>p</span>, <span class='va'>europe_map_data</span>, <span class='va'>europe_eu</span>, <span class='va'>custom_cols</span><span class='op'>)</span></span>
<span><span class='op'>}</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># combining using patchwork with 2 rows</span></span>
<span><span class='va'>combined_map</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/wrap_plots.html'>wrap_plots</a></span><span class='op'>(</span><span class='va'>map_list</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_annotation.html'>plot_annotation</a></span><span class='op'>(</span></span>
<span>    title <span class='op'>=</span> <span class='st'>"2024 European Parliament Election Results by Party"</span>,</span>
<span>    subtitle <span class='op'>=</span> <span class='st'>"Vote share for each political group across EU member states"</span>,</span>
<span>    caption <span class='op'>=</span> <span class='st'>"Source: European Parliament Election Results 2024"</span>,</span>
<span>    theme <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span></span>
<span>      plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>16</span>, </span>
<span>                                face <span class='op'>=</span> <span class='st'>"bold"</span>, </span>
<span>                                color <span class='op'>=</span> <span class='st'>"grey10"</span>, </span>
<span>                                margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>b <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>      plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>12</span>, </span>
<span>                                   color <span class='op'>=</span> <span class='st'>"grey30"</span>, </span>
<span>                                   margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>b <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>      plot.caption <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>9</span>, </span>
<span>                                  color <span class='op'>=</span> <span class='st'>"grey50"</span>, </span>
<span>                                  hjust <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>                                  margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>      plot.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"white"</span>, </span>
<span>                                     color <span class='op'>=</span> <span class='cn'>NA</span><span class='op'>)</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='co'># saving the plot</span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span><span class='st'>"eu_election_faceted_maps_individual_legends.png"</span>, </span>
<span>       plot <span class='op'>=</span> <span class='va'>combined_map</span>, </span>
<span>       width <span class='op'>=</span> <span class='fl'>20</span>, height <span class='op'>=</span> <span class='fl'>10</span>, dpi <span class='op'>=</span> <span class='fl'>300</span>, bg <span class='op'>=</span> <span class='st'>"white"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="eu_election_faceted_maps_individual_legends.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Pirzkall (2025, Dec. 15). Data Visualization | MSc CSS: EUROPE ELECTS - Visualising the 2024 European Parliament Elections. Retrieved from https://csslab.uc3m.es/dataviz/projects/2025/100561659/</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@misc{pirzkall2025europe,
  author = {Pirzkall, Kirsty},
  title = {Data Visualization | MSc CSS: EUROPE ELECTS - Visualising the 2024 European Parliament Elections},
  url = {https://csslab.uc3m.es/dataviz/projects/2025/100561659/},
  year = {2025}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<!--radix_placeholder_navigation_after_body--><html><body>
<div class="distill-site-nav distill-site-footer">
<p><img src="../../../assets/acronimo_nombre1l_0.png" width="400"></p>
</div>
<!--/radix_placeholder_navigation_after_body-->
</body></html>


</body>

</html>
